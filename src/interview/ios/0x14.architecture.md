---
title: æ¶æ„è®¾è®¡
icon: hashtag

index: true

---

<!-- more -->

------

## æ¶æ„è®¾è®¡

### â“`AppDelegate` å¦‚ä½•ç˜¦èº«

::: details ğŸ’¡

> `AppDelegate`ï¼š`iOS` åº”ç”¨ç¨‹åºçš„å…¥å£ç‚¹å’Œä¸­å¤®åè°ƒè€…ï¼Œå› æ­¤é€šå¸¸æœ‰è®¸å¤šä»£ç éƒ½ä¼šé›†ä¸­åœ¨æ­¤ã€‚æŒ‰ç…§æœ€åˆçš„è®¾è®¡ï¼Œå®ƒå¤„ç†ç”Ÿå‘½å‘¨æœŸäº‹ä»¶ã€æ¨é€é€šçŸ¥ç­‰ã€‚éšç€æ—¶é—´çš„æ¨ç§»ï¼Œ`AppDelegate` å¯èƒ½ä¼šç§¯ç´¯å¤§é‡çš„ä»£ç ï¼Œå¯¼è‡´å…¶éš¾ä»¥ç†è§£å’Œç»´æŠ¤ã€‚

- ä½¿ç”¨æœåŠ¡ç±»ï¼šå¯ä»¥å°† `AppDelegate` ä¸­çš„ä¸€äº›ä»£ç å‰¥ç¦»å‡ºæ¥ï¼Œå»ºç«‹ä¸ºå•ç‹¬çš„æœåŠ¡ç±»ã€‚
    > ä¾‹å¦‚ï¼Œå¯ä»¥å°†å¤„ç†æ¨é€é€šçŸ¥çš„ä»£ç ç§»è‡³ä¸€ä¸ªåä¸º `PushNotificationService` çš„ç±»ä¸­ï¼Œè¿™æ · `AppDelegate` åªéœ€è¦ç»´æŠ¤ä¸€ä¸ª `PushNotificationService` çš„å®ä¾‹ï¼Œé€šè¿‡è°ƒç”¨å¯¹åº”æ–¹æ³•è¿›è¡Œæ“ä½œã€‚

- ä½¿ç”¨ç»„åˆæ–¹å¼ï¼šå¦‚æœå¯èƒ½ï¼Œä½¿ç”¨ç»„åˆæ–¹å¼è€Œä¸æ˜¯ç»§æ‰¿ï¼Œå°†å¯¹è±¡çš„ä¸€äº›åŠŸèƒ½æå–ä¸ºå•ç‹¬çš„ç»„ä»¶ï¼Œé¿å…åœ¨ `AppDelegate` ä¸­æ·»åŠ è¿‡å¤šçš„ä»£ç ã€‚

- å¯¹å‡½æ•°è¿›è¡Œé‡æ„ï¼šè§‚å¯Ÿæ˜¯å¦æœ‰é‡å¤çš„ä»£ç ï¼Œå°è¯•æå–è¿™äº›ä»£ç ä¸ºæ–°çš„å‡½æ•°ã€‚å°è¯•å°†å¤æ‚å‡½æ•°æ‹†åˆ†ä¸ºå‡ ä¸ªç®€å•å‡½æ•°ï¼Œè¿™æ ·å¯ä»¥ä½¿å¾—ä»£ç æ›´åŠ æ¸…æ™°ï¼Œä¹Ÿæœ‰åˆ©äºç†è§£å’Œç»´æŠ¤ã€‚

- ä½¿ç”¨ `Coordinator`ï¼š
    > `Coordinator` æ˜¯ä¸€ä¸ªè®¾è®¡æ¨¡å¼ï¼Œå®ƒå¯ä»¥ç”¨æ¥é‡æ„ `AppDelegate` çš„ä¸€éƒ¨åˆ†ä»£ç ï¼Œç‰¹åˆ«æ˜¯å…³äºå¯¼èˆªé€»è¾‘çš„ä»£ç ã€‚ `Coordinator` ä¼šå¤„ç†ç¨‹åºçš„å¯åŠ¨ã€æ­£åœ¨è¿è¡Œå’Œè¿›å…¥åå°ç­‰äº‹ä»¶ï¼Œå®ƒä¸ `AppDelegate` ä¸€èµ·å·¥ä½œï¼Œä½†æ˜¯ç‹¬ç«‹äºè§†å›¾æ§åˆ¶å™¨å’Œå¯¼èˆªæ§åˆ¶å™¨ã€‚

:::

### â“ä» 0 å¼€å§‹åšä¸€ä¸ªé¡¹ç›®ï¼Œä½ æ˜¯å¦‚ä½•æ¶æ„æ€è€ƒçš„

::: details ğŸ’¡

- ç†è§£éœ€æ±‚
    > å…ˆè¦å®Œå…¨ç†è§£é¡¹ç›®çš„éœ€æ±‚ï¼ŒåŒ…æ‹¬ç”¨æˆ·çš„éœ€æ±‚å’ŒæŠ€æœ¯éœ€æ±‚ã€‚ç¡®è®¤é¡¹ç›®çš„ç›®æ ‡ï¼Œåœ¨å¤šå°‘æ—¶é—´å†…éœ€è¦å®Œæˆå“ªäº›åŠŸèƒ½ï¼Œä»¥åŠé¢„æœŸçš„é•¿æœŸç›®æ ‡ã€‚

- å®šä¹‰æ¶æ„
    > åœ¨æ˜ç¡®éœ€æ±‚çš„åŸºç¡€ä¸Šï¼Œå¼€å§‹é€‰æ‹©æˆ–å®šä¹‰é¡¹ç›®çš„æ¶æ„ã€‚å¯ä»¥è€ƒè™‘ `MVCã€MVVMã€MVPã€VIPERã€RIBs` ç­‰ã€‚æ¯ç§æ¶æ„æ¨¡å¼æœ‰å…¶ä¼˜ç¼ºç‚¹ï¼Œéœ€è¦æ ¹æ®é¡¹ç›®éœ€æ±‚å’Œå›¢é˜Ÿç†Ÿæ‚‰åº¦è¿›è¡Œé€‰æ‹©ã€‚

- é€‰æ‹©æŠ€æœ¯æ ˆ
    > ç¡®å®šé¡¹ç›®çš„æŠ€æœ¯æ ˆï¼Œå¦‚ä½¿ç”¨ `Objective-C` è¿˜æ˜¯ `Swift` è¿›è¡Œå¼€å‘ã€ä½¿ç”¨ `RxSwift` è¿˜æ˜¯ `Combine` è¿›è¡Œå“åº”å¼ç¼–ç¨‹ã€ä½¿ç”¨å“ªç§ç¬¬ä¸‰æ–¹åº“ç­‰ã€‚

- è®¾è®¡æ•°æ®æµ
    > è®¾è®¡åº”ç”¨çš„æ•°æ®æµæ˜¯éå¸¸é‡è¦çš„ä¸€æ­¥ï¼Œå°¤å…¶æ˜¯å¤šäººå¼€å‘çš„é¡¹ç›®ã€‚ç†æƒ³çš„æƒ…å†µä¸‹ï¼Œæ•°æ®æµåº”è¯¥æ˜¯å•å‘çš„ï¼Œå¯é¢„æµ‹çš„ã€‚

- å®šä¹‰ç›®å½•ç»“æ„
    > ç¡®å®šä»£ç çš„æ–‡ä»¶å’Œç›®å½•ç»“æ„ï¼Œä½¿ä¹‹æ¸…æ™°æ˜“è¯»ï¼Œä¾¿äºåä½œã€‚`UIViewControllerã€UIViewã€Modelã€ViewModel` åº”è¯¥å…·æœ‰æ˜ç¡®çš„ç›®å½•åˆ’åˆ†ã€‚

- è®¾å®šç¼–ç è§„èŒƒ
    > ä¸ºå›¢é˜Ÿè®¾å®šä¸€è‡´çš„ç¼–ç è§„èŒƒå’Œæœ€ä½³å®è·µï¼Œå¦‚å‘½åè§„åˆ™ã€ç¼©è¿›æ ·å¼ã€æ³¨é‡Šè§„åˆ™ç­‰ï¼Œä»¥å‡å°‘ä»£ç å®¡æŸ¥çš„éš¾åº¦å’Œæ”¹è¿›ä»£ç è´¨é‡ã€‚

- é¢„ç•™æ‰©å±•ç‚¹
    > é¢„ç•™ä¸€äº›æ‰©å±•ç‚¹ï¼Œä½¿å¾—ä¹‹åå¯ä»¥å®¹æ˜“æ·»åŠ æ–°åŠŸèƒ½æˆ–è€…æ”¹å˜ç°æœ‰çš„å®ç°ã€‚

- æµ‹è¯•è®¡åˆ’
    > ä¸ºæ¯ä¸ªæ¨¡å—ç¼–å†™å•å…ƒæµ‹è¯•å’Œé›†æˆæµ‹è¯•ï¼Œç¡®ä¿è½¯ä»¶çš„æ­£ç¡®æ€§å’Œå¯é æ€§ã€‚

- è‡ªåŠ¨åŒ–å’ŒæŒç»­é›†æˆ
    > æ­å»ºè‡ªåŠ¨åŒ–æµ‹è¯•ã€æŒç»­é›†æˆå’ŒæŒç»­éƒ¨ç½²æµç¨‹ï¼Œä½¿å¾—å¼€å‘æµç¨‹æ›´ä¸ºä¾¿æ·é«˜æ•ˆã€‚

:::


### â“å¦‚ä½•ç¼–å†™å•å…ƒæµ‹è¯•(ä¾‹å¦‚å®Œæˆäº†ç½‘ç»œæ¨¡å—ï¼Œå¦‚ä½•æµ‹è¯•è¯¥ç½‘ç»œæ¨¡å—ï¼Œæµ‹è¯•ç”¨ä¾‹åº”è¯¥å¦‚ä½•è¦†ç›–)

::: details ğŸ’¡

  ç¼–å†™å•å…ƒæµ‹è¯•æ˜¯ä¸€ç§ä¿è¯ä»£ç è´¨é‡å’Œç¨‹åºç¨³å®šæ€§çš„æœ‰æ•ˆæ–¹æ³•ã€‚æµ‹è¯•ç”¨ä¾‹åº”è¯¥è¦†ç›–åˆ°æ‰€æœ‰çš„å¯èƒ½æ€§ï¼ŒåŒ…æ‹¬æ­£å¸¸çš„æƒ…å†µå’Œå¯èƒ½å‡ºç°çš„å„ç§è¾¹ç¼˜æƒ…å†µã€‚

ç½‘ç»œæ¨¡å—å•å…ƒæµ‹è¯•ï¼š

  - åˆ›å»ºä¸€ä¸ªæµ‹è¯•ç›®æ ‡ï¼Œå‘½åä¸º `NetworkModuleTests` `Xcode` ä¼šè‡ªåŠ¨ç”Ÿæˆä¸€ä¸ªæµ‹è¯•ç±»ã€‚

  - åœ¨æµ‹è¯•ç±»ä¸­ï¼Œå¯¼å…¥éœ€è¦æµ‹è¯•çš„æ¨¡å—ï¼Œæ¯”å¦‚ `import Networking`ã€‚

  - å¯¹äºç½‘ç»œæ¨¡å—çš„æµ‹è¯•ï¼Œå¸¸è§çš„æœ‰æµ‹è¯•ä¸€æ¬¡ç½‘ç»œè¯·æ±‚çš„æ‰€æœ‰ç¯èŠ‚ï¼ŒåŒ…æ‹¬åˆ›å»º`URL`ï¼Œåˆ›å»ºè¯·æ±‚ï¼Œå‘é€è¯·æ±‚ï¼Œè§£æå“åº”ç­‰ã€‚æ¯ä¸ªç¯èŠ‚éƒ½åº”è¯¥æœ‰å¯¹åº”çš„æµ‹è¯•ç”¨ä¾‹ã€‚

  - ç”±äºç½‘ç»œè¯·æ±‚å¯èƒ½æ¶‰åŠåˆ°å»¶è¿Ÿå’Œå¼‚æ­¥æ“ä½œï¼Œæ‰€ä»¥éœ€è¦ä½¿ç”¨ `XCTestExpectation` ç±»å‹çš„å¯¹è±¡æ¥å¤„ç†ã€‚
    
    ```swift
    // å¯¹ä¸€ä¸ªç½‘ç»œè¯·æ±‚çš„å‡½æ•°è¿›è¡Œæµ‹è¯•
    func testFetchData() {
        let expectation = XCTestExpectation(description: "Fetch data")
        
        NetworkModule.shared.fetchData(completion: { data, error in
            // å¦‚æœè¿”å›äº†é”™è¯¯æˆ–è€…æ²¡æœ‰è¿”å›æ•°æ®ï¼Œæµ‹è¯•ä¼šå¤±è´¥
            XCTAssertNil(error)
            XCTAssertNotNil(data)
            expectation.fulfill()
        })
        
        wait(for: [expectation], timeout: 5.0)
    }
    ```

  - è‡³äºæµ‹è¯•ç”¨ä¾‹çš„è¦†ç›–ï¼Œåº”è¯¥å°½é‡è€ƒè™‘åˆ°æ‰€æœ‰å¯èƒ½çš„æƒ…å†µã€‚
    > ä¾‹å¦‚ï¼Œå¯¹äºç½‘ç»œè¯·æ±‚ï¼Œä½ åº”è¯¥æµ‹è¯•å„ç§ç½‘ç»œé”™è¯¯çš„æƒ…å†µï¼Œä¾‹å¦‚æœåŠ¡å™¨æ— å“åº”ï¼Œè¿”å›äº†é”™è¯¯çš„çŠ¶æ€ç ç­‰ã€‚ä¹Ÿå¯ä»¥æµ‹è¯•è¾“å…¥äº†é”™è¯¯çš„ `URL` æˆ–å‚æ•°çš„æƒ…å†µã€‚

æ³¨æ„ï¼šå•å…ƒæµ‹è¯•åªæ˜¯æµ‹è¯•æ‰‹æ®µä¹‹ä¸€ï¼Œè¿˜æœ‰é›†æˆæµ‹è¯•ã€ç³»ç»Ÿæµ‹è¯•ã€å›å½’æµ‹è¯•ç­‰å…¶ä»–æµ‹è¯•æ–¹æ³•éœ€è¦é…åˆä½¿ç”¨ï¼Œç¡®ä¿ä»£ç è´¨é‡å’Œç³»ç»Ÿç¨³å®šæ€§ã€‚

:::

### â“å†…å­˜ç¼“å­˜ç­–ç•¥æœ‰å“ªäº›ï¼Œ`NSCache` ä½¿ç”¨ä»€ä¹ˆç¼“å­˜ç­–ç•¥

::: details ğŸ’¡

ç¼“å­˜ç­–ç•¥

  - `LRU` (Least Recently Used) æœ€è¿‘æœ€å°‘ä½¿ç”¨ï¼šç¼“å­˜æ»¡æ—¶ï¼Œæ·˜æ±°æœ€ä¹…æ²¡è¢«ä½¿ç”¨çš„æ•°æ®ã€‚

  - `FIFO` (First In First Out) å…ˆè¿›å…ˆå‡ºï¼šç¼“å­˜æ»¡æ—¶ï¼Œæ·˜æ±°æœ€æ—©è¿›å…¥ç¼“å­˜çš„æ•°æ®ã€‚

  - `LFU` (Least Frequently Used) æœ€ä¸ç»å¸¸ä½¿ç”¨ï¼šç¼“å­˜æ»¡æ—¶ï¼Œæ·˜æ±°ä½¿ç”¨é¢‘ç‡æœ€å°‘çš„æ•°æ®ã€‚
   
  - `RR` (Random Replacement) éšæœºæ›¿æ¢ï¼šç¼“å­˜æ»¡æ—¶ï¼Œéšæœºæ·˜æ±°ä¸€ä¸ªæ•°æ®ã€‚

`NSCache` ç¼“å­˜ç­–ç•¥é‡‡ç”¨çš„æ˜¯ `LRU`ã€‚`NSCache`æ˜¯ä¸€ä¸ªå®¹é‡é™åˆ¶çš„é›†åˆï¼Œç”¨æ¥å­˜å‚¨é”®å€¼å¯¹ï¼Œå¹¶ä¸”å½“å†…å­˜ç´§å¼ çš„æ—¶å€™è‡ªåŠ¨å›æ”¶ã€‚

`NSCache` ç‰¹ç‚¹ï¼š

  - çº¿ç¨‹å®‰å…¨çš„ï¼Œåœ¨å¤šçº¿ç¨‹ç¯å¢ƒä¸‹ï¼Œä¸å¿…åŠ é”å°±å¯ä»¥ä½¿ç”¨å®ƒã€‚
  - è‡ªåŠ¨æ ¹æ®ç³»ç»Ÿå†…å­˜æƒ…å†µæ¥ç¼©å‡ç¼“å­˜ï¼Œå½“ç³»ç»Ÿå†…å­˜ç´§å¼ æ—¶ï¼Œç³»ç»Ÿä¼šè‡ªåŠ¨ç§»é™¤éƒ¨åˆ†ç¼“å­˜æ•°æ®ï¼Œä»¥é‡Šæ”¾å†…å­˜ã€‚
  - è®¾ç½® `totalCostLimit` å‚æ•°æ¥æ ‡è¯†ç¼“å­˜çš„æˆæœ¬ï¼Œæ¯”å¦‚å¯ä»¥ä»£è¡¨ä½“ç§¯ï¼Œæ¶ˆè€—çš„å†…å­˜ï¼ŒIOï¼Œé€šå¸¸çš„ä½¿ç”¨åœºæ™¯æ˜¯å›¾ç‰‡çš„ç¼“å­˜ã€‚
  - å­˜å‚¨çš„æ•°æ®éƒ½æ˜¯å¼ºå¼•ç”¨ï¼Œä½†æ˜¯ä¸ä¼šé€ æˆå¾ªç¯å¼•ç”¨ã€‚å³å½“ç¼“å­˜æŸä¸ªå¯¹è±¡åï¼Œç¨‹åºä¼šä¿ç•™æ­¤å¯¹è±¡ï¼Œå¹¶ä¸”ä¸ä¼šå°†æ­¤å¯¹è±¡é‡Šæ”¾ã€‚

:::

### â“æ— ç—•åŸ‹ç‚¹å¦‚ä½•å®ç°ï¼Œä½ è®¤ä¸ºç†æƒ³çš„æ— ç—•åŸ‹ç‚¹åº”è¯¥å…·å¤‡å“ªäº›ç‰¹ç‚¹

::: details ğŸ’¡

æ— ç—•åŸ‹ç‚¹ï¼šåˆç§°ä¸ºè‡ªåŠ¨åŸ‹ç‚¹ï¼Œå®ƒé€šè¿‡åŠ¨æ€çš„æ–¹å¼ï¼Œè¿›è¡Œç”¨æˆ·è¡Œä¸ºå’Œäº¤äº’äº‹ä»¶çš„æ•°æ®æ”¶é›†ã€‚
  > åŸºæœ¬æ€è·¯ï¼šé€šè¿‡ `hook` äº‹ä»¶æˆ–æ¶ˆæ¯æœºåˆ¶ï¼Œæ¯”å¦‚ `iOS` ä¸­çš„ `method swizzling`ã€`Android` ä¸­çš„ `AOP`ï¼ŒåŠ¨æ€åœ°æ•è·åˆ°ç”¨æˆ·è¡Œä¸ºäº‹ä»¶ï¼Œç„¶åè®°å½•ä¸‹æ¥ã€‚

æ— ç—•åŸ‹ç‚¹çš„å®ç°ï¼š

  - åˆç†åˆ©ç”¨ç³»ç»Ÿæä¾›çš„ `runtime` æœºåˆ¶ã€‚ä¾‹å¦‚åœ¨ `iOS` ä¸­ï¼Œå¯ä»¥ä½¿ç”¨ `Objective-C` çš„åŠ¨æ€æ€§è´¨ï¼Œä½¿ç”¨ `Method Swizzling` æ”¹å˜æ–¹æ³•çš„å®ç°ï¼Œæˆ–åˆ©ç”¨ `KVO` è¿›è¡Œç›‘å¬ï¼›åœ¨ `Android` ä¸­ï¼Œåˆ©ç”¨å­—èŠ‚ç æŠ€æœ¯ï¼Œå¦‚ `AspectJ` è¿›è¡Œ `AOP` ç¼–ç¨‹ã€‚

  - åˆ©ç”¨åå°„æŠ€æœ¯æˆ–è€…åŠ¨æ€ä»£ç†è¿›è¡Œæ•°æ®æ”¶é›†ã€‚å¯ä»¥ç›´æ¥æ”¹å˜æˆ–è€…æ‹¦æˆªå‡½æ•°è°ƒç”¨ï¼Œä»è€Œè¿›è¡ŒåŸ‹ç‚¹ã€‚

  - åˆ©ç”¨ç³»ç»Ÿåº•å±‚çš„æ¶ˆæ¯æœºåˆ¶è¿›è¡Œäº‹ä»¶æ”¶é›†ã€‚ä¾‹å¦‚åœ¨ `iOS` ä¸­ï¼Œåˆ©ç”¨ `Responder Chain` è¿›è¡Œäº‹ä»¶ä¼ é€’ï¼›åœ¨ `Android` ä¸­ï¼Œåˆ©ç”¨ `EventBus` æˆ–è€…ç³»ç»Ÿè‡ªå®šä¹‰çš„å¹¿æ’­è¿›è¡Œäº‹ä»¶ä¼ é€’ã€‚

ç†æƒ³çš„æ— ç—•åŸ‹ç‚¹åº”è¯¥å…·å¤‡çš„ç‰¹ç‚¹ï¼š

  - ç²¾ç¡®æ•è·ï¼šèƒ½å‡†ç¡®æ•è·åˆ°ç”¨æˆ·æ‰€æœ‰è¡Œä¸ºå’Œäº¤äº’äº‹ä»¶ï¼Œä¸é—æ¼ï¼Œä¸é‡å¤ã€‚
  - é«˜æ€§èƒ½ï¼Œä½æ¶ˆè€—ï¼šå°½é‡å‡å°‘å¯¹æ€§èƒ½çš„å½±å“ï¼Œä¸ä¼šå› ä¸ºåŸ‹ç‚¹é€»è¾‘è€Œå¢åŠ `CPU`ã€å†…å­˜æ¶ˆè€—ï¼Œæˆ–è€…å¯¼è‡´å´©æºƒã€‚
  - æ˜“æ‰©å±•ï¼šå¯ä»¥æ ¹æ®ä¸åŒçš„éœ€æ±‚ï¼Œæ–¹ä¾¿åœ°å¢åŠ æˆ–è€…å‡å°‘åŸ‹ç‚¹äº‹ä»¶ã€‚
  - å¥å£®æ€§ï¼šå³ä½¿åœ¨æ¶åŠ£çš„ç½‘ç»œç¯å¢ƒä¸‹ï¼Œä¹Ÿèƒ½ä¿è¯æ•°æ®çš„å‡†ç¡®æ€§å’Œå®Œæ•´æ€§ã€‚
  - åº”ç”¨é€æ˜ï¼šå¯¹åº”ç”¨å±‚å®Œå…¨é€æ˜ï¼Œä¸æ”¹å˜ä»»ä½•ä¸šåŠ¡é€»è¾‘ã€‚
  - æ•°æ®å®‰å…¨ï¼šä¿è¯æ”¶é›†çš„æ•°æ®åœ¨ä¼ è¾“å’Œå­˜å‚¨è¿‡ç¨‹ä¸­çš„å®‰å…¨ã€‚

æ— ç—•åŸ‹ç‚¹çš„æœ€å¤§å¥½å¤„ï¼šé™ä½äº†å¯¹ä¸šåŠ¡ä»£ç çš„ä¾µå…¥æ€§ï¼Œä½¿ç¨‹åºå‘˜å¯ä»¥ä¸“æ³¨äºä¸šåŠ¡é€»è¾‘çš„å®ç°ï¼Œè€Œä¸ç”¨åœ¨æ¯ä¸€ä¸ªéœ€è¦è¿½è¸ªçš„ç‚¹ä¸Šæ’å…¥åŸ‹ç‚¹ä»£ç ï¼Œæ—¢æé«˜äº†å¼€å‘æ•ˆç‡ï¼Œåˆå‡å°‘äº†å‡ºé”™æ¦‚ç‡ï¼Œéå¸¸é€‚åˆå¤§è§„æ¨¡å¹¶ä¸”ä¸šåŠ¡é¢‘ç¹å˜åŒ–çš„é¡¹ç›®ã€‚

:::

### â“æ‰‹åŠ¨åŸ‹ç‚¹ã€è‡ªåŠ¨åŒ–åŸ‹ç‚¹ã€å¯è§†åŒ–åŸ‹ç‚¹

::: details ğŸ’¡

åŸ‹ç‚¹æ˜¯æ•°æ®åˆ†æä¸­çš„ä¸€ä¸ªé‡è¦æ¦‚å¿µï¼Œä¸»è¦ç”¨äºæ”¶é›†ç”¨æˆ·åœ¨äº§å“ä¸­çš„è¡Œä¸ºæ•°æ®ã€‚

- æ‰‹åŠ¨åŸ‹ç‚¹ï¼šå°±æ˜¯å¼€å‘è€…åœ¨éœ€è¦ç»Ÿè®¡çš„åœ°æ–¹æ‰‹åŠ¨æ’å…¥ç»Ÿè®¡ä»£ç ã€‚è¿™ç§æ–¹å¼èƒ½å¤Ÿç²¾ç¡®æ§åˆ¶è¦ç»Ÿè®¡çš„æ•°æ®ï¼ŒåŒæ—¶ä¹Ÿå¯ä»¥è·å–åˆ°ä¸°å¯Œçš„æ•°æ®ä¿¡æ¯ã€‚ä½†è¿™ç§æ–¹å¼çš„ç¼ºç‚¹æ˜¯å·¥ä½œé‡è¾ƒå¤§ï¼Œä¸€æ—¦ä¸šåŠ¡æœ‰å˜æ›´ï¼Œå¯èƒ½éœ€è¦ä¿®æ”¹å¤§é‡ä»£ç ã€‚

- è‡ªåŠ¨åŸ‹ç‚¹ï¼šè‡ªåŠ¨åŸ‹ç‚¹ä¸€èˆ¬æ˜¯é€šè¿‡ `hook` ç›¸å…³çš„ç³»ç»Ÿæ–¹æ³•æ¥å®ç°çš„ã€‚ä¾‹å¦‚æ‰‹æœºåº”ç”¨ä¸­ï¼Œå¯ä»¥é€šè¿‡ `hook` ç”¨æˆ·ç‚¹å‡»äº‹ä»¶ï¼Œè‡ªåŠ¨çš„è®°å½•ç”¨æˆ·çš„è¡Œä¸ºã€‚è¿™ç§æ–¹å¼çš„ä¼˜ç‚¹æ˜¯å·¥ä½œé‡å°ï¼Œä¸€æ¬¡è®¾ç½®å¥½å°±å¯ä»¥å…¨å±€ç”Ÿæ•ˆã€‚ä½†ç¼ºç‚¹æ˜¯æ— æ³•è·å–åˆ°å…·ä½“çš„ä¸šåŠ¡æ•°æ®ï¼Œåªèƒ½ç»Ÿè®¡åˆ°ç”¨æˆ·çš„è¡Œä¸ºã€‚

- å¯è§†åŒ–åŸ‹ç‚¹ï¼šå¯è§†åŒ–åŸ‹ç‚¹æ˜¯ä¸€ç§æ–°çš„åŸ‹ç‚¹æ–¹å¼ï¼Œå¯ä»¥é€šè¿‡å¯è§†åŒ–çš„æ“ä½œç•Œé¢ï¼Œè¿›è¡ŒåŸ‹ç‚¹çš„è®¾ç½®å’Œé…ç½®ï¼Œæ— éœ€ç¼–å†™ä»£ç ã€‚è¿™ç§æ–¹å¼æœ‰åˆ©äºéå¼€å‘äººå‘˜è¿›è¡Œæ•°æ®ç»Ÿè®¡ï¼Œæé«˜äº†å·¥ä½œæ•ˆç‡ã€‚æ˜“äºæ“ä½œä¸”æ— éœ€ä¿®æ”¹ä»£ç ã€‚ä½†æ˜¯å¯èƒ½å­˜åœ¨ç¨³å®šæ€§é—®é¢˜å’Œå¯¹å¤æ‚æºæ“ä½œæ— æ³•è¯†åˆ«çš„æƒ…å†µã€‚

:::

### â“è¯´è¯´ä½ å¸¸ç”¨çš„å‡ ä¸ªé‡æ„çš„æŠ€å·§ï¼Œä½ è§‰å¾—é‡æ„é€‚åˆä»€ä¹ˆæ—¶å€™æ¥åš

::: details ğŸ’¡

é‡æ„ï¼šç³»ç»Ÿæ€§æ”¹å˜ä»£ç ç»“æ„çš„è¿‡ç¨‹ï¼Œæ—¨åœ¨æ”¹å–„ä»£ç çš„å¯è¯»æ€§ï¼Œç®€åŒ–ä»£ç è®¾è®¡ï¼Œæé«˜æ•ˆç‡ï¼Œå¹¶ä¸”è¦åœ¨ä¸æ”¹å˜è½¯ä»¶çš„å¤–åœ¨è¡Œä¸ºçš„æƒ…å†µä¸‹è¿›è¡Œã€‚

é‡æ„æŠ€å·§ï¼š

  - æç‚¼æ–¹æ³•ï¼ˆ`Extract Method`ï¼‰ï¼šå¦‚æœçœ‹åˆ°æœ‰ä¸€å—ä»£ç å¯ä»¥è¢«å•ç‹¬å°è£…èµ·æ¥ï¼Œé‚£ä¹ˆå°±å¯ä»¥åˆ›å»ºä¸€ä¸ªæ–°çš„æ–¹æ³•ï¼Œå¹¶å°†è¿™æ®µä»£ç çš„é€»è¾‘æ”¾åˆ°æ–°çš„æ–¹æ³•é‡Œã€‚
   
  - åˆå¹¶é‡å¤çš„ä»£ç ï¼šè¿™æ˜¯å‡å°‘ä»£ç å¤åˆ¶çš„ä¸€ä¸ªå¥½æ–¹æ³•ï¼Œå½“çœ‹åˆ°å¤šæ®µç›¸ä¼¼çš„ä»£ç æ—¶ï¼Œå°è¯•å°†å®ƒä»¬åˆå¹¶åˆ°ä¸€ä¸ªå…¬å…±çš„æ–¹æ³•æˆ–ç±»ä¸­ã€‚
   
  - é‡å‘½åï¼ˆ`Rename`ï¼‰ï¼šé‡å‘½åæ˜¯ä¸€ä¸ªæå…¶å¸¸ç”¨çš„ä¼˜åŒ–æŠ€æœ¯ï¼Œå¦‚æœä¸€ä¸ªå˜é‡æˆ–æ–¹æ³•çš„åå­—ä¸å¤Ÿæ¸…æ™°ï¼Œå¯ä»¥é‡æ–°å‘½åå®ƒä»¥é€éœ²å®ƒçš„çœŸå®åŠŸèƒ½ã€‚
   
  - åˆ†è§£æ¡ä»¶è¡¨è¾¾å¼ï¼šå½“ä¸€ä¸ªå¤æ‚çš„é€»è¾‘æ¡ä»¶åœ¨ä¸€ä¸ªå‡½æ•°ä¸­è¢«å¤šæ¬¡ä½¿ç”¨æ—¶ï¼Œå°†å®ƒæå–åˆ°ä¸€ä¸ªç‹¬ç«‹çš„æ–¹æ³•ä¸­ï¼Œä¼šä½¿ä»£ç å˜å¾—æ›´æ˜“è¯»ã€‚
   
  - æ›¿æ¢ä¸´æ—¶å˜é‡ï¼ˆ`Replace Temp with Query`ï¼‰ï¼šå–ä»£å¯¹ä¸€ä¸ªä¸´æ—¶å˜é‡çš„å¤šæ¬¡å¼•ç”¨ä»¥ä¸€ä¸ªé’ˆå¯¹å…¶è®¡ç®—çš„å‡½æ•°è°ƒç”¨ã€‚
   
  - ä½¿ç”¨å¯¹è±¡ç»„åˆä»£æ›¿ç±»ç»§æ‰¿ï¼šé¢å‘å¯¹è±¡çš„è­¦è¯­ï¼šå°½é‡ä½¿ç”¨ç»„åˆ/èšåˆï¼Œå°‘ç”¨ç»§æ‰¿ã€‚

é‡æ„æ—¶æœºï¼š

  - æ–°åŠŸèƒ½å¼€å‘éœ€è¦è°ƒæ•´ç°æœ‰ç»“æ„ï¼šåœ¨æ·»åŠ æ–°åŠŸèƒ½ä¹‹å‰ï¼Œå…ˆé‡æ„é‚£äº›è®©æ·»åŠ æ–°åŠŸèƒ½å˜å¾—å›°éš¾çš„ä»£ç ï¼Œå°†ä»£ç ä¿®æ•´åˆ°å®¹æ˜“æ·»åŠ æ–°åŠŸèƒ½çš„çŠ¶æ€ã€‚

  - ä»£ç é˜…è¯»æ—¶å‘ç°ä»£ç è´¨é‡é—®é¢˜ï¼šåœ¨ä»£ç é˜…è¯»æ—¶å‘ç°ä»£ç ä¸æ˜“è¯»æˆ–ä»£ç é‡å¤ç­‰é—®é¢˜æ—¶ï¼Œä¾¿å¯ä»¥å¯¹å…¶é‡æ„ã€‚
  
  - ä¿®å¤ `Bug` æ—¶ï¼šåœ¨ä¿®å¤ `Bug` æ—¶ï¼Œé€šå¸¸éœ€è¦ä¿®æ”¹ä»£ç ï¼Œè¿™ä¸ºæˆ‘ä»¬æä¾›äº†ä¸€æ¬¡æ€è€ƒå¦‚ä½•æå‡ä»£ç è´¨é‡ã€æ˜¯å¦æœ‰æ›´å¥½è®¾è®¡çš„æœºä¼šã€‚

  ä»¥ä¸Šä¸‰ç§æƒ…å†µï¼Œéƒ½å¯ä»¥å°†é‡æ„å®‰æ’åœ¨ã€Œäº‹æƒ…æœªå‘ç”Ÿå‰ã€ï¼Œä½¿é‡æ„å¸®åŠ©æˆ‘ä»¬æ›´å®¹æ˜“åœ°å®Œæˆå·¥ä½œã€‚åŒæ—¶ï¼Œè¿™æ ·çš„é‡æ„ï¼Œå¾€å¾€å¯ä»¥å¾ˆç¡®å®šå…¶ä»·å€¼ï¼Œå› ä¸ºç»å¸¸èƒ½ç«‹å³çœ‹åˆ°æ•ˆæœã€‚

æ€»çš„æ¥è¯´ï¼Œé‡æ„åº”è¯¥æ˜¯æŒç»­ä¸æ–­åœ°è¿›è¡Œï¼Œè€Œä¸æ˜¯ç´§æ€¥æƒ…å†µä¸‹çš„ä¸€æ¬¡å¤§è¡ŒåŠ¨ã€‚ä½¿ä»£ç ä¿æŒè‰¯å¥½çš„ç»“æ„ï¼Œä½¿å¾—æˆ‘ä»¬å¯ä»¥ç»´æŒæ­£å¸¸çš„å¼€å‘é€Ÿåº¦ï¼Œé˜²æ­¢æŠ€æœ¯å€ºåŠ¡çš„ç´¯ç§¯ã€‚ä¸è¦å®³æ€•ä¿®æ”¹ä»£ç ï¼Œä»£ç æ˜¯ç”¨æ¥è¢«æ”¹çš„ï¼Œåªè¦æœ‰äº†å¥½çš„å•å…ƒæµ‹è¯•ï¼Œæ”¹ä¸€ç‚¹ï¼Œè·‘ä¸€ä¸‹å•å…ƒæµ‹è¯•ï¼ŒæŒç»­åé¦ˆã€æŒç»­æ”¹è¿›ï¼Œé‡æ„å°†æ˜¯ä¸€ä»¶éå¸¸æ„‰å¿«çš„äº‹æƒ…ã€‚

:::

------

## ç»„ä»¶åŒ–

### â“ç»„ä»¶åŒ–è®¾è®¡æ€è·¯

::: details ğŸ’¡

> ç»„ä»¶åŒ–ï¼šæœ‰æ—¶ä¹Ÿç§°ä¸ºâ€œæ¨¡å—åŒ–â€ã€‚å°†ä¸€ä¸ªå¤§çš„ä¸šåŠ¡åŠŸèƒ½ï¼ŒæŒ‰ç…§ä¸åŒçš„åŠŸèƒ½æ¨¡å—è¿›è¡Œæ‹†åˆ†ã€‚

æ‹†åˆ†åŸåˆ™ï¼šç±»ä¼¼ `SOLID` åŸåˆ™ã€‚
  
  - å•ä¸€èŒè´£åŸåˆ™ : æ‹†åˆ†çš„åŠŸèƒ½æ¨¡å—åº”è¯¥å°½é‡åšåˆ°åŠŸèƒ½å•ä¸€ã€‚
  - æ¥å£éš”ç¦»åŸåˆ™ : åŠŸèƒ½æ¨¡å—å°½é‡åšåˆ°å¯¹å¤–æš´éœ²æ¥å£çš„æœ€å°åŒ–ã€‚

åˆ†å±‚åŸåˆ™ï¼šå€Ÿç”¨ç»å…¸å››è±¡é™æ³•åˆ™æ¥åˆ’åˆ†(ä»¥ **ä¸šåŠ¡ç›¸å…³**ã€**UI ç›¸å…³** ä½œä¸ºä¸¤ä¸ªè½´çº¿ï¼Œæ¥è¿›è¡Œç»„ä»¶åŒ–åˆ†å±‚)
  
  - ä¸šåŠ¡åŠŸèƒ½å±‚ : ä¸šåŠ¡æœ‰å…³ & `UI` æœ‰å…³ã€‚ç”¨æˆ·çœ‹åˆ°çš„ä¸»è¦åŠŸèƒ½é¡µé¢ã€‚
  - ä¸šåŠ¡é€»è¾‘å±‚ : ä¸šåŠ¡æœ‰å…³ & `UI` æ— å…³ã€‚åœ¨ç”¨æˆ·ä½¿ç”¨ä¸šåŠ¡åŠŸèƒ½æ—¶ï¼ŒèƒŒåçš„å¤„ç†é€»è¾‘ã€‚
  - `UI` å±‚ : ä¸šåŠ¡æ— å…³ & `UI` æœ‰å…³ã€‚é€šç”¨çš„ `UI` é¡µé¢ï¼Œä¸å…³è”å…·ä½“çš„ä¸šåŠ¡é€»è¾‘ã€‚
  - åŸºç¡€å±‚ : ä¸šåŠ¡æ— å…³ & `UI` æ— å…³ã€‚é€šç”¨çš„åŸºç¡€åŠŸèƒ½ã€‚

å•å‘ä¾èµ–åŸåˆ™ï¼šç»„ä»¶ä¹‹é—´çš„ä¾èµ–å…³ç³»ï¼Œåº”è¯¥åšåˆ°ä¸Šå±‚ä¾èµ–ä¸‹å±‚ï¼Œä¸‹å±‚ä¸è¦ä¾èµ–ä¸Šå±‚ã€‚

:::

### â“ä¸‹å±‚ç»„ä»¶éœ€è¦è°ƒç”¨ä¸Šå±‚ç»„ä»¶æ€æ ·å¤„ç†

::: details ğŸ’¡

  æ–¹æ¡ˆä¸€ï¼šä¾èµ–æ³¨å…¥æ–¹å¼ã€‚ä¸‹å±‚ç»„ä»¶å®šä¹‰å¥½é’©å­å‡½æ•°ï¼Œæ³¨å†Œæ—¶ï¼Œå°†ä¸Šå±‚ç»„ä»¶æ³¨å…¥ä¸‹å±‚ç»„ä»¶å®šä¹‰å¥½çš„é’©å­å‡½æ•°ã€‚
  
  æ–¹æ¡ˆäºŒï¼šé—´æ¥è®¿é—®ã€‚é€šè¿‡åº•å±‚çš„è·¯ç”±ç»„ä»¶ï¼Œå°†ä¸Šå±‚ç»„ä»¶æ³¨å†Œåˆ°è·¯ç”±è¡¨ä¸­ï¼Œè¿™æ ·ä¸‹å±‚ç»„ä»¶å°±å¯ä»¥é€šè¿‡è·¯ç”±é—´æ¥è®¿é—®åˆ°ä¸Šå±‚ç»„ä»¶ã€‚

:::

### â“ç»„ä»¶ä¹‹é—´å¦‚ä½•è§£è€¦

::: details ğŸ’¡

è‰¯å¥½çš„ä»£ç è®¾è®¡åº”è¯¥å°½å¯èƒ½åœ°å‡å°‘å„éƒ¨åˆ†é—´çš„è€¦åˆæ€§ï¼Œä»¥ä¾¿åœ¨ä¿®æ”¹æˆ–å¢åŠ æ–°åŠŸèƒ½æ—¶å¢å¼ºä»£ç çš„çµæ´»æ€§ã€‚è§£è€¦çš„ç›®çš„æ˜¯ä½¿ç³»ç»Ÿå„éƒ¨åˆ†æ¨¡å—åŒ–ï¼Œä½¿ä¹‹èƒ½å¤Ÿæ›´åŠ ç‹¬ç«‹åœ°å¼€å‘ã€ä¿®æ”¹ã€æ›¿æ¢ã€æµ‹è¯•å’Œå¤ç”¨ã€‚

è§£è€¦æ–¹æ¡ˆï¼š

  - é‡‡ç”¨é¢å‘æ¥å£ç¼–ç¨‹ï¼Œè€Œä¸æ˜¯é¢å‘å®ç°ç¼–ç¨‹ã€‚æ¨¡å—ä¹‹é—´åªé€šè¿‡æ¥å£è¿›è¡Œäº¤äº’ï¼Œåªä¾èµ–æ¥å£ï¼Œè€Œä¸ä¾èµ–å…·ä½“çš„å®ç°ç±»ï¼Œè¿™æ ·å°±å¯ä»¥é™ä½è€¦åˆæ€§ã€‚

  - ä½¿ç”¨ä¾èµ–æ³¨å…¥ã€‚ä¸åœ¨æ¨¡å—å†…éƒ¨åˆ›å»ºæ‰€ä¾èµ–çš„å¯¹è±¡ï¼Œè€Œæ˜¯é€šè¿‡å¤–éƒ¨æ–¹å¼æ³¨å…¥ã€‚è¿™æ ·å°±é¿å…äº†æ¨¡å—å’Œä¾èµ–å¯¹è±¡ä¹‹é—´çš„ç´§å¯†è€¦åˆå…³ç³»ã€‚

  - å¦‚æœç»„ä»¶éœ€è¦äº¤äº’ï¼Œå¯ä»¥ä½¿ç”¨æ¶ˆæ¯æ€»çº¿æˆ–è€…äº‹ä»¶é©±åŠ¨çš„æ–¹å¼è¿›è¡Œè§£è€¦ã€‚ä¾‹å¦‚ï¼Œåˆ©ç”¨ `Observer` æ¨¡å¼æˆ–è€… `Event Bus`ï¼Œè®©è®¢é˜…è€…å’Œå‘å¸ƒè€…è§£è€¦ã€‚

  - åˆ©ç”¨ä¸­é—´å±‚æˆ–è€… `Facade` (å¤–è§‚)æ¨¡å¼æä¾›ç»Ÿä¸€çš„æ¥å£ã€‚æç«¯æƒ…å†µä¸‹ï¼Œå¦‚æœè§£è€¦å›°éš¾ï¼Œä¹Ÿå¯ä»¥è®¾ç½®ä¸€ä¸ªâ€œèƒ¶æ°´â€æ¨¡å—ä¸“é—¨è´Ÿè´£åè°ƒã€‚

  - å‡å°‘å…¨å±€å˜é‡çš„ä½¿ç”¨ï¼Œå…¨å±€å˜é‡ä¼šè®©å„ä¸ªæ¨¡å—äº§ç”Ÿè€¦åˆã€‚

  - åˆ©ç”¨è®¾è®¡æ¨¡å¼å’ŒåŸåˆ™ï¼Œå¦‚å•ä¸€èŒè´£åŸåˆ™ï¼Œå¼€é—­åŸåˆ™ï¼Œé‡Œæ°æ›¿æ¢åŸåˆ™ç­‰ï¼Œä»¥å‡å°‘ä¸å¿…è¦çš„è€¦åˆã€‚

  - `MVC`ã€`MVVM` ç­‰è®¾è®¡æ¨¡å¼ï¼Œåˆ†ç¦»è§†å›¾å’Œæ•°æ®ï¼Œå‡å°‘å®ƒä»¬ä¹‹é—´çš„ç›´æ¥å…³ç³»ã€‚

  - æ¨¡å—èŒè´£å°½å¯èƒ½å•ä¸€ï¼Œåªåšå¥½è‡ªå·±çš„äº‹æƒ…ï¼Œä¸æ¶‰åŠåˆ°å…¶å®ƒæ¨¡å—çš„ä¸šåŠ¡ã€‚

  - ä»£ç å®¡æŸ¥ï¼Œå®šæœŸè¿›è¡Œä»£ç å®¡æŸ¥ï¼Œé¿å…ä¸åˆç†çš„è®¾è®¡å’Œå®ç°ã€‚

:::

### â“`CTMediator` vs `MGJRouter`

::: details ğŸ’¡

> `CTMediator`

- ä¼˜ç‚¹ï¼š

    * é‡‡ç”¨ `Target-Action` æ¨¡å¼è¿›è¡Œè§£è€¦ï¼Œä½¿å„ä¸ªç»„ä»¶ä¹‹é—´æ— éœ€ç›´æ¥å¼•ç”¨ï¼Œåªéœ€è¦çŸ¥é“ `Target` å’Œ `Action` å³å¯ã€‚
    * é‡‡ç”¨ `runtime` åŠ¨æ€è°ƒç”¨ï¼Œå¼€å‘è€…å¯ä»¥æ ¹æ®éœ€è¦è‡ªç”±æ·»åŠ æ–°çš„ `Target` å’Œ `Action`ã€‚
    * æä¾›äº†ä¸€ç§éå¸¸çµæ´»çš„æ–¹å¼è¿›è¡Œç»„ä»¶ä¹‹é—´çš„æ•°æ®ä¼ é€’å’Œè°ƒç”¨ã€‚

- ç¼ºç‚¹ï¼š

    * æ‰€æœ‰çš„ `Target` å’Œ `Action` éƒ½éœ€è¦é€šè¿‡å­—ç¬¦ä¸²æ¥è°ƒç”¨ï¼Œå­—ç¬¦ä¸²çš„ç®¡ç†å’Œç»´æŠ¤å·¥ä½œé‡è¾ƒå¤§ï¼Œä¸”ç¼–è¯‘å™¨æ— æ³•ç»™å‡ºé”™è¯¯æç¤ºã€‚
    * ä¸å­˜åœ¨ä¸€ä¸ªç»Ÿä¸€çš„ `URL` è§„åˆ™ï¼Œä¸åˆ©äºé€šè¿‡ `URL` è¿›è¡Œé¡µé¢è·³è½¬ã€‚éœ€è¦é¢å¤–å®ç°ä¸€å¥—æ˜ å°„è§„åˆ™ã€‚

`MGJRouter`

- ä¼˜ç‚¹ï¼š
   
    * é‡‡ç”¨ `URL-Handler` çš„æ–¹å¼è¿›è¡Œç»„ä»¶è§£è€¦ï¼Œå¯ä»¥é€šè¿‡æ³¨å†Œ `URL` çš„æ–¹å¼æ¥å®ç°é¡µé¢çš„è·³è½¬å’Œæ•°æ®ä¼ é€’ã€‚
    * æ”¯æŒäº† `URL Scheme`ï¼Œæ–¹ä¾¿ `App` ä¹‹é—´è°ƒç”¨æˆ–è€…å®Œæˆä¸€äº›ç‰¹å®šåŠŸèƒ½ã€‚
    * æ¥å£è®¾è®¡æ›´åŠ åˆç†ï¼Œè°ƒç”¨èµ·æ¥ä¹Ÿååˆ†æ–¹ä¾¿ï¼Œè·¯ç”±å™¨è·³è½¬é¡µé¢ä¹Ÿæ¯”è¾ƒæ–¹ä¾¿ã€‚
    
- ç¼ºç‚¹ï¼š
    
    * å¯¹äºå¤æ‚é¡µé¢çš„ä¼ å€¼æ¯”è¾ƒéº»çƒ¦ï¼Œåªèƒ½é€šè¿‡ `URL` å‚æ•°è¿›è¡Œç®€å•çš„ä¼ å€¼ï¼Œä¸èƒ½ç›´æ¥ä¼ é€’å¤æ‚å¯¹è±¡ã€‚
    * åŠ¨æ€æ€§è¾ƒå·®ï¼Œåªèƒ½åœ¨ç¼–è¯‘æ—¶ç¡®å®š `URL` è·¯ç”±å…³ç³»ã€‚
    
:::

### â“ä¸ºä»€ä¹ˆ `CTMediator` æ–¹æ¡ˆä¼˜äºå…¶å®ƒè·¯ç”±çš„æ–¹æ¡ˆ

::: details ğŸ’¡

- æ˜“äºè§£è€¦ï¼šé‡‡ç”¨äº† `Target-Action` æ¨¡å¼ï¼Œä¸ºç»„ä»¶ä¹‹é—´æä¾›äº†é€šä¿¡æ¥å£ï¼Œå„ç»„ä»¶ä¹‹é—´ä¸éœ€è¦äº’ç›¸å¼•ç”¨ï¼Œåªéœ€è¦çŸ¥é“å¯¹æ–¹çš„ `Target` å’Œ `Action`ï¼Œè¿™ç§æ¨¡å¼æœ‰åˆ©äºæé«˜ä»£ç çš„ç»´æŠ¤æ€§å’Œå¯è¯»æ€§ã€‚

- çµæ´»æ€§ï¼šé€šè¿‡ `runtime` å®ç°åŠ¨æ€è°ƒç”¨ï¼Œèƒ½æ–¹ä¾¿åœ°æ·»åŠ æ–°çš„åŠŸèƒ½å’ŒæœåŠ¡ã€‚

- ç»„ä»¶åŒ–æ”¯æŒï¼šè®¾è®¡åŸåˆ™æ˜¯ â€œä¾èµ–è¯·æ±‚è€Œéä¾èµ–æ¥å£â€ï¼Œé€šè¿‡ä¸­é—´äººè§’è‰²æä¾›é€šä¿¡é€šé“ï¼Œå°½å¯èƒ½å‡å°‘æ¨¡å—é—´çš„è€¦åˆæ€§ï¼Œä½¿å¾—å„ä¸ªæ¨¡å—éƒ½å¯ä»¥ç‹¬ç«‹å¼€å‘å’Œæ›´æ–°ã€‚

- æœ¬åœ°å’Œè¿œç¨‹ä¸€è‡´æ€§ï¼šå¯¹äºæœ¬åœ°ç»„ä»¶å’Œè¿œç¨‹æœåŠ¡ï¼Œé‡‡ç”¨äº†ç»Ÿä¸€çš„æ¥å£è¿›è¡Œè°ƒç”¨ï¼Œä½¿å¾—å¼€å‘è€…ä¸éœ€è¦å…³å¿ƒè°ƒç”¨çš„å…·ä½“å®ç°ï¼Œæé«˜äº†å¼€å‘æ•ˆç‡ã€‚

- å‚æ•°ä¼ é€’æ–¹ä¾¿ï¼šå…è®¸å¼€å‘è€…çµæ´»åœ°ä¼ é€’å„ç§ç±»å‹çš„å‚æ•°è€Œæ— éœ€è¿›è¡Œç±»å‹è½¬åŒ–ã€‚

:::

### â“åŸºäº `CTMediator` çš„ç»„ä»¶åŒ–æ–¹æ¡ˆï¼Œæœ‰å“ªäº›æ ¸å¿ƒç»„æˆ

::: details ğŸ’¡

- `CTMediator`ï¼šä½œä¸ºä¸­ä»‹è€…åœ¨å„ä¸ªæ¨¡å—æˆ–ç»„ä»¶ä¹‹é—´è¿›è¡Œé€šä¿¡ã€‚ä¸»è¦çš„æ–¹å¼æ˜¯æ ¹æ®æä¾›çš„ `Target` å­—ç¬¦ä¸²è·å¾—ç›®æ ‡å¯¹è±¡ï¼Œç„¶åæ ¹æ® `Action` å­—ç¬¦ä¸²è·å¾—ç›®æ ‡å¯¹è±¡çš„æ–¹æ³•ï¼Œæœ€åè°ƒç”¨è¯¥æ–¹æ³•æ¥å®Œæˆå„ä¸ªæ¨¡å—æˆ–ç»„ä»¶ä¹‹é—´çš„äº¤äº’ã€‚

- `Target`ï¼šç»§æ‰¿è‡ª `NSObject` çš„ç±»ï¼Œç”¨äºå¤„ç†éœ€è¦æ‰§è¡Œçš„å…·ä½“ä¸šåŠ¡é€»è¾‘ã€‚ä¸€èˆ¬æ¥è¯´ï¼Œæ¯ä¸ªæ¨¡å—æˆ–ç»„ä»¶éƒ½ä¼šæœ‰ä¸€ä¸ªå¯¹åº”çš„ `Target` ç±»ã€‚

- `Action`ï¼š`Target` ç±»ä¸­çš„æ–¹æ³•ï¼Œè´Ÿè´£æ‰§è¡Œå…·ä½“çš„æ“ä½œã€‚æ¯ä¸ªæ“ä½œéƒ½ä¼šå¯¹åº”ä¸€ä¸ª `Action`ã€‚

- `Category`ï¼š`CTMediator` çš„åˆ†ç±»ï¼Œç”¨äºæä¾›ä¸€ä¸ªæ›´ä¾¿äºè°ƒç”¨çš„æ¥å£ã€‚ä¸€èˆ¬æ¥è¯´ï¼Œæ¯ä¸€ä¸ªæ¨¡å—æˆ–ç»„ä»¶éƒ½ä¼šæœ‰ä¸€ä¸ªå¯¹åº”çš„ `Category`ï¼Œè¿™ä¸ª `Category` ä¼šæä¾›ä¸€äº›æ–¹æ³•ï¼Œé€šè¿‡è¿™äº›æ–¹æ³•å¯ä»¥æ›´æ–¹ä¾¿åœ°è°ƒç”¨è¯¥æ¨¡å—æˆ–ç»„ä»¶æ‰€å¯¹åº”çš„ `Target-Action`ã€‚

- `URLRouter`ï¼šæä¾›äº†ä¸€ä¸ª `URL` åˆ° `Target-Action` çš„æ˜ å°„ï¼Œä½¿å¾—é€šè¿‡ `URL` èƒ½å¤Ÿæ–¹ä¾¿åœ°è°ƒç”¨ `Target-Action`ã€‚ä¸»è¦ç”¨äºå¤„ç†å¤–éƒ¨è°ƒç”¨ã€è·³è½¬ç­‰æƒ…å†µã€‚

- `Params`: ä¼ é€’ç»™ `Target` çš„ä¸€ç»„å‚æ•°ï¼Œæ¯”å¦‚ç”¨æˆ·æ•°æ®æˆ–è€…å…¶ä»–é¡¹ç›®çº§åˆ«çš„ä¸€äº›é…ç½®ä¿¡æ¯ç­‰ã€‚

:::

------

## è®¾è®¡æ¨¡å¼

### â“`iOS` ä¸­çš„çš„å•ä¾‹å®ç°

::: details ğŸ’¡

```objc
+ (instancetype)sharedInstance {
    static dispatch_once_t onceToken;
    static YourClass *sharedInstance = nil;
    // dispatch_once ç¡®ä¿å…¶å†…çš„ä»£ç å—åœ¨æ•´ä¸ªåº”ç”¨ç”Ÿå‘½å‘¨æœŸä¸­åªè¢«æ‰§è¡Œä¸€æ¬¡
    dispatch_once(&onceToken, ^{
        sharedInstance = [[YourClass alloc] init];
    });
    
    return sharedInstance;
}
```

```swift
class Singleton {
    static let shared = Singleton()
    private init() {} // ç§æœ‰åŒ–æ„é€ æ–¹æ³•ï¼Œé˜²æ­¢å…¶ä»–åœ°æ–¹äº§ç”Ÿå®ä¾‹
}
```

:::

### â“è¯´è¯´å•ä¾‹æ¨¡å¼ä¼˜ç¼ºç‚¹

::: details ğŸ’¡

å•ä¾‹æ¨¡å¼æ˜¯ä¸€ç§è®¾è®¡æ¨¡å¼ï¼Œå®ƒç¡®ä¿ä¸€ä¸ªç±»åªæœ‰ä¸€ä¸ªå®ä¾‹ï¼Œå¹¶æä¾›ä¸€ä¸ªå…¨å±€çš„è®¿é—®ç‚¹ã€‚

ä¼˜ç‚¹ï¼š

  - å…¨å±€è®¿é—®ç‚¹ï¼šå•ä¾‹æ¨¡å¼æä¾›äº†ä¸€ä¸ªå…¨å±€è®¿é—®ç‚¹ï¼Œå¯ä»¥æ–¹ä¾¿åœ°åœ¨ä»£ç çš„ä»»ä½•ä½ç½®è®¿é—®è¿™ä¸ªå®ä¾‹ã€‚
  - èµ„æºèŠ‚çœï¼šç”±äºåªåˆ›å»ºä¸€ä¸ªå®ä¾‹ï¼Œæ‰€ä»¥å¯ä»¥èŠ‚çœæ¯”è¾ƒå¤šçš„ç³»ç»Ÿèµ„æºã€‚
  - ä¿è¯æ•°æ®åŒæ­¥ï¼šå…¨å±€åªæœ‰ä¸€ä¸ªè®¿é—®ç‚¹ä¸”å…¨å±€åªèƒ½è®¿é—®è¿™ä¸ªå®ä¾‹æ—¶ï¼Œå¯ä»¥ç¡®ä¿æ•°æ®çš„ä¸€è‡´æ€§ã€‚

ç¼ºç‚¹ï¼š

  - ä¸åˆ©äºç³»ç»Ÿæ‰©å±•ï¼šç”±äºå•ä¾‹æ¨¡å¼å¯¹èµ„æºçš„æ§åˆ¶è¿‡ä¸¥æ ¼ï¼Œå¯èƒ½åœ¨æŸäº›æƒ…å†µä¸‹é˜»ç¢ç³»ç»Ÿçš„æ‰©å±•å’Œä¼˜åŒ–ã€‚
  - è¿èƒŒå•ä¸€èŒè´£åŸåˆ™ï¼šå•ä¾‹æ¨¡å¼çš„ç±»æ—¢è¦è´Ÿè´£ä¸šåŠ¡éœ€æ±‚ï¼Œåˆè¦è´Ÿè´£ä¿è¯æ˜¯å•ä¸€çš„å®ä¾‹ï¼Œè¿™è¿åäº†å•ä¸€èŒè´£åŸåˆ™ã€‚
  - æµ‹è¯•å›°éš¾ï¼šç”±äºå•ä¾‹æ¨¡å¼çš„å®ä¾‹æ˜¯å…¨å±€çš„ï¼Œå¯èƒ½ä¼šåœ¨å…¶ä»–æµ‹è¯•æ—¶å¼•å…¥ä¸å¯æ§çš„çŠ¶æ€ï¼Œå¯¼è‡´æµ‹è¯•å›°éš¾ã€‚

:::

### â“è‹¹æœè®¾è®¡çš„ç±»å¯¹è±¡ `[MyClass class]` æ˜¯ä¸æ˜¯å•ä¾‹æ¨¡å¼

::: details ğŸ’¡

  `[MyClass class]` è¿”å›çš„æ˜¯ `MyClass` çš„ç±»å¯¹è±¡ï¼Œè¿™ä¸ªç±»å¯¹è±¡åœ¨ç¨‹åºè¿è¡ŒæœŸé—´æ˜¯å”¯ä¸€çš„ï¼Œæ‰€ä»¥å¯ä»¥è¢«çœ‹ä½œæ˜¯å•ä¾‹æ¨¡å¼ã€‚

  åœ¨ä¸€ä¸ªè¿è¡Œä¸­çš„ `Objective-C` ç¨‹åºä¸­ï¼Œæ¯ä¸€ä¸ªç±»åªæœ‰ä¸€ä¸ªç±»å¯¹è±¡ã€‚è€Œè¿™ä¸ªç±»å¯¹è±¡åŒ…å«äº†ç±»çš„å…ƒæ•°æ®ï¼Œæ¯”å¦‚å®ä¾‹å˜é‡çš„å¸ƒå±€ã€å®šä¹‰çš„æ–¹æ³•ï¼Œè¿˜æœ‰å®ƒçš„çˆ¶ç±»ç­‰ç­‰ä¿¡æ¯ã€‚

  æ³¨æ„ï¼šè¿™å¹¶ä¸æ˜¯å•ä¾‹æ¨¡å¼çš„å…¸å‹åº”ç”¨ã€‚å•ä¾‹æ¨¡å¼çš„ä¸»è¦ç”¨é€”æ˜¯ç¡®ä¿æŸä¸ªç±»åªæœ‰ä¸€ä¸ªå®ä¾‹ï¼Œç”¨äºé‚£äº›å…¨åº”ç”¨éœ€è¦ç»Ÿä¸€è®¿é—®çš„åœºæ™¯ã€‚è¿™äº›ç±»çš„ä¾‹å­é€šå¸¸åŒ…æ‹¬é…ç½®ç®¡ç†ç±»ã€ç½‘ç»œè¯·æ±‚ç±»ç­‰ã€‚

  `[MyClass class]` æ˜¯ `Objective-C `çš„å†…ç½®æœºåˆ¶ï¼Œæ˜¯ä¸ºäº†æ”¯æŒ `Objective-C` åŠ¨æ€ç‰¹æ€§ç‰¹åˆ«è®¾è®¡çš„ã€‚æ‰€ä»¥è™½ç„¶å®ƒæ˜¯å”¯ä¸€çš„ï¼Œä½†å®ƒä¸æ˜¯å•ä¾‹æ¨¡å¼çš„åº”ç”¨å®ä¾‹ã€‚

:::

### â“`iOS` ä¸ºä»€ä¹ˆæ²¡æœ‰ç±»ä¼¼äº `Java` çš„ `Builder` çš„æ„é€ æ¨¡å¼

::: details ğŸ’¡

  `Swift` çš„æŸäº›ç‰¹æ€§ï¼Œå¦‚ å¯é€‰ç±»å‹ å’Œ é»˜è®¤å‚æ•°ï¼Œä¹Ÿä½¿å¾—ä¸€äº› `Builder` æ¨¡å¼çš„éœ€è¦å˜å¾—ä¸å¤ªæ˜æ˜¾ï¼Œå› ä¸ºå¯ä»¥åˆ›å»ºéƒ¨åˆ†å®ä¾‹å˜é‡æœªèµ‹å€¼çš„å¯¹è±¡ï¼Œä¹Ÿå¯ä»¥åœ¨ `init` å‡½æ•°ä¸­ä¸ºä¸€äº›å‚æ•°è®¾ç½®é»˜è®¤å€¼ã€‚

  ç®€å•å·¥å‚ã€æŠ½è±¡å·¥å‚æˆ–åè®®éƒ½å¯ä»¥åœ¨æŸç§ç¨‹åº¦ä¸Šå®ç°ç±»ä¼¼ `Builder` æ¨¡å¼çš„æ•ˆæœã€‚
    
  `Swift` ä¹Ÿå¯ä»¥åˆ›å»ºä¸€ä¸ª `Builder` ç±»æ¥åˆ›å»ºå’Œé…ç½®å¯¹è±¡ã€‚

```swift
class Person {
    let name: String
    let age: Int
    //...
}

class PersonBuilder {
    var name: String = ""
    var age: Int = 0
    //...
    
    func build() -> Person {
        return Person(name: name, age: age)
    }
}

```

:::

### â“`iOS` ä¸­å¸¸ç”¨è®¾è®¡æ¨¡å¼å®è·µæœ‰å“ªäº›

::: details ğŸ’¡

-  `MVC` (Model-View-Controller)
    > ä¸€ä¸ªä¼ ç»Ÿçš„ `iOS` æ¶æ„æ¨¡å¼ï¼Œç”¨äºå°†ç”¨æˆ·ç•Œé¢ä¸ä¸šåŠ¡é€»è¾‘åˆ†ç¦»ã€‚æ¨¡å‹è¡¨ç¤ºæ•°æ®å’Œä¸šåŠ¡é€»è¾‘ï¼Œè§†å›¾è¡¨ç¤ºç”¨æˆ·ç•Œé¢ï¼Œè€Œæ§åˆ¶å™¨åˆ™åè°ƒæ¨¡å‹å’Œè§†å›¾ã€‚

- `Delegation`: å§”æ‰˜æ¨¡å¼
    > ä¸€ä¸ªç®€å•çš„è¡Œä¸ºæŠ½è±¡æ¨¡å¼ï¼Œå…è®¸ä¸€ä¸ªå¯¹è±¡å°†æŸäº›å†³ç­–æƒå’Œè¡Œä¸ºæ”¾åœ¨å…¶å®ƒå¯¹è±¡ä¸Šã€‚è¿™ä¸ªæ¨¡å¼è¢«å¹¿æ³›åº”ç”¨äº `UIKit` ä¸­ã€‚

- `Singleton`: å•ä¾‹æ¨¡å¼
    > ä¿è¯ä¸€ä¸ªç±»åªæœ‰ä¸€ä¸ªå®ä¾‹åœ¨ä»»ä½•æ—¶å€™éƒ½æ˜¯å¯è®¿é—®çš„ï¼Œè¿™åœ¨ `iOS` å¼€å‘ä¸­é€‚ç”¨äºé‚£äº›æä¾›å…¨å±€è®¿é—®ç‚¹æˆ–é‡ç”¨æŸä¸ªèµ„æºçš„åœºæ™¯ï¼Œæ¯”å¦‚ `UIApplication`ï¼Œ`UserDefaults` ç­‰ã€‚

- `Observer`: è§‚å¯Ÿè€…æ¨¡å¼
    > ä¸€ä¸ªå¯¹è±¡çš„çŠ¶æ€å‘ç”Ÿå˜åŒ–æ—¶é€šçŸ¥æ‰€æœ‰ä¾èµ–äºå®ƒçš„å¯¹è±¡ã€‚åœ¨ `iOS` å¼€å‘ä¸­ï¼Œè¿™ä¸ªæ¨¡å¼ç»å¸¸ä»¥ `NotificationCenter` æˆ– `KVO` (Key-Value Observing) çš„å½¢å¼å‡ºç°ã€‚

- `Builder`: åˆ›å»ºè€…æ¨¡å¼
    > ç”¨äºä»¥æ­¥éª¤æ–¹å¼åˆ›å»ºå¤æ‚å¯¹è±¡ã€‚å®ƒå°†ä¸€ä¸ªå¤æ‚å¯¹è±¡çš„åˆ›å»ºæ­¥éª¤å°è£…åˆ°ä¸€ä¸ªå•ä¸€çš„å¯¹è±¡ä¸­ï¼Œè¿™æ ·åªéœ€è¦æä¾›å¿…è¦çš„ä¿¡æ¯ï¼Œè€Œæ— éœ€äº†è§£å†…éƒ¨å®ç°ç»†èŠ‚ã€‚

- `Prototype`: åŸå‹æ¨¡å¼
    > é€šè¿‡å¤åˆ¶æˆ–å…‹éš†å·²å­˜åœ¨çš„å®ä¾‹æ¥åˆ›å»ºæ–°çš„å¯¹è±¡ã€‚åœ¨ `iOS` å¼€å‘ä¸­ï¼Œè¿™å¸¸å¸¸ç”¨äºå¤åˆ¶ `UIView` å­ç±»çš„å®ä¾‹ï¼Œæ¯”å¦‚ `UILabel`ã€`UIButton` ç­‰ã€‚

- `Factory Method`: å·¥å‚æ–¹æ³•æ¨¡å¼
    > å®šä¹‰äº†ä¸€ç§åˆ›å»ºå¯¹è±¡çš„æ¥å£ï¼Œå°†å¯¹è±¡çš„å®ä¾‹åŒ–æ¨è¿Ÿåˆ°å­ç±»ã€‚åœ¨ `iOS` æ¡†æ¶ä¸­ï¼Œå¯ä»¥åœ¨éœ€è¦äº§ç”Ÿä¸€ç³»åˆ—ç›¸å…³çš„å¯¹è±¡æ—¶ï¼Œç»å¸¸ä¼šä½¿ç”¨è¿™ç§æ¨¡å¼ï¼Œæ¯”å¦‚ `UIAlertController` çš„åˆ›å»ºã€‚

:::

### â“`MVC`ã€`MVP`ã€`MVVM`ã€`Coordinator`

::: details ğŸ’¡

- `MVC (Model-View-Controller)`ï¼š ä¸€ç§å°†ä¸šåŠ¡é€»è¾‘ã€æ•°æ®ä»¥åŠç•Œé¢æ˜¾ç¤ºåˆ†ç¦»çš„è®¾è®¡æ¨¡å¼ã€‚
    * `Model` (æ¨¡å‹) è´Ÿè´£å¤„ç†æ•°æ®å’Œä¸šåŠ¡é€»è¾‘ã€‚
    * `View` (è§†å›¾) è´Ÿè´£æ˜¾ç¤ºæ•°æ®ï¼Œå³ç”¨æˆ·ç•Œé¢ã€‚
    * `Controller` (æ§åˆ¶å™¨) æ˜¯ Model å’Œ View çš„æ¡¥æ¢ï¼Œè´Ÿè´£æ›´æ–° View ä»¥åŠå¤„ç†ç”¨æˆ·äº‹ä»¶ã€‚

- `MVP (Model-View-Presenter)`ï¼š å¯¹ `MVC` çš„ä¸€ç§æ”¹è¿›ã€‚
    > åœ¨ `MVP` ä¸­ï¼Œ`Presenter` å–ä»£äº† `Controller` çš„éƒ¨åˆ†èŒè´£ï¼Œ`View` ä¸ `Model` ä¸å†ç›´æ¥é€šä¿¡ï¼Œæ‰€æœ‰çš„é€šä¿¡éƒ½é€šè¿‡ `Presenter` æ¥è¿›è¡Œã€‚è¿™æ ·æ›´å¥½çš„åˆ†ç¦»äº† `View` å’Œ `Model`ã€‚

- `MVVM (Model-View-ViewModel)`ï¼šä¸€ç§æ”¹è‰¯å‹çš„ `MVP` è®¾è®¡æ¨¡å¼ã€‚
    > å®ƒå¼•å…¥äº† `ViewModel`ï¼Œ`ViewModel` ä¸»è¦è´Ÿè´£ `View` ä¸­çš„çŠ¶æ€ä»¥åŠå¤„ç†ä¸€éƒ¨åˆ†ä¸šåŠ¡é€»è¾‘ï¼Œå¹¶ä¸” `ViewModel` ä¸åŒ…å«å¯¹ `View` çš„å¼•ç”¨ï¼Œæ‰€ä»¥åœ¨ `MVVM` ä¸­ï¼Œ`View`ï¼Œ`ViewModel` å’Œ `Model` æ˜¯å®Œå…¨è§£è€¦çš„ã€‚

- `Coordinator`ï¼šä¸€ç§è¡Œä¸ºå’Œå¯¼èˆªæµç¨‹ç®¡ç†çš„æ¨¡å¼ã€‚
    > ä¸»è¦ç›®çš„æ˜¯å°†è¿™äº›ä» `MVC`ã€`MVP` æˆ– `MVVM` ä¸­æŠ½ç¦»å‡ºæ¥ï¼Œä½¿å…¶èŒè´£æ›´åŠ æ¸…æ™°ã€‚`Coordinator` å¯ä»¥ç®¡ç†åº”ç”¨çš„å¯¼èˆªæµç¨‹ï¼Œæ§åˆ¶å…¶å®ƒ `MVC`ã€`MVP` æˆ– `MVVM` æ¨¡å—ï¼Œåè°ƒè¿™äº›æ¨¡å—é—´çš„å·¥ä½œã€‚

:::

### â“`MVC` ä»‹ç»ä¸€ä¸‹ï¼Œä¼šæœ‰ä»€ä¹ˆé—®é¢˜

::: details ğŸ’¡

`MVC`

  - æ¨¡å‹ï¼ˆ`Model`ï¼‰ï¼šç”¨äºå­˜å‚¨å’Œç®¡ç†åº”ç”¨ç¨‹åºçš„æ•°æ®ã€‚å®ƒåœ¨æ•°æ®åº“ä¸­è¯»å–æˆ–å†™å…¥æ•°æ®ï¼Œå¹¶åœ¨éœ€è¦æ—¶æ›´æ–°å…¶çŠ¶æ€ã€‚æ¨¡å‹å¹¶ä¸ç›´æ¥ä¸æ§åˆ¶å™¨æˆ–è§†å›¾äº¤äº’ã€‚
  - è§†å›¾ï¼ˆ`View`ï¼‰ï¼šç”¨äºæ„å»ºç”¨æˆ·ç•Œé¢å’Œå±•ç¤ºæ•°æ®ã€‚è§†å›¾ä¸çŸ¥é“æ¨¡å‹çš„å­˜åœ¨ï¼Œè§†å›¾å¹¶ä¸ç›´æ¥ä¸æ¨¡å‹é€šä¿¡ã€‚è§†å›¾åªæ˜¯æ ¹æ®æ§åˆ¶å™¨æä¾›çš„æ•°æ®ç”Ÿæˆè¾“å‡ºã€‚
  - æ§åˆ¶å™¨ï¼ˆ`Controller`ï¼‰ï¼šä¸­ä»‹è€…ï¼Œè´Ÿè´£å¤„ç†æ¨¡å‹å’Œè§†å›¾ä¹‹é—´çš„æ‰€æœ‰é€šä¿¡ã€‚æ§åˆ¶å™¨æ¥æ”¶æ¥è‡ªè§†å›¾çš„ç”¨æˆ·è¾“å…¥ï¼Œå¹¶æ ¹æ®è¾“å…¥æŒ‡ç¤ºæ¨¡å‹è¿›è¡Œæ›´æ”¹ï¼Œç„¶åæ ¹æ®æ¨¡å‹çš„çŠ¶æ€æ›´æ–°è§†å›¾ã€‚

é—®é¢˜ï¼š

  - `Massive View Controller`ï¼š`ViewController` é€šå¸¸æˆä¸ºå¤§è€Œå¤æ‚çš„ç±»ï¼Œè´Ÿè´£äº†è®¸å¤šèŒè´£ï¼Œæ¯”å¦‚ç½‘ç»œè¯·æ±‚ã€æ•°æ®å¤„ç†ã€`UI` æ›´æ–°ç­‰ã€‚è¿™å¸¸å¸¸è¿åäº†å•ä¸€èŒè´£åŸåˆ™ï¼ˆ`Single Responsibility Principle`ï¼‰ï¼Œä½¿å¾— `ViewController` éš¾ä»¥ç»´æŠ¤å’Œæµ‹è¯•ã€‚

  - è§†å›¾å’Œæ¨¡å‹å¯èƒ½è¿‡äºä¾èµ–æ§åˆ¶å™¨ï¼šå°½ç®¡æ¨¡å‹å’Œè§†å›¾ä¹‹é—´çš„é€šä¿¡å¿…é¡»é€šè¿‡æ§åˆ¶å™¨è¿›è¡Œï¼Œä½†æœ‰æ—¶å€™æ§åˆ¶å™¨ä¼šè´Ÿæ‹…å¤ªå¤šçš„è´£ä»»ï¼Œæ¯”å¦‚åœ¨æŸäº›åœºæ™¯ä¸‹ï¼Œæ¨¡å‹å’Œè§†å›¾ä¹‹é—´è‹¥èƒ½è¿›è¡Œç›´æ¥é€šä¿¡ï¼Œå¯èƒ½ä¼šæ›´åŠ ç›´æ¥å’Œé«˜æ•ˆã€‚

  - ä¸ºä¿æŒè§†å›¾å’Œæ¨¡å‹çš„éš”ç¦»ï¼Œå¯èƒ½éœ€è¦è¿½åŠ é¢å¤–çš„ä»£ç ï¼šä¸ºäº†ä¿æŒè§†å›¾å’Œæ¨¡å‹å½¼æ­¤ç‹¬ç«‹ï¼Œæœ‰æ—¶å€™éœ€è¦ç¼–å†™é¢å¤–çš„ä»£ç æ¥æ›´æ–°å’ŒåŒæ­¥æ•°æ®ï¼Œè¿™å¯èƒ½æˆä¸ºä¸€ä¸ªè´Ÿæ‹…ã€‚

  - æµ‹è¯•å›°éš¾ï¼šç”±äºæ§åˆ¶å™¨ä¸­åŒ…å«äº†å¤§é‡çš„ä¸šåŠ¡é€»è¾‘ï¼Œå› æ­¤å•å…ƒæµ‹è¯•å¯èƒ½å˜å¾—æ¯”è¾ƒå›°éš¾ã€‚

:::

### â“`MVC` ç›¸äº’é€šè®¯è§„åˆ™éƒ½æœ‰å“ªäº›

::: details ğŸ’¡

![iOS-MVC](media/iOS-MVC.png)

é€šä¿¡æ–¹å¼ï¼š

  - æ§åˆ¶å™¨(`Controller`)ä¸æ¨¡å‹(`Model`)ï¼šæ§åˆ¶å™¨å¯ä»¥ç›´æ¥ä¸æ¨¡å‹è¿›è¡Œé€šä¿¡ã€‚
    > ä¾‹å¦‚ `XML` æˆ– `JSON` è§£æï¼Œæ•°æ®åº“ `CRUD` æ“ä½œç­‰ï¼Œå°†è·å–çš„æ•°æ®è½¬åŒ–ä¸ºæ¨¡å‹ï¼Œæˆ–è€…å°†æ¨¡å‹æŒä¹…åŒ–ä¸ºæ•°æ®ã€‚
  - æ§åˆ¶å™¨(`Controller`)ä¸è§†å›¾(`View`)ï¼šæ§åˆ¶å™¨ä¹Ÿå¯ä»¥ä¸è§†å›¾è¿›è¡Œç›´æ¥é€šä¿¡ã€‚
    > ä¾‹å¦‚ï¼Œæ§åˆ¶å™¨å¯ä»¥è®¾ç½®è§†å›¾çš„æ˜¾ç¤ºï¼Œå¤„ç†ç”¨æˆ·è¾“å…¥ï¼Œä»¥åŠæ›´æ–°è§†å›¾ä¸Šçš„æ•°æ®ã€‚
  - è§†å›¾(`View`)å’Œæ¨¡å‹(`Model`)ï¼šåœ¨ä¼ ç»Ÿçš„ `MVC` æ¡†æ¶ä¸­ï¼Œä¸€èˆ¬ä¸å»ºè®®è§†å›¾å’Œæ¨¡å‹ç›´æ¥é€šä¿¡ï¼Œæ‰€æœ‰çš„é€šä¿¡éƒ½åº”è¯¥é€šè¿‡æ§åˆ¶å™¨æ¥è¿›è¡Œã€‚
    > è‹¹æœæä¾›çš„ä¸€äº› `UIKit` ç»„ä»¶ï¼ˆæ¯”å¦‚ `UITableView` å’Œ `UICollectionView`ï¼‰ä¼šç”±äºæ€§èƒ½å’Œæ•ˆç‡çš„éœ€è¦ï¼Œéœ€è¦å…è®¸è§†å›¾å’Œæ¨¡å‹è¿›è¡Œç›´æ¥äº¤äº’ã€‚è¿™ç§äº¤äº’ä¹Ÿæ˜¯åœ¨æ§åˆ¶å™¨çš„ç®¡ç†ä¸‹è¿›è¡Œçš„ã€‚

ä¸ºäº†å¤„ç†è§†å›¾å’Œæ¨¡å‹çš„äº¤äº’ï¼Œé€šå¸¸ä¼šå€ŸåŠ©äºä¸€äº›è®¾è®¡æ¨¡å¼ï¼š

  - `Delegate`ï¼ˆå§”æ‰˜ï¼‰ï¼šä¾‹å¦‚ `UITableView` å’Œ `UICollectionView` çš„ `delegate` å’Œ `dataSource`ã€‚
  - `Notification`ï¼ˆé€šçŸ¥ï¼‰ï¼šä½¿ç”¨ `NSNotificationCenter` è¿›è¡Œå¯¹è±¡ä¹‹é—´çš„é€šä¿¡ï¼Œå®ƒå…è®¸ä¸€ä¸ªå¯¹è±¡å¹¿æ’­äº‹ä»¶ï¼Œè€Œå…¶å®ƒå¯¹è±¡å¯ä»¥é€‰æ‹©æ¥æ”¶è¿™ä¸ªäº‹ä»¶ã€‚
  - `KVO`ï¼ˆKey Value Observingï¼‰ï¼šä¸€ä¸ªå¯¹è±¡å¯ä»¥è§‚å¯Ÿå¦ä¸€ä¸ªå¯¹è±¡çš„æŸä¸ªå±æ€§ï¼Œå½“è¿™ä¸ªå±æ€§çš„å€¼å‘ç”Ÿæ”¹å˜æ—¶ï¼Œè§‚å¯Ÿè€…å¯¹è±¡ä¼šå¾—åˆ°é€šçŸ¥ã€‚
  - `Block`ï¼ˆé—­åŒ…ï¼‰ï¼šä¸€ä¸ªå¯¹è±¡å¯ä»¥æŠŠä¸€æ®µä»£ç ï¼ˆå³é—­åŒ…ï¼‰ä¼ é€’ç»™å¦ä¸€ä¸ªå¯¹è±¡æ‰§è¡Œã€‚

:::

### â“`Model` ä¼šæŒæœ‰ `View` å—

::: details ğŸ’¡

`Model`ï¼ˆæ¨¡å‹ï¼‰ä¸åº”è¯¥æŒæœ‰ `View`ï¼ˆè§†å›¾ï¼‰ã€‚è¿™ç§åˆ†ç¦»ä½¿å¾— `Model` å’Œ `View` å¯ä»¥å„è‡ªç‹¬ç«‹åœ°æ”¹å˜å’Œå¤ç”¨ï¼Œè€Œä¸éœ€è¦å…³å¿ƒå…¶å®ƒç»„ä»¶çš„å®ç°ï¼Œä½¿å¾—ä»£ç æ›´åŠ æ¸…æ™°ï¼Œæ˜“äºç†è§£å’Œç»´æŠ¤ã€‚

:::

### â“`MVVM` å¦‚ä½•å®ç°ç»‘å®š

::: details ğŸ’¡

 - `KVO`(Key-Value Observing)ï¼šå¯ä»¥ä½¿ç”¨ `KVO` æ¥è§‚å¯Ÿ `ViewModel` ä¸­å±æ€§çš„å˜åŒ–ï¼Œå½“å±æ€§å˜åŒ–æ—¶ï¼Œæ›´æ–°å¯¹åº”çš„ `UI`ã€‚

  - `Delegate`ï¼šé€šè¿‡å®šä¹‰åè®®å’Œä»£ç†ï¼Œ`ViewModel` å¯ä»¥æŠŠçŠ¶æ€å˜åŒ–é€šçŸ¥ç»™ `View`ã€‚

  - é€šçŸ¥å’Œäº‹ä»¶ï¼šå½“ `ViewModel` çš„çŠ¶æ€æ”¹å˜æ—¶ï¼Œå®ƒå¯ä»¥å‘é€ä¸€ä¸ªé€šçŸ¥æˆ–è€…è§¦å‘ä¸€ä¸ªäº‹ä»¶ï¼Œ`View` å¯ä»¥ç›‘å¬è¿™äº›é€šçŸ¥æˆ–äº‹ä»¶ï¼Œç„¶åä½œå‡ºå“åº”ã€‚

  - `Reactive Programming`ï¼šæ¯”å¦‚ä½¿ç”¨ `ReactiveCocoa`(åœ¨ `Objective-C` ä¸­)æˆ–è€… `RxSwift` (åœ¨ `Swift` ä¸­)ï¼Œè¿™äº›åº“æä¾›äº†ä¸€ç§å“åº”å¼ç¼–ç¨‹çš„æ–¹å¼ï¼Œå¯ä»¥æ–¹ä¾¿çš„åˆ›å»ºæ•°æ®æµå¹¶å“åº”å€¼çš„å˜åŒ–ã€‚

  - `Data Binding` æ¡†æ¶ï¼šåœ¨ä¸€äº›å¹³å°ä¸Šï¼Œå¦‚ `Windows` æˆ– `Android`ï¼Œæ¡†æ¶å±‚æä¾›äº†æ•°æ®ç»‘å®šçš„æ”¯æŒã€‚åªéœ€è¦åœ¨å¸ƒå±€æ–‡ä»¶ä¸­å£°æ˜ç»‘å®šå…³ç³»ï¼Œæ¡†æ¶ä¼šè‡ªåŠ¨åœ¨ `ViewModel` å’Œ `View` ä¹‹é—´åŒæ­¥æ•°æ®ã€‚

:::

### â“å•å‘æ•°æ®æµ (`Redux`ã€`ReSwift`ã€`RxFeedback`)

::: details ğŸ’¡

> å•å‘æ•°æ®æµï¼šæ•°æ®åœ¨åº”ç”¨ä¸­æµåŠ¨çš„æ–¹å¼ï¼Œå…¶ä¸­æ•°æ®åªèƒ½æŒ‰ç…§é¢„å®šçš„è·¯å¾„æµåŠ¨ï¼Œä¸ä¼šå‡ºç°æ•°æ®æµæ··ä¹±çš„æƒ…å†µã€‚ç»å¸¸ä¼šè¢«ç”¨äºè§£å†³çŠ¶æ€ç®¡ç†çš„é—®é¢˜ï¼Œå®ƒèƒ½å¤Ÿè®©æ•°æ®æµçš„èµ°å‘å˜å¾—æ›´æ¸…æ™°ï¼Œæœ‰åˆ©äºè°ƒè¯•å’Œç»´æŠ¤ã€‚

- `Redux` : `JavaScript` ç¯å¢ƒä¸‹çš„ä¸€ä¸ªçŠ¶æ€ç®¡ç†åº“ï¼Œæ‰€æœ‰çš„çŠ¶æ€æ›´æ–°éƒ½éµå¾ªå•å‘æ•°æ®æµï¼Œæµç¨‹ä¸ºï¼š`Action` -> `Reducer` -> `Store` -> `View` -> `Action`ã€‚

- `ReSwift` : `Redux` åœ¨ `Swift` ç¯å¢ƒä¸­çš„ç§»æ¤ç‰ˆæœ¬ï¼Œå…¶å¤„ç†æµç¨‹åŒæ ·æ˜¯å•å‘çš„ï¼š`Action` -> `Reducer` -> `Store` -> `View` -> `Action`ã€‚

- RxFeedback : åŸºäº `RxSwift` çš„ä¸€ä¸ªæ— çŠ¶æ€æ¡†æ¶ï¼Œå®ƒä½¿ç”¨ç³»ç»Ÿå¾ªç¯ï¼ˆ`System Loop`ï¼‰çš„æ¦‚å¿µæ¥æè¿°å•å‘æ•°æ®æµï¼Œå¤„ç†æµç¨‹ä¸ºï¼š`System` -> `Mutation` -> `State` -> `View` -> `Event` -> `System`ã€‚

:::

------

## æŒç»­é›†æˆ

### â“ä½¿ç”¨è¿‡ä»€ä¹ˆæŒç»­é›†æˆæ–¹å¼

::: details ğŸ’¡

  > æŒç»­é›†æˆ `CI`(Continuous Integration) æ˜¯ä¸€ç§è½¯ä»¶å¼€å‘å®è·µï¼Œæ¯æ¬¡é›†æˆéƒ½ä¼šé€šè¿‡ç¼–è¯‘ã€åˆ›å»ºæ„å»ºå’Œè‡ªåŠ¨åŒ–æµ‹è¯•æ¥éªŒè¯ä»£ç çš„æ­£ç¡®æ€§ã€‚

- `Jenkins`: ä¸€ä¸ªå¼€æºçš„ã€åŸºäº `Java` çš„æŒç»­é›†æˆå·¥å…·ã€‚å®ƒéå¸¸çµæ´»ï¼Œæœ‰è®¸å¤šæ’ä»¶å¯ç”¨ï¼Œå¯ä»¥ç”¨äºæ„å»ºé¡¹ç›®ï¼Œæ‰§è¡Œæµ‹è¯•ï¼Œå¹¶ç”Ÿæˆæµ‹è¯•æŠ¥å‘Šã€‚

- `Travis CI`: ä¸€ä¸ªåœ¨çº¿çš„ã€åˆ†å¸ƒå¼çš„æŒç»­é›†æˆæœåŠ¡ï¼Œç”¨äºæ„å»ºå’Œæµ‹è¯•åœ¨ `GitHub` å’Œ `Bitbucket` ä¸Šæ‰˜ç®¡çš„é¡¹ç›®ã€‚

- `CircleCI`: ä¸€ä¸ªä¸ºè½¯ä»¶å›¢é˜Ÿæä¾›æŒç»­é›†æˆå’Œäº¤ä»˜çš„æœåŠ¡ã€‚å®ƒæ”¯æŒåŒ…æ‹¬ `Androidã€iOS` åœ¨å†…çš„å¤šç§å¹³å°è¿›è¡Œæ„å»ºå’Œæµ‹è¯•ã€‚

- `GitHub Action`: `GitHub` æä¾›çš„ `CI/CD` å·¥å…·ã€‚ 

- `GitLab CI/CD`: `GitLab` è‡ªå¸¦ `CI/CD` åŠŸèƒ½ï¼Œå¯ä»¥åœ¨ä»“åº“ä¸­æ·»åŠ  `.gitlab-ci.yml` æ–‡ä»¶ï¼Œå®šä¹‰å‡ºä¸€ç»„ç”¨äº `CI/CD` çš„é…ç½®å’Œä»»åŠ¡ã€‚

- `Fastlane`: ä¸€æ¬¾ä¸º `iOS` å’Œ `Android` åº”ç”¨è®¾è®¡çš„æŒç»­é›†æˆå·¥å…·ï¼Œä¸»è¦ç”¨äºè‡ªåŠ¨åŒ–æ„å»ºã€æµ‹è¯•å’Œéƒ¨ç½²ã€‚

- `Xcode Cloud`: `Apple` æä¾›çš„ä¸€æ¬¾æŒç»­é›†æˆæ–¹æ¡ˆï¼Œå¯ä»¥è¿›è¡Œæ„å»ºã€åˆ†æã€æµ‹è¯•å’Œå½’æ¡£ã€‚

:::

### â“`Jenkins` æ€ä¹ˆå¤‡ä»½æ¢å¤

::: details ğŸ’¡

å¤‡ä»½å’Œæ¢å¤ä¸»è¦éœ€è¦è€ƒè™‘çš„æ˜¯ `Jenkins` çš„ä¸»ç›®å½•ï¼Œä¸»ç›®å½•å­˜å‚¨äº†æ„å»ºçš„å·¥ä½œç›®å½•ï¼Œç”¨æˆ·è´¦å·é…ç½®ï¼Œæ’ä»¶è®¾ç½®ï¼Œç³»ç»Ÿé…ç½®ç­‰ä¿¡æ¯ã€‚

```shell
# å¤‡ä»½
#   - è¿›å…¥ Jenkins çš„ä¸»ç›®å½•
cd /var/lib/jenkins
#   - å°† Jenkins ä¸»ç›®å½•ä¸‹çš„æ‰€æœ‰æ–‡ä»¶å’Œæ–‡ä»¶å¤¹æ‰“åŒ…ä¸ºä¸€ä¸ªæ–‡ä»¶ï¼Œå°†æ­¤æ–‡ä»¶å­˜å‚¨åœ¨å®‰å…¨çš„åœ°æ–¹è¿›è¡Œå¤‡ä»½
sudo tar cvzf jenkins-backup.tar.gz *

# æ¢å¤
#   - å°†å¤‡ä»½æ–‡ä»¶å¤åˆ¶åˆ° Jenkins çš„ä¸»ç›®å½•
sudo cp /path/to/your/backup/jenkins-backup.tar.gz /var/lib/jenkins
#   - è§£å‹å¤‡ä»½æ–‡ä»¶å¹¶æ¢å¤å—æŸçš„ Jenkin
cd /var/lib/jenkins
sudo tar xvzf jenkins-backup.tar.gz
#   - ä¿æ‰€æœ‰æ–‡ä»¶çš„æƒé™è®¾ç½®æ­£ç¡®ï¼Œé‡å¯ Jenkins
sudo chown -R jenkins:jenkins /var/lib/jenkins
sudo service jenkins restart
```

:::

### â“`Jenkins` ä½¿ç”¨è¿‡å“ªäº›æ’ä»¶

::: details ğŸ’¡

- `Git Plugin`: å…è®¸ `Jenkins` é€šè¿‡ `Git` ä½œä¸ºæºä»£ç ç®¡ç†å·¥å…·è¿›è¡Œé¡¹ç›®æ„å»ºã€‚

- `GitHub Plugin`: ä¸º `Jenkins` æä¾›äº†ä¸€ç§ä¸ `Github` äº¤äº’çš„æ–¹å¼ï¼Œæ¯”å¦‚å¯ä»¥è§¦å‘ `Jenkins` åš `CI/CD`ã€‚

- `Pipeline`: æœ€ä¸»è¦çš„æ’ä»¶ä¹‹ä¸€ã€‚å¸¦æ¥äº† `Jenkins Pipeline`ï¼ˆä¹Ÿå«åš `Jenkinsfile`ï¼‰è¿™ç§æ–¹å¼ï¼Œå…è®¸ä»¥ä»£ç å½¢å¼å®šä¹‰å’Œç®¡ç† `Jenkins` ä¸­çš„æ„å»ºæµç¨‹ã€‚

- `Maven Integration plugin`: è®© `Jenkins` æ”¯æŒ `Maven` æ„å»ºä»»åŠ¡ã€‚

- `Blue Ocean`: `Jenkins` çš„ä¸€ç§æ–°çš„ç”¨æˆ·ç•Œé¢ï¼Œå®ƒè®© `Pipeline` çš„åˆ›å»ºå’Œç›‘è§†æ›´åŠ ç›´è§‚å’Œç”¨æˆ·å‹å¥½ã€‚

- `Email Extension Plugin`: è¿™ä¸ªæ’ä»¶å¯ä»¥å¸®åŠ© `Jenkins` åœ¨æ„å»ºç»“æœå‡ºç°åå‘é€é‚®ä»¶é€šçŸ¥ã€‚

- `Junit Plugin`: å¯ä»¥è®© `Jenkins` æ”¯æŒ `JUnit` æµ‹è¯•æŠ¥å‘Šã€‚

- `Build Monitor Plugin`: æä¾›äº†ä¸€ç§è§†è§‰æ˜¾ç¤ºæ¥å±•ç¤ºæ„å»ºçš„çŠ¶æ€ã€‚

:::

------

## æ¨¡å—è®¾è®¡

### â“è®¾è®¡å®ç°ä¸€ä¸ªæ—¶é•¿ç»Ÿè®¡æ¨¡å—

::: details ğŸ’¡

è®¾è®¡æ€è·¯ï¼š

  - å®šä¹‰éœ€æ±‚ï¼šé¦–å…ˆéœ€è¦æ˜ç¡®æ—¶é—´ç»Ÿè®¡æ¨¡å—éœ€è¦ç»Ÿè®¡çš„å…·ä½“å†…å®¹ã€‚å¯èƒ½æ˜¯`App`ä½¿ç”¨æ—¶é•¿ã€æŸä¸ªåŠŸèƒ½æˆ–è€…é¡µé¢çš„åœç•™æ—¶é•¿ï¼Œæˆ–è€…æŸä¸ªè¿‡ç¨‹çš„è¿è¡Œæ—¶é•¿ã€‚
  
  - æ•°æ®æ”¶é›†ï¼šè®¾è®¡åˆé€‚çš„æ–¹æ³•å»æ”¶é›†è¿™äº›æ—¶é—´æ•°æ®ã€‚å¦‚å¼€å§‹/ç»“æŸæ—¶é—´çš„è®°å½•ï¼Œå¯èƒ½éœ€è¦ç›¸åº”çš„è§¦å‘æ¡ä»¶(æ¯”å¦‚ `App` å¯åŠ¨/å…³é—­ï¼Œè¿›å…¥/ç¦»å¼€é¡µé¢ï¼Œå¼€å§‹/ç»“æŸæŸä¸ªè¿‡ç¨‹ç­‰)ã€‚

  - æ•°æ®å­˜å‚¨ï¼šå®šä¹‰åˆé€‚çš„æ•°æ®ç»“æ„æ¥å­˜å‚¨è¿™äº›æ•°æ®ï¼Œå¯èƒ½ç»“åˆæ—¥æœŸè¿›è¡Œå­˜å‚¨ï¼Œä¸ºåç»­çš„æ•°æ®åˆ†æåšå‡†å¤‡ã€‚å¯ä»¥ä½¿ç”¨æ•°æ®åº“æˆ–è€…æ–‡ä»¶å½¢å¼å­˜å‚¨ã€‚
    
  - æ•°æ®å¤„ç†åŠåˆ†æï¼šå¯¹æ”¶é›†åˆ°çš„æ—¶é•¿æ•°æ®è¿›è¡Œå¤„ç†åŠåˆ†æã€‚è¿™å¯èƒ½æ¶‰åŠåˆ°ç®—æ³•çš„è®¾è®¡ï¼Œåœ¨å†…å­˜é™åˆ¶åŠè®¡ç®—æ€§èƒ½å…è®¸çš„æƒ…å†µä¸‹ï¼Œé«˜æ•ˆåœ°è¿›è¡Œæ•°æ®è®¡ç®—ï¼Œå¹¶åœ¨éœ€è¦çš„æ—¶å€™æä¾›ç»Ÿè®¡æ•°æ®ã€‚

  - æ•°æ®å‘ˆç°ï¼šè®¾è®¡åˆé€‚çš„æ–¹å¼æ¥å‘ˆç°è¿™äº›æ—¶é—´ç»Ÿè®¡çš„ç»“æœã€‚å¯èƒ½æ˜¯ç®€å•çš„åˆ—è¡¨å½¢å¼ï¼Œæˆ–è€…å’Œå†å²æ•°æ®å¯¹æ¯”çš„å›¾è¡¨å½¢å¼ã€‚


> ä¸€ä¸ªç®€æ˜“çš„ `App` ä½¿ç”¨æ—¶é•¿ç»Ÿè®¡æ¨¡å—ï¼š

  - å®šä¹‰æ•°æ®ç»“æ„ï¼šå®šä¹‰ä¸€ä¸ªç»“æ„ä½“æˆ–ç±»æ¥å­˜å‚¨ç»Ÿè®¡çš„æ•°æ®ï¼Œä¾‹å¦‚å¼€å§‹ä½¿ç”¨çš„æ—¶é—´ã€ç»“æŸä½¿ç”¨çš„æ—¶é—´ï¼Œè¿™äº›åº”è¯¥ä½œä¸ºæ•°æ®çš„ä¸€éƒ¨åˆ†ã€‚

    ```swift
    // å®šä¹‰ä¸€ä¸ªç»“æ„ä½“æˆ–ç±»æ¥å­˜å‚¨ç»Ÿè®¡çš„æ•°æ®
    struct UsageInfo {
        let startTime: Date // å¼€å§‹ä½¿ç”¨çš„æ—¶é—´
        var endTime: Date?  // ç»“æŸä½¿ç”¨çš„æ—¶é—´
    }
    ```

  - è®°å½•å¼€å§‹æ—¶é—´ï¼šå½“ `App` å¯åŠ¨æ—¶ï¼Œæˆ‘ä»¬éœ€è¦åœ¨é€‚å½“çš„ä½ç½®(å¯èƒ½æ˜¯åº”ç”¨çš„ç”Ÿå‘½å‘¨æœŸæ–¹æ³• `applicationDidBecomeActive`)æ„é€ ä¸€ä¸ª `UsageInfo`ï¼Œè®°å½•ä¸‹å½“å‰çš„å¼€å§‹æ—¶é—´ã€‚

    ```swift
    var currentUsage: UsageInfo = UsageInfo(startTime: Date(), endTime: nil)
    ```

  - è®°å½•ç»“æŸæ—¶é—´ï¼šå½“ `App` ç»“æŸè¿è¡Œæ—¶ï¼ˆå¯èƒ½æ˜¯åº”ç”¨ç”Ÿå‘½å‘¨æœŸæ–¹æ³• `applicationWillResignActive`ï¼‰ï¼Œéœ€è¦è®°ä¸‹ç»“æŸæ—¶é—´ã€‚

    ```swift
    currentUsage.endTime = Date()
    ```

  - è®¡ç®—ä½¿ç”¨æ—¶é—´ï¼šæœ‰äº†å¼€å§‹æ—¶é—´å’Œç»“æŸæ—¶é—´ï¼Œå¯ä»¥ç®€å•åœ°é€šè¿‡å‡æ³•è®¡ç®—å‡ºæ€»è®¡ä½¿ç”¨æ—¶é—´ã€‚

    ```swift
    if let end = currentUsage.endTime {
        let duration = end.timeIntervalSince(currentUsage.startTime)
        //ä¿å­˜æˆ–ä½¿ç”¨ duration
    }
    ```

  - å­˜å‚¨æ•°æ®ï¼šå¯èƒ½éœ€è¦æŸç§æ–¹å¼æ¥å­˜å‚¨è¿™äº›ç»Ÿè®¡æ•°æ®ï¼Œä¾‹å¦‚ä½¿ç”¨ `UserDefaults`ã€æ–‡ä»¶æˆ–æ˜¯æ•°æ®åº“ç­‰ï¼Œä»¥ä¾›åç»­åˆ†ææˆ–æ˜¾ç¤ºã€‚

  - æ•°æ®å±•ç¤ºï¼šéœ€è¦æä¾›ä¸€ä¸ªæ–¹æ³•æˆ–æ¥å£ä»å­˜å‚¨æ•°æ®çš„åœ°æ–¹å–å‡ºæ•°æ®ï¼Œå¹¶ä»¥åˆé€‚çš„æ–¹å¼è¿›è¡Œå±•ç¤ºï¼Œå¯èƒ½æ˜¯åˆ—è¡¨ï¼Œå›¾è¡¨æˆ–å…¶ä»–å½¢å¼ã€‚

  å®é™…å·¥ç¨‹ä¸­æ—¶å¯èƒ½éœ€è¦è€ƒè™‘æ›´å¤šçš„å› ç´ ï¼Œä¾‹å¦‚æ—¶åŒºé—®é¢˜ã€`App` å´©æºƒå¯¼è‡´æ— æ³•è®°å½•ç»“æŸæ—¶é—´æ—¶å¦‚ä½•å¤„ç†ã€æ•°æ®çš„å®‰å…¨æ€§ç­‰ç­‰ã€‚

:::

### â“è®¾è®¡å®ç°ä¸€ä¸ªæ—¥å¿—è®°å½•æ¨¡å—

::: details ğŸ’¡

è®¾è®¡æ€è·¯ï¼š

  - å®šä¹‰æ—¥å¿—çº§åˆ«ï¼šå®šä¹‰ä¸åŒçš„æ—¥å¿—çº§åˆ«ï¼Œæ¯”å¦‚ `Errorã€Warningã€Infoã€Debugã€Verbose` ç­‰ï¼Œä»¥ä¾¿èƒ½å¤Ÿæ ¹æ®éœ€è¦è®°å½•å’ŒæŸ¥çœ‹ä¸åŒçº§åˆ«çš„æ—¥å¿—ã€‚

  - è®¾è®¡æ—¥å¿—æ¥å£ï¼šè®¾è®¡ä¸€ä¸ªç»Ÿä¸€çš„æ—¥å¿—è®°å½•æ¥å£ï¼Œè®©æ‰€æœ‰çš„æ—¥å¿—éƒ½é€šè¿‡è¿™ä¸ªæ¥å£è¿›è¡Œè®°å½•ã€‚

    ```swift
    func log(level: LogLevel, message: String, file: String, function: String, line: Int)
    ```

  - æ—¥å¿—æ ¼å¼ï¼šå®šä¹‰æ¯æ¡æ—¥å¿—ä¿¡æ¯çš„æ ¼å¼ã€‚ä¸€æ¡å®Œæ•´çš„æ—¥å¿—ä¿¡æ¯åº”åŒ…å«ä½†ä¸é™äºï¼šæ—¶é—´æˆ³ã€æ—¥å¿—çº§åˆ«ã€æ–‡ä»¶åã€å‡½æ•°åã€è¡Œæ•°ä»¥åŠå®é™…çš„æ—¥å¿—ä¿¡æ¯ã€‚

  - æ—¥å¿—å­˜å‚¨ï¼šæ—¥å¿—å¯ä»¥è¾“å‡ºåˆ°æ§åˆ¶å°ï¼Œä¹Ÿå¯ä»¥å­˜å‚¨åˆ°æœ¬åœ°æ–‡ä»¶æˆ–è€…ä¸Šä¼ åˆ°æœåŠ¡å™¨ã€‚å¦‚æœå­˜å‚¨åˆ°æœ¬åœ°æ–‡ä»¶ï¼Œéœ€è¦åšå¥½æ—¥å¿—æ–‡ä»¶çš„ç®¡ç†ï¼Œæ¯”å¦‚æ—¥å¿—æ–‡ä»¶çš„ç”Ÿæˆå’Œåˆ é™¤ç­–ç•¥ã€‚

  - æ—¥å¿—è¿‡æ»¤ï¼šæä¾›æ—¥å¿—è¿‡æ»¤çš„åŠŸèƒ½ï¼Œå¯ä»¥æ ¹æ®æ—¥å¿—çº§åˆ«è¿‡æ»¤å‡ºæƒ³è¦æŸ¥çœ‹çš„æ—¥å¿—ã€‚

  - å¤šç¯å¢ƒæ”¯æŒï¼šè€ƒè™‘åˆ°é¡¹ç›®å¤šä¸ªç¯å¢ƒä¸‹(æ¯”å¦‚å¼€å‘ç¯å¢ƒã€æµ‹è¯•ç¯å¢ƒã€ç”Ÿäº§ç¯å¢ƒ)çš„æ—¥å¿—è®°å½•éœ€æ±‚ä¸ä¸€æ ·ï¼Œéœ€è¦è®¾è®¡æˆå¯é…ç½®çš„å½¢å¼ã€‚


> ä¸€ä¸ªç®€æ˜“çš„æ—¥å¿—è®°å½•æ¨¡å—ï¼š

```swift
// æ—¥å¿—çº§åˆ«
enum LogLevel {
    case Error
    case Warning
    case Info
    case Debug
    case Verbose
}
// æ—¥å¿—ç±»
class Logger {
    static func log(level: LogLevel, message: String, file: String = #file, function: String = #function, line: Int = #line) {
        print("[\(level)] \((file as NSString).lastPathComponent)[\(line)], \(function): \(message)")
    }
}
// è®°å½•æ—¥å¿—
Logger.log(level: .Info, message: "This is an info log.")
```

:::

### â“è®¾è®¡å®ç°ä¸€ä¸ªç½‘ç»œè¯·æ±‚æ¨¡å—

::: details ğŸ’¡

è®¾è®¡æ€è·¯ï¼š

  - åŠŸèƒ½è®¾è®¡: åˆ†æç›®å‰çš„åº”ç”¨éœ€æ±‚ã€æŠ€æœ¯æ ˆã€é¢„æœŸç›®æ ‡ç­‰è¿›è¡Œå…¨é¢çš„åˆ†æï¼Œå®šä¹‰ç½‘ç»œåº“çš„åŠŸèƒ½ï¼ˆå¦‚ï¼Œæ•°æ®è¯·æ±‚ã€ä¸Šä¼ ã€ä¸‹è½½ã€ç¼“å­˜ã€å®‰å…¨ç­–ç•¥ã€é”™è¯¯å¤„ç†ç­‰ï¼‰ã€‚

  - æ¥å£è®¾è®¡: è®¾è®¡æ˜“äºä½¿ç”¨å¹¶æ¸…æ™°æ˜äº†çš„ `API`ã€‚
    > ä¾‹å¦‚è®¾è®¡ä¸€ä¸ªä¸»ç±»ï¼Œç”¨äºå¤„ç† `HTTP` è¯·æ±‚ï¼Œæ­¤ç±»åº”åŒ…å« `GETï¼ŒPOSTï¼ŒPUTï¼ŒDELETE` ç­‰ `HTTP` æ–¹æ³•ã€‚å¹¶ä¸”åº”è¯¥è¦å®šä¹‰æ¸…æ™°çš„è¯·æ±‚å’Œå“åº”ç±»ã€‚
    
  - çº¿ç¨‹å¤„ç†ï¼šå¯¹äºç½‘ç»œè¯·æ±‚ï¼Œä¸€èˆ¬ä½¿ç”¨å¼‚æ­¥é˜Ÿåˆ—ï¼Œä»¥é¿å…é˜»å¡ä¸»çº¿ç¨‹ã€‚
    > å¯ä»¥ä½¿ç”¨ `DispatchQueue` æ¥è¿›è¡Œç›¸å…³å¤„ç†ã€‚

  - æ•°æ®åºåˆ—åŒ–ï¼šè¯·æ±‚æ•°æ®çš„åºåˆ—åŒ–å’Œååºåˆ—åŒ–ã€‚
    > å¯ä»¥ä½¿ç”¨ `Codable` æ¥å®ç°æ•°æ®æ¨¡å‹çš„åºåˆ—åŒ–å’Œååºåˆ—åŒ–ã€‚
    
  - é”™è¯¯å¤„ç†ï¼šç½‘ç»œè¯·æ±‚ä¸­ä¼šæœ‰å„ç§é”™è¯¯å¯èƒ½å‘ç”Ÿï¼Œéœ€è¦è®¾è®¡åˆç†çš„é”™è¯¯å¤„ç†æœºåˆ¶ï¼Œä½¿å¾—é”™è¯¯èƒ½è¢«å‡†ç¡®æ•è·å¹¶ä¼ é€’ç»™è°ƒç”¨è€…ã€‚

  - å®‰å…¨ç­–ç•¥ï¼šå¯¹äºéœ€è¦ä¿å¯†çš„æ•°æ®è¿›è¡ŒåŠ å¯†å¤„ç†ã€‚
    > å¦‚ç”¨æˆ·å‡­è¯ï¼Œåº”è¯¥ä½¿ç”¨ç›¸åº”çš„æ•£åˆ—æˆ–åŠ å¯†ç®—æ³•è¿›è¡Œå®‰å…¨å¤„ç†ã€‚

  - ç¼“å­˜ç­–ç•¥ï¼šå¯¹äºä¸€äº›é¢‘ç¹è¯·æ±‚ä½†ä¸å¸¸å˜åŠ¨çš„æ•°æ®ï¼Œå¯ä»¥é‡‡ç”¨åˆç†çš„ç¼“å­˜ç­–ç•¥ã€‚å¯ä»¥æ˜¾è‘—æå‡åº”ç”¨æ€§èƒ½ä»¥åŠå‡å°‘ç”¨æˆ·çš„æµé‡æ¶ˆè€—ã€‚
    
  - æµ‹è¯•ç”¨ä¾‹ï¼šç¼–å†™å®Œå–„çš„å•å…ƒæµ‹è¯•å’Œé›†æˆæµ‹è¯•ï¼Œä¿è¯ç½‘ç»œåº“çš„ç¨³å®šæ€§å’Œå¯é æ€§ã€‚


> ä¸€ä¸ªç®€æ˜“ç½‘ç»œæ¨¡å—çš„å®ç°ï¼š

  - å®šä¹‰ç½‘ç»œè¯·æ±‚çš„åŸºæœ¬ç»„ä»¶ï¼šè¿™åŒ…æ‹¬è¯·æ±‚æ–¹æ³•(`GETï¼ŒPOSTï¼ŒPUTï¼ŒDELETE` ç­‰)ã€è¯·æ±‚ `URL`ã€è¯·æ±‚å¤´ã€è¯·æ±‚å‚æ•°ã€è¶…æ—¶æ—¶é—´ç­‰ã€‚

    ```swift
    struct Request {
        let method: HttpMethod
        let url: String
        let headers: [String: String]?
        let params: [String: Any]?
        let timeout: Double
    }
    ```

  - æŠ½è±¡ç½‘ç»œè¯·æ±‚æ“ä½œï¼šå¯ä»¥å®šä¹‰ä¸€ä¸ªç½‘ç»œè¯·æ±‚æ“ä½œç±»æˆ–ä¸€ä¸ªå‡½æ•°ï¼Œç”¨äºå‘é€ç½‘ç»œè¯·æ±‚ï¼Œè§£æå“åº”å’Œå¤„ç†é”™è¯¯ã€‚

    ```swift
    class NetworkManager {
        static func send(request: Request, completion: @escaping (Result<Data, Error>) -> Void) {
            // å‘é€ç½‘ç»œè¯·æ±‚ï¼Œå¤„ç†å“åº”å’Œé”™è¯¯
        }
    }
    ```

  - æä¾›å…¬å…±æ¥å£ï¼šç±»æˆ–è€…å‡½æ•°é€šè¿‡å…¬å…±æ¥å£æä¾›æœåŠ¡ï¼Œæ¥å£åº”è¯¥æä¾›è¶³å¤Ÿçš„çµæ´»æ€§æ¥åº”å¯¹ä¸åŒç±»å‹çš„ç½‘ç»œè¯·æ±‚ã€‚

    ```swift
    extension NetworkManager {
        static func get(url: String, params: [String: Any]?, completion: @escaping (Result<Data, Error>) -> Void) {
            let request = Request(method: .GET, url: url, headers: nil, params: params, timeout: 30.0)
            send(request: request, completion: completion)
        }
    }
    ```

  - é”™è¯¯å¤„ç†ï¼šç½‘ç»œè¯·æ±‚è¿‡ç¨‹ä¸­å¯èƒ½ä¼šé‡åˆ°å„ç§é”™è¯¯ï¼Œéœ€è¦é¢„è§å¹¶å¤„ç†è¿™äº›é”™è¯¯ï¼Œæ¯”å¦‚æ— ç½‘ç»œè¿æ¥ã€æœåŠ¡å™¨æ— å“åº”ç­‰ã€‚
    
  - å“åº”è§£æï¼šç½‘ç»œè¯·æ±‚çš„æˆåŠŸå“åº”é€šå¸¸åŒ…æ‹¬ä¸€äº›å…ƒæ•°æ®å’Œå®é™…çš„å“åº”å†…å®¹ï¼Œéœ€è¦è§£æè¿™äº›å†…å®¹å¹¶ä»¥åˆé€‚çš„æ–¹å¼æä¾›ç»™å…¶ä»–éƒ¨åˆ†çš„ä»£ç ã€‚

  åœ¨å®ç°çš„è¿‡ç¨‹ä¸­ï¼Œå¯èƒ½è¿˜éœ€è¦å¤„ç†å„ç§å¤æ‚æƒ…å†µï¼Œæ¯”å¦‚å¹¶å‘è¯·æ±‚ã€è¯·æ±‚çš„ä¼˜å…ˆçº§ã€ç¼“å­˜ç­–ç•¥ã€èº«ä»½éªŒè¯ç­‰ç­‰ï¼Œæ ¹æ®å®é™…éœ€æ±‚è¿›è¡Œè®¾è®¡ã€‚

:::

### â“è®¾è®¡å®ç°ä¸€ä¸ªæ•°æ®ç¼“å­˜æ¨¡å—

::: details ğŸ’¡

è®¾è®¡æ€è·¯ï¼š

  - å®šä¹‰ä¸€ä¸ªç¼“å­˜é”®-å€¼å¯¹çš„æ•°æ®ç»“æ„ï¼šå¯ä»¥ä½¿ç”¨é›†åˆï¼Œä¸”å¿…é¡»å¯ä»¥æ ¹æ®é”®è½»æ¾æŸ¥æ‰¾åˆ°å€¼ã€‚

    ```swift
    var cache: NSCache<NSString, AnyObject> = NSCache<NSString, AnyObject>()
    ```

  - å®šä¹‰ä¸€ä¸ªæ–¹æ³•æ¥æ·»åŠ æ•°æ®åˆ°ç¼“å­˜ï¼šè¿™ä¸ªæ–¹æ³•åº”æ¥å—ä¸€ä¸ªé”®å’Œä¸€ä¸ªå€¼ï¼Œå¹¶æŠŠå€¼å…³è”åˆ°é”®ã€‚ç„¶åï¼ŒæŠŠè¿™ä¸ªé”®-å€¼å¯¹æ·»åŠ åˆ°ç¼“å­˜ã€‚

    ```swift
    func set(key: NSString, value: AnyObject) {
        cache.setObject(value, forKey: key)
    }
    ```

  - å®šä¹‰ä¸€ä¸ªæ–¹æ³•ä»ç¼“å­˜è·å–æ•°æ®ï¼šè¿™ä¸ªæ–¹æ³•åº”æ¥å—ä¸€ä¸ªé”®ï¼Œå¹¶è¿”å›ä¸è¯¥é”®å…³è”çš„å€¼ã€‚

    ```swift
    func get(key: NSString) -> AnyObject? {
        return cache.object(forKey: key)
    }
    ```

  - å®šä¹‰ä¸€ä¸ªæ–¹æ³•æ¥æ¸…é™¤ç¼“å­˜ï¼šè¿™ä¸ªæ–¹æ³•åº”æ¸…é™¤ç¼“å­˜ä¸­çš„æ‰€æœ‰æ•°æ®ã€‚

    ```swift
    func clear() {
        cache.removeAllObjects()
    }
    ```

  - ä¸ºç¼“å­˜å®šä¹‰ä¸€ä¸ªå¤§å°é™åˆ¶ï¼šè¿™å°†é˜²æ­¢ç¼“å­˜æ— é™åˆ¶åœ°å¢å¤§ï¼Œå¹¶ç¡®ä¿åœ¨è¾¾åˆ°é™åˆ¶æ—¶æ¸…é™¤ä¸€äº›æ—§çš„ç¼“å­˜æ•°æ®ã€‚

    ```swift
    var cache: NSCache<NSString, AnyObject> = {
        let cache = NSCache<NSString, AnyObject>()
        cache.countLimit = 200 // é™åˆ¶200ä¸ªå¯¹è±¡
        return cache
    }()
    ```

  - å¤±æ•ˆç­–ç•¥ï¼šæ ¹æ®ä½¿ç”¨æƒ…å†µï¼Œåˆ¶å®šç¼“å­˜å¤±æ•ˆç­–ç•¥ï¼Œæ¯”å¦‚æœ€é•¿ç¼“å­˜æ—¶é—´ã€LRU(Least Recently Used)æœ€è¿‘æœ€å°‘ä½¿ç”¨æ·˜æ±°ç­–ç•¥ç­‰

  å¯¹äºæ›´å¤æ‚çš„ä½¿ç”¨åœºæ™¯ï¼Œæ¯”å¦‚ç½‘ç»œç¼“å­˜ã€å›¾ç‰‡ç¼“å­˜ç­‰ï¼Œè®¾è®¡ä¼šæ›´ä¸ºå¤æ‚ï¼Œéœ€è¦æ ¹æ®å®é™…æƒ…å†µå®šåˆ¶ã€‚

> ä¸€ä¸ªç®€æ˜“çš„æ•°æ®ç¼“å­˜æ¨¡å—ï¼š

```swift
class DataCacheManager {
    // åˆå§‹åŒ–ä¸€ä¸ª NSCache å¯¹è±¡
    private let cache = NSCache<NSString, AnyObject>()
    
    // å•ä¾‹æ¨¡å¼ï¼Œå…¨å±€è®¿é—®ç‚¹
    static let shared = DataCacheManager()
    
    // æ·»åŠ æ•°æ®åˆ°ç¼“å­˜ä¸­
    func setData(_ data: AnyObject, for key: NSString) {
        cache.setObject(data, forKey: key)
    }
    
    // è·å–ç¼“å­˜æ•°æ®
    func getData(for key: NSString) -> AnyObject? {
        return cache.object(forKey: key)
    }
    
    // æ¸…é™¤æ‰€æœ‰ç¼“å­˜æ•°æ®
    func removeAllData() {
        cache.removeAllObjects()
    }
    
    // æ¸…é™¤æŸä¸€ç¼“å­˜æ•°æ®
    func removeData(for key: NSString) {
        cache.removeObject(forKey: key)
    }
    
    // å¯ä»¥æ ¹æ®éœ€è¦æ·»åŠ æ›´å¤šçš„æ¥å£ï¼Œæ¯”å¦‚ç¼“å­˜è¿‡æœŸæ—¶é—´ã€ç¼“å­˜å¤§å°é™åˆ¶ç­‰ã€‚
    // ...
}
```

:::

### â“è®¾è®¡å®ç°ä¸€ä¸ªæ•°æ®å­˜å‚¨æ¨¡å—

::: details ğŸ’¡

```swift
// ä½¿ç”¨ UserDefault å®ç°ä¸€ä¸ªç®€æ˜“çš„æ•°æ®å­˜å‚¨æ¨¡å—
class DataStorage {
    static let shared = DataStorage()

    private let defaults = UserDefaults.standard

    // Save data
    func saveData(value: Any, key: String) {
        defaults.set(value, forKey: key)
        defaults.synchronize()
    }

    // Get data
    func getData(key: String) -> Any? {
        if let data = defaults.value(forKey: key) {
            return data
        }
        return nil
    }

    // Remove data
    func removeData(key: String) {
        defaults.removeObject(forKey: key)
        defaults.synchronize()
    }

}

// ä½¿ç”¨
DataStorage.shared.saveData(value: "Hello, World", key: "greeting")
print(DataStorage.shared.getData(key: "greeting") ?? "No Data")
DataStorage.shared.removeData(key: "greeting")
print(DataStorage.shared.getData(key: "greeting") ?? "No Data")
```

:::