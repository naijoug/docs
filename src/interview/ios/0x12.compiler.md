---
title: ç¼–è¯‘å™¨
icon: hashtag

index: true

---

<!-- more -->

------

## ç¼–è¯‘å™¨

### â“iOS æ•´ä¸ªç¼–è¯‘æµç¨‹è¯´ä¸€ä¸‹

::: details ğŸ’¡

- é¢„å¤„ç†ï¼šè¿™ä¸€æ­¥ä¸»è¦æ˜¯å¤„ç†æºä»£ç ä¸­çš„é¢„å¤„ç†å™¨æŒ‡ä»¤ï¼Œå¦‚ `#defineã€#include` ç­‰ï¼Œå¹¶å°†ç»“æœè¾“å‡ºä¸ºé¢„å¤„ç†åçš„æºæ–‡ä»¶ã€‚

- ç¼–è¯‘ï¼šé¢„å¤„ç†åçš„æºæ–‡ä»¶è¢«ç¼–è¯‘å™¨ï¼ˆä¾‹å¦‚`Clang`ï¼‰ç¼–è¯‘ï¼Œè¿›è¡Œè¯æ³•åˆ†æã€è¯­æ³•åˆ†æã€è¯­ä¹‰åˆ†æå’Œä¼˜åŒ–ï¼Œå°†ä»£ç è½¬æ¢æˆå¯¹åº”çš„ä¸­é—´ä»£ç ã€‚ç„¶åå°†ä¸­é—´ä»£ç è¿›ä¸€æ­¥ä¼˜åŒ–å¹¶ç”Ÿæˆæ±‡ç¼–ä»£ç ã€‚

- æ±‡ç¼–ï¼šæ±‡ç¼–å™¨ï¼ˆä¾‹å¦‚ `Clang` çš„é›†æˆæ±‡ç¼–å™¨ï¼‰å°†æ±‡ç¼–ä»£ç è½¬æ¢ä¸ºç›®æ ‡æ–‡ä»¶ï¼ˆ`.o` æ–‡ä»¶ï¼‰ï¼Œå³åŒ…å«äº†æœºå™¨è¯­è¨€ä»£ç çš„æ–‡ä»¶ã€‚

- é“¾æ¥ï¼šé“¾æ¥å™¨ï¼ˆä¾‹å¦‚ `ld`ï¼‰å°†æ‰€æœ‰çš„ç›®æ ‡æ–‡ä»¶ä»¥åŠæ‰€éœ€çš„ç³»ç»Ÿåº“å’Œæ¡†æ¶è¿›è¡Œé“¾æ¥ï¼Œç”Ÿæˆå¯æ‰§è¡Œæ–‡ä»¶ã€‚è¿™é‡Œæ¶‰åŠåˆ°çš„ä¸»è¦æ­¥éª¤æœ‰åœ°å€å’Œç©ºé—´çš„åˆ†é…ã€ç¬¦å·å†³è®®åŠé‡å®šä½ã€‚

- æ‰“åŒ…ï¼šå¯æ‰§è¡Œæ–‡ä»¶é…åˆå¯¹åº”çš„èµ„æºæ–‡ä»¶ï¼ˆå¦‚å›¾ç‰‡ã€éŸ³é¢‘ç­‰ï¼‰ä¸€èµ·æ‰“åŒ…ï¼Œç”Ÿæˆ `.ipa` æ–‡ä»¶ï¼Œè¿™ä¸€æ­¥ä¸»è¦ç”± `Xcode` çš„å·¥å…·å®Œæˆã€‚

- ç­¾åï¼š`.ipa` æ–‡ä»¶éœ€è¦ç»è¿‡å¼€å‘è€…çš„ç§é’¥è¿›è¡Œç­¾åæ‰èƒ½åœ¨è®¾å¤‡ä¸Šè¿è¡Œï¼Œç­¾åè¿‡ç¨‹é€šå¸¸ä¹Ÿç§°ä¸ºä»£ç ç­¾åã€‚

- å®‰è£…ï¼šå°†ç­¾ååçš„ `.ipa` æ–‡ä»¶å®‰è£…åˆ°è®¾å¤‡ä¸Šï¼Œé€šå¸¸æ˜¯é€šè¿‡ `iTunes` æˆ–è€… `Xcode` è¿›è¡Œå®‰è£…ã€‚

:::

### â“app çš„å¯åŠ¨è¿‡ç¨‹

::: details ğŸ’¡

- `main` å‡½æ•°æ‰§è¡Œå‰ï¼š

    * ç‚¹å‡»å›¾æ ‡åï¼Œç”± `springboard` è¿›ç¨‹é€šè¿‡ `posix_spawn` å‡½æ•°æ¥åˆ›å»ºæ–°çš„è¿›ç¨‹ã€‚
    * åŠ¨æ€é“¾æ¥å™¨ `dyld` ä½œä¸ºæ–°è¿›ç¨‹çš„ä¸»çº¿ç¨‹å¼€å§‹æ‰§è¡Œã€‚é¦–å…ˆåŠ è½½ `Mach-O` æ–‡ä»¶ä¸­çš„ `dyld` è·¯å¾„ï¼Œè§£æåŠ è½½ `App` çš„æ‰€æœ‰ä¾èµ–åº“ã€‚
    * åœ¨åŠ è½½ä¾èµ–åº“è¿‡ç¨‹ä¸­ï¼Œ`dyld` é¦–å…ˆä¼šé€šè¿‡ `mach-o` åŠ è½½å™¨è§£æ `mach-o` æ–‡ä»¶ï¼ŒæŒ‰ä¾èµ–é¡ºåºè¿›è¡ŒåŠ è½½ã€‚ç„¶åå¯¹ `library` è¿›è¡Œ `rebase` å’Œ `bind` æ“ä½œï¼Œä»¥ç¡®ä¿ `library` åœ¨å†…å­˜ä¸­çš„æ­£ç¡®ä½ç½®ã€‚æ¥ç€è¿›è¡Œåˆæ­¥çš„ `lazy binding` å’Œ `weak binding` æ“ä½œã€‚
    * `dyld` ä¸ºäº†æé«˜æ‰§è¡Œæ€§èƒ½ï¼Œä¼šç¼“å­˜ä¸€ä»½å…±äº«ç¼“å­˜ï¼Œæé«˜ä¸‹æ¬¡å¯åŠ¨æ€§èƒ½ã€‚

- `Runtime` åˆå§‹åŒ–ï¼š

    - åŠ è½½å®Œæˆåï¼Œ`dyld` ä¼šåˆå§‹åŒ– `runtime` å¹¶è°ƒç”¨æ‰€æœ‰ `image` ä¸­çš„ `+load` æ–¹æ³•ã€‚
    - ä¹‹åå¯¹ `C++` å…¨å±€æ„é€ å™¨å’Œ `__attribute__((constructor))` ä¿®é¥°çš„æ–¹æ³•è¿›è¡Œè°ƒç”¨ã€‚
    - è¿›è¡Œå®Œä¸Šè¿°æ­¥éª¤ï¼Œ`dyld` åˆ™æŠŠæ§åˆ¶æƒäº¤å›ç»™ `App`ã€‚

- `main` å‡½æ•°å’Œ `UIApplicationMain` å‡½æ•°æ‰§è¡Œï¼š

    - `main` å‡½æ•°å¼€å§‹æ‰§è¡Œï¼Œä¼šè°ƒç”¨ `UIApplicationMain` å‡½æ•°ã€‚
    - åœ¨ `UIApplicationMain` ä¸­ï¼Œå®ƒä¼šåˆ›å»º `UIApplication` å¯¹è±¡ï¼Œå¹¶è®¾ç½® `UIApplicationDelegate`ï¼Œå¹¶å¯åŠ¨ä¸»è¿è¡Œå¾ªç¯ï¼ˆå³`Main RunLoop`ï¼‰ï¼Œå¼€å§‹æ¥æ”¶ç”¨æˆ·æ“ä½œã€‚
    - `UIApplication` å¯åŠ¨åï¼Œå®ƒä¼šæ ¹æ® `Info.plist` æ˜¯å¦æŒ‡å®š `Main storyboard` æ–‡ä»¶åï¼Œå¦‚æœæŒ‡å®šï¼Œé‚£ä¹ˆå°±ä¼šåŠ è½½ `Main storyboard`ï¼Œåˆ›å»ºå’Œè®¾ç½® `UIWindow` å’Œ `root view controller`ï¼Œç„¶åæ˜¾ç¤º `window` åˆ°å±å¹•ï¼Œ`App` å‘ˆç°å‡ºæ¥ã€‚

- `finishLaunching` æµç¨‹ï¼š

    - `UIApplication` å¯¹è±¡ä¼šå›è°ƒ `UIApplicationDelegate` ä¸­çš„ `application:didFinishLaunchingWithOptions:` æ–¹æ³•ï¼Œè¿™æ˜¯ `App` å¯åŠ¨çš„æœ€åä¸€æ­¥ï¼Œä¹‹åå°±è¿›å…¥äº†äº‹ä»¶å¤„ç†å¾ªç¯ï¼Œå¯åŠ¨æµç¨‹åˆ°æ­¤ç»“æŸã€‚

:::

### â“ä»ä»£ç ä»“åº“æ‹‰å–ä»£ç ï¼Œåˆ°ç”Ÿæˆ `.ipa` éƒ½æœ‰å“ªäº›è¿‡ç¨‹ï¼ŒæœŸé—´éƒ½ç”Ÿæˆäº†ä»€ä¹ˆæ–‡ä»¶

::: details ğŸ’¡

- æ‹‰å–ä»£ç 
    > ä½¿ç”¨ç‰ˆæœ¬æ§åˆ¶å·¥å…·ï¼ˆå¦‚`Git`ï¼‰ä»ä»£ç ä»“åº“æ‹‰å–é¡¹ç›®ä»£ç ã€‚

- é¢„å¤„ç†
    > é€šè¿‡ `Xcode` æˆ–å‘½ä»¤è¡Œå·¥å…·è¿›è¡Œé¢„å¤„ç†ï¼Œå°†æºä»£ç ä¸­çš„å®ç­‰é¢„å¤„ç†æŒ‡ä»¤è¿›è¡Œå±•å¼€ã€‚è¿™ä¸ªè¿‡ç¨‹å¹¶ä¸ç›´æ¥ç”Ÿæˆæ–‡ä»¶ï¼Œåªæ˜¯å¯¹æºä»£ç è¿›è¡Œé¢„å¤„ç†ã€‚

- ç¼–è¯‘
    > é¢„å¤„ç†åçš„ä»£ç è¢«ç¼–è¯‘å™¨ï¼ˆå¦‚`Clang`ï¼‰é€ä¸ªç¼–è¯‘ä¸ºç›®æ ‡æ–‡ä»¶ï¼ˆ`.o` æ–‡ä»¶ï¼‰ã€‚æ­¤è¿‡ç¨‹ä¸­å¯èƒ½ä¼šç”Ÿæˆä¸€äº›ä¸­é—´æ–‡ä»¶ï¼Œå¦‚é¢„ç¼–è¯‘å¤´æ–‡ä»¶ `.pch`ï¼Œæˆ–è€… `Swift` æ¨¡å—æ–‡ä»¶ `.swiftmodule` ç­‰ã€‚

- é“¾æ¥
    > ç”±é“¾æ¥å™¨ï¼ˆå¦‚ `ld`ï¼‰å°†æ‰€æœ‰çš„ç›®æ ‡æ–‡ä»¶ä»¥åŠæ‰€éœ€çš„ç³»ç»Ÿåº“å’Œæ¡†æ¶è¿›è¡Œé“¾æ¥ï¼Œç”Ÿæˆå¯æ‰§è¡Œçš„ `Mach-O` æ–‡ä»¶ã€‚

- æ‰“åŒ…
    > å°†å¯æ‰§è¡Œæ–‡ä»¶ä»¥åŠå„ç§èµ„æºæ–‡ä»¶ï¼ˆå¦‚å›¾ç‰‡ã€`xib`ã€`storyboard` æ–‡ä»¶ç­‰ï¼‰æ‰“åŒ…åˆ° `.app` æ–‡ä»¶ï¼ˆå³åº”ç”¨ç¨‹åºåŒ…ï¼‰ä¸­ã€‚

- ç­¾å
    > å¯¹ `.app` æ–‡ä»¶è¿›è¡Œç­¾åï¼Œç”Ÿæˆ `embedded.mobileprovision`ï¼ˆåŒ…å«å¼€å‘è€…è¯ä¹¦å’Œè®¾å¤‡ `UDID`ï¼‰ã€`CodeResources`ï¼ˆåŒ…å«èµ„æºæ–‡ä»¶çš„å“ˆå¸Œå€¼ï¼‰ç­‰æ–‡ä»¶ï¼Œå¹¶è¢«åŒ…å«åˆ° `.app` æ–‡ä»¶ä¸­ã€‚

- ç”Ÿæˆ `.ipa`
    > å°†ä¸Šè¿°çš„ `.app` æ–‡ä»¶ä»¥åŠ `iTunesArtwork`ï¼ˆ`iTunes` ä¸­ç”¨æ¥å±•ç¤ºçš„ `App` å›¾æ ‡ï¼‰ç­‰æ–‡ä»¶æ‰“åŒ…è¿› `Payload` æ–‡ä»¶å¤¹ï¼Œç„¶åä»¥ `.zip` æ ¼å¼è¿›è¡Œå‹ç¼©ï¼Œæœ€åå°†æ–‡ä»¶åç¼€åæ”¹ä¸º `.ipa`ï¼Œå°±ç”Ÿæˆäº†æœ€åçš„ `.ipa` æ–‡ä»¶ã€‚

:::

### â“ç¨‹åºåˆ°å¯æ‰§è¡Œæ–‡ä»¶çš„è¿‡ç¨‹ï¼Œé“¾æ¥è¿‡ç¨‹éƒ½å¹²äº†å•¥

::: details ğŸ’¡

å°†ç¨‹åºè½¬æ¢ä¸ºå¯æ‰§è¡Œæ–‡ä»¶å¯ä»¥åˆ†ä¸ºç¼–è¯‘å’Œé“¾æ¥ä¸¤ä¸ªè¿‡ç¨‹ã€‚

- ç¼–è¯‘ï¼š

    * é¢„å¤„ç†ï¼šè¿™ä¸€æ­¥ä¸»è¦å¤„ç†æºæ–‡ä»¶ä¸­çš„é¢„å¤„ç†å‘½ä»¤ï¼Œå¦‚å®å®šä¹‰ã€å¤´æ–‡ä»¶åŒ…å«ç­‰ã€‚
    * ç¼–è¯‘ï¼šé¢„å¤„ç†è¿‡çš„æºæ–‡ä»¶è¢«ç¼–è¯‘æˆæ±‡ç¼–è¯­è¨€ã€‚
    * æ±‡ç¼–ï¼šæ±‡ç¼–ç¨‹åºå°†æ±‡ç¼–è¯­è¨€æ–‡ä»¶è½¬æ¢ä¸ºç›®æ ‡æ–‡ä»¶ï¼Œè¿™æ˜¯ä¸ªäºŒè¿›åˆ¶æ–‡ä»¶ï¼ŒåŒ…å«äº†æºç¨‹åºç¼–è¯‘åçš„æœºå™¨è¯­è¨€ä»£ç ã€‚

- é“¾æ¥ï¼š
    > é“¾æ¥ä¸»è¦å¯¹ç¼–è¯‘ç”Ÿæˆçš„å¤šä¸ªç›®æ ‡æ–‡ä»¶ä¹‹é—´çš„å¼•ç”¨è¿›è¡Œè§£æå¹¶åˆå¹¶ï¼Œè¾“å‡ºä¸ºä¸€ä¸ªå¯æ‰§è¡Œæ–‡ä»¶ã€‚

    * ç¬¦å·è§£æï¼šæ¯ä¸ªç¬¦å·å¯¹åº”ç€ä¸€å—å†…å­˜ï¼Œç¬¦å·è§£æçš„ä¸»è¦ç›®æ ‡å°±æ˜¯æ‰¾åˆ°è¿™å—å†…å­˜çš„åœ°å€ã€‚é“¾æ¥å™¨è¦è´Ÿè´£æŠŠæ¯ä¸ªç¬¦å·çš„å¼•ç”¨ä¸å®šä¹‰å…³è”èµ·æ¥ã€‚
    * é‡å®šä½ï¼šåœ¨ç¬¦å·è§£æçš„åŸºç¡€ä¸Šï¼Œè¿›è¡Œåœ°å€åˆ†é…å’Œé‡å®šä½ã€‚åœ°å€åˆ†é…å°±æ˜¯æŠŠæ¯ä¸ªæ®µåˆ†é…ä¸€ä¸ªè¿è¡Œæ—¶å†…å­˜åœ°å€ã€‚é‡å®šä½å°±æ˜¯æŠŠæ¯æ¡æŒ‡ä»¤å’Œå…¨å±€å˜é‡å¼•ç”¨çš„ç¬¦å·ä¿®æ”¹æˆè¿è¡Œæ—¶åœ°å€ã€‚
    * æ®µåˆå¹¶ï¼šå°†æ‰€æœ‰ç›®æ ‡æ–‡ä»¶çš„åŒåæ®µåˆå¹¶æˆä¸€ä¸ªæ®µï¼Œä½äºä¸€ä¸ªå¯æ‰§è¡Œæ–‡ä»¶ä¸­çš„åŒä¸€ä½ç½®ã€‚
    * ç©ºé—´å’Œåœ°å€åˆ†é…ï¼šä¸ºæ¯ä¸ªæ®µåˆ†é…ä¸€ä¸ªå†…å­˜åœ°å€ã€‚
    * é‡å®šä½è¡¨å’Œç¬¦å·è¡¨çš„åˆ›å»ºå’Œæ›´æ–°ï¼šåˆ›å»ºå’Œæ›´æ–°è¿™ä¸¤ä¸ªè¡¨æ˜¯ä¸ºäº†ç¨‹åºçš„åŠ è½½å’Œè¿è¡Œã€‚
    * è°ƒè¯•åŠå…¶å®ƒçš„ä¿¡æ¯ï¼šåŠ å…¥å¿…è¦çš„è°ƒè¯•ç­‰ä¿¡æ¯ã€‚
    * ç»“æœè¾“å‡ºï¼šå°†é“¾æ¥ç»“æœè¾“å‡ºåˆ°å¯æ‰§è¡Œæ–‡ä»¶ã€‚

    é“¾æ¥ï¼Œå°±æ˜¯è§£å†³å„ä¸ªç¼–è¯‘å•å…ƒä¹‹é—´çš„å¼•ç”¨é—®é¢˜ï¼ŒåŒ…æ‹¬åœ°å€åˆ†é…ï¼Œç¬¦å·è§£æï¼Œé‡å®šä½ç­‰æ­¥éª¤ã€‚å®ƒæ˜¯æŠŠå„ä¸ªç¼–è¯‘å•å…ƒç¼–è¯‘ç”Ÿæˆçš„ç›®æ ‡æ–‡ä»¶è¿æ¥æˆä¸€ä¸ªå®Œæ•´çš„å¯æ‰§è¡Œç¨‹åºçš„è¿‡ç¨‹ã€‚

:::

### â“åŠ¨æ€åº“é™æ€åº“åŒºåˆ«

::: details ğŸ’¡

è§£é‡Šï¼š

  - é™æ€åº“ï¼šåœ¨ç¼–è¯‘æ—¶å°±è¢«é“¾æ¥åˆ°ç›®æ ‡ç¨‹åºä¸­ï¼Œç¨‹åºè¿è¡Œæ—¶ä¸å†éœ€è¦è¯¥é™æ€åº“ã€‚ç”Ÿæˆçš„å¯æ‰§è¡Œæ–‡ä»¶è¾ƒå¤§ï¼Œå› ä¸ºæ‰€æœ‰ä½¿ç”¨çš„åº“å‡½æ•°ä»£ç éƒ½ä¼šè¢«å¤åˆ¶åˆ°ç›®æ ‡ä»£ç ä¸­ã€‚å› æ­¤ï¼Œé™æ€åº“çš„æ”¹åŠ¨éœ€è¦é‡æ–°ç¼–è¯‘ç¨‹åºæ‰èƒ½ç”Ÿæ•ˆï¼Œä½†å…·æœ‰è¾ƒå¥½çš„å¯ç§»æ¤æ€§ã€‚

  - åŠ¨æ€åº“ï¼šåœ¨ç¼–è¯‘æ—¶å¹¶ä¸ä¼šè¢«é“¾æ¥åˆ°ç›®æ ‡ç¨‹åºä¸­ï¼Œè€Œæ˜¯åœ¨ç¨‹åºè¿è¡Œæ—¶ç”±ç³»ç»ŸåŠ¨æ€åœ°åŠ è½½å¹¶é“¾æ¥åˆ°ç¨‹åºä¸­ã€‚åŠ¨æ€åº“è™½ç„¶ä¼šç¼©å°ç”Ÿæˆçš„å¯æ‰§è¡Œæ–‡ä»¶çš„ä½“ç§¯ï¼Œä½†éœ€è¦ä¿è¯è¿è¡Œç¯å¢ƒä¸­æœ‰ç›¸åº”çš„åº“æ–‡ä»¶ã€‚åŠ¨æ€åº“çš„ä¸€ä¸ªç‰¹ç‚¹æ˜¯ï¼Œå¤šä¸ªåº”ç”¨ç¨‹åºå¯ä»¥å…±äº«ä¸€ä¸ªåŠ¨æ€åº“çš„å•ä¸€æ‹·è´ï¼Œè¿™æ ·å¯ä»¥èŠ‚çœç³»ç»Ÿèµ„æºã€‚

åŒºåˆ«ï¼š

  - ç©ºé—´å ç”¨ï¼šé™æ€åº“ä¼šè®©ç¨‹åºä½“ç§¯å˜å¤§ï¼ŒåŠ¨æ€åº“åˆ™ä¼šè®©ç¨‹åºåœ¨è¿è¡Œæ—¶å ç”¨æ›´å¤šå†…å­˜ã€‚
  - è°ƒè¯•ï¼šé™æ€åº“è°ƒè¯•æ¯”è¾ƒç®€å•ï¼Œå› ä¸ºæ‰€æœ‰çš„ä»£ç éƒ½åœ¨å¯æ‰§è¡Œæ–‡ä»¶ä¸­ã€‚è€ŒåŠ¨æ€åº“åˆ™éœ€è¦åœ¨è¿è¡Œæ—¶æ‰èƒ½å¤Ÿè¿›è¡Œè°ƒè¯•ã€‚
  - å…¼å®¹æ€§ï¼šé™æ€é“¾æ¥çš„ç¨‹åºæ›´ä¾¿äºåˆ†å‘ï¼Œå› ä¸ºå®ƒåŒ…å«äº†æ‰€æœ‰éœ€è¦çš„ä»£ç ã€‚è€ŒåŠ¨æ€é“¾æ¥çš„ç¨‹åºåˆ™éœ€è¦å¯ä»¥è®¿é—®ç‰¹å®šç‰ˆæœ¬çš„åŠ¨æ€åº“ï¼Œå¦åˆ™å¯èƒ½ä¼šå¯¼è‡´è¿è¡Œé”™è¯¯ã€‚
  - æ›´æ–°ï¼šåŠ¨æ€åº“å¯ä»¥åˆ©ç”¨ç³»ç»Ÿçš„åŠ¨æ€é“¾æ¥æœºåˆ¶è¿›è¡Œæ›´æ–°ï¼Œè€Œä¸éœ€è¦é‡æ–°ç¼–è¯‘ç¨‹åºã€‚

:::

### â“é™æ€åº“å’ŒåŠ¨æ€åº“å„è‡ªçš„å¥½å¤„

::: details ğŸ’¡

é™æ€åº“çš„å¥½å¤„ï¼š

  - é«˜æ•ˆï¼šé™æ€åº“åœ¨ç¼–è¯‘é˜¶æ®µå°±å·²ç»è¢«åŒ…å«åˆ°äº†äºŒè¿›åˆ¶å¯æ‰§è¡Œæ–‡ä»¶ä¸­ï¼Œè¿è¡Œæ—¶ä¸éœ€è¦é¢å¤–çš„åŠ¨æ€é“¾æ¥è¿‡ç¨‹ï¼Œæ‰€ä»¥ä»è¿™ä¸ªè§’åº¦æ¥è¯´é™æ€é“¾æ¥çš„æ‰§è¡Œæ•ˆç‡ä¼šä¼˜äºåŠ¨æ€é“¾æ¥ã€‚
  - å¯ç§»æ¤æ€§ï¼šå› ä¸ºé™æ€åº“è¢«æ‰“åŒ…åˆ°äº†æœ€ç»ˆçš„å¯æ‰§è¡Œæ–‡ä»¶ä¸­ï¼Œå¯ä»¥ç®€åŒ–ç¨‹åºçš„å‘å¸ƒï¼Œä¸éœ€è¦è€ƒè™‘æ˜¯å¦ç¼ºå°‘æŸäº›åŠ¨æ€åº“ã€‚
  - å®‰å…¨ï¼šé¿å…äº†åŠ¨æ€åº“ç‰ˆæœ¬ä¸ä¸€è‡´å¯¼è‡´çš„é—®é¢˜ã€‚

åŠ¨æ€åº“çš„å¥½å¤„ï¼š

  - èŠ‚çœèµ„æºï¼šè‹¥æœ‰å¾ˆå¤šç¨‹åºéƒ½è¦ç”¨åˆ°æŸä¸ªåº“ï¼Œé‚£ä¹ˆä½¿ç”¨é™æ€åº“å°†ä¼šåœ¨æ¯ä¸ªç¨‹åºä¸­éƒ½ç”Ÿæˆä¸€ä»½è¿™ä¸ªåº“çš„æ‹·è´ã€‚è€ŒåŠ¨æ€åº“åªéœ€è¦ä¸€ä»½æ‹·è´ï¼Œæ‰€æœ‰çš„ç¨‹åºå…±äº«åŒä¸€ä»½åŠ¨æ€åº“ï¼Œè¿™æ ·å°±èŠ‚çœäº†ç£ç›˜ç©ºé—´å’Œå†…å­˜ã€‚
  - æ›´æ–°ç®€ä¾¿ï¼šå¦‚æœåº“éœ€è¦æ›´æ–°æˆ–è€…ä¿®å¤ `bug`ï¼Œåªéœ€è¦é‡æ–°ç¼–è¯‘åº“ï¼Œç„¶åæ›¿æ¢ç°æœ‰çš„åŠ¨æ€åº“æ–‡ä»¶å³å¯ï¼Œä¸éœ€è¦å¯¹ä½¿ç”¨åˆ°è¿™ä¸ªåº“çš„è½¯ä»¶è¿›è¡Œé‡æ–°é“¾æ¥ã€‚å¯¹äºä½¿ç”¨é™æ€åº“çš„ç¨‹åºåˆ™éœ€è¦é‡æ–°ç¼–è¯‘é“¾æ¥å…¨éƒ¨ç¨‹åºã€‚
  - åŠ¨æ€é“¾æ¥ï¼šå¯ä»¥åœ¨ç¨‹åºè¿è¡Œæ—¶åŠ¨æ€åŠ è½½æ‰€éœ€çš„åº“ï¼Œç”šè‡³æ˜¯ç¨‹åºå¯åŠ¨åå†å†³å®šåŠ è½½å“ªä¸ªåº“ã€‚è¿™æå¤§çš„æé«˜äº†ç¨‹åºçš„çµæ´»æ€§å’ŒåŠŸèƒ½çš„æ‰©å±•æ€§ã€‚

:::

### â“è¯´è¯´å¯¹ `bitcode` çš„ç†è§£å’Œä½œç”¨

::: details ğŸ’¡

> `Bitcode` æ˜¯è‹¹æœåœ¨ `2015` å¹´æ¨å‡ºçš„ä¸€ä¸ªæ–°çš„ç¼–è¯‘é€‰é¡¹ï¼Œå®ƒæ˜¯ `LLVM`ï¼ˆä½çº§è™šæ‹Ÿæœºï¼‰çš„ä¸€ç§ä¸­é—´è¡¨ç¤ºï¼ˆ`Intermediate Representationï¼ŒIR`ï¼‰å½¢å¼ã€‚å¯¹æºä»£ç åšå®Œä¸€äº›åŸºæœ¬çš„è¯­ä¹‰åˆ†æå’ŒéªŒè¯å·¥ä½œåï¼Œå°±å¯ä»¥è½¬åŒ–æˆ`Bitcode`ã€‚

  `Bitcode` çš„å‡ºç°æ˜¯ä¸ºäº†æ”¯æŒè‹¹æœçš„ `App Thinning` ç‰¹æ€§ã€‚å…·ä½“æ¥è¯´ï¼Œå½“æäº¤ä¸€ä¸ªåŒ…å« `Bitcode` çš„åº”ç”¨åˆ° `App Store` æ—¶ï¼Œè‹¹æœä¼šåœ¨åå°é‡æ–°ç¼–è¯‘æäº¤çš„åº”ç”¨å¹¶è¿›è¡Œä¼˜åŒ–ï¼Œç”Ÿæˆé’ˆå¯¹å„ç§è®¾å¤‡çš„å…·ä½“æ‰§è¡Œæ–‡ä»¶ã€‚å› æ­¤ï¼Œå½“ç”¨æˆ·ä» `App Store` ä¸‹è½½åº”ç”¨æ—¶ï¼Œä»–ä»¬åªéœ€ä¸‹è½½é€‚ç”¨äºä»–ä»¬è‡ªå·±è®¾å¤‡æ¶æ„çš„äºŒè¿›åˆ¶ä»£ç ï¼Œè€Œæ— éœ€ä¸‹è½½é¢å‘æ‰€æœ‰è®¾å¤‡çš„é€šç”¨äºŒè¿›åˆ¶ä»£ç ã€‚

ä¼˜ç‚¹ï¼š

  - èŠ‚çœå­˜å‚¨ç©ºé—´ï¼šç”¨æˆ·ä¸‹è½½çš„åº”ç”¨ä½“ç§¯æ›´å°ï¼ŒèŠ‚çœäº†è®¾å¤‡çš„å­˜å‚¨ç©ºé—´ã€‚
  - æé«˜æ€§èƒ½ï¼šè‹¹æœå¯ä»¥æ ¹æ®ç‰¹å®šç¡¬ä»¶å’Œ `iOS` ç‰ˆæœ¬è¿›è¡Œç‰¹å®šçš„ä¼˜åŒ–ï¼Œä»è€Œæ›´å¥½åœ°åˆ©ç”¨ç¡¬ä»¶æ€§èƒ½ã€‚
  - æ›´æ–°å…¼å®¹ï¼šå½“è‹¹æœå¼• `introduce` æ–°çš„ç¡¬ä»¶æˆ–è€…æŒ‡ä»¤é›†æ—¶ï¼Œå¯ä»¥åœ¨åå°é‡æ–°ç¼–è¯‘ `Bitcode`ï¼Œè‡ªåŠ¨ä½¿åº”ç”¨é€‚é…æœ€æ–°çš„è®¾å¤‡ï¼Œè€Œæ— éœ€å¼€å‘è€…é‡æ–°ç¼–è¯‘å’Œæäº¤ã€‚

ç¼ºç‚¹ï¼š

  - å¤±å»ä¸€äº›æ§åˆ¶æƒï¼šç”±äºç¨‹åºæœ€ç»ˆæ˜¯ç”± `Apple` çš„æœåŠ¡å™¨è¿›è¡Œç¼–è¯‘å’Œä¼˜åŒ–ï¼Œå¼€å‘è€…æ— æ³•çŸ¥é“ã€æ§åˆ¶å’ŒéªŒè¯ä¼˜åŒ–çš„ç»†èŠ‚ã€‚
  - è°ƒè¯•éš¾åº¦å¢åŠ ï¼šå½“å‡ºç°é—®é¢˜æ—¶ï¼Œå¯èƒ½ä¸‹è½½çš„äºŒè¿›åˆ¶ä»£ç å·²ç»è¢«ä¿®æ”¹ï¼Œä¸å¼€å‘è€…æœ¬åœ°ç¼–è¯‘å‡ºçš„äºŒè¿›åˆ¶ä¸ä¸€è‡´ï¼Œå› æ­¤å¯èƒ½å¸¦æ¥è°ƒè¯•å›°éš¾ã€‚æ­¤å¤–ï¼Œæäº¤çš„ `.ipa` åŒ…ä¹Ÿæ— æ³•ç›´æ¥è¿è¡Œå’Œè°ƒè¯•ï¼Œç”±äºé‡Œé¢çš„äºŒè¿›åˆ¶ä»£ç å®é™…ä¸Šæ˜¯ `Bitcode`ï¼Œéœ€è¦é€šè¿‡è¿è¡Œ `App Store` ç‰ˆæœ¬æˆ–è€…ä» `Xcode` ä¸­ä¸‹è½½ `dSYM` æ–‡ä»¶æ¥è·å–å…·ä½“çš„å´©æºƒæ—¥å¿—ã€‚

æ€»ç»“ï¼š`Bitcode` æœ‰ç‚¹åƒæŠŠåŸå…ˆåœ¨æœ¬åœ°è¿›è¡Œçš„â€œé“¾æ¥â€è¿‡ç¨‹äº¤ç»™äº†è‹¹æœçš„æœåŠ¡å™¨æ¥å®Œæˆï¼Œè¿›ä¸€æ­¥åŠ å¼ºäº†è‹¹æœå¯¹ `AppStore` ä¸­åº”ç”¨çš„æ§åˆ¶ï¼Œåˆèƒ½æå‡ç”¨æˆ·çš„ä¸‹è½½ä½“éªŒå’Œè®¾å¤‡æ€§èƒ½ã€‚å¯¹äºå¼€å‘è€…æ¥è¯´ï¼Œéœ€è¦æƒè¡¡ `Bitcode` å¸¦æ¥çš„å¥½å¤„ä¸æ½œåœ¨é—®é¢˜ã€‚

:::

------

## hook

### â“`iOS` ä¸­ `hook` ä¸€ä¸ªæ–¹æ³•æœ‰ä»€ä¹ˆé€”å¾„

::: details ğŸ’¡

- `Method Swizzling`ï¼šé€šè¿‡ `Objective-C` çš„æ–¹æ³•äº¤æ¢ (`Method Swizzling`)ï¼Œå¯ä»¥åœ¨è¿è¡Œæ—¶åŠ¨æ€åœ°äº¤æ¢æŸä¸ªç±»çš„ä¸¤ä¸ªæ–¹æ³•çš„å®ç°ã€‚

- åˆ†ç±»(`Category`)ï¼šåœ¨å…¶ä¸­æ·»åŠ ä¸€ä¸ªæ–°æ–¹æ³•ï¼Œç„¶åç”¨è¿™ä¸ªæ–°æ–¹æ³•çš„å®ç°æ›¿æ¢åŸå§‹æ–¹æ³•çš„å®ç°ã€‚è¿™å°†å¯¼è‡´åŸå§‹æ–¹æ³•è¢«åˆ†ç±»ä¸­çš„æ–°æ–¹æ³•æ‰€æ›¿ä»£ã€‚

- åå°„æœºåˆ¶ï¼šå¯ä»¥åœ¨è¿è¡Œæ—¶åŠ¨æ€åœ°åˆ›å»ºç±»ã€æ£€æŸ¥ç±»çš„å±æ€§å’Œæ–¹æ³•ï¼Œç”šè‡³æ”¹å˜ç±»çš„ç»“æ„ã€‚é€šè¿‡åå°„å¯ä»¥å®ç°å¯¹æ–¹æ³•çš„æ‹¦æˆªå’Œæ›¿æ¢ã€‚

- ä½¿ç”¨ç¬¬ä¸‰æ–¹åº“ï¼šå¦‚`Aspects`ï¼Œ`Facebook` çš„ `fishhook`ï¼Œå®ƒä»¬æä¾›äº†è¾ƒä¸ºæ–¹ä¾¿å’Œç®€æ´çš„ `hook` æ–¹æ¡ˆã€‚

- `Cycript`ï¼šè¿™æ˜¯ä¸€ä¸ªç”¨äºè°ƒè¯•å’Œç ”ç©¶ `iOS` åº”ç”¨çš„å·¥å…·ï¼Œå®ƒå¯ä»¥æ³¨å…¥ `JavaScript` è¯­å¢ƒè¿›å…¥æ­£åœ¨è¿è¡Œçš„åº”ç”¨è¿›ç¨‹ä¸­ï¼Œä»è€Œå®ç°å¯¹å¯¹è±¡å’Œå‡½æ•°çš„äº¤äº’æ“ä½œã€‚

:::

### â“`iOS` å¦‚ä½• `hook` ä¸€ä¸ªå¯¹è±¡çš„æ–¹æ³•ï¼Œè€Œä¸å½±å“å…¶å®ƒå¯¹è±¡

::: details ğŸ’¡

> â€œIsa Swizzlingâ€ï¼šè¿™æ˜¯ä¸€ç§åŠ¨æ€æ”¹å˜å¯¹è±¡çš„ç±»çš„æŠ€æœ¯ã€‚

```objc
// åŸæ¥çš„ç±»
@interface MyClass : NSObject
- (void)originalMethod;
@end

@implementation MyClass
- (void)originalMethod {
    NSLog(@"Original method");
}
@end

// å­ç±»
@interface MySwizzledClass : MyClass
@end

@implementation MySwizzledClass
- (void)originalMethod {
    NSLog(@"Swizzled method");
    [super originalMethod];
}
@end

// è®© hook çš„å¯¹è±¡ä½¿ç”¨å­ç±»
MyClass *myInstance = [[MyClass alloc] init];
object_setClass(myInstance, [MySwizzledClass class]);
[myInstance originalMethod]; // è¾“å‡º â€œSwizzled methodâ€ å’Œ â€œOriginal methodâ€
```

:::

### â“äº†è§£ `fishhook` å—ï¼Œè¯´è¯´ä¸ºä»€ä¹ˆ `fishhook` ä¸èƒ½ä¿®æ”¹éåŠ¨æ€è¿æ¥åº“ä¸­çš„ç¬¦å·

::: details ğŸ’¡

  > `fishhook` æ˜¯ `Facebook` å¼€å‘çš„ä¸€ä¸ªç”¨äº `iOS` å’Œ `macOS` åº”ç”¨çš„å¼€æºåº“ï¼Œå…è®¸ä½ åœ¨è¿è¡Œæ—¶å¯¹ `C` è¯­è¨€å‡½æ•°è¿›è¡Œé‡ç»‘å®šï¼Œå¹¶ä¸”æ˜¯é€šè¿‡ä¿®æ”¹ `mach-O` æ–‡ä»¶ä¸­çš„ç¬¦å·è¡¨ï¼ˆ`Symbol Table`ï¼‰å®ç°çš„ã€‚

ä¸èƒ½ä¿®æ”¹éåŠ¨æ€è¿æ¥åº“ä¸­çš„ç¬¦å·çš„åŸå› ï¼š

  - `fishhook` ä¿®æ”¹çš„æ˜¯åŠ¨æ€é“¾æ¥è¡¨ï¼Œåœ¨ç¨‹åºå¯åŠ¨æ—¶ï¼ŒåŠ¨æ€é“¾æ¥å™¨(`dyld`)ä¼šæ ¹æ®è¡¨ä¸­çš„ç¬¦å·ä¿¡æ¯ï¼Œæ‰¾åˆ°åŠ¨æ€é“¾æ¥åº“ä¸­çš„å‡½æ•°åœ°å€ï¼Œå¹¶åœ¨è¿è¡Œæ—¶è¿›è¡Œå‡½æ•°è°ƒç”¨ã€‚è€Œå¯¹äºé™æ€é“¾æ¥åº“ï¼Œé“¾æ¥å‘ç”Ÿåœ¨ç¼–è¯‘æ—¶ï¼Œå¯¹åº”çš„å‡½æ•°æˆ–è€…å˜é‡çš„å€¼åœ¨ç¼–è¯‘åå°±ç¡®å®šäº†ï¼Œä¸å­˜åœ¨åŠ¨æ€é“¾æ¥è¡¨ï¼Œå› æ­¤ `fishhook`æ— æ³•ä¿®æ”¹ã€‚
  - é™æ€åº“åœ¨ç¼–è¯‘æ—¶ä¼šç›´æ¥è¢«åˆå¹¶åˆ°å¯æ‰§è¡Œæ–‡ä»¶ä¸­ï¼Œé™æ€åº“ä¸­çš„ç¬¦å·ä¿¡æ¯ä¼šåœ¨ç¼–è¯‘æ—¶è¢«è§£æå¹¶ä¸”å†™å…¥åˆ°å¯æ‰§è¡Œæ–‡ä»¶ä¸­ï¼Œæ‰€ä»¥ `fishhook`ä¹Ÿ æ— æ³•ä¿®æ”¹ã€‚
  - æ ¹æ® `Mach-O` æ–‡ä»¶æ ¼å¼çš„å®šä¹‰ï¼Œ`fishhook` é€šè¿‡ä¿®æ”¹ `LC_SYMTAB command` ä¸‹çš„ç¬¦å·è¡¨ï¼Œè€Œè¿™ä¸ªç¬¦å·è¡¨ä¸»è¦ç”¨äºåŠ¨æ€è¿æ¥è¿‡ç¨‹ä¸­çš„ç¬¦å·è§£æï¼Œæ‰€ä»¥åªèƒ½ä¿®æ”¹åŠ¨æ€åº“ä¸­çš„ç¬¦å·ã€‚

  æ€»ç»“ï¼š`fishhook` åªèƒ½ä¿®æ”¹åŠ¨æ€åº“çš„ç¬¦å·ï¼Œæ— æ³•ä¿®æ”¹éåŠ¨æ€åº“çš„ç¬¦å·ã€‚

:::

------

## å®‰å…¨é—®é¢˜

### â“`iOS` è®¾å¤‡è·å–å”¯ä¸€è®¾å¤‡å·çš„å†å²å˜è¿

::: details ğŸ’¡

- `UDID`ï¼ˆUnique Device Identifierï¼‰ï¼šåœ¨`iOS 5`ä¹‹å‰ï¼Œå¯ä»¥ç›´æ¥ä½¿ç”¨ `[UIDevice currentDevice].uniqueIdentifier` æ¥è·å–è®¾å¤‡çš„ `UDID`ï¼Œå®ƒæ˜¯ä¸€ä¸ª40ä½çš„åå…­è¿›åˆ¶åºåˆ—ï¼Œç”±è®¾å¤‡çš„å„ç§ç¡¬ä»¶ä¿¡æ¯ç”Ÿæˆï¼Œæ¯å°è®¾å¤‡å”¯ä¸€ã€‚ç„¶è€Œï¼Œç”±äºéšç§é—®é¢˜ï¼Œ`Apple` åœ¨ `iOS 5` åŠä»¥åçš„ç‰ˆæœ¬ä¸­åºŸå¼ƒäº†è¿™ä¸ª `API`ã€‚

- `MAC` åœ°å€ï¼šå› ä¸º `UDID` è¢«åºŸå¼ƒï¼Œéƒ¨åˆ†å¼€å‘è€…å¼€å§‹ä½¿ç”¨è®¾å¤‡çš„ `Wi-Fi chip` çš„ `MAC` åœ°å€ä½œä¸ºæ›¿ä»£ã€‚ç„¶è€Œåœ¨ `iOS 7` ä»¥åï¼Œ`Apple` ä¹Ÿç¦æ­¢äº†è·å– `MAC` åœ°å€ï¼Œæ‰€æœ‰å°è¯•è·å–çš„è¡Œä¸ºéƒ½ä¼šè¿”å›å›ºå®šçš„"02:00:00:00:00:00"ã€‚

- `UUID`ï¼ˆUniversally Unique Identifierï¼‰ï¼š`UUID` æ˜¯æ¯æ¬¡ç”Ÿæˆéƒ½ä¸åŒçš„ä¸€ä¸²å­—ç¬¦ã€‚åœ¨ `UDID` å’Œ `MAC` åœ°å€éƒ½ä¸èƒ½ä½¿ç”¨åï¼Œéƒ¨åˆ†å¼€å‘è€…å¼€å§‹äº§ç”Ÿä¸€ä¸ª `UUID` å¹¶å°†å…¶å­˜å‚¨åœ¨åº”ç”¨çš„ `KeyChain` ä¸­ï¼Œè¿™æ ·å°±å¯ä»¥ä¿è¯åŒä¸€å°è®¾å¤‡ä¸Šä¸åŒçš„å®‰è£…è¿‡ç¨‹ä¸­è·å–çš„ `UUID` ç›¸åŒã€‚ä½†æ˜¯ï¼Œå¦‚æœåº”ç”¨è¢«å½»åº•åˆ é™¤åæˆ–è€…è®¾å¤‡è¢«é‡ç½®åï¼Œä¹‹å‰çš„ `UUID` å°†æ— æ³•å†è¢«è·å–åˆ°ã€‚

- `IDFA`ï¼ˆIdentifier for Advertisersï¼‰ï¼šåœ¨ `iOS 6` åŠä»¥åçš„ç‰ˆæœ¬ä¸­ï¼Œ`Apple` å¼•å…¥äº†å¹¿å‘Šæ ‡è¯†ç¬¦ `IDFA`ï¼Œä¸»è¦ç”¨äºå¹¿å‘Šå•†è·Ÿè¸ªå’Œæ ‡è¯†ç”¨æˆ·ã€‚ç”¨æˆ·å¯ä»¥åœ¨è®¾ç½®ä¸­é‡ç½®è‡ªå·±çš„ `IDFA`ï¼Œæˆ–è€…å®Œå…¨å…³é—­è¿™ä¸ªåŠŸèƒ½ã€‚

- `IDFV`ï¼ˆIdentifier for Vendorï¼‰ï¼šåœ¨ `iOS 6` åŠä»¥åçš„ç‰ˆæœ¬ä¸­ï¼Œ`Apple` ä¹Ÿå¼•å…¥äº† `IDFV`ï¼Œè¿™æ˜¯ä¸€ä¸ªé’ˆå¯¹åŒä¸€å¼€å‘è€…ï¼ˆ`Vendor`ï¼‰ä¸‹çš„æ‰€æœ‰åº”ç”¨éƒ½ç›¸åŒçš„æ ‡è¯†ç¬¦ã€‚åªæœ‰å½“ç”¨æˆ·å°†è¯¥å‚å•†çš„æ‰€æœ‰åº”ç”¨å…¨éƒ¨åˆ é™¤åï¼Œè¿™ä¸ªæ ‡è¯†ç¬¦æ‰ä¼šè¢«é‡ç½®ã€‚

ä¸ºäº†ä¿æŠ¤ç”¨æˆ·éšç§ï¼Œ`Apple` ä¸æ–­çš„æ”¹å˜æ ‡è¯†è®¾å¤‡çš„æ–¹å¼ï¼Œå¼€å‘è€…å¿…é¡»é€‚åº”è¿™äº›å˜åŒ–å¹¶å°Šé‡ç”¨æˆ·çš„éšç§ã€‚

:::

### â“æ²™ç›’ç›®å½•çš„æ¯ä¸ªæ–‡ä»¶å¤¹åˆ’åˆ†çš„ä½œç”¨

::: details ğŸ’¡

 > æ²™ç›’(Sandbox)ï¼Œæ¯ä¸ªåº”ç”¨éƒ½æœ‰ä¸€ä¸ªè‡ªå·±çš„æ²™ç›’ç›®å½•ï¼Œå…¶ä»–åº”ç”¨åº”ç”¨æˆ–è€…å¤–éƒ¨ç¯å¢ƒæ— æ³•è®¿é—®è¯¥åº”ç”¨çš„æ²™ç›’ã€‚è¿™æ˜¯ `iOS` ä¿è¯ç”¨æˆ·æ•°æ®éšç§å’Œå®‰å…¨çš„æœºåˆ¶ä¹‹ä¸€ã€‚åœ¨åº”ç”¨çš„æ²™ç›’å†…ï¼Œåˆåˆ’åˆ†äº†ä¸€äº›ç›®å½•æ–‡ä»¶å¤¹ï¼Œä¸åŒçš„ç›®å½•æœ‰ç€ä¸åŒçš„ä½œç”¨ï¼š

- `Documents`ï¼šç”¨æ¥å­˜å‚¨ç”¨æˆ·åˆ›å»ºæˆ–åº”ç”¨ç¨‹åºè¿è¡Œéœ€è¦æŒä¹…åŒ–çš„æ•°æ®ã€‚`iTunes` åŒæ­¥è®¾å¤‡æ—¶ä¼šå¤‡ä»½è¯¥ç›®å½•å†…å®¹ã€‚

- `tmp`ï¼šç”¨äºå­˜æ”¾ä¸´æ—¶æ–‡ä»¶ï¼Œå½“åº”ç”¨é€€å‡ºåï¼Œè¿™ä¸ªç›®å½•ä¸‹çš„æ–‡ä»¶ä¼šè¢«åˆ é™¤ã€‚æ‰€ä»¥æœ‰äº›ä¸´æ—¶äº§ç”Ÿçš„æ–‡ä»¶ï¼Œå¦‚ç¼“å­˜çš„å›¾ç‰‡æˆ–è€…ä¸‹è½½çš„ä¸´æ—¶çš„æ–‡ä»¶å¯ä»¥æ”¾åœ¨è¿™é‡Œã€‚

- `Library`ï¼šLibraryç›®å½•ä¸‹æœ‰ä¸¤ä¸ªå­ç›®å½•ï¼Œ`Caches` å’Œ `Preferences`ã€‚å…¶ä¸­ `Caches` ç›®å½•ä¸»è¦å­˜æ”¾ç¼“å­˜æ–‡ä»¶ï¼Œ`Preferences` ç›®å½•ä¸»è¦å­˜æ”¾åº”ç”¨çš„é…ç½®ä¿¡æ¯ï¼Œè¿™äº›æ•°æ®åœ¨è®¾å¤‡çš„è®¾ç½®åº”ç”¨ä¸­è®¾ç½®ã€‚æ­¤å¤–ï¼Œ`Library` è¿˜å¯ä»¥å­˜æ”¾åº”ç”¨çš„å…¶ä»–ä¸€äº›æŒä¹…æ€§çš„æ–‡ä»¶ã€‚

- `Library/Caches`ï¼šä¿å­˜åº”ç”¨ç¨‹åºä½¿ç”¨æ—¶äº§ç”Ÿçš„éœ€è¦æŒä¹…åŒ–çš„æ•°æ®ï¼Œ`iTunes` ä¸ä¼šå¤‡ä»½è¯¥ç›®å½•ï¼Œæ­¤ç›®å½•ä¸‹æ–‡ä»¶ä¸ä¼šåœ¨åº”ç”¨é€€å‡ºååˆ é™¤ã€‚

:::

### â“`iOS` é€†å‘åˆ†æ

::: details ğŸ’¡

> `iOS` é€†å‘åˆ†æï¼Œé€šå¸¸æŒ‡ç ´è§£è€…é€šè¿‡åˆ†æå’Œä¿®æ”¹è®¾å¤‡ä¸­çš„ `iOS` åº”ç”¨ç¨‹åºæ¥äº†è§£å…¶å·¥ä½œåŸç†çš„è¡Œä¸ºã€‚é€†å‘åˆ†æçš„åº”ç”¨åœºæ™¯å¹¿æ³›ï¼ŒåŒ…æ‹¬ä½†ä¸é™äºï¼š`Bug` å®šä½ã€æ€§èƒ½ä¼˜åŒ–ã€å®‰å…¨æµ‹è¯•ä»¥åŠå¯¹ç«å“çš„è°ƒç ”ç­‰ã€‚

`iOS` é€†å‘åˆ†æçš„æ–¹æ³•ï¼š

- é™æ€åˆ†æï¼šé™æ€åˆ†ææ˜¯åˆ†æå­—èŠ‚ç æˆ–é€†å‘ç¼–è¯‘åçš„ä»£ç æ¥äº†è§£å…¶åŠŸèƒ½å’Œè¡Œä¸ºçš„è¿‡ç¨‹ï¼Œæœªè¿è¡Œç¨‹åºä»£ç ã€‚å¸¸ç”¨çš„é™æ€åˆ†æå·¥å…·æœ‰ `Hopper Disassembler`ã€`IDA Pro` ç­‰ã€‚

- åŠ¨æ€åˆ†æï¼šåŠ¨æ€åˆ†ææ˜¯åœ¨ç¨‹åºè¿è¡Œæ—¶è§‚å¯Ÿå…¶è¡Œä¸ºï¼Œå¸¸ç”¨åˆ°çš„å·¥å…·æœ‰ `LLDB`ã€`Cycript`ã€`frida` ç­‰ã€‚é€šè¿‡åŠ¨æ€åˆ†æå¯ä»¥å®æ—¶æŸ¥çœ‹å’Œä¿®æ”¹ç¨‹åºçš„è¿è¡ŒçŠ¶æ€ã€‚

- `Class-Dump`ï¼šæ˜¯ä¸€ä¸ªç”¨æ¥è§£æåœ¨ `Mach-O` æ–‡ä»¶ä¸­ `Objc` çš„ç±»ä¿¡æ¯çš„å‘½ä»¤è¡Œå·¥å…·ã€‚é€†å‘åˆ†æçš„ç¬¬ä¸€æ­¥å¸¸å¸¸æ˜¯ä½¿ç”¨ `Class-Dump` è·å–è¢«åˆ†æå¯¹è±¡çš„å¤´æ–‡ä»¶ä¿¡æ¯ã€‚

- `Mach-O` æ–‡ä»¶æ¢ç´¢ï¼š`Mach-O` æ–‡ä»¶æ˜¯ `macOS` å’Œ `iOS` çš„å¯æ‰§è¡Œæ–‡ä»¶çš„æ ¼å¼ã€‚é€šè¿‡æ¢ç´¢ `Mach-O` æ–‡ä»¶ï¼Œå¯ä»¥è·å–åˆ°ç¨‹åºçš„ `Segmentsã€Sectionsã€Symbol` ç­‰ä¿¡æ¯ï¼Œåˆ†æç¨‹åºçš„å…¥å£ç‚¹ã€é“¾æ¥åº“ç­‰ã€‚

:::

### â“æ€ä¹ˆé˜²æ­¢åˆ«äººåç¼–è¯‘ä½ çš„ `iOS App`

::: details ğŸ’¡

- ä»£ç æ··æ·†ï¼šè¿™æ˜¯æœ€åŸºæœ¬çš„æ–¹æ³•ï¼Œé€šè¿‡æ”¹å˜å˜é‡åå’Œæ–¹æ³•åï¼Œæ·»åŠ æ— ç”¨ä»£ç ç­‰æ‰‹æ®µæ¥è®©åç¼–è¯‘å‡ºçš„ä»£ç éš¾ä»¥é˜…è¯»ã€‚

- å­—ç¬¦ä¸²åŠ å¯†ï¼šå¾ˆå¤šæ—¶å€™ï¼Œæ•æ„Ÿçš„ä¿¡æ¯æ˜¯ä»¥å­—ç¬¦ä¸²çš„å½¢å¼å­˜åœ¨äºç¨‹åºä¸­çš„ï¼Œé€šè¿‡å°†è¿™äº›å­—ç¬¦ä¸²åŠ å¯†ï¼Œå¯ä»¥æœ‰æ•ˆé˜²æ­¢è¿™äº›ä¿¡æ¯è¢«æ³„éœ²ã€‚

- ç¬¦å·å‰¥ç¦»ï¼šå°†ç¨‹åºä¸­çš„ç¬¦å·ä¿¡æ¯å‰¥ç¦»æ‰ï¼Œè¿™æ ·åœ¨åç¼–è¯‘çš„æ—¶å€™å°±çœ‹ä¸åˆ°åŸå§‹çš„ç¬¦å·ä¿¡æ¯ï¼Œé™ä½å¯è¯»æ€§ã€‚

- æŠŠå…³é”®ä»£ç éƒ¨åˆ†ç”¨æ±‡ç¼–æˆ–è€… `C` è¯­è¨€é‡å†™ï¼šé«˜çº§è¯­è¨€ç›¸æ¯”äºåº•å±‚è¯­è¨€æ›´æ˜“äºè¢«åç¼–è¯‘å’Œç†è§£ï¼ŒæŠŠå…³é”®éƒ¨åˆ†çš„ä»£ç ç”¨æ±‡ç¼–æˆ–è€… `C` è¯­è¨€å†™å¯ä»¥å¢åŠ ç ´è§£éš¾åº¦ã€‚

- ä½¿ç”¨é˜²æŠ¤å£³ï¼šå°±åƒç”µè„‘ç«¯çš„è½¯ä»¶å¯ä»¥ä½¿ç”¨åŠ å£³æŠ€æœ¯ä¸€æ ·ï¼Œç§»åŠ¨ç«¯çš„ç¨‹åºä¹Ÿå¯ä»¥é€šè¿‡é˜²æŠ¤å£³æ¥å¯¹æŠ—åç¼–è¯‘ã€‚

- è¿è¡Œæ—¶é˜²æŠ¤ï¼šå¯ä»¥åœ¨ç¨‹åºä¸­åŠ å…¥ä¸€äº›è¿è¡Œæ—¶æ£€æµ‹çš„ä»£ç ï¼Œæ¯”å¦‚æ£€æµ‹è®¾å¤‡æ˜¯å¦è¢«è¶Šç‹±ï¼Œæ£€æµ‹æ­£åœ¨è¿è¡Œçš„è¿›ç¨‹ç­‰ï¼Œä¸€æ—¦å‘ç°ç ´è§£è¡Œä¸ºï¼Œå°±ç«‹å³ç»ˆæ­¢è¿è¡Œã€‚

:::

### â“`lild` é‡ç­¾å

::: details ğŸ’¡

`Resigning` é‡ç­¾åï¼šå¯¹ç»™å®šçš„åº“æˆ–è€…æ’ä»¶è¿›è¡Œç­¾åæ‰èƒ½å°†å®ƒåŒ…å«åœ¨æˆ‘ä»¬çš„åº”ç”¨ä¸­ã€‚

`lild`ï¼ˆLink Identity Editorï¼‰æ˜¯ä¸€ä¸ªåœ¨ `macOS` ä¸Šå¯ä»¥ç”¨æ¥é‡ç­¾åå¯æ‰§è¡Œæ–‡ä»¶çš„å‘½ä»¤è¡Œå·¥å…·ã€‚

```shell
# æ¸…é™¤åŸæœ‰ç­¾å
codesign --remove-signature /path/to/my.framework
    
# æ·»åŠ æ–°çš„ç­¾å
#   -f: å¼ºåˆ¶é‡ç­¾åï¼Œå³ä½¿å·²ç»ç­¾è¿‡åäº†
#   -s: å¼€å‘è€…è¯ä¹¦ï¼Œå¯ä»¥åœ¨ Keychain Access åº”ç”¨ç¨‹åºä¸­æ‰¾åˆ°
codesign -f -s "iPhone Developer: Your Name (ID)" /path/to/my.framework
```

æ³¨æ„ï¼šè¿›è¡Œé‡ç­¾åæ“ä½œéœ€è¦æ­£ç¡®çš„å¼€å‘è€…è¯ä¹¦å’Œé…å¥—çš„ `Provisioning Profiles`ï¼Œå¦åˆ™é‡ç­¾ååçš„æ–‡ä»¶å°†æ— æ³•åœ¨è®¾å¤‡ä¸Šè¿è¡Œã€‚é‡ç­¾åæ˜¯å®‰å…¨æ•æ„Ÿæ“ä½œï¼Œå¿…é¡»ç¡®ä¿æºæ–‡ä»¶å’Œç­¾åè¯ä¹¦çš„å¯ä¿¡ä»»æ€§ã€‚éµå®ˆç›¸å…³æ³•å¾‹æ³•è§„å’Œåè®®å‡ºäºåˆæ³•åˆè§„çš„å‰ææ“ä½œã€‚

:::

### â“ç®€è¿°ä¸‹ `Match-O` æ–‡ä»¶ç»“æ„

::: details ğŸ’¡

> `Mach-O` ï¼ˆMach Objectï¼‰æ–‡ä»¶æ ¼å¼æ˜¯ç”¨äºå¯æ‰§è¡Œæ–‡ä»¶ã€å¯¹è±¡ä»£ç ã€å…±äº«åº“ã€åŠ¨æ€åŠ è½½ä»£ç ä»¥åŠå†…æ ¸ä»£ç ç­‰åœ¨ `macOS` å’Œ `iOS` ä¸­çš„æ ¼å¼ã€‚

- `Header`ï¼šæè¿°äº†æ•´ä¸ª `Mach-O` æ–‡ä»¶çš„ä¸€äº›åŸºæœ¬ä¿¡æ¯ã€‚
    > ä¾‹å¦‚æ–‡ä»¶ç±»å‹ï¼ˆå¦‚å¯æ‰§è¡Œæ–‡ä»¶ã€åŠ¨æ€åº“æˆ–å¯¹è±¡æ–‡ä»¶ç­‰ï¼‰ã€`CPU` ç±»å‹ã€åŠ è½½å‘½ä»¤çš„æ•°é‡å’Œå¤§å°ç­‰ã€‚

- `Load Commands`ï¼šè´Ÿè´£æè¿° `Mach-O` æ–‡ä»¶çš„å†…éƒ¨ç»“æ„å’Œå¸ƒå±€ã€‚
    > ä¾‹å¦‚ `Segmentã€Sectionã€Dynamic Symbol Tableã€Dylib IDã€Entry Point` ç­‰ä¿¡æ¯ã€‚

- `Segments and Sections`ï¼š`Segments` åŒ…å«ä¸€ç§æˆ–å¤šç§ç±»å‹çš„ `Sections`ã€‚æ¯ä¸ª `Segment` å¯¹åº”ç¨‹åºè¿è¡Œæ—¶çš„ä¸€ä¸ªå†…å­˜æ˜ å°„ï¼Œ`Sections` åˆ™å­˜å‚¨å…·ä½“çš„ä»£ç å’Œæ•°æ®ã€‚

- `Data`ï¼šåŒ…æ‹¬ç¬¦å·è¡¨ã€å­—ç¬¦ä¸²è¡¨ç­‰å„ç§å®é™…çš„æ•°æ®ã€‚
    > ä¾‹å¦‚ç¨‹åºçš„æ‰§è¡Œä»£ç ã€å¸¸é‡ã€å…¨å±€å˜é‡ç­‰ã€‚

:::