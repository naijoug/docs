---
title: Swift
icon: hashtag

index: true

---

<!-- more -->
  
## reference

- [](âœ…)[2020-04-15 ä¸€æ–‡é‰´å®šæ˜¯ Swift çš„ç‹è€…ï¼Œè¿˜æ˜¯é’é“œ](https://juejin.cn/post/6844904128188006413)
    > [](âœ…)[Answer - Swift è¿›é˜¶é»„é‡‘ä¹‹è·¯](https://juejin.cn/post/6844904152951193608)
- []()[2018-12-03 Swift ä¸­çš„é¢å‘åè®®ç¼–ç¨‹ï¼šæ˜¯å¦ä¼˜äºé¢å‘å¯¹è±¡ç¼–ç¨‹ï¼Ÿ](https://swift.gg/2018/12/03/pop-vs-oop/)
- []()[2018-11-01 æ·±å…¥å‰–æ Swift æ€§èƒ½ä¼˜åŒ–](https://mp.weixin.qq.com/s/U95QmOOjeXkk-yC23cuZCQ)
- []()[2018-10-08 Swift çš„ Witness Table](https://www.jianshu.com/p/c93d7a7d6771)
- []()[2017-01-10 æ·±å…¥ç†è§£ Swift æ´¾å‘æœºåˆ¶](https://juejin.cn/post/6844903459863412750?from=search-suggest#heading-5)
- []()[2016-02-27 Swift çƒ§è„‘ä½“æ“](https://blog.devtang.com/2016/02/27/swift-gym-1-nested-optional/)

------

## è®¾è®¡ç†å¿µ

### â“`Swift` ä¸ºä»€ä¹ˆæ˜¯â€œé¢å‘åè®®â€çš„è¯­è¨€

::: details ğŸ’¡

:::

### â“`Swift` ä¸­çš„ `POP` ä¸ `OOP` çš„åŒºåˆ«

::: details ğŸ’¡

> `OOP`ï¼ˆé¢å‘å¯¹è±¡ç¼–ç¨‹ï¼‰å’Œ `POP`ï¼ˆé¢å‘åè®®ç¼–ç¨‹ï¼‰æ˜¯ä¸¤ç§ä¸åŒçš„ç¼–ç¨‹èŒƒå¼ã€‚

ä¸»è¦åŒºåˆ«ï¼š

  - ç»§æ‰¿ï¼š
    * `OOP` ä¸­ï¼Œç±»ï¼ˆ`Class`ï¼‰æ˜¯ä¸€ç§ä¸»è¦çš„æ„é€ ï¼Œä¸€ä¸ªç±»å¯ä»¥ç»§æ‰¿å¦ä¸€ä¸ªç±»çš„å±æ€§å’Œæ–¹æ³•ã€‚ç„¶è€Œï¼Œç»§æ‰¿å¯èƒ½å¼•å¯¼è¿›å…¥â€œç»§æ‰¿åœ°ç‹±â€ï¼Œå³è¿‡åº¦ä½¿ç”¨ç»§æ‰¿è€Œå¯¼è‡´çš„è®¾è®¡å¤æ‚æ€§å’Œä»£ç å†—ä½™ã€‚
    * `POP` ä¸­ï¼Œé€šè¿‡åè®®ï¼ˆ`Protocol`ï¼‰å®šä¹‰ä¸€ç»„è¡Œä¸ºï¼Œç±»å‹å¯ä»¥éµå®ˆåè®®å¹¶å®ç°åè®®æ‰€è§„å®šçš„è¡Œä¸ºã€‚åè®®å¯ä»¥è¢«ä»»ä½•ç±»å‹ï¼ˆå¦‚ç±»ã€ç»“æ„ä½“ã€æšä¸¾ç­‰ï¼‰éµå®ˆï¼Œå¯ä»¥ä½¿ç”¨åè®®æ¥ä»£æ›¿ç±»çš„ç»§æ‰¿ã€‚

  - å¤šæ€ï¼š
    * `OOP` ä¸­ï¼Œå¤šæ€æ˜¯é€šè¿‡ç»§æ‰¿å’Œæ–¹æ³•é‡å†™å®ç°çš„ã€‚
    * `POP` ä¸­ï¼Œå¤šæ€æ˜¯é€šè¿‡åè®®å’Œæ‰©å±•å®ç°çš„ã€‚ä»»ä½•ç±»å‹åªè¦éµå®ˆåŒä¸€ä¸ªåè®®ï¼Œå°±å¯ä»¥è¢«è§†ä¸ºåŒä¸€ç§ç±»å‹ã€‚é€šè¿‡åè®®æ‰©å±•ï¼Œå¯ä»¥æä¾›é»˜è®¤å®ç°æˆ–è€…æ·»åŠ æ–°çš„åŠŸèƒ½ã€‚

  - ç»„åˆï¼š
    * `OOP` ä¸­ï¼Œä¸ºäº†ä»£ç å¤ç”¨ï¼Œå¯èƒ½éœ€è¦è®¾è®¡å¤æ‚çš„ç±»å±‚æ¬¡ç»“æ„ï¼Œè€Œä¸” `Swift` ç±»ä¸æ”¯æŒå¤šç»§æ‰¿ï¼Œæ‰€ä»¥å½“åŠŸèƒ½è·¨å¤šä¸ªç±»æ—¶å¯èƒ½ä¼šå˜å¾—å¾ˆéº»çƒ¦ã€‚
    * `POP` ä¸­ï¼Œç±»å‹å¯ä»¥éµå®ˆå¤šä¸ªåè®®ï¼Œæ¯ä¸ªåè®®å¯ä»¥ä»£è¡¨ä¸€ç§åŠŸèƒ½æˆ–è€…ç‰¹æ€§ï¼Œè¿™ä½¿å¾—ç±»å‹çš„ç»„åˆæ›´ä¸ºçµæ´»ã€‚

æ³¨ï¼šåœ¨ `Swift` ä¸­ `POP` è¢«å¹¿æ³›ä½¿ç”¨ã€‚æ¯”å¦‚ `Swift` æ ‡å‡†åº“çš„è®¸å¤šåŠŸèƒ½ï¼Œå¦‚é›†åˆç±»å‹(`Array`, `Dictionary` ç­‰)ã€æ•°å€¼ç±»å‹ï¼ˆ`Int`, `Double` ç­‰ï¼‰ã€`Comparable`ã€`Equatable` ç­‰éƒ½æ˜¯é€šè¿‡ `POP` è®¾è®¡çš„ã€‚

:::

### â“`Swift` å¯¹æ¯” `OC` çš„ä¼˜ç‚¹åœ¨å“ªé‡Œ

::: details ğŸ’¡

  - ç®€åŒ–çš„è¯­æ³•å’Œè¯­ä¹‰ï¼š`Swift` çš„è¯­æ³•æ›´æ¥è¿‘ç°ä»£ç¼–ç¨‹è¯­è¨€ã€‚
    > æ¯”å¦‚ä½¿ç”¨ `let`å£°æ˜å¸¸é‡ï¼Œ`var` å£°æ˜å˜é‡ï¼Œå¯ä»¥çœå» `;` åˆ†å·ï¼ŒåŒæ—¶å®ƒå¼•å…¥äº†å…ƒç»„å’Œå¯é€‰å‹æ¦‚å¿µï¼Œä½¿ä»£ç æ›´æ˜“è¯»æ˜“å†™ã€‚
   
  - å®‰å…¨æ€§ï¼š`Swift` æœ‰å¾ˆå¤šç”¨äºå¢åŠ ä»£ç çš„ç¨³å®šæ€§å’Œå¯è¯»æ€§çš„ç‰¹æ€§ã€‚
    > ä¾‹å¦‚ï¼Œå®ƒçš„å¯é€‰å‹ç³»ç»Ÿå¯ä»¥æ¸…æ¥šåœ°å¤„ç† `nil` å€¼æˆ–è€…ç¼ºå¤±å€¼ã€‚

  - æ˜“äºç»´æŠ¤ï¼šç”±äºæ­¤è¯­è¨€æ·˜æ±°äº† `C` è¯­è¨€çš„é—é£ï¼Œ`Swift` ä»£ç æ›´æ˜“äºç†è§£å’Œç»´æŠ¤ã€‚å¦å¤–ï¼Œ`Swift` è¿˜å–æ¶ˆäº†å¤´æ–‡ä»¶çš„æ¦‚å¿µï¼Œä»£ç æ›´åŠ ç´§å‡‘ã€‚

  - æé«˜æ€§èƒ½ï¼š`Swift` åœ¨æŸäº›æ€§èƒ½ä¸Šï¼Œæ¯”å¦‚ `GEMM` ç®—æ³•ï¼Œå¿«é€Ÿå‚…é‡Œå¶å˜æ¢ç­‰ï¼Œå·²ç»å¯ä»¥è¾¾åˆ° `C++` çš„æ°´å¹³ï¼Œè¿™ç‚¹åœ¨ `Objective-C` ä¸Šæ˜¯éš¾ä»¥æƒ³è±¡çš„ã€‚

  - å†…å­˜ç®¡ç†ï¼š`Swift` ä½¿ç”¨ `ARC`ï¼Œè‡ªåŠ¨ç®¡ç†åº”ç”¨ç¨‹åºçš„å†…å­˜ï¼Œç›¸å¯¹äº `OC` æ›´åŠ ä¾¿æ·ã€‚

  - å…·æœ‰å‡½æ•°å¼ç¼–ç¨‹çš„ç‰¹æ€§ï¼š`Swift` ä¸ä»…å¯ä»¥åƒ `Objective-C` é‚£æ ·è¿›è¡Œé¢å‘å¯¹è±¡å¼ç¼–ç¨‹ï¼Œè€Œä¸”å®ƒè¿˜æ··å…¥äº†å‡½æ•°å¼ç¼–ç¨‹çš„ä¸€äº›æ¦‚å¿µï¼Œä¾‹å¦‚ `map` å’Œ `filter` è¿™æ ·çš„å‡½æ•°ã€‚

  - äº¤äº’æ€§å’Œå¯ç©æ€§ï¼š`Playgrounds` æ˜¯ `Swift` çš„ä¸€é¡¹é‡è¦ç‰¹æ€§ï¼Œå®ƒä½¿å¾—å­¦ä¹  `Swift` æ›´åŠ æœ‰è¶£ã€‚

  - æœªæ¥å‘å±•ï¼š`Swift` æ˜¯ `Apple` å®˜æ–¹æ¨å‡ºå’Œä¸»å¯¼çš„ç¼–ç¨‹è¯­è¨€ï¼Œæœªæ¥å°†ä¼šè·å¾—æ›´å¥½çš„æ”¯æŒå’Œå‘å±•ã€‚

æ€»ç»“ï¼š`Swift` ç›¸æ¯”äº `Objective-C` åœ¨è¯­æ³•çš„ç®€æ´æ€§ã€ä»£ç çš„å¯è¯»æ€§ã€å®‰å…¨æ€§ã€æ€§èƒ½åŠæœªæ¥çš„å‘å±•ç­‰å¤šæ–¹é¢å…·æœ‰æ›´å¤§çš„ä¼˜åŠ¿ã€‚

:::

------
  
## ç»“æ„ä½“ä¸ç±»

### â“`Swift` ç»“æ„ä½“ä¸ç±»çš„åŒºåˆ«

::: details ğŸ’¡

  - å€¼ç±»å‹å’Œå¼•ç”¨ç±»å‹ï¼šç»“æ„ä½“æ˜¯å€¼ç±»å‹ï¼›ç±»æ˜¯å¼•ç”¨ç±»å‹ã€‚
    
    ä¸€ä¸ªç»“æ„ä½“å®ä¾‹è¢«èµ‹å€¼ç»™ä¸€ä¸ªæ–°çš„å˜é‡æˆ–è€…ä½œä¸ºä¸€ä¸ªå‡½æ•°çš„å‚æ•°ä¼ é€’æ—¶ï¼Œè¿™ä¸ªå®ä¾‹çš„æ‹·è´ä¼šè¢«åˆ›å»ºå‡ºæ¥ï¼Œæ‰€ä»¥æ”¹å˜æ–°å˜é‡ä¸­çš„å€¼ä¸ä¼šå½±å“åŸæ¥çš„å®ä¾‹ã€‚
    ä¸€ä¸ªç±»å®ä¾‹èµ‹å€¼å®é™…ä¸Šæ˜¯ä¼ é€’äº†ä¸€ä¸ªå¼•ç”¨ï¼Œæ‰€ä»¥ä¿®æ”¹èµ‹å€¼åçš„å®ä¾‹ä¹Ÿä¼šå½±å“åˆ°åŸæ¥çš„å®ä¾‹ã€‚
    
  - ç»§æ‰¿ï¼šç»“æ„ä½“ä¸èƒ½ç»§æ‰¿å…¶ä»–çš„ç»“æ„ä½“æˆ–è€…ç±»ï¼›ç±»å¯ä»¥ç»§æ‰¿å…¶ä»–çš„ç±»ã€‚
  
  - ç±»å‹è½¬åŒ–ï¼šç»“æ„ä½“ä¸èƒ½ï¼›ç±»å¯ä»¥è¢«å¼ºåˆ¶ç±»å‹è½¬æ¢ï¼Œå¯ä»¥ä½¿ç”¨ `is` å’Œ `as` æ“ä½œç¬¦åœ¨è¿è¡Œæ—¶æ£€æŸ¥å®ä¾‹çš„ç±»å‹ã€‚
  
  - ææ„å‡½æ•°ï¼šç»“æ„ä½“æ²¡æœ‰ï¼›ç±»æœ‰ææ„å‡½æ•°ï¼Œç”¨æ¥åœ¨ç±»å®ä¾‹è¢«é”€æ¯å‰æ‰§è¡Œç‰¹å®šçš„æ“ä½œã€‚
  
  - å¼•ç”¨è®¡æ•°ï¼šç»“æ„ä½“æ²¡æœ‰ï¼›ç±»é€šè¿‡å¼•ç”¨è®¡æ•°è¿›è¡Œå†…å­˜ç®¡ç†ã€‚ 
  
  - åè®®ï¼šç±»å’Œç»“æ„ä½“éƒ½å¯ä»¥å®ç°åè®®ï¼Œä½†æ˜¯ç±»å¯ä»¥åˆ©ç”¨æŸäº›ç‰¹å®šçš„åè®®æä¾›çš„è¿è¡Œæ—¶ç‰¹æ€§ã€‚
  
:::

### ç»“æ„ä½“

#### â“`Swift` ä¸­ `Array`ã€`Dictionary`ã€`Set` ä¸ºä»€ä¹ˆè®¾è®¡æˆå€¼ç±»å‹

::: details ğŸ’¡

  - è¯­ä¹‰æ¸…æ™°
    > å¯ä»¥ä½¿èµ‹å€¼çš„è¯­ä¹‰æ›´åŠ æ¸…æ™°ã€‚å½“ä½ æŠŠä¸€ä¸ªæ•°ç»„ï¼ˆæˆ–å­—å…¸ã€é›†åˆï¼‰èµ‹å€¼ç»™æ–°çš„å˜é‡æ—¶ï¼Œ`Swift` å®é™…ä¸Šä¼šå¤åˆ¶ä¸€ä»½è¿™ä¸ªæ•°ç»„ï¼Œè¿™æ„å‘³ç€æ–°å˜é‡å’Œæ—§å˜é‡ä¹‹é—´ä¸å­˜åœ¨ä»»ä½•å…³è”ï¼Œå¯¹å…¶ä¸­ä¸€ä¸ªçš„æ”¹åŠ¨ä¸ä¼šå½±å“åˆ°å¦ä¸€ä¸ªã€‚
  
  - çº¿ç¨‹å®‰å…¨
    > åœ¨æ¶‰åŠå¤šçº¿ç¨‹æ“ä½œçš„ç¯å¢ƒä¸­ï¼Œæ— éœ€æ‹…å¿ƒå¯¹æ•°ç»„ï¼ˆæˆ–å­—å…¸ã€é›†åˆï¼‰çš„ä¿®æ”¹ä¼šæ½œåœ¨åœ°å½±å“åˆ°å…¶ä»–çº¿ç¨‹ã€‚æœ‰åˆ©äºå‡å°‘ç”±ç«æ€æ¡ä»¶ï¼ˆrace conditionï¼‰å¯¼è‡´çš„é—®é¢˜ï¼Œå¹¶ä½¿å¾—ä»£ç æ›´åŠ å®‰å…¨ã€‚
  
  - æ€§èƒ½ä¼˜åŒ–
    > è™½ç„¶å€¼ç±»å‹åœ¨èµ‹å€¼æ—¶éœ€è¦å¤åˆ¶å…¶æ•°æ®ï¼Œä½† `Swift` é‡‡ç”¨äº†ä¸€ç§è¢«ç§°ä¸ºâ€œå†™æ—¶å¤åˆ¶â€ï¼ˆcopy-on-writeï¼‰çš„ä¼˜åŒ–ç­–ç•¥ã€‚åªæœ‰å½“æ•°æ®çœŸæ­£éœ€è¦è¢«æ”¹åŠ¨æ—¶ï¼Œ`Swift` æ‰ä¼šå¤åˆ¶ä¸€ä»½æ•°æ®ï¼Œé¿å…äº†ä¸å¿…è¦çš„å¤åˆ¶æ“ä½œã€‚

:::

#### â“`cow` è®¾è®¡è¯´ä¸€ä¸‹

::: details ğŸ’¡

  `cow` (Copy on Write) : `Swift` çš„å†™æ—¶æ‹·è´ï¼Œä¹Ÿå°±æ˜¯è¯´æ•°æ®åªæœ‰ç­‰åˆ°èµ‹å€¼ä¿®æ”¹æ—¶æ‰è¿›è¡Œæ‹·è´ï¼Œä¸»è¦åº”ç”¨åœ¨ç³»ç»Ÿè®¾è®¡çš„å€¼ç±»å‹(`String`ã€`Array`ã€`Dictionary`)

:::
  
#### â“`isKnownUniquelyReferenced` å®ç°è‡ªå®šä¹‰ç»“æ„ä½“ `cow`
  
::: details ğŸ’¡
  
  `isKnownUniquelyReferenced` å‡½æ•°å¯ä»¥ç”¨æ¥æ£€æµ‹æ˜¯è¢«è¢«å¤šä¸ªå˜é‡å¼•ç”¨
  
  ```swift
  // æ•°æ®åŒ…è£…ç±»
  final class Wrapper<A> {
    var wrapper: A
    init(_ value: A) { 
        self.wrapper = value 
    }
  }
  struct MyArray {
    private var storage: Wrapper<[Int]>
    init() {
        storage = Box([1, 2, 3])
    }
    /// æ·»åŠ æ•°æ®
    mutating func append(_ item: Int) {
        // åˆ¤æ–­æ˜¯å¦ä¸ºå”¯ä¸€çš„å¼•ç”¨ï¼Œå¦‚æœä¸æ˜¯ï¼Œå…ˆåˆ›å»ºå‰¯æœ¬å¯¹è±¡ï¼Œåœ¨è¿›è¡Œæ·»åŠ ä¿®æ”¹
        if !isKnownUniquelyReferenced(&storage) {
            storage = Wrapper(storage.wrapper)
        }
        storage.wapper.append(item)
    }
  }
  ```
  
:::

### ç±»

#### â“`Swift` ä¸­çš„åˆå§‹åŒ–æ–¹æ³•

::: details ğŸ’¡

> åˆå§‹åŒ–æ–¹æ³•æ˜¯ç”¨æ¥ç¡®ä¿ç±»å‹å®ä¾‹ä¸­çš„æ‰€æœ‰å­˜å‚¨å±æ€§éƒ½è¢«èµ‹äºˆåˆå§‹å€¼çš„ç‰¹æ®Šæ–¹æ³•ã€‚

`Swift` çš„åˆå§‹åŒ–è¿‡ç¨‹ä¸­æœ‰ä¸¤ä¸ªé˜¶æ®µï¼š

  - ç¬¬ä¸€é˜¶æ®µæ˜¯ä¸ºæ¯ä¸ªå­˜å‚¨å‹å±æ€§è®¾ç½®åˆå§‹å€¼ã€‚å½“æ¯ä¸ªå­˜å‚¨å‹å±æ€§çš„åˆå§‹å€¼è¢«ç¡®å®šå
  - ç¬¬äºŒé˜¶æ®µå¼€å§‹ï¼Œå®ƒå…è®¸äººä»¬å¯ä»¥è‡ªå®šä¹‰ä»–ä»¬çš„å­˜å‚¨å‹å±æ€§ã€‚

`Swift` çš„æ„é€ å™¨åˆ†ä¸ºä¸¤ç§ï¼šæŒ‡å®šæ„é€ å™¨å’Œä¾¿åˆ©æ„é€ å™¨ã€‚

  - æŒ‡å®šæ„é€ å™¨ï¼šç±»ä¸­æœ€ä¸»è¦çš„æ„é€ å™¨ï¼Œä¸€ä¸ªç±»å¿…é¡»æ‹¥æœ‰è‡³å°‘ä¸€ä¸ªæŒ‡å®šæ„é€ å™¨ã€‚
  - ä¾¿åˆ©æ„é€ å™¨ï¼šç±»ä¸­æ¯”è¾ƒæ¬¡è¦çš„ï¼Œè¾…åŠ©å‹çš„æ„é€ å™¨ã€‚å®ƒé€šå¸¸åœ¨ä¸ºæŸä¸ªç‰¹å®šä½¿ç”¨åœºæ™¯æˆ–è€…ç‰¹å®šè¾“å…¥å€¼æä¾›æ„é€ æ–¹ä¾¿ã€‚

```swift
class MyClass {
    var name: String

    // æŒ‡å®šæ„é€ å™¨
    init(name: String) {
        self.name = name
    }
    
    // ä¾¿åˆ©æ„é€ å™¨
    convenience init() {
        self.init(name: "[Unnamed]")
    }
}
```

:::

#### â“`static` å’Œ `class` çš„åŒºåˆ«

::: details ğŸ’¡

  `static` å’Œ `class` éƒ½å¯ä»¥ç”¨æ¥å£°æ˜ç±»å‹çº§åˆ«çš„æ–¹æ³•æˆ–å±æ€§ã€‚

  - `static` å¯ä»¥ç”¨äºç±»ã€ç»“æ„ä½“å’Œæšä¸¾ï¼Œå£°æ˜é™æ€æ–¹æ³•å’Œé™æ€å±æ€§ã€‚å¯¹äºé™æ€æ–¹æ³•å’Œå±æ€§ï¼Œæ— è®ºæ˜¯åœ¨ç±»è¿˜æ˜¯åœ¨ç±»çš„å®ä¾‹ä¸­ï¼Œéƒ½æ˜¯å…±äº«åŒä¸€ä¸ªå­˜å‚¨ç©ºé—´ã€‚å¯¹äºä½¿ç”¨ `static` å£°æ˜çš„è®¡ç®—å±æ€§æˆ–æ–¹æ³•ï¼Œæ— æ³•åœ¨å­ç±»ä¸­è¿›è¡Œé‡å†™ã€‚è¿™æ˜¯å› ä¸º `static` å£°æ˜çš„å±æ€§å’Œæ–¹æ³•è¢«ç»‘å®šåˆ°äº†å®ƒä»¬è¢«å£°æ˜çš„ç±»å‹ä¸Šã€‚

    ```swift
    class MyClass {
        static var myStaticProperty: Int {
            return 1
        }
    }
    ```

  - `class` å…³é”®å­—åªèƒ½ç”¨äºç±»ï¼Œç”¨äºå£°æ˜ç±»æ–¹æ³•å’Œç±»å±æ€§ã€‚ä½¿ç”¨ `class` å…³é”®å­—æ ‡è®°çš„è®¡ç®—å±æ€§æˆ–è€…æ–¹æ³•å¯ä»¥åœ¨å­ç±»ä¸­è¿›è¡Œé‡å†™ã€‚

    ```swift
    class MySuperClass {
        class var myClassProperty: Int {
            return 1
        }
    }
    
    class MySubClass: MySuperClass {
        override class var myClassProperty: Int {
            return 2
        }
    }
    ```

:::

#### â“`Swift` ä¸­çš„ `final` ä½œç”¨

::: details ğŸ’¡

> `final` å…³é”®å­—ç”¨äºé˜²æ­¢ä¸€ä¸ªç±»è¢«ç»§æ‰¿ï¼Œæˆ–è€…é˜²æ­¢ä¸€ä¸ªæ–¹æ³•ã€å±æ€§æˆ–ä¸‹æ ‡æ–¹æ³•è¢«ä¸€ä¸ªå­ç±»é‡å†™ã€‚

```swift
// 1> é˜²æ­¢ç±»è¢«ç»§æ‰¿
// å¦‚æœä¸€ä¸ªç±»ä¸º finalï¼Œé‚£ä¹ˆè¯¥ç±»ä¸­æ‰€æœ‰çš„æ–¹æ³•ã€å±æ€§ä»¥åŠä¸‹æ ‡æ–¹æ³•éƒ½å°†è¢«è‡ªåŠ¨æ ‡è®°ä¸º finalã€‚
final class SomeClass {
    // class definition here
}

class SomeClass {
    // 2> é˜²æ­¢æ–¹æ³•è¢«å­ç±»é‡å†™
    final func someMethod() {
        // method body here
    }
}
```

  `final` çš„ä¸»è¦ç›®çš„ï¼šä¸€æ˜¯æé«˜æ€§èƒ½ï¼ˆç¼–è¯‘å™¨å¯ä»¥ä¼˜åŒ– `final` æ–¹æ³•æˆ–ç±»çš„è°ƒç”¨ï¼‰ï¼ŒäºŒæ˜¯è¡¨è¾¾è®¾è®¡æ„å›¾ï¼ˆä¸å¸Œæœ›ã€ä¹Ÿä¸éœ€è¦å­ç±»å»é‡å†™æˆ–è€…ç»§æ‰¿ï¼‰ã€‚

:::

### å±æ€§

#### â“å­˜å‚¨å±æ€§ä¸è®¡ç®—å±æ€§åŒºåˆ«

::: details ğŸ’¡

  - **å­˜å‚¨å±æ€§**ï¼šé¡¾åæ€ä¹‰ï¼Œå­˜å‚¨å±æ€§æ˜¯æŸä¸ªç‰¹å®šç±»æˆ–ç»“æ„ä½“å®ä¾‹æ‰€å­˜å‚¨çš„ä¸€ä¸ªå€¼ï¼Œå¦‚ `Intã€Stringã€Double` ç±»å‹çš„å¸¸é‡æˆ–å˜é‡ã€‚è¿™ä¸ªå€¼å¯èƒ½æ˜¯å®šä¹‰æ—¶ç›´æ¥èµ‹å€¼çš„ï¼Œä¹Ÿå¯èƒ½æ˜¯åœ¨åˆå§‹åŒ–æ—¶èµ‹å€¼ã€‚

    ```swift
    // Point ç»“æ„ä½“æœ‰ä¸¤ä¸ªå­˜å‚¨å±æ€§ x å’Œ yã€‚
    struct Point {
        var x = 0.0
        var y = 0.0
    }
    var point = Point(x: 5.0, y: 5.0)
    ```

  - **è®¡ç®—å±æ€§**ï¼šè®¡ç®—å±æ€§å¹¶ä¸ç›´æ¥å­˜å‚¨å€¼ï¼Œè€Œæ˜¯æä¾›ä¸€ä¸ª `getter` å’Œä¸€ä¸ªå¯é€‰çš„ `setter` æ¥é—´æ¥è·å–å’Œè®¾ç½®å…¶ä»–å±æ€§æˆ–è€…å˜é‡çš„å€¼ã€‚

    ```swift
    struct Rectangle {
        var width = 0.0
        var height = 0.0
    
        // Rectangle ç»“æ„ä½“æœ‰ä¸€ä¸ªè®¡ç®—å±æ€§ area
        var area: Double {
            get { // é€šè¿‡ width å’Œ height è®¡ç®—å¾—æ¥
                return width * height
            }
            set { // å¯ä»¥é€šè¿‡è®¾ç½® area çš„å€¼é—´æ¥ä¿®æ”¹ width å’Œ height çš„å€¼
                width = sqrt(newValue)
                height = sqrt(newValue)
            }
        }
    }
    ```

  > æ€»ç»“ï¼šå­˜å‚¨å±æ€§æ˜¯å­˜å‚¨åœ¨ç‰¹å®šç±»æˆ–ç»“æ„ä½“å®ä¾‹ä¸­çš„ä¸€ä¸ªå¸¸é‡æˆ–å˜é‡ï¼›è®¡ç®—å±æ€§åˆ™æ˜¯é€šè¿‡è®¡ç®—å¾—åˆ°çš„ä¸€ä¸ªå€¼ã€‚

:::

#### â“`Swift` ä¸­çš„å±æ€§ä¿®é¥°ç¬¦

::: details ğŸ’¡

  - è®¿é—®æƒé™ä¿®é¥°ç¬¦ï¼š

    * `private`ï¼šç§æœ‰å±æ€§ï¼Œåªèƒ½åœ¨å±æ€§æ‰€åœ¨çš„ç±»æˆ–ç»“æ„ä½“ä¸­è®¿é—®ã€‚
    * `fileprivate`ï¼šæ–‡ä»¶ç§æœ‰å±æ€§ï¼Œåªèƒ½åœ¨è¯¥å±æ€§æ‰€åœ¨çš„æ–‡ä»¶èŒƒå›´å†…è®¿é—®ã€‚
    * `internal`ï¼šå†…éƒ¨å±æ€§ï¼Œå¯ä»¥åœ¨æ•´ä¸ªæ¨¡å—ï¼ˆä¾‹å¦‚ä¸€ä¸ª `App` æˆ–è€…ä¸€ä¸ª `Framework`ï¼‰å†…è®¿é—®ï¼Œè¿™æ˜¯é»˜è®¤çš„è®¿é—®çº§åˆ«ã€‚
    * `public`ï¼šå…¬å¼€å±æ€§ï¼Œå¯ä»¥è¢«ä»»ä½•äººè®¿é—®ï¼Œä½†åœ¨åˆ«çš„æ¨¡å—ä¸­ä¸èƒ½è¢« `override` å’Œç»§æ‰¿ã€‚
    * `open`ï¼šå¼€æ”¾å±æ€§ï¼Œå¯ä»¥è¢«ä»»ä½•äººä½¿ç”¨ï¼Œä¹Ÿå¯ä»¥åœ¨åˆ«çš„æ¨¡å—ä¸­è¢« `override` å’Œç»§æ‰¿ã€‚
 
  - å†…å­˜ç®¡ç†ä¿®é¥°ç¬¦
  
    * `weak`ï¼šç”¨äºè§£å†³å¾ªç¯å¼•ç”¨çš„é—®é¢˜ï¼Œè¢«ä¿®é¥°çš„å±æ€§åœ¨å¼•ç”¨çš„å¯¹è±¡è¢«é”€æ¯åå°†è‡ªåŠ¨è¢«è®¾ä¸º `nil`ã€‚
    * `unowned`ï¼šå’Œ `weak` ç±»ä¼¼ï¼Œä¹Ÿç”¨äºè§£å†³å¾ªç¯å¼•ç”¨çš„é—®é¢˜ï¼Œä½†è¢«ä¿®é¥°çš„å±æ€§åœ¨å¼•ç”¨çš„å¯¹è±¡è¢«é”€æ¯åä¸ä¼šè¢«è®¾ä¸º `nil`ï¼Œå› æ­¤åœ¨ä½¿ç”¨æ—¶éœ€è¦ç¡®ä¿è¯¥å¯¹è±¡ä»ç„¶å­˜åœ¨ï¼Œå¦åˆ™ä¼šå‡ºç°è¿è¡Œæ—¶é”™è¯¯ã€‚

  - åŠŸèƒ½ä¿®é¥°ç¬¦
    
    * `lazy`ï¼šå»¶è¿ŸåŠ è½½çš„å±æ€§ï¼Œå®ƒçš„å€¼å°†åœ¨ç¬¬ä¸€æ¬¡è®¿é—®æ—¶æ‰è¢«è®¡ç®—å¹¶å­˜å‚¨ã€‚
    * `dynamic`ï¼šå¯ä»¥è®©è¯¥å±æ€§åœ¨è¿è¡Œæ—¶åŠ¨æ€æŸ¥æ‰¾ï¼Œä¸»è¦ç”¨äº `Objective-C` å’Œ `Swift` çš„äº’æ“ä½œã€‚
    
  - ç‰¹æ€§ä¿®é¥°ç¬¦
    * `@IBOutlet`ï¼šç”¨äº `Interface Builder` ä¸­çš„å±æ€§çš„è¿æ¥ã€‚
    * `@propertyWrapper`ï¼šç”¨äºè‡ªå®šä¹‰å±æ€§åŒ…è£…å™¨ï¼Œé€šè¿‡åŒ…è£…å™¨å¯ä»¥å®šä¹‰å±æ€§å€¼çš„å­˜å‚¨æ–¹å¼å’Œé€»è¾‘ã€‚
    * `@Published`ï¼šç”¨äºè‡ªåŠ¨ä¸ºå±æ€§ç”Ÿæˆå°†ä¼šå‘é€å±æ€§æœ€æ–°å€¼çš„ `publisher`ã€‚

:::

#### â“å»¶è¿Ÿå­˜å‚¨å±æ€§

::: details ğŸ’¡

  > å»¶è¿Ÿå­˜å‚¨å±æ€§ï¼ˆ`Lazy Stored Properties`ï¼‰æ˜¯æŒ‡å½“å±æ€§é¦–æ¬¡è¢«è°ƒç”¨æ—¶æ‰è®¡ç®—å…¶åˆå§‹å€¼çš„å±æ€§ã€‚åœ¨å±æ€§å£°æ˜å‰æ·»åŠ  `lazy` å…³é”®å­—æ¥è¡¨ç¤ºä¸€ä¸ªå»¶è¿Ÿå­˜å‚¨å±æ€§ã€‚

ä½¿ç”¨åœºæ™¯ï¼š

  - å±æ€§åˆå§‹åŒ–æ¶ˆè€—å¤§ï¼Œä½†åˆå¯èƒ½ä¸ä¼šè¢«ç”¨åˆ°ã€‚
  - å±æ€§çš„å€¼ä¾èµ–äºå®ä¾‹çš„å…¶ä»–å±æ€§ï¼Œä½†æ˜¯åˆéœ€è¦åœ¨å®ä¾‹å®Œå…¨åˆå§‹åŒ–ä»¥åæ‰èƒ½è·å–ã€‚

```swift
class DataImporter {
    
    /*
    DataImporter æ˜¯ä¸€ä¸ªè´Ÿè´£å°†å¤–éƒ¨æ–‡ä»¶ä¸­çš„æ•°æ®å¯¼å…¥çš„ç±»ã€‚
    è¿™ä¸ªç±»çš„åˆå§‹åŒ–ä¼šæ¶ˆè€—ä¸å°‘æ—¶é—´ã€‚
    */
    var fileName = "data.txt"
    // å¯¼å…¥æ•°æ®çš„ä»£ç ......
}

class DataManager {
    lazy var importer = DataImporter()
    var data = [String]()
    // å…¶ä»–æ•°æ®ç®¡ç†ä»£ç ......
}

let manager = DataManager()
manager.data.append("Some data")
// 'importer' å±æ€§å°šæœªè¢«åˆ›å»º
print(manager.importer.fileName)
// 'importer' å±æ€§ç°åœ¨è¢«åˆ›å»ºäº†
// è¾“å‡º "data.txtâ€
```

:::
  
------

## å­—ç¬¦ä¸²

### â“`Swift` ä¸­çš„ `String` çš„è®¾è®¡ç†å¿µ

::: details ğŸ’¡
 
  > è®¾è®¡ç†å¿µï¼šå®‰å…¨ã€ç®€æ´ã€ç°ä»£ã€æ˜“ç”¨ã€‚
    
  - å®‰å…¨æ€§ï¼šå­—ç¬¦ä¸²è¢«è®¾è®¡ä¸ºå€¼ç±»å‹ï¼›æ— æ³•é€šè¿‡ä¸‹æ ‡ç´¢å¼•æ¥è®¿é—®å­—ç¬¦ï¼Œéœ€è¦ä½¿ç”¨ `String.Index` ç±»å‹çš„ç´¢å¼•è¿›è¡Œå­—ç¬¦ä¸²çš„è®¿é—®å’Œæ“ä½œã€‚
 
  - ç®€æ´æ€§ï¼šä¸»è¦ä½“ç°åœ¨å†…ç½®çš„å­—ç¬¦ä¸²ç›¸å…³ `API` ä¸Šï¼Œç®€åŒ–äº† `OC` é—ç•™çš„æ¥å£åç§°å†—é•¿çš„é—®é¢˜ã€‚
 
  - ç°åœ°åŒ–ï¼šæ”¯æŒ `Unicode`ï¼Œå¯ä»¥å¤„ç†å¤šæ ·åŒ–çš„æ–‡æœ¬å†…å®¹ã€‚è¿™æ˜¯å› ä¸ºåœ¨ `Swift` ä¸­ `String` ç±»å‹ä»¥ `UTF-16` çš„å½¢å¼å­˜å‚¨ã€‚

  - æ˜“ç”¨æ€§ï¼šå¯ä»¥è·Ÿä¸€èˆ¬çš„åŸºæœ¬ç±»å‹å€¼ä¸€æ ·ï¼Œç›´æ¥è¿›è¡Œâ€œ+â€ã€â€œ+=â€è¿ç®—ç¬¦çš„æ“ä½œï¼Œè¿˜æœ‰å„ç§å†…ç½®çš„å¤„ç†å­—ç¬¦ä¸²çš„ `API`ï¼Œå¦‚ï¼šå¤§å°å†™è½¬åŒ–ï¼Œå»é™¤å‰åç©ºæ ¼ç­‰ã€‚

:::

### â“ä¸ºä»€ä¹ˆ `Swift` å°† `String` è®¾è®¡ä¸ºä¸èƒ½é€šè¿‡ç´¢å¼•è®¿é—®

::: details ğŸ’¡

  å› ä¸º `Swift` ä¸­çš„ `String` å…¼å®¹ `Unicode` å­—ç¬¦ä¸²çš„ã€‚

  åœ¨ `Unicode` ä¸­ï¼Œå­—ç¬¦çš„é•¿åº¦å¯èƒ½æ˜¯ä¸ä¸€è‡´çš„ï¼ˆä¾‹å¦‚ï¼ŒæŸäº› `emoji` è¡¨æƒ…å­—ç¬¦ç”±å¤šä¸ª `Unicode` ç»„æˆï¼‰ï¼Œæ‰€ä»¥é‡‡ç”¨æ•´æ•°ç´¢å¼•å¯èƒ½ä¼šå°†å­—ç¬¦ä¸²æˆªæ–­ï¼Œå¯¼è‡´å­—ç¬¦ä¸å®Œæ•´ï¼Œç”šè‡³å¯¼è‡´å´©æºƒã€‚

:::

### â“å¦‚ä½•è¯„ä»· `String` çš„ç´¢å¼•è®¾è®¡

::: details ğŸ’¡

  åœ¨ `Swift` ä¸­ `String` çš„ç´¢å¼•è®¾è®¡æ˜¯ä¸ºäº†å¤„ç† `Unicode` å­—ç¬¦ä¸²çš„å¤æ‚æ€§ã€‚

  å­—ç¬¦ä¸²æ˜¯ç”± `Unicode` å­—ç¬¦ç»„æˆçš„ï¼Œè€Œ `Unicode` å­—ç¬¦çš„é•¿åº¦æ˜¯ä¸å›ºå®šçš„ã€‚æœ‰çš„ `Unicode` å­—ç¬¦å¯èƒ½ç”±ä¸€ä¸ª `Unicode` æ ‡é‡ï¼ˆscalarï¼‰æ„æˆï¼Œè€Œæœ‰çš„ `Unicode` å­—ç¬¦å¯èƒ½ç”±å¤šä¸ª `Unicode` æ ‡é‡æ„æˆã€‚è¿˜æœ‰ä¸€ç§æƒ…å†µæ˜¯ï¼Œä¸€ä¸ªå¯è§†å­—ç¬¦å¯èƒ½ç”±å¤šä¸ª `Unicode` å­—ç¬¦æ„æˆï¼Œä¾‹å¦‚å¸¦é‡éŸ³çš„å­—æ¯ã€‚

  å› æ­¤åœ¨ `Swift` ä¸­ï¼Œ`String` çš„ç´¢å¼•ä¸èƒ½ç®€å•åœ°ç”¨æ•´æ•°è¡¨ç¤ºã€‚å¦‚æœç”¨æ•´æ•°è¡¨ç¤ºï¼Œä¼šå¯¼è‡´å–å­—ç¬¦çš„æ“ä½œæˆä¸ºä¸€ä¸ª `O(n)` æ—¶é—´å¤æ‚åº¦çš„æ“ä½œï¼Œå› ä¸ºå¿…é¡»ä»å¤´å¼€å§‹éå†å­—ç¬¦ä¸²è·å¾—æŒ‡å®šç´¢å¼•çš„å­—ç¬¦ã€‚æ­¤å¤–ï¼Œç”±äº `Unicode` å­—ç¬¦é•¿åº¦çš„ä¸å›ºå®šæ€§ï¼Œå¦‚æœç”¨æ•´æ•°åšç´¢å¼•è¿˜å¯èƒ½ä¼šé€ æˆç´¢å¼•è¶Šç•Œçš„é”™è¯¯ã€‚

  ä¸ºäº†è§£å†³è¿™äº›é—®é¢˜ï¼Œ`Swift` è®¾è®¡äº† `String.Index` æ¥ä½œä¸ºå­—ç¬¦ä¸²çš„ç´¢å¼•ã€‚`String.Index` å°è£…äº†å¯¹åº•å±‚å­—ç¬¦ä¸²å­˜å‚¨çš„è®¿é—®ï¼Œå¯ä»¥é«˜æ•ˆä¸”å®‰å…¨åœ°è¿›è¡Œå­—ç¬¦çš„è®¿é—®ã€‚åªèƒ½é€šè¿‡ç‰¹å®šçš„æ–¹æ³•(æ¯”å¦‚`index(after:)`æˆ–è€…`index(before:)`ç­‰)æ¥æ“ä½œç´¢å¼•ï¼Œè¿™æœ‰åŠ©äºä¿è¯å­—ç¬¦ä¸²çš„è®¿é—®å®‰å…¨æ€§ã€‚

  è™½ç„¶è¿™ç§è®¾è®¡ä½¿å¾—å¤„ç†å­—ç¬¦ä¸²çš„ç´¢å¼•å˜å¾—ç¨å¾®æœ‰äº›ç¹çï¼Œä½†æ˜¯å´èƒ½æœ‰æ•ˆåœ°å¤„ç† `Unicode` å­—ç¬¦ä¸²çš„å¤æ‚æ€§ï¼Œä¿è¯å­—ç¬¦ä¸²æ“ä½œçš„å®‰å…¨æ€§å’Œæ•ˆç‡ï¼Œé¿å…äº†è¯¸å¤šå¸¸è§çš„é”™è¯¯ã€‚æ‰€ä»¥ï¼Œå¯ä»¥è¯´ `String` çš„ç´¢å¼•è®¾è®¡æ˜¯éå¸¸ä¼˜ç§€å’Œåˆ‡å®å¯è¡Œçš„ã€‚

:::
  
------

## æšä¸¾

### â“`Swift` ä¸­çš„æšä¸¾å’Œå…¶å®ƒç¼–ç¨‹è¯­è¨€çš„åŒºåˆ«

::: details ğŸ’¡

  - å…³è”å€¼ï¼šæšä¸¾æˆå‘˜å¯ä»¥ä¸ä»»æ„ç±»å‹çš„å€¼è¿›è¡Œå…³è”å­˜å‚¨ï¼Œå«åšå…³è”å€¼ï¼ˆ`Associated Values`ï¼‰ï¼›æ¯ä¸ªæšä¸¾æˆå‘˜çš„å…³è”å€¼ç±»å‹å¯ä»¥æ˜¯ä¸åŒçš„ã€‚
  
  - æ–¹æ³•ï¼šä¸ç»“æ„ä½“å’Œç±»ä¸€æ ·ï¼Œæšä¸¾ä¹Ÿå¯ä»¥å®šä¹‰æ–¹æ³•ï¼Œåœ¨æšä¸¾å€¼å®ä¾‹ä¸Šè°ƒç”¨çš„æ–¹æ³•åŠŸèƒ½ï¼›
  
  - æ„é€ å‡½æ•°ï¼šå¯ä»¥æä¾›æ„é€ å‡½æ•°ï¼Œç”¨ä»¥æä¾›ä¸€ä¸ªå¸¦æœ‰é»˜è®¤æšä¸¾å€¼çš„å®ä¾‹ã€‚
  
  - é€’å½’æšä¸¾ï¼šå¦‚æœæšä¸¾çš„ä¸€ç§ `case` æŒæœ‰è¯¥æšä¸¾ç±»å‹çš„å…³è”å€¼ï¼Œé‚£ä¹ˆè¿™ä¸ªæšä¸¾å°±æ˜¯é€’å½’æšä¸¾ã€‚
  
  - æ¨¡å¼åŒ¹é…ï¼šæšä¸¾å€¼å’Œ `switch` è¯­å¥ä¸€èµ·ä½¿ç”¨æ—¶ï¼Œå¯ä»¥è¿›è¡Œæ¨¡å¼åŒ¹é…ï¼ŒåŒ…æ‹¬è·å–æšä¸¾å€¼å…³è”å€¼ï¼Œæˆ–è€…å¤šä¸ª `case` å€¼ä¸€èµ·åŒ¹é…ã€‚

:::

### â“`Swift` ä¸­çš„ `switch` å’Œå…¶å®ƒç¼–ç¨‹è¯­è¨€æœ‰ä»€ä¹ˆåŒºåˆ«

::: details ğŸ’¡

  - æ¨¡å¼åŒ¹é…ï¼šå¯ä»¥è¿›è¡Œå¤æ‚çš„æ¨¡å¼åŒ¹é…ï¼ŒåŒ…æ‹¬å…ƒç»„ã€èŒƒå›´åŒ¹é…ä»¥åŠå…³è”æšä¸¾å€¼ç­‰ã€‚
  
  - æ— éœ€ `break`ï¼šå…¶ä»–ç¼–ç¨‹è¯­è¨€ä¸­ï¼Œå¦‚`C`è¯­è¨€æ¯ä¸ª `case` åé¢éƒ½éœ€è¦æ·»åŠ  `break` å…³é”®å­—ä»¥é€€å‡º `switch` å¦åˆ™å°†ä¼šå‘ç”Ÿè´¯ç©¿ç°è±¡ã€‚åœ¨ `Swift` ä¸­æ¯ä¸ª `case` åé¢ä¸éœ€è¦æ·»åŠ  `break`ï¼Œå½“é‡åˆ°ç¬¦åˆçš„ `case` åç¨‹åºä¼šç›´æ¥é€€å‡º `switch` è¯­å¥ã€‚
  
  - ç»‘å®šå¸¸é‡å’Œå˜é‡ï¼šåœ¨ä¸€ä¸ª `case` çš„è¯­å¥ä¸­ï¼Œå¯ä»¥ç”¨ `let` æˆ–è€… `var` æ¥ç»‘å®šåŒ¹é…åˆ°çš„å€¼åˆ°ä¸´æ—¶çš„å¸¸é‡æˆ–å˜é‡ä¸­ã€‚

:::
    
### â“æ¨¡å¼åŒ¹é…æ·±å…¥è¯´ä¸€ä¸‹

::: details ğŸ’¡

  `Swift` çš„æ¨¡å¼åŒ¹é…éå¸¸çµæ´»ä¸”å¼ºå¤§ï¼Œå®ƒä¸ä»…å¯ä»¥ä½¿ç”¨åœ¨ `switch` è¯­å¥ä¸­ï¼Œè¿˜å¯ç”¨åœ¨ `ifã€whileã€guard` è¯­å¥ä¸­ï¼Œä»¥åŠ `for-in` å¾ªç¯å’Œç±»å‹è½¬æ¢ã€‚

  - **é€šé…ç¬¦æ¨¡å¼ï¼ˆWildcard Patternï¼‰**ï¼š ä½¿ç”¨ `_` è¡¨ç¤ºï¼ŒåŒ¹é…ä»»ä½•å€¼ï¼Œä½†ä¸ç»‘å®šè¯¥å€¼ã€‚

    ```swift
    let someValue: Int? = 42
    if let _ = someValue {
        print("This will always be true!")
    }
    ```

  - **æ ‡è¯†ç¬¦æ¨¡å¼ï¼ˆIdentifier Patternï¼‰** åŒ¹é…ä»»ä½•å€¼å¹¶èµ‹å€¼ç»™ä¸€ä¸ªå¸¸é‡æˆ–è€…å˜é‡ã€‚

    ```swift
    let someValue: Int? = 42
    if let value = someValue {
        print("Value is \(value)")  // "Value is 42"
    }
    ```

  - **å€¼ç»‘å®šæ¨¡å¼ï¼ˆValue-Binding Patternï¼‰ï¼š** å°†åŒ¹é…çš„å€¼ç»‘å®šç»™ä¸€ä¸ªå˜é‡æˆ–å¸¸é‡ã€‚

    ```swift
    let point = (3, 2)
    switch point {
    case let (x, y):
        print("The point is at (\(x), \(y))")  // "The point is at (3, 2)"
    }
    ```

  - **å…ƒç»„æ¨¡å¼ï¼ˆTuple Patternï¼‰ï¼š** ç”¨æ¥åŒ¹é…å…ƒç»„ã€‚

    ```swift
    let points = [(0, 0), (0, 1), (1, 0), (1, 1)]
    for let (x, y) in points where x == y {
        print("Matched point (\(x), \(y))")  // "Matched point (0, 0)", "Matched point (1, 1)"
    }
    ```

  - **æšä¸¾ç”¨ä¾‹æ¨¡å¼ï¼ˆEnumeration Case Patternï¼‰ï¼š** åŒ¹é…æšä¸¾çš„æŸä¸ª `case`ã€‚

    ```swift
    enum Direction {
        case north, south, east, west
    }
    
    let heading: Direction = .north
    if .north = heading {
        print("We're heading north!")  // "We're heading north!"
    }
    ```

  - **ç±»å‹è½¬æ¢æ¨¡å¼ï¼š** æ£€æŸ¥ä¸€ä¸ªå€¼æ˜¯å¦ä¸ºæŸä¸ªç±»å‹ï¼Œå¦‚æœæ˜¯çš„è¯ç»‘å®šä¸ºé‚£ä¸ªç±»å‹çš„å¸¸é‡æˆ–å˜é‡ã€‚

    ```swift
    let someValue: Any = 42
    if let value as Int = someValue {
        print("Value as an integer is \(value)")  // "Value as an integer is 42"
    }
    ```

  - **å¯é€‰æ¨¡å¼ï¼ˆOptional Patternï¼‰ï¼š** ç”¨æ¥åŒ¹é…å¯é€‰å€¼ã€‚

    ```swift
    let someOptional: Int? = 42
    if .some(let value) = someOptional {
        print("Value is \(value)")  // "Value is 42"
    }
    // ä½¿ç”¨è¯­æ³•ç³–
    if let value = someOptional {
        print("Value is \(value)")  // "Value is 42"
    }
    ```

:::
  
### â“`fallthrough` çš„ä½œç”¨
  
::: details ğŸ’¡

> `fallthrough` åœ¨ `Swift` ä¸­ç”¨äºæ˜¾å¼åœ°å…è®¸åœ¨ `switch` è¯­å¥çš„ä¸€ä¸ª `case` åˆ†æ”¯æ‰§è¡Œå®Œæ¯•åï¼Œç›´æ¥è¿ç»­åœ°æ‰§è¡Œä¸‹ä¸€ä¸ª `case` åˆ†æ”¯ï¼Œè€Œä¸ç®¡ä¸‹ä¸€ä¸ª `case` æ˜¯å¦æ»¡è¶³åŒ¹é…æ¡ä»¶ã€‚ä½¿ç”¨ `fallthrough` å°±åƒç ´å `case` çš„è¾¹ç•Œï¼Œä½¿å¾—ä»£ç çš„æ§åˆ¶æµèƒ½å¤Ÿâ€œç©¿é€â€åˆ°ä¸‹ä¸€ä¸ª `case` ä¸­å»ã€‚

  ä¸€èˆ¬æƒ…å†µä¸‹ï¼Œå½“ Swift çš„ `switch` è¯­å¥åŒ¹é…åˆ°æŸä¸ª `case` åï¼Œå°±ä¼šæ‰§è¡Œè¯¥ `case` ä¸­çš„è¯­å¥å¹¶é€€å‡º `switch` è¯­å¥ã€‚å¦‚æœä½ å¸Œæœ›åœ¨ä¸€ä¸ª `case` æ‰§è¡Œå®Œæ¯•åè¿˜èƒ½ç»§ç»­æ‰§è¡Œä¸‹ä¸€ä¸ª `case`ï¼Œå¯ä»¥ä½¿ç”¨ `fallthrough` å…³é”®å­—ã€‚

```swift
let integerToDescribe = 5
var description = "The number \(integerToDescribe) is"

switch integerToDescribe {
case 2, 3, 5, 7, 11, 13, 17, 19:
    description += " a prime number, and also"
    fallthrough
default: // fallthrough ä½¿å¾—æ§åˆ¶æµè¿ç»­åœ°æ‰§è¡Œäº† default åˆ†æ”¯
    description += " an integer."
}

print(description)
// è¾“å‡º "The number 5 is a prime number, and also an integer."
```

:::
  
------

## å¯é€‰ç±»å‹

### â“`Swift` å¯é€‰ç±»å‹ `Optional` äº†è§£å—

::: details ğŸ’¡

  `Optional` æ˜¯ä¸€ä¸ªéå¸¸é‡è¦çš„ç‰¹æ€§ï¼Œå®ƒæŒ‡çš„æ˜¯å˜é‡æˆ–å¸¸é‡å¯èƒ½å®Œå…¨æ²¡æœ‰å€¼ï¼Œæˆ–è€…è¯´å˜é‡æˆ–å¸¸é‡çš„å€¼å¯èƒ½ä¸ºç©ºã€‚

  `Swift` ä½¿ç”¨ `Optional` æ¥å¤„ç†å€¼å¯èƒ½ä¸º `nil` çš„æƒ…å†µã€‚è¿™ä¸ `Objective-C` ä¸åŒï¼Œå› ä¸º `Objective-C` ä¸­ä»»ä½•å¯¹è±¡ç±»å‹éƒ½å¯ä»¥è¢«è®¾å®šä¸º `nil`ï¼Œè€ŒåŸºæœ¬ç±»å‹åˆ™ä¸èƒ½ã€‚åœ¨ `Swift` ä¸­ï¼Œå¯é€‰ç±»å‹å¯ä»¥ç”¨äºæ‰€æœ‰ç±»å‹ï¼ŒåŒ…æ‹¬åŸºæœ¬ç±»å‹å’Œè‡ªå®šä¹‰ç±»å‹ã€‚

å£°æ˜ä¸€ä¸ª `Optional` ç±»å‹çš„è¯­æ³•æ˜¯åœ¨ç±»å‹åé¢åŠ ä¸Šä¸€ä¸ªé—®å· `?`ã€‚

è§£åŒ…æœ‰ä¸¤ç§æ–¹å¼ï¼š
  
  - å¼ºåˆ¶è§£åŒ…ï¼Œä½¿ç”¨æ„Ÿå¹å· `!`
  - å¯é€‰å‹ç»‘å®šï¼Œä½¿ç”¨ `if let` æˆ–è€… `guard let`ã€‚

```swift
// å£°æ˜å¯é€‰å­—ç¬¦ä¸²
var myString: String? = "Hello, Swift!"

if let actualString = myString {
    print("The string has - \(actualString)")
} else {
    print("The string does not have a value")
}
```

  > ä½¿ç”¨ `Optional` ç±»å‹æ—¶ï¼Œéœ€è¦æ³¨æ„å®‰å…¨åœ°è§£åŒ…ï¼Œä»¥é¿å…å‡ºç° `nil` å€¼å¯¼è‡´çš„è¿è¡Œæ—¶é”™è¯¯ã€‚è€Œè¿™æ°æ°æ˜¯ `Swift` ä½¿ç”¨ `Optional` çš„ä¸€ä¸ªå…³é”®ç†å¿µï¼Œå°±æ˜¯è®©æ½œåœ¨çš„ `nil` æ›´æ˜æ˜¾ï¼Œä»è€Œæå‡ç¨‹åºçš„å®‰å…¨æ€§ã€‚

:::

### â“ä¸ºä»€ä¹ˆ `Swift` ä¸­è¦å¼•å…¥ä¸€ä¸ªå¯é€‰ç±»å‹

::: details ğŸ’¡



:::

### â“`Optional` å¯é€‰ç±»å‹çš„åº•å±‚å®ç°

::: details ğŸ’¡

  ä¸ `Objective-C` ä¸­çš„ `nil` ç•¥æœ‰ä¸åŒï¼Œå› ä¸º `Swift` ä¸­çš„ `nil` ä¸æ˜¯ä¸€ä¸ªæŒ‡é’ˆï¼Œè€Œæ˜¯ä¸€ä¸ªè¡¨ç¤ºæ²¡æœ‰å€¼çš„çŠ¶æ€ã€‚

  ```swift
  public enum Optional<Wrapped>: ExpressibleByNilLiteral {
    case none           // è¡¨ç¤ºæ²¡æœ‰å€¼ nil
    case some(Wrapped)  // è¡¨ç¤ºæœ‰å€¼
  }
  ```

::: 

### â“`Swift` ç»Ÿä¸€ç±»å‹çš„å˜é‡å¯é€‰å€¼ä¸éå¯é€‰å€¼å†…å­˜æœ‰ä»€ä¹ˆåŒºåˆ«

::: details ğŸ’¡

åœ¨ `Swift` ä¸­ï¼Œå¯é€‰å€¼ï¼ˆ`Optional`ï¼‰å®é™…ä¸Šæ˜¯ä¸€ä¸ªæšä¸¾ç±»å‹

```swift
enum Optional<Wrapped> {
    case none           // è¡¨ç¤ºæ²¡æœ‰å€¼
    case some(Wrapped)  // è¡¨ç¤ºæœ‰å€¼
}
```

æ€»ç»“ï¼šå¯é€‰å€¼åœ¨å†…å­˜ä¸Šæ¯”éå¯é€‰å€¼å¤šäº†ä¸€å±‚æšä¸¾çš„ä¿¡æ¯ï¼Œä¸€èˆ¬æƒ…å†µä¸‹ï¼Œå¤šå‡ºçš„è¿™ä¸€å±‚éœ€è¦ä¸€äº›é¢å¤–çš„å†…å­˜æ¥å­˜å‚¨æšä¸¾çš„çŠ¶æ€ï¼ˆ`none`æˆ–`some`ï¼‰ã€‚å…·ä½“å¤šå‡ºå¤šå°‘å†…å­˜ï¼Œå–å†³äºç‰¹å®šçš„æšä¸¾ç±»å‹å’Œç¼–è¯‘å™¨çš„ä¼˜åŒ–ã€‚åœ¨å¯é€‰å€¼ä¸º `none` çš„çŠ¶æ€ä¸‹ï¼Œä¹Ÿå°±æ˜¯ `nil` çš„æƒ…å†µä¸‹ï¼Œå¯é€‰å€¼å› ä¸ºæ²¡æœ‰éœ€è¦å­˜å‚¨çš„å€¼ï¼Œæ‰€ä»¥åœ¨å†…å­˜ä¸­ä¸€èˆ¬åªéœ€è¦å­˜å‚¨æšä¸¾çš„çŠ¶æ€ã€‚

:::
  
------

## é—­åŒ…

### â“`Swift` ä¸­çš„é—­åŒ…

::: details ğŸ’¡

  - éé€ƒé€¸é—­åŒ…
    > é—­åŒ…ä½œä¸ºå‡½æ•°å‚æ•°ï¼Œåœ¨å‡½æ•°è¿”å›ä¹‹å‰ï¼Œè¿™ä¸ªé—­åŒ…å·²ç»æ‰§è¡Œï¼Œåˆ™ä¸ºéé€ƒé€¸é—­åŒ…ã€‚
  
    ```swift
    func someFunctionWithNonescapingClosure(closure: () -> Void) {
        closure()
    }
    ```
    
  - é€ƒé€¸é—­åŒ… 
    > é—­åŒ…ä½œä¸ºå‡½æ•°å‚æ•°ä¼ å…¥å‡½æ•°ï¼Œå¦‚æœè¿™ä¸ªé—­åŒ…åœ¨å‡½æ•°è¿”å›ä¹‹åå†æ‰§è¡Œï¼Œåˆ™ä¸ºé€ƒé€¸é—­åŒ…ï¼Œé—­åŒ…å‚æ•°éœ€è¦ä½¿ç”¨ `@escaping` ä¿®é¥°ã€‚
  
    ```swift
    var completionHandlers: [() -> Void] = []
    func someFunctionWithEscapingClosure(completionHandler: @escaping () -> Void) {
        completionHandlers.append(completionHandler)
    }
    ```
    
  - å°¾éšé—­åŒ…
    > å°†é—­åŒ…ä½œä¸ºå‡½æ•°çš„æœ€åä¸€ä¸ªå‚æ•°ï¼Œå‡½æ•°è°ƒç”¨æ—¶ï¼Œé—­åŒ…å‚æ•°å°±æ˜¯ä¸€ä¸ªå†™åœ¨å°¾éšå‡½æ•°è°ƒç”¨åé¢çš„ä¸€ä¸ªé—­åŒ…è¡¨è¾¾å¼ã€‚
  
    ```swift
    func someFunctionThatTakesAClosure(closure: () -> Void) {
        // å‡½æ•°ä½“éƒ¨åˆ†
    }
    
    // ä»¥ä¸‹æ˜¯ä¸ä½¿ç”¨å°¾éšé—­åŒ…è¿›è¡Œå‡½æ•°è°ƒç”¨
    someFunctionThatTakesAClosure(closure: {
        // é—­åŒ…ä¸»ä½“éƒ¨åˆ†
    })
    
    // ä»¥ä¸‹æ˜¯ä½¿ç”¨å°¾éšé—­åŒ…è¿›è¡Œå‡½æ•°è°ƒç”¨
    someFunctionThatTakesAClosure() {
        // å°¾éšé—­åŒ…ä¸»ä½“éƒ¨åˆ†
    }
    ```
  
  - è‡ªåŠ¨é—­åŒ…
    > éœ€è¦ä¸€ä¸ªä¸æ¥å—å‚æ•°çš„é—­åŒ…ä½œä¸ºå‡½æ•°å‚æ•°ï¼Œä½¿ç”¨ `@autoclosure` ä¿®é¥°ã€‚ç”¨ä½œé—­åŒ…è¡¨è¾¾å¼çš„å»¶è¿ŸåŠ è½½ï¼Œåªæœ‰å½“é—­åŒ…è¡¨è¾¾å¼çœŸæ­£è°ƒç”¨æ—¶æ‰æ‰§è¡Œã€‚
    
    ```swift
    var customersInLine = ["Chris", "Alex", "John", "Jessie"]
    let customerProvider = { customersInLine.remove(at: 0) }
    print("Now serving \(customerProvider())!")
    ```

:::

### â“`@escaping` vs `@autoclosure`
  
::: details ğŸ’¡

  - `@escaping`ï¼šç”¨äºæŒ‡ç¤ºä¸€ä¸ªé—­åŒ…å‚æ•°å¯ä»¥â€œé€ƒé€¸â€å‡ºå‡½æ•°ã€‚
    
    ```swift
    var completionHandlers: [() -> Void] = []
      
    func someFunctionWithEscapingClosure(completionHandler: @escaping () -> Void) {
        // å¦‚æœæ²¡æœ‰è¢«æ ‡è®°ä¸º @escapingï¼Œå°†æ— æ³•å°†å…¶å­˜å‚¨åœ¨å‡½æ•°å¤–éƒ¨ã€‚
        completionHandlers.append(completionHandler)
    }
    ```

  - `@autoclosure`ï¼šç”¨äºè‡ªåŠ¨åˆ›å»ºä¸€ä¸ªé—­åŒ…æ¥å°è£…ä¼ å…¥çš„è¡¨è¾¾å¼ã€‚
    
    ```swift
    func logIfTrue(_ predicate: @autoclosure () -> Bool) {
        if predicate() {
            print("True")
        }
    }
    // å¯ä»¥æŠŠä¸€ä¸ªè¡¨è¾¾å¼å½“ä½œé—­åŒ…æ¥è°ƒç”¨
    logIfTrue(2 > 1)  // æ‰“å° "True"
    ```
    
:::
  
------
  
## å‡½æ•°

### â“`Swift` å‡½æ•°æ´¾å‘æœºåˆ¶

::: details ğŸ’¡

æ´¾å‘æ–¹å¼ :
  - é™æ€æ´¾å‘
  - åŠ¨æ€æ´¾å‘
    * å‡½æ•°è¡¨æ´¾å‘ : åŸºäº `VTable` (Virtual Method Table)
    * æ¶ˆæ¯æ´¾å‘ : åŸºäº `OC` è¿è¡Œæ—¶æœºåˆ¶      
   
æ´¾å‘æ•ˆç‡ : `é™æ€æ´¾å‘` > `å‡½æ•°è¡¨æ´¾å‘` > `æ¶ˆæ¯æ´¾å‘`
   
  - é™æ€æ´¾å‘ : `swift` ä¸­å¤§å¤šæ•°ç±»å‹è¢«è®¾è®¡ä¸ºå€¼ç±»å‹(`struct`ã€`enum`)ï¼Œå€¼ç±»å‹çš„æ–¹æ³•éƒ½æ˜¯é™æ€æ´¾å‘ã€‚å¦‚æœæ˜¯ `final` ä¿®é¥°å¼•ç”¨ç±»å‹ä¹Ÿæ˜¯é™æ€æ´¾å‘ã€‚`extension` ä¸­çš„æ–¹æ³•ä¹Ÿæ˜¯é™æ€æ´¾å‘ã€‚
    > é€šè¿‡ `function_ref` æŒ‡ä»¤è°ƒç”¨æ–¹æ³•ã€‚
  
  - å‡½æ•°è¡¨æ´¾å‘ : å±äºåŠ¨æ€æ´¾å‘ï¼Œå¯¹äºå¼•ç”¨ç±»å‹ï¼Œä¸æ˜¯ `extension` ä¸­çš„æ–¹æ³•æ˜¯é€šè¿‡ `VTable`(Virtual Method Table) è™šæ–¹æ³•è¡¨è¿›è¡Œæ´¾å‘ã€‚è¿˜å­˜åœ¨ä¸€ä¸­ `WTable`(Witness Table) è§è¯è€…è¡¨ï¼Œç”¨äºä¿å­˜å¼•ç”¨ç±»å‹å®ç°çš„åè®®æ–¹æ³•ã€‚
    > é€šè¿‡ `class_method` æŒ‡ä»¤è°ƒç”¨æ–¹æ³•ã€‚
  
  - æ¶ˆæ¯è½¬å‘ : å±äºåŠ¨æ€æ´¾å‘ï¼Œä½¿ç”¨ `@objc` å’Œ `dynamic` ä¿®é¥°çš„æ–¹æ³•é€šè¿‡æ¶ˆæ¯è½¬å‘ã€‚ä»…é€šè¿‡ `@objc` ä¿®é¥°çš„æ–¹æ³•ï¼Œä¸ä¼šæ”¹å˜æ´¾å‘æ–¹å¼ï¼Œä»…ç”Ÿæˆä¸€ä¸ªå¯ä¾› `OC` ä½¿ç”¨çš„æ–¹æ³•ã€‚
    > é€šè¿‡ `objc_method` æŒ‡ä»¤è°ƒç”¨æ–¹æ³•ã€‚ 

| ç±»å‹ | ç›´æ¥æ´¾å‘ | å‡½æ•°è¡¨æ´¾å‘ | æ¶ˆæ¯æ´¾å‘
| --- | ---
| `struct`      | æ‰€æœ‰æ–¹æ³• | æ—  | æ— 
| `class`       | æ‰©å±•æ–¹æ³• | åˆå§‹åŒ–å®šä¹‰æ–¹æ³• | æ— 
| `protocol`    | æ‰©å±•æ–¹æ³• | åˆå§‹åŒ–å®šä¹‰æ–¹æ³• | `@objc`

![swift-method-dispatch](media/swift-method-dispatch.jpeg)

:::

### â“`inout` å…³é”®å­—åšäº†ä»€ä¹ˆ

::: details ğŸ’¡

  `inout` å¯ä»¥è®©å‡½æ•°ã€æ–¹æ³•æˆ–è€…è¿ç®—ç¬¦å¯ä»¥æ”¹å˜ä¼ å…¥å‚æ•°çš„å€¼ã€‚

  åœ¨ `Swift` ä¸­ï¼Œæ ‡é‡ç±»å‹ï¼ˆå¦‚`Int`ï¼Œ`Double`ï¼Œ`Bool`ï¼Œ`String`ç­‰ï¼‰å’Œç»“æ„ä½“ï¼Œæšä¸¾éƒ½æ˜¯å€¼ç±»å‹ï¼ˆvalue typeï¼‰, ä¹Ÿå°±æ˜¯åœ¨å‡½æ•°å†…éƒ¨æ”¹å˜è¿™äº›å‚æ•°å¹¶ä¸ä¼šå½±å“åˆ°å‡½æ•°å¤–éƒ¨çš„å€¼ï¼Œå› ä¸ºä¼ é€’çš„æ˜¯å€¼çš„æ‹·è´ã€‚

  `inout` å…³é”®å­—å…è®¸å‡½æ•°ä¿®æ”¹å¤–éƒ¨å˜é‡çš„å€¼ã€‚æœ¬è´¨ä¸Šï¼Œå®ƒå°†å€¼ä¼ é€’ç»™å‡½æ•°ï¼Œå¹¶å°†å‡½æ•°è¿”å›åçš„å€¼å¤åˆ¶å›åŸå§‹å˜é‡ã€‚

  ```swift
  func increment(_ value: inout Int) {
    value += 1
    print(value)
  }

  var value = 1
  print(value)      // 1
  increment(&value) // 2
  print(value)      // 2
  ```

:::

### â“`mutating` å…³é”®å­—çš„ä½œç”¨

::: details ğŸ’¡

> `mutating` æ˜¯ `Swift` ä¸­çš„ä¸€ä¸ªå…³é”®å­—ï¼Œåªèƒ½ç”¨åœ¨ç»“æ„ä½“å’Œæšä¸¾çš„æ–¹æ³•ä¸­ã€‚å®ƒçš„ä½œç”¨æ˜¯å…è®¸è¯¥æ–¹æ³•ä¿®æ”¹ç»“æ„ä½“æˆ–æšä¸¾çš„ `variables` æˆ– `properties`ã€‚é»˜è®¤æƒ…å†µä¸‹ï¼Œå€¼ç±»å‹çš„å±æ€§ä¸èƒ½åœ¨å…¶å®ä¾‹æ–¹æ³•ä¸­è¢«ä¿®æ”¹ï¼ˆå› ä¸ºå€¼ç±»å‹åœ¨ä¼ é€’å’Œèµ‹å€¼æ—¶ä¼šè¢«å¤åˆ¶ï¼‰ã€‚å½“åœ¨æ–¹æ³•å‰é¢åŠ äº† `mutating` å…³é”®å­—ï¼Œé‚£ä¹ˆå°±èƒ½åœ¨è¿™ä¸ªæ–¹æ³•ä¸­ä¿®æ”¹å®ƒçš„å±æ€§ï¼Œä¸”è¿™ä¸ªæ”¹åŠ¨ä¼šåœ¨æ–¹æ³•ç»“æŸåä¿æŒã€‚

```swift
// ç»“æ„ä½“ä½¿ç”¨ mutating
struct Point {
    var x = 0
    var y = 0

    // ç§»åŠ¨ç‚¹åˆ°å¦ä¸€ä¸ªåæ ‡
    mutating func moveBy(x deltaX: Int, y deltaY: Int) {
        x += deltaX
        y += deltaY
    }
}

var point = Point(x: 1, y: 1)
point.moveBy(x: 2, y: 3)
print(point) // Point(x: 3, y: 4)

// æšä¸¾ä¸­ä½¿ç”¨ mutating
enum TrafficLight {
    case red, yellow, green
    
    // ä¸‹ä¸€ä¸ªçº¢ç»¿ç¯
    mutating func next() {
        switch self {
        case .red:
            self = .green
        case .green:
            self = .yellow
        case .yellow:
            self = .red
        }
    }
}

var light = TrafficLight.red
light.next() // light ç°åœ¨æ˜¯ .green
```

:::

### â“`infix operator` äº†è§£å—

::: details ğŸ’¡

  - `infix operator`: ä¸­ç¼€è¿ç®—ç¬¦ï¼Œæ˜¯ä¸€ç§ç‰¹æ®Šç±»å‹çš„è¿ç®—ç¬¦ï¼Œå®ƒä½äºä¸¤ä¸ªæ“ä½œæ•°ä¹‹é—´ï¼Œå¦‚ `+, -, *, /` ç­‰ã€‚

    ```swift
    // è‡ªå®šä¹‰çš„ä¸­ç¼€è¿ç®—ç¬¦ %%
    infix operator %%
    func %%(left: Int, right: Int) -> Int {
        return (left + right) * 2
    }
    let result = 5 %% 3  // ç»“æœä¸º16
    ```

 - å¯ä»¥åœ¨å®šä¹‰ä¸­ç¼€è¿ç®—ç¬¦æ—¶æ·»åŠ ä¼˜å…ˆçº§
    > é¢„å®šä¹‰çš„ä¼˜å…ˆçº§ç»„(`precedence`): `AdditionPrecedence`ã€`MultiplicationPrecedence`ã€`BitwiseShiftPrecedence` ç­‰ã€‚

    ```swift
    // å¯ä»¥åœ¨å®šä¹‰ä¸­ç¼€è¿ç®—ç¬¦æ—¶æ·»åŠ ä¼˜å…ˆçº§å’Œç»“åˆæ€§
    infix operator %%: AdditionPrecedence // + ä¼˜å…ˆçº§
    func %%(left: Int, right: Int) -> Int {
        return (left + right) * 2
    }
    let result = 5 %% 3 + 2  // ç»“æœä¸º18ï¼Œè€Œä¸æ˜¯36ï¼Œå› ä¸º"%%"çš„ä¼˜å…ˆçº§ä¸"+"ç›¸åŒ
    ```
    
  - å¯ä»¥åœ¨å®šä¹‰ä¸­ç¼€è¿ç®—ç¬¦æ—¶æŒ‡å®šç»“åˆæ€§(`associativity`): `left`(å·¦ç»“åˆ)ã€`right`(å³ç»“åˆ) æˆ– `none`(ä¸ç»“åˆ)ã€‚
    > ä¾‹å¦‚ï¼Œ"+" å’Œ "*" è¿ç®—ç¬¦æ˜¯ `left-associative`ï¼Œå³å®ƒä»¬ä»å·¦å‘å³ç»“åˆã€‚
    
    ```swift
    infix operator ^ : PowerPrecedence
    precedencegroup PowerPrecedence {
        higherThan: MultiplicationPrecedence
        associativity: left
    }
    func ^ (lhs: Double, rhs: Double) -> Double {
        return pow(lhs, rhs)
    }
    let result = 2.0 ^ 2.0 ^ 3.0  // ç»“æœä¸º64.0ï¼Œå› ä¸ºæ“ä½œç¬¦æ˜¯å·¦ç»“åˆï¼Œæ‰€ä»¥é¦–å…ˆè®¡ç®—2çš„å¹³æ–¹ï¼Œç„¶åç”¨4çš„ç«‹æ–¹è®¡ç®—ç»“æœã€‚
    ```
    
:::

### â“`Swift` ä¸­çš„ `pwt`ã€`vwt`

::: details ğŸ’¡

> `pwt` å’Œ `vwt` æ˜¯ `Swift` çš„åº•å±‚å®ç°ä¸Šæ–‡ä¸­çš„æ¦‚å¿µï¼Œåˆ†åˆ«æ˜¯ `PropertyWitnessTable` å’Œ `ValueWitnessTable` çš„ç®€å†™ã€‚

  - `pwt`ï¼ˆ`Property Witness Table`ï¼‰ï¼šå±æ€§è§è¯è¡¨
    > å±æ€§è§è¯è¡¨åŒ…å«äº†å±æ€§çš„ä¸€äº›åŸºç¡€ä¿¡æ¯å’Œæ“ä½œå‡½æ•°ï¼Œå¦‚ `destroy`ã€`initialize`ã€`get`ç­‰ã€‚`pwt` åœ¨ `Swift` ä¸­ä¸ºåè®®æ‰©å±•ä»¥åŠæ³›å‹ç¼–ç¨‹æä¾›äº†å¯èƒ½ã€‚
    
  - `vwt`ï¼ˆ`Value Witness Table`ï¼‰ï¼šå€¼è§è¯è¡¨
    > å€¼è§è¯è¡¨æ˜¯ä¸€ä¸ªç»“æ„ä½“çš„å…ƒä¿¡æ¯çš„é›†åˆã€‚å®ƒåŒ…å«äº†æè¿°å¯¹è±¡å¦‚ä½•å¤åˆ¶ã€é”€æ¯çš„å‡½æ•°æŒ‡é’ˆï¼Œä»¥åŠå¯¹è±¡çš„å¤§å°å’Œå¯¹é½æ–¹å¼ç­‰ä¿¡æ¯ã€‚æ¯ä¸ª `Swift` å¯å–å€¼ç±»å‹ï¼Œæ¯”å¦‚ `structï¼Œenumï¼Œtuple` ç­‰ï¼Œéƒ½æœ‰å¯¹åº”çš„å€¼è§è¯è¡¨ã€‚å½“éœ€è¦è¿›è¡Œä¸€äº›å†…å­˜æ“ä½œæ—¶ï¼Œå¦‚å¤åˆ¶ã€é”€æ¯ã€ç§»åŠ¨å†…å­˜ç­‰ï¼Œä¾¿ä¼šè°ƒç”¨å®ƒä»¬å¯¹åº”çš„ `Value Witness Table` ä¸­çš„å‡½æ•°æ¥è¿›è¡Œæ“ä½œã€‚
    
æ€»ç»“ï¼šè¿™äº›è¡¨åœ¨ç¼–è¯‘æ—¶å°±ä¼šç”Ÿæˆï¼Œå¹¶é™„ç€åœ¨æ¯ä¸ªç±»å‹çš„å…ƒæ•°æ®ä¸Šã€‚åœ¨è¿è¡Œæ—¶ï¼Œå½“ç±»å‹éœ€è¦å¯¹è‡ªèº«çš„å±æ€§æˆ–è€…å€¼è¿›è¡Œæ“ä½œæ—¶ï¼Œå°±ä¼šè°ƒç”¨è¿™äº›è¡¨ä¸­çš„å‡½æ•°ã€‚å®ƒä»¬æ˜¯ `Swift` åœ¨æ³›å‹å’Œåè®®ä¸Šé¢åšåˆ°ç±»å‹å®‰å…¨å’ŒæŠ½è±¡çš„å…³é”®æ‰€åœ¨ã€‚

:::

### å‡½æ•°å¼ç¼–ç¨‹

#### â“â€œ`Swift` ä¸­å‡½æ•°æ˜¯ç¬¬ä¸€ç­‰å…¬æ°‘â€ è¿™å¥è¯æ€ä¹ˆç†è§£

::: details ğŸ’¡

  > ä¸€ç­‰å…¬æ°‘ï¼šåŒå…¶å®ƒåŸºç¡€æ•°æ®ç±»å‹ä¸€æ ·ã€‚

  - å¯ä»¥ä½œä¸ºå‚æ•°ä¼ é€’ç»™å…¶ä»–å‡½æ•°(é«˜é˜¶å‡½æ•°)ã€‚
  - å¯ä»¥ä½œä¸ºå…¶ä»–å‡½æ•°çš„è¿”å›å€¼ã€‚
  - å¯ä»¥èµ‹å€¼ç»™å˜é‡ã€‚
  - å¯ä»¥å­˜å‚¨åœ¨æ•°æ®ç»“æ„ä¸­ã€‚

:::

#### â“`map`ã€`filter`ã€`reduce`

::: details ğŸ’¡

> `map`ã€`filter`ã€`reduce` æ˜¯ `Swift` ä¸­å¸¸ç”¨çš„ä¸‰ä¸ªé«˜é˜¶å‡½æ•°ï¼Œä¸»è¦ç”¨äºå¯¹æ•°ç»„è¿›è¡Œæ“ä½œã€‚

  - `map`ï¼šè·å–ä¸€ä¸ªé—­åŒ…è¡¨è¾¾å¼ä½œä¸ºå…¶å”¯ä¸€å‚æ•°ã€‚æ•°ç»„ä¸­çš„æ¯ä¸ªå…ƒç´ è°ƒç”¨ä¸€æ¬¡è¯¥é—­åŒ…å‡½æ•°ï¼Œå¹¶è¿”å›ä¸€ä¸ªåŒ…å«æœ‰æ‰€æœ‰æ–°å€¼çš„æ•°ç»„ã€‚

    ```swift
    let numbers = [1, 2, 3, 4, 5]
    let doubled = numbers.map { $0 * 2 }   // è¿”å›æ–°çš„æ•°ç»„ï¼š[2, 4, 6, 8, 10]
    ```

  - `filter`ï¼šç”¨äºè¿‡æ»¤æ•°ç»„ï¼ŒåŒæ ·éœ€è¦ä¼ å…¥ä¸€ä¸ªé—­åŒ…è¡¨è¾¾å¼ä½œä¸ºå‚æ•°ï¼Œ è¿™ä¸ªé—­åŒ…å‡½æ•°éœ€è¦è¿”å›ä¸€ä¸ªå¸ƒå°”å€¼ç”¨æ¥ç¡®å®šæ˜¯å¦è¿‡æ»¤æ‰æŸä¸€ä¸ªå…ƒç´ ã€‚

    ```swift
    let numbers = [1, 2, 3, 4, 5]
    let evens = numbers.filter { $0 % 2 == 0 } // è¿”å›æ–°çš„æ•°ç»„ï¼š[2, 4]
    ```

  - `reduce`ï¼šå°†æ‰€æœ‰å…ƒç´ ç»„åˆæˆä¸€ä¸ªå€¼ã€‚å®ƒéœ€è¦ä¸¤ä¸ªå‚æ•°ï¼Œç¬¬ä¸€ä¸ªå‚æ•°æ˜¯åˆå§‹å€¼ï¼Œç¬¬äºŒä¸ªå‚æ•°æ˜¯ä¸€ä¸ªé—­åŒ…å‡½æ•°ã€‚é—­åŒ…å‡½æ•°ä¼šè¢«æ•°ç»„ä¸­çš„å…ƒç´ ä¾æ­¤è°ƒç”¨ï¼Œå¹¶å°†ç»“æœè¿ç»­ç»„åˆèµ·æ¥ã€‚

    ```swift
    let numbers = [1, 2, 3, 4, 5]
    let sum = numbers.reduce(0, { $0 + $1 })   // è¿”å›çš„ç»“æœæ˜¯ï¼š15
    let sum = numbers.reduce(0, +) // ç®€åŒ–ç‰ˆæœ¬
    ```

:::

#### â“`flatMap`ã€ `compactMap`

::: details ğŸ’¡

> `flatMap` åœ¨ `Swift 4.1` ä¹‹å‰ï¼Œç”¨æ¥å¤„ç†åµŒå¥—çš„é›†åˆä»¥åŠå¯é€‰å€¼çš„æƒ…å†µã€‚ä½†ç”±äºè¿™ç§ä½¿ç”¨æ–¹å¼å­˜åœ¨å¼•å‘æ··æ·†çš„æƒ…å†µï¼Œå› æ­¤ä» `Swift 4.1` å¼€å§‹ï¼Œå¤„ç†å¯é€‰å€¼çš„ `flatMap` æ–¹æ³•è¢«é‡å‘½åä¸º `compactMap`ï¼Œè€Œ `flatMap` åªç”¨æ¥å¤„ç†åµŒå¥—é›†åˆã€‚

  - `flatMap`: ç”¨æ¥ "æ‘Šå¹³" åµŒå¥—é›†åˆ

    ```swift
    let arrays = [[1, 2, 3], [4, 5, 6], [7, 8, 9]]
    // å°†äºŒç»´æ•°ç»„åˆå¹¶æˆä¸€ä¸ªæ–°çš„ä¸€ç»´æ•°ç»„
    let flatArray = arrays.flatMap { $0 }
    print(flatArray)  // è¾“å‡ºï¼š[1, 2, 3, 4, 5, 6, 7, 8, 9]
    ```
    
  - `compactMap`: ç”¨æ¥è¿‡æ»¤æ‰ `nil`

    ```swift
    let numbers = ["1", "2", "three", "4", "5"]
    // Int($0) å°†å­—ç¬¦ä¸²è½¬åŒ–ä¸º Intï¼Œå¯èƒ½è¿”å› nilï¼ŒcompactMap å°†è¿‡æ»¤æ‰ nil çš„å…ƒç´ 
    let integers = numbers.compactMap { Int($0) }
    print(integers)  // è¾“å‡ºï¼š[1, 2, 4, 5]
    ```

:::

#### â“`Swift` å‡½æ•°å¼ç¼–ç¨‹ (å‡½å­ã€å•å­)

::: details ğŸ’¡

> å‡½æ•°å¼ç¼–ç¨‹æ˜¯ä¸€ç§ç¼–ç¨‹èŒƒå¼ï¼Œå‡½å­ï¼ˆ`functor`ï¼‰å’Œå•å­ï¼ˆ`monad`ï¼‰æ˜¯å‡½æ•°å¼ç¼–ç¨‹ä¸­çš„æœ¯è¯­ã€‚
  
  - å‡½å­ : æ˜¯ä¸€ç§å¯ä»¥å°†æ‰€æœ‰çš„è¾“å…¥æ“ä½œæ˜ å°„åˆ°è¾“å‡ºæ“ä½œçš„å¯¹è±¡ã€‚åœ¨ `Swift` ä¸­ï¼Œæœ€å¸¸è§çš„å‡½å­å°±æ˜¯ `Array`, `map` æ–¹æ³•å°±æ˜¯ä¸€ä¸ªå…¸å‹çš„å‡½å­æ“ä½œã€‚
  
  - å•å­ : æ˜¯å‡½å­çš„ä¸€ä¸ªç‰¹ä¾‹ï¼Œæ»¡è¶³ä¸€äº›é¢å¤–æ¡ä»¶ã€‚å…·ä½“æ¥è¯´ï¼Œå®ƒéœ€è¦å®ç°ä¸¤ä¸ªæ–¹æ³•ï¼šä¸€ä¸ªæ˜¯ç”¨æ¥åˆ›å»ºå•å­çš„æ–¹æ³•ï¼Œå¦ä¸€ä¸ªæ˜¯ç”¨æ¥è¿æ¥ä¸¤ä¸ªå•å­çš„æ–¹æ³•ã€‚åœ¨ `Swift` ä¸­ï¼Œå¯¹äº `Array` æ¥è¯´ï¼Œåˆ›å»ºå•å­çš„æ–¹æ³•æ˜¯åˆå§‹åŒ–æ–¹æ³•ï¼Œè¿æ¥ä¸¤ä¸ªå•å­çš„æ–¹æ³•åŒæ ·æ˜¯ `flatMap`ã€‚

:::

#### â“`Swift` å‡½æ•°ä¸­çš„ `Currying`

::: details ğŸ’¡

> `Currying`ï¼ˆæŸ¯é‡ŒåŒ–ï¼‰æ˜¯ä¸€ç§å°†å…·æœ‰å¤šä¸ªå‚æ•°çš„å‡½æ•°è½¬æ¢æˆä¸€ç³»åˆ—ä½¿ç”¨ä¸€ä¸ªå‚æ•°çš„å‡½æ•°çš„æŠ€æœ¯ã€‚

```swift
// æ¥å—ä¸¤ä¸ªå‚æ•°çš„å‡½æ•°
func add(a: Int, b: Int) -> Int {
    return a + b
}
let result = add(a: 3, b: 2) // è¿”å› 5

// æŸ¯é‡ŒåŒ–ä¸ºä¸€ä¸ªæ¥å—ä¸€ä¸ªå‚æ•°å¹¶è¿”å›ä¸€ä¸ªå‡½æ•°çš„å‡½æ•°ï¼Œè¿”å›çš„å‡½æ•°åŒæ ·æ¥å—ä¸€ä¸ªå‚æ•°å¹¶è¿”å›åŠ æ³•ç»“æœ
func add(a: Int) -> ((Int) -> Int) {
    return { b in return a + b }
}
let addThree = add(a: 3)  // è¿”å›ä¸€ä¸ªæ–°çš„å‡½æ•°
let result = addThree(2)  // è¿”å› 5
```

é€šè¿‡æŸ¯é‡ŒåŒ–ï¼Œå¯ä»¥æ–¹ä¾¿åœ°åˆ›å»ºå…·æœ‰ç‰¹å®šè¡Œä¸ºçš„æ–°å‡½æ•°ï¼Œè¿™åœ¨å‡½æ•°å¼ç¼–ç¨‹ä¸­å¾ˆå¸¸è§ã€‚å½“æˆ‘ä»¬éœ€è¦ç”Ÿæˆå¤§é‡ç±»ä¼¼çš„å‡½æ•°æ—¶ï¼Œè¿™ç§æŠ€æœ¯ä¼šéå¸¸æœ‰ç”¨ã€‚

:::

-----

## åè®®

### â“`Swift` ä¸­çš„åè®®ä¸ `OC` ä¸­åè®®çš„ç‰¹ç‚¹å’ŒåŒºåˆ«

::: details ğŸ’¡

  - ç›¸åŒç‚¹ : åè®®åœ¨ `Swift` å’Œ `Objective-C` ä¸­éƒ½æ˜¯å®šä¹‰ä¸€ç»„ç‰¹å®šçš„æ–¹æ³•ã€å±æ€§æˆ–è€…å…¶å®ƒè¦æ±‚çš„å·¥å…·ã€‚å…¶ä»–ç±»ã€ç»“æ„ä½“æˆ–è€…æšä¸¾éƒ½å¯ä»¥éµå®ˆè¿™äº›åè®®ï¼Œå¹¶æä¾›è¿™äº›è¦æ±‚çš„å…·ä½“å®ç°ã€‚

  - ä¸åŒç‚¹
    * `Objective-C` ä¸­ï¼Œåè®®å¾€å¾€ç”¨äºå®ç°â€œå§”æ‰˜â€æ¨¡å¼ï¼Œå°¤å…¶æ˜¯åœ¨ `UI` ç¼–ç¨‹ä¸­ç»å¸¸ä½¿ç”¨ã€‚åè®®ä¸­åªèƒ½åŒ…å«æ–¹æ³•çš„å£°æ˜ã€‚
    * `Swift` ä¸­çš„åè®®æ›´åŠ å¼ºå¤§ã€‚

> `Swift` åè®®ï¼š

  - è¦æ±‚éµå¾ªåè®®çš„ç±»å‹æä¾›ç‰¹å®šåç§°å’Œç±»å‹çš„å®ä¾‹å±æ€§æˆ–è€…ç±»å‹å±æ€§
  - è¦æ±‚éµå¾ªåè®®çš„ç±»å‹æä¾›ç‰¹å®šåç§°å’Œç±»å‹çš„æ–¹æ³•ã€åˆå§‹åŒ–æ–¹æ³•ã€ä¸‹æ ‡æ“ä½œç¬¦
  - è¦æ±‚éµå¾ªåè®®çš„ç±»å‹æä¾›ç‰¹å®šçš„æ“ä½œç¬¦æ–¹æ³•
  - ä¸ºéµå¾ªåè®®çš„ç±»å‹æä¾›é»˜è®¤çš„æ–¹æ³•æˆ–è€…å±æ€§çš„å®ç°
  - å¯ä»¥å®šä¹‰ç±»å‹åˆ«å
  - å¯ä»¥ç»§æ‰¿å…¶å®ƒåè®®
  - å¯ä»¥åœ¨åè®®ä¸­ä½¿ç”¨å…³è”ç±»å‹ç­‰

:::

### â“â€œé¢å‘åè®®ç¼–ç¨‹â€ è¯´è¯´ä½ çš„ç†è§£

::: details ğŸ’¡

  - æ ¸å¿ƒæ€æƒ³ : å…ˆå®šä¹‰å‡ºéœ€è¦çš„è¡Œä¸ºå’Œç‰¹æ€§ï¼Œç„¶åå†æ ¹æ®è¿™äº›è¦æ±‚æ¥ç¼–å†™å…·ä½“çš„å®ç°ï¼Œè€Œä¸æ˜¯å…ˆå†™å…·ä½“çš„ç±»å‹ç„¶åå†å»è€ƒè™‘å®ƒä»¬ä¹‹é—´çš„å…³ç³»ã€‚
  
  - ä¼˜ç‚¹ï¼šä½¿å¾—æˆ‘ä»¬çš„ä»£ç æ›´åŠ çµæ´»å’Œå¯å¤ç”¨ã€‚ç”±äºåè®®çš„é»˜è®¤å®ç°å’Œå¤šåè®®ç»§æ‰¿ç­‰ç‰¹æ€§ï¼Œèƒ½å¤Ÿè½»æ¾åœ°å®šä¹‰å‡ºè¡Œä¸ºå¤æ‚çš„ç±»å‹ï¼Œå¹¶ä¸”èƒ½å¤Ÿé€šè¿‡åè®®çš„ç»„åˆæ¥å®ç°æ›´ä¸ºå¼ºå¤§çš„åŠŸèƒ½ã€‚ä¹Ÿä½¿å¾—ä»£ç è§£è€¦æ€§æ›´å¼ºï¼Œæ›´å®¹æ˜“è¿›è¡Œå•å…ƒæµ‹è¯•ã€‚

:::

### éé€æ˜ç±»å‹

#### â“`some` çš„ä½œç”¨

::: details ğŸ’¡

> åœ¨ `Swift 5.1` ä¸­å¼•å…¥äº† `some` å…³é”®å­—æ¥æ”¯æŒ `Opaque Types`ï¼ˆä¸é€æ˜ç±»å‹ï¼‰çš„ç‰¹æ€§ã€‚è¿™ä¸ªç‰¹æ€§å…è®¸å‡½æ•°æˆ–æ–¹æ³•éšè—å…·ä½“çš„è¿”å›ç±»å‹ï¼Œåªæš´éœ²å®ƒéµå¾ªçš„åè®®ï¼Œä»è€Œå¢å¼ºä»£ç çš„å°è£…æ€§å’Œçµæ´»æ€§ã€‚å®ƒåœ¨æŸäº›åœºæ™¯ä¸‹è§£å†³äº†ä½¿ç”¨åè®®ä½œä¸ºç±»å‹å¸¦æ¥çš„é—®é¢˜ã€‚

  `Opaque Type`ï¼ˆä¸é€æ˜ç±»å‹ï¼‰å°±æ„å‘³ç€è¿™æ˜¯ä¸€ç§ç‰¹å®šçš„ç±»å‹ï¼Œå°½ç®¡å…·ä½“çš„ç±»å‹è¢«éšè—äº†ã€‚æ¢å¥è¯è¯´ï¼Œå°±æ˜¯ä½¿ç”¨ `some` å…³é”®å­—å£°æ˜ä¸€ä¸ªè¿”å›å€¼çš„ç±»å‹ï¼Œè€Œä¸å…·ä½“è¯´æ˜æ˜¯ä»€ä¹ˆæ ·çš„ç±»å‹ï¼Œåªæ‡ˆè¯´æ˜å®ƒéµå®ˆäº†å“ªä¸ªåè®®ã€‚åªæœ‰è¿”å›çš„ç±»å‹æ˜¯ç»Ÿä¸€çš„ï¼Œä½ æ— æ³•ä½¿ç”¨ `some` å£°æ˜çš„å‡½æ•°åŒæ—¶è¿”å›ä¸åŒçš„ç±»å‹ã€‚

```swift
protocol Animal {
  func makeNoise() -> String
}

struct Dog: Animal {
  func makeNoise() -> String {
    return "Woof!"
  }
}

struct Cat: Animal {
  func makeNoise() -> String {
    return "Meow!"
  }
}

// è¿™ä¸ªå‡½æ•°è¿”å›äº† some Animalï¼Œæ„æ€å°±æ˜¯è¿”å›äº†ä¸€ä¸ªéµå®ˆ Animal åè®®çš„ç±»å‹ï¼Œå…·ä½“æ˜¯ä»€ä¹ˆç±»å‹ï¼Œè°ƒç”¨è€…æ— æ³•çŸ¥é“
func getPet() -> some Animal {
  return Dog()
}

let pet = getPet()
print(pet.makeNoise())  // è¾“å‡º "Woof!"
```
:::


### æ ‡å‡†åº“åè®®

#### â“`CustomStringConvertible` & `CustomDebugStringConvertible`

::: details ğŸ’¡

  - `CustomStringConvertible` æ˜¯ä¸€ä¸ªåè®®ï¼Œå¦‚æœè‡ªå®šä¹‰çš„ç±»å‹å®ç°äº† `CustomStringConvertible` åè®®ï¼Œé‚£ä¹ˆèƒ½å¤Ÿè‡ªå®šä¹‰è¡¨ç¤ºå®ä¾‹çš„å­—ç¬¦ä¸²ã€‚
    > `Swift` çš„è®¸å¤šåŸºç¡€ç±»å‹éƒ½å®ç°äº†è¿™ä¸ªåè®®ï¼ŒåŒ…æ‹¬ `String, Int, Double` ç­‰ã€‚

    ```swift
    struct Point: CustomStringConvertible {
        var x: Int, y: Int
    
        // å®ç° CustomStringConvertible æä¾›ä¸€ä¸ª description å±æ€§
        var description: String {
            return "(\(x), \(y))"
        }
    }
    let p = Point(x: 5, y: 5)
    print(p)  // Prints "(5, 5)"
    ```

  - `CustomDebugStringConvertible` æ˜¯ `Swift` æ ‡å‡†åº“ä¸­çš„ä¸€ä¸ªåè®®ï¼Œå®ƒæä¾›äº†è‡ªå®šä¹‰ç±»å‹åœ¨è°ƒè¯•æ‰“å°æ—¶çš„æè¿°ã€‚
    > å½“ä½¿ç”¨ `debugPrint` å‡½æ•°æˆ– `po` å‘½ä»¤ï¼ˆåœ¨è°ƒè¯•å™¨ä¸­ï¼‰æ‰“å°å¯¹è±¡æ—¶ï¼Œ`debugDescription` å±æ€§çš„å­—ç¬¦ä¸²å°†è¢«ä½¿ç”¨ã€‚

    ```swift
    struct Person {
        var name: String
        var age: Int
    }
    // éµå¾ª CustomDebugStringConvertible å¹¶ä¸”å®ç° debugDescription å±æ€§
    extension Person: CustomDebugStringConvertible {
        var debugDescription: String {
            return "Person(name: \(name), age: \(age))"
        }
    }
    let person = Person(name: "Alice", age: 30)
    print(person)
    // è¾“å‡ºï¼šPerson(name: Alice, age: 30)
    ```

  æ³¨ï¼šé€šå¸¸ `debugDescription` æä¾›çš„ä¿¡æ¯æ¯”é»˜è®¤çš„ `description` æ›´è¯¦ç»†ï¼Œä»¥å¸®åŠ©æˆ‘ä»¬æ›´å¥½åœ°ç†è§£å¯¹è±¡çš„çŠ¶æ€ã€‚

:::

#### â“`Equatable` & `Comparable` & `Hashable`

::: details ğŸ’¡

  - `Equatable` æ˜¯ `Swift` æ ‡å‡†åº“ä¸­çš„ä¸€ä¸ªåè®®ï¼Œå®ƒå®šä¹‰äº†ä¸€ç§æ–¹å¼æ¥æ£€æŸ¥ä¸¤ä¸ªå®ä¾‹æ˜¯å¦ç›¸ç­‰ã€‚
    > å¯¹äºéµå¾ªè¯¥åè®®çš„ç±»å‹ï¼Œå¯ä»¥ä½¿ç”¨ `==` æˆ– `!=` è¿ç®—ç¬¦æ¥æ¯”è¾ƒå®ƒä»¬çš„å®ä¾‹ã€‚

    ```swift
    struct Person {
        var name: String
        var age: Int
    }
    
    // éµå¾ª Equatable åè®®ï¼Œå¹¶å®ç° == è¿ç®—ç¬¦
    extension Person: Equatable {
        static func == (lhs: Person, rhs: Person) -> Bool {
            return lhs.name == rhs.name && lhs.age == rhs.age
        }
    }
    
    // å¯ä»¥ç›´æ¥æ¯”è¾ƒè¿™äº›ç±»å‹çš„å®ä¾‹
    let alice = Person(name: "Alice", age: 25)
    let anotherAlice = Person(name: "Alice", age: 25)
    print(alice == anotherAlice)  // æ‰“å° "true"
    ```

  - `Comparable` æ˜¯ `Swift` çš„ä¸€ä¸ªåè®®ï¼Œç»§æ‰¿äº `Equatable` åè®®ã€‚
    > éµå¾ªè¯¥åè®®çš„ç±»å‹å¯ä»¥è¿›è¡Œæ¯”è¾ƒæ“ä½œã€‚è¿™æ„å‘³ç€å¯ä»¥ä½¿ç”¨ `<`ã€`<=`ã€`>=`ã€`>` è¿™æ ·çš„æ¯”è¾ƒè¿ç®—ç¬¦æ¥æ¯”è¾ƒè¿™äº›ç±»å‹çš„å®ä¾‹ã€‚
    
    * è¯¥ç±»å‹ä¸è‡ªèº«çš„æ¯”è¾ƒè¿ç®—ç¬¦ï¼ˆå¦‚ `<`ã€`<=`ã€`>=`ã€`>`ï¼‰å¿…é¡»è¿›è¡Œå®ç°ã€‚
    * å¿…é¡»å®ç°ç­‰äº `==` æ“ä½œç¬¦ï¼Œå› ä¸º `Comparable` åè®®ç»§æ‰¿è‡ª `Equatable`ã€‚

    ```swift
    struct Person: Comparable {
        var name: String
        
        static func < (lhs: Person, rhs: Person) -> Bool {
            return lhs.name < rhs.name
        }
        
        static func == (lhs: Person, rhs: Person) -> Bool {
            return lhs.name == rhs.name
        }
    }
    
    // å¯¹å®ä¾‹è¿›è¡Œæ¯”è¾ƒ
    let alice = Person(name: "Alice")
    let bob = Person(name: "Bob")
    print(alice < bob)  // æ‰“å° "true"
    ```

  - `Hashable` æ˜¯ `Swift` çš„ä¸€ä¸ªåè®®ï¼Œç»§æ‰¿äº `Equatable` åè®®ã€‚
    > ç”¨äºå®šä¹‰é‚£äº›å¯ä»¥å°†å®ƒä»¬çš„å®ä¾‹è½¬åŒ–ä¸ºä¸€ä¸ªå¯ä»¥ä»£è¡¨å®ƒä»¬çš„å”¯ä¸€æ•´æ•°å€¼ï¼ˆå³æ•£åˆ—å€¼ï¼‰çš„ç±»å‹ï¼Œè¿™ä½¿å¾—å®ƒä»¬èƒ½å¤Ÿè¯¸å¦‚å­˜å‚¨åœ¨ `Set` ä¸­æˆ–ä½œä¸º `Dictionary` çš„é”®ç­‰æ“ä½œã€‚

    * å®ç° `hash(into:)` å‡½æ•°æ¥æä¾›ä¸€ä¸ªæ•£åˆ—å€¼ã€‚
    * å¿…é¡»å®ç°ç­‰äº `==` æ“ä½œç¬¦ï¼Œå› ä¸º `Hashable` åè®®ç»§æ‰¿è‡ª `Equatable`ã€‚

    ```swift
    // Hashable åè®®å®šä¹‰
    public protocol Hashable : Equatable {
        // æ•£åˆ—å€¼
        var hashValue: Int { get }
        // å“ˆå¸Œå‡½æ•°
        func hash(into hasher: inout Hasher)
    }
    ```
    
    ```swift
    struct Person: Hashable {
        var name: String
        var age: Int
    
        static func == (lhs: Person, rhs: Person) -> Bool {
            return lhs.name == rhs.name && lhs.age == rhs.age
        }
        // æ•£åˆ—å‡½æ•°
        func hash(into hasher: inout Hasher) {
            hasher.combine(name)
            hasher.combine(age)
        }
    }
    
    let alice = Person(name: "Alice", age: 20)
    let bob = Person(name: "Bob", age: 21)
    // å­˜å…¥ Set ä¸­çš„æ•°æ®ï¼Œéœ€è¦çŸ¥é“å¦‚ä½•æ£€æŸ¥å…¶ä¸­çš„å…ƒç´ æ˜¯å¦é‡å¤
    let people: Set<Person> = [alice, bob]
    ```

:::

#### â“`Sequence` & `Collection` & `RangeReplaceableCollection`

::: details ğŸ’¡

  - `Sequence` æ˜¯ `Swift` æ ‡å‡†åº“ä¸­çš„ä¸€ä¸ªåŸºç¡€åè®®ã€‚å®ƒè¡¨ç¤ºä¸€ä¸ªå…ƒç´ æœ‰é¡ºåºå¹¶å¯éå†çš„ç»„åˆã€‚
    
    * éµå¾ª `Sequence` åè®®çš„ç±»å‹ï¼ˆå¦‚æ•°ç»„ `Array`ã€å­—å…¸ `Dictionary` æˆ–è€…é›†åˆ `Set` ç­‰ï¼‰éœ€è¦å®ç°ä¸€ä¸ª `makeIterator()` æ–¹æ³•ã€‚
    * ä½œä¸º `Sequence` ä¹Ÿå¯ä»¥ä½¿ç”¨å‡ ç§å‡½æ•°æ¥æ“ä½œå’ŒæŸ¥è¯¢ä½ çš„åºåˆ—ï¼Œæ¯”å¦‚ `map()`ã€`filter()`ã€`dropFirst()`ã€`prefix()` ç­‰ã€‚

    ```swift
    // Sequence åè®®å®šä¹‰
    public protocol Sequence {
        associatedtype Element where Self.Element == Self.Iterator.Element
        associatedtype Iterator : IteratorProtocol
        // è¿”å›ä¸€ä¸ª `Iterator` ç±»å‹çš„å®ä¾‹ï¼Œé€šè¿‡è¯¥å®ä¾‹å¯ä»¥éå†åºåˆ—(`for-in`)çš„å…ƒç´ ã€‚
        func makeIterator() -> Self.Iterator
    }
    ```

    ```swift
    // numbers å°±æ˜¯ä¸€ä¸ª Sequence
    // ä½¿ç”¨ for-in æ¥éå†æ•°ç»„
    let numbers = [1,2,3,4,5]
    for number in numbers {
        print(number)
    }
    
    // ä½¿ç”¨ map å‡½æ•°æ¥å°†æ•°ç»„ä¸­çš„æ¯ä¸€ä¸ªå…ƒç´ ä¹˜ä»¥ 2
    let doubled = numbers.map { $0 * 2 }
    print(doubled)  // æ‰“å° [2, 4, 6, 8, 10]
    ```

  - `Collection` æ˜¯ `Swift` ä¸­çš„ä¸€ä¸ªåè®®ï¼Œç»§æ‰¿è‡ª `Sequence` åè®®ã€‚
    > è¡¨ç¤ºå¯ä»¥éå†ä¸”å…ƒç´ æœ‰é¡ºåºçš„æ•°æ®ç±»å‹ï¼Œæ¯”å¦‚æ•°ç»„ã€å­—å…¸å’Œé›†åˆç­‰ï¼Œå¹¶æä¾›äº†ä¸€äº›é¢å¤–çš„åŠŸèƒ½ï¼Œæ¯”å¦‚å¯ä»¥é€šè¿‡ç´¢å¼•è®¿é—®å…ƒç´ ã€‚

    * `startIndex` å’Œ `endIndex` å±æ€§ï¼Œè¡¨ç¤ºé›†åˆçš„å¼€å§‹å’Œç»“æŸç´¢å¼•ã€‚
    * `index(after:)` æ–¹æ³•ï¼Œè¡¨ç¤ºè·å–ç»™å®šç´¢å¼•çš„ä¸‹ä¸€ä¸ªç´¢å¼•ã€‚
    * ä½¿ç”¨ä¸‹æ ‡è®¿é—®å…ƒç´ çš„èƒ½åŠ›ã€‚
    
    ```swift
    // Collection åè®®å®šä¹‰
    public protocol Collection : Sequence {
        associatedtype Index : Comparable where ...
        // é›†åˆå¼€å§‹ç´¢å¼•
        var startIndex: Self.Index { get }
        // é›†åˆç»“æŸç´¢å¼•
        var endIndex: Self.Index { get }
        
        // ä¸‹æ ‡è®¿é—®å…ƒç´ 
        subscript(position: Self.Index) -> Self.Element { get }
        subscript(bounds: Range<Self.Index>) -> Self.SubSequence { get }
        
        var count: Int { get }
        func index(after i: Self.Index) -> Self.Index
        // ...
    }
    ```
    
    ```swift
    let array = ["a", "b", "c"]
    for i in array.indices {
        print(array[i])
    }
    ```

  - `RangeReplaceableCollection` æ˜¯ `Swift` çš„ä¸€ä¸ªé›†åˆåè®®ï¼Œç»§æ‰¿äºäº† `Collection` åè®®ã€‚
    > å®ƒä¸ºèƒ½å¯¹é›†åˆçš„ä¸€ä¸ªèŒƒå›´è¿›è¡Œæ’å…¥å’Œåˆ é™¤æ“ä½œçš„ç±»å‹å£°æ˜äº†ä¸€ç»„æ–¹æ³•ã€‚å¦‚ `removeSubrange(_:)` ç­‰ã€‚
    
    * `init()`ï¼Œç”¨äºåˆ›å»ºä¸€ä¸ªæ–°çš„ç©ºé›†åˆã€‚
    * `replaceSubrange(_:with:)`ï¼Œç”¨äºæ›¿æ¢é›†åˆä¸­çš„ä¸€æ®µèŒƒå›´ä¸ºä¸€ç»„æ–°çš„å…ƒç´ ã€‚
    
    ```swift
    public protocol RangeReplaceableCollection : Collection where Self.SubSequence : RangeReplaceableCollection {
        associatedtype SubSequence
        init()
        // æ›¿æ¢é›†åˆä¸­æŒ‡å®šèŒƒå›´å…ƒç´ 
        mutating func replaceSubrange<C>(_ subrange: Range<Self.Index>, with newElements: C) where C : Collection, Self.Element == C.Element
    }
    ```
    
    ```swift
    var numbers = [10, 20, 30, 40, 50]
    numbers.removeSubrange(1...3)
    print(numbers) // è¾“å‡º [10, 50]
    ```

:::

#### â“ `ExpressibleByStringLiteral` & `ExpressibleByArrayLiteral` & `ExpressibleByDictionaryLiteral`

::: details ğŸ’¡

  - `ExpressibleByStringLiteral` æ˜¯ `Swift` ä¸­çš„ä¸€ä¸ªåè®®ï¼Œå®ƒè¡¨ç¤ºä¸€ä¸ªç±»å‹å¯ä»¥é€šè¿‡å­—ç¬¦ä¸²å­—é¢é‡è¿›è¡Œåˆå§‹åŒ–ã€‚
    > è¦éµå¾ªè¯¥åè®®ï¼Œç±»å‹éœ€è¦å®ç° `init(stringLiteral value: StringLiteralType)` åˆå§‹åŒ–æ–¹æ³•ã€‚åœ¨åˆå§‹åŒ–æ–¹æ³•ä¸­ï¼Œå°†å­—ç¬¦ä¸²å­—é¢é‡è½¬åŒ–ä¸ºè¯¥ç±»å‹çš„ä¸€ä¸ªå®ä¾‹ã€‚
    
    ```swift
    struct HTMLComponent: ExpressibleByStringLiteral {
        var html: String
        
        init(stringLiteral value: String) {
            html = "<p>\(value)</p>"
        }
    }
    // å°†å­—ç¬¦ä¸²è‡ªåŠ¨åŒ…è£…ä¸º HTML æ®µè½æ ‡ç­¾
    let component: HTMLComponent = "Hello, world!"
    print(component.html)  // è¾“å‡º "<p>Hello, world!</p>"
    ```
    
  - `ExpressibleByArrayLiteral` æ˜¯ `Swift` ä¸­çš„ä¸€ä¸ªåè®®ï¼Œå…è®¸ä½¿ç”¨æ•°ç»„å­—é¢é‡æ¥åˆå§‹åŒ–éµå¾ªæ­¤åè®®çš„ç±»å‹ã€‚
    > è¦ä½¿å¾—ç±»å‹éµå¾ª `ExpressibleByArrayLiteral`ï¼Œéœ€è¦æä¾›ä¸€ä¸ª `init(arrayLiteral elements:)` çš„åˆå§‹åŒ–æ–¹æ³•ã€‚è¿™ä¸ªæ–¹æ³•æ¥æ”¶ä¸€ä¸ªæˆ–å¤šä¸ªåŒä¸€ç±»å‹çš„å€¼ï¼Œè¿™äº›å€¼ä¸æ•°ç»„å­—é¢é‡ä¸­çš„å…ƒç´ ä¸€ä¸€å¯¹åº”ã€‚

    ```swift
    struct Vector: ExpressibleByArrayLiteral {
        var x, y, z: Double
        
        init(arrayLiteral elements: Double...) {
            assert(elements.count == 3)
            x = elements[0]
            y = elements[1]
            z = elements[2]
        }
    }
    
    let vector: Vector = [1.0, 2.0, 3.0]
    print(vector.x, vector.y, vector.z)  // æ‰“å° "1.0 2.0 3.0"
    ```
    
  - `ExpressibleByDictionaryLiteral` æ˜¯ `Swift` çš„ä¸€ä¸ªåè®®ã€‚éµå¾ªæ­¤åè®®çš„ç±»å‹å¯ä»¥ä½¿ç”¨å­—å…¸å­—é¢é‡è¿›è¡Œåˆå§‹åŒ–ã€‚è¿™æ„å‘³ç€å¯ä»¥ç›´æ¥ä½¿ç”¨ `{key: value, ...}` çš„æ ¼å¼æ¥åˆ›å»ºè¿™ç§ç±»å‹çš„å®ä¾‹ã€‚
    > ä¸ºäº†éµå¾ª `ExpressibleByDictionaryLiteral` åè®®ä½ éœ€è¦å®šä¹‰ä¸€ä¸ª `init(dictionaryLiteral elements: (Key, Value)...)` åˆå§‹åŒ–æ–¹æ³•ã€‚`Key` å’Œ `Value` æ˜¯ä½ éœ€è¦çš„å­—å…¸çš„é”®å’Œå€¼çš„ç±»å‹ã€‚

    ```swift
    struct MyDictionary: ExpressibleByDictionaryLiteral {
        var value: [String : Int]
    
        init(dictionaryLiteral elements: (String, Int)...) {
            value = Dictionary(uniqueKeysWithValues: elements)
        }
    }
    // ä½¿ç”¨å­—å…¸å­—é¢é‡æ¥åˆ›å»ºä¸€ä¸ª MyDictionary å®ä¾‹
    let myDict: MyDictionary = ["one": 1, "two": 2, "three": 3]
    print(myDict.value)  // Prints:  ["one": 1, "two": 2, "three": 3]
    ```
    
> `Swift` ä¸­çš„å­—é¢é‡åè®®

  - `ExpressibleByNilLiteral`        : `nil` å­—é¢é‡åè®®
  - `ExpressibleByBooleanLiteral`    : å¸ƒå°”å€¼å­—é¢é‡åè®®
  - `ExpressibleByIntegerLiteral`    : æ•´æ•°å­—é¢é‡åè®®
  - `ExpressibleByFloatLiteral`      : æµ®ç‚¹æ•°å­—é¢é‡åè®®
  - `ExpressibleByStringLiteral`     : å­—ç¬¦ä¸²å­—é¢é‡åè®®
  - `ExpressibleByArrayLiteral`      : æ•°ç»„å­—é¢é‡åè®®
  - `ExpressibleByDictionaryLiteral` : å­—å…¸å­—é¢é‡åè®®
    
:::

### Codable

::: details ğŸ’¡

> `Codable` æ˜¯ `Swift` æ ‡å‡†åº“ä¸­çš„ä¸€ä¸ªç±»å‹åˆ«åï¼Œè¡¨ç¤ºå¯ä»¥ç¼–ç å’Œè§£ç çš„æ•°æ®ç±»å‹ã€‚å®ƒæ˜¯ `Encodable` å’Œ `Decodable` ä¸¤ä¸ªåè®®çš„ç»„åˆã€‚

```swift
struct Person: Codable {
    var name: String
    var age: Int
}

let person = Person(name: "Alice", age: 30)

// è½¬ä¸º JSON æ•°æ®
let encoder = JSONEncoder()
if let data = try? encoder.encode(person) {
    // è½¬å› Person å®ä¾‹
    let decoder = JSONDecoder()
    if let decodedPerson = try? decoder.decode(Person.self, from: data) {
        print(decodedPerson.name)  // æ‰“å° "Alice"
    }
}
```

:::

#### â“`Codable` å¦‚ä½•å®ç° `key` æ˜ å°„

::: details ğŸ’¡

> `Codable` æ˜¯ `Swift` ä¸­å¤„ç†æ•°æ®åºåˆ—åŒ–å’Œååºåˆ—åŒ–çš„åè®®ã€‚å½“ `JSON` å­—æ®µåç§°å’Œæ¨¡å‹å±æ€§åç§°ä¸ä¸€è‡´æ—¶ï¼Œå¯ä»¥ä½¿ç”¨è¿™ä¸ªåè®®ä¸­çš„ä¸€ä¸ªå…³é”®ç‰¹æ€§ â€”â€” é”®æ˜ å°„ (key mapping)ã€‚åœ¨æ¨¡å‹ä¸­å®šä¹‰ä¸€ä¸ªæšä¸¾ï¼Œéµå®ˆ `CodingKey` åè®®ï¼Œç”¨äºæ˜ å°„ `JSON` å­—æ®µå’Œæ¨¡å‹å±æ€§ã€‚

```swift
struct User: Codable {
    var id: Int
    var name: String
    var registrationDate: Date

    // å®šä¹‰é”®æ˜ å°„çš„æšä¸¾
    enum CodingKeys: String, CodingKey {
        case id
        case name
        case registrationDate = "registration_date"  // è¿›è¡Œé”®æ˜ å°„
    }
}
```

æ³¨æ„ï¼šå¦‚æœå‹ç±»å‹ä¸­æ‰€æœ‰çš„é”®éƒ½å’Œ `JSON` çš„é”®ä¸€ä¸€å¯¹åº”ï¼Œé‚£ä¹ˆä¸éœ€è¦æ‰‹åŠ¨æä¾› `CodingKeys`ã€‚`Swift` çš„ç¼–è¯‘å™¨ä¼šè‡ªåŠ¨æä¾›ä¸€ä¸ª`String`ç±»å‹çš„ï¼Œåä¸º`CodingKeys`çš„æšä¸¾ï¼Œé‡Œé¢åŒ…å«äº†æ¯ä¸ªå±æ€§å¯¹åº”çš„é”®ã€‚ä½†ä¸€æ—¦åœ¨æ¨¡å‹ä¸­è‡ªå®šä¹‰äº† `CodingKeys`ï¼Œé‚£ä¹ˆç¼–è¯‘å™¨å°±ä¼šåœæ­¢è‡ªåŠ¨åˆæˆï¼Œéœ€è¦ä¸ºæ¨¡å‹ä¸­çš„æ¯ä¸ªå±æ€§éƒ½æä¾›å¯¹åº”çš„é”®ã€‚

:::

#### â“`Codable` å®ç°åŸç†

::: details ğŸ’¡

  åœ¨æ ‡å‡†åº“ä¸­ï¼Œå®šä¹‰äº†ä¸€ä¸ª `Decoder` åè®®ï¼Œä¸€èˆ¬è§£ç å™¨ï¼ˆæ¯”å¦‚ `JSONDecoder`ï¼‰éƒ½ä¼šéµå¾ªè¿™ä¸ªåè®®ã€‚ç›¸åº”åœ°ï¼Œè¿˜æœ‰ä¸€ä¸ª `Encoder` åè®®ï¼Œç¼–ç å™¨ï¼ˆå¦‚ `JSONEncoder`ï¼‰ä¼šéµå¾ªè¿™ä¸ªåè®®ã€‚

  å¯¹äºæ¯ä¸ªæ•°æ®ç±»å‹ï¼Œåªè¦å®ƒéµå¾ªäº† `Decodable` åè®®ï¼Œå°±å¯ä»¥è§£ç ï¼›éµå¾ªäº† `Encodable` åè®®ï¼Œå°±å¯ä»¥ç¼–ç ã€‚é€šè¿‡åè®®é»˜è®¤å®ç°ç¼–ç è§£ç ä»»åŠ¡ã€‚

```swift
// è§£ç æ–¹æ³•
init(from decoder: Decoder) throws
// ç¼–ç æ–¹æ³•
func encode(to encoder: Encoder) throws
```

:::

------

## æ³›å‹

### â“å…³è”ç±»å‹

::: details ğŸ’¡

  åœ¨ `Swift` ä¸­ï¼Œå…³è”ç±»å‹æ˜¯ç”¨åœ¨åè®®ä¸­çš„ä¸€ç§ç±»å‹ã€‚å…³è”ç±»å‹æä¾›äº†ä¸€ç§æ–¹å¼æ¥ä½¿åè®®ä¸­çš„æ–¹æ³•ã€å±æ€§æˆ–ä¸‹æ ‡è„šæœ¬çš„ç±»å‹ä¿æŒçµæ´»æ€§ã€‚å®ƒç»™åè®®æ·»åŠ äº†ä¸€ä¸ªéœ€è¦åœ¨å®ç°åè®®çš„æ—¶å€™æ‰ç¡®å®šçš„ç±»å‹å ä½ç¬¦ã€‚

  å…³è”ç±»å‹æ˜¯é€šè¿‡ `associatedtype` å…³é”®å­—å£°æ˜çš„ã€‚ä¸€æ—¦ä¸€ä¸ªåè®®æ‹¥æœ‰äº†å…³è”ç±»å‹ï¼Œå®ƒå°±ä¸èƒ½è¢«å½“åšä¸€ä¸ªç‹¬ç«‹çš„ç±»å‹ä½¿ç”¨ã€‚

```swift
// å®¹å™¨åè®®
protocol Container {
    associatedtype Item // å…³è”ç±»å‹
    mutating func append(_ item: Item)  // æ·»åŠ å…ƒç´ 
    var count: Int { get }              // è·å–å…ƒç´ æ•°é‡
    subscript(i: Int) -> Item { get }   // é€šè¿‡ç´¢å¼•è·å–å…ƒç´ 
}

struct IntArray: Container { // å®ç° Int ç±»å‹çš„å®¹å™¨åè®®
    var items = [Int]()
    typealias Item = Int

    mutating func append(_ item: Int) {
        items.append(item)
    }

    var count: Int {
        return items.count
    }

    subscript(i: Int) -> Int {
        return items[i]
    }
}
```

:::

### â“`Any` ä¸ `AnyObject` åŒºåˆ«

::: details ğŸ’¡

> `Any` å’Œ `AnyObject` æ˜¯ `Swift` ä¸­ä¸¤ç§ç‰¹æ®Šçš„ç±»å‹ï¼Œå®ƒä»¬éƒ½å¯ä»¥è¡¨ç¤º "ä»»ä½•ç±»å‹"ã€‚

åŒºåˆ«ï¼š

  - `AnyObject` å¯ä»¥è¡¨ç¤ºä»»ä½•ç±»ç±»å‹çš„å®ä¾‹ï¼Œä¹Ÿå°±æ˜¯è¯´ï¼Œéç±»ç±»å‹ï¼ˆæ¯”å¦‚ç»“æ„ä½“ã€æšä¸¾ï¼‰çš„å®ä¾‹ä¸èƒ½èµ‹å€¼ç»™ `AnyObject`ã€‚è¿™ä¸ `Objective-C` ä¸­çš„ `id` ç±»å‹æ¯”è¾ƒç›¸ä¼¼ã€‚`AnyObject` ä¸€èˆ¬åœ¨ `Swift` ä¸ `Objective-C` äº¤äº’çš„æ—¶å€™ä½¿ç”¨ã€‚
    
    ```swift
    class MyClass {}
    struct MyStruct {}
    
    let myClass: AnyObject = MyClass()
    let myStruct: AnyObject = MyStruct()  // ç¼–è¯‘é”™è¯¯ï¼Œç»“æ„ä½“ä¸èƒ½è¢«èµ‹å€¼ç»™ AnyObject
    ```

  - `Any` åˆ™å¯ä»¥è¡¨ç¤º `Swift` ä¸­çš„ä»»ä½•ç±»å‹çš„å®ä¾‹ï¼ŒåŒ…æ‹¬ç±»ã€ç»“æ„ä½“ã€æšä¸¾ã€åŸºæœ¬æ•°æ®ç±»å‹ã€å‡½æ•°ã€æ•°ç»„ã€å­—å…¸ç­‰ç­‰ï¼Œç”šè‡³è¿˜åŒ…æ‹¬å¯é€‰ç±»å‹ã€‚
    
    ```swift
    let myClass: Any = MyClass()
    let myStruct: Any = MyStruct()  // ç¼–è¯‘é€šè¿‡ï¼Œç»“æ„ä½“å¯ä»¥è¢«èµ‹å€¼ç»™ Any
    let myInt: Any = 123
    let myArray: Any = [1, 2, 3]
    let myOptional: Any = Optional.none
    ```
    
:::

### â“æ³›å‹ `T` ä¸ `Any` æœ‰ä»€ä¹ˆåŒºåˆ«

::: details ğŸ’¡

  - æ³›å‹ `T` æ˜¯åœ¨ç¼–è¯‘æ—¶å°±ç¡®å®šçš„å…·ä½“ç±»å‹ã€‚åœ¨å‡½æ•°æˆ–ç±»å‹å®šä¹‰ä¸­ï¼Œ`T` åªæ˜¯ä¸€ä¸ªå ä½ç¬¦ï¼Œä»£è¡¨ä»»æ„ç±»å‹ã€‚ç„¶è€Œï¼Œå½“å‡½æ•°è¢«è°ƒç”¨æˆ–ç±»å‹è¢«å®ä¾‹åŒ–æ—¶ï¼Œ`T` å°†è¢«å…·ä½“çš„ç±»å‹æ›¿æ¢ã€‚å› æ­¤ï¼Œä½¿ç”¨æ³›å‹å¯ä»¥ç¡®ä¿ç±»å‹çš„ä¸€è‡´æ€§å’Œå®‰å…¨æ€§ã€‚
    
    ```swift
    // äº¤æ¢ä¸¤ä¸ªå…ƒç´ å€¼çš„å‡½æ•°
    func swapTwoValues<T>(a: inout T, b: inout T) {
        let temporaryA = a
        a = b
        b = temporaryA
    }
    
    var num1 = 100
    var num2 = 200
    // T åœ¨å‡½æ•°è°ƒç”¨æ—¶è¢«ç¡®å®šä¸º Int ç±»å‹
    swapTwoValues(a: &num1, b: &num2)
    // ç°åœ¨ num1 æ˜¯ 200, num2 æ˜¯ 100
    ```
    
  - `Any` æ˜¯ä¸€ä¸ªå¯ä»¥è¡¨ç¤º `Swift` ä¸­ä»»ä½•ç±»å‹çš„ç‰¹æ®Šç±»å‹ï¼ŒåŒ…æ‹¬ç±»ã€ç»“æ„ä½“ã€æšä¸¾ã€å‡½æ•°ç±»å‹ç­‰ç­‰ã€‚å¯ä»¥æŠŠ `Any` çœ‹ä½œæ˜¯ä¸€ä¸ª â€œç±»å‹çš„é»‘ç®±â€ï¼Œå¯ä»¥å°†ä»»ä½•ç±»å‹çš„å®ä¾‹èµ‹å€¼ç»™ `Any`ï¼Œä½†ä½¿ç”¨è¿™ä¸ªå€¼æ—¶ï¼Œéœ€è¦å°†å…¶è½¬æ¢å›åŸæ¥çš„ç±»å‹ã€‚
    
    ```swift
    var items: [Any] = []
    items.append(42)
    items.append("Hello World")
    items.append((3.14159, "Pi"))
    ```
    
:::

### â“`AnyIterator` äº†è§£å—

::: details ğŸ’¡

  > `AnyIterator` æ˜¯ä¸€ç§ç±»å‹æ“¦é™¤çš„è¿­ä»£å™¨ï¼Œå®ƒæä¾›äº†ä¸€ç§æ–¹æ³•æ¥åˆ›å»ºç¬¦åˆ `IteratorProtocol` çš„ç±»å‹ï¼Œè€Œä¸éœ€è¦åˆ›å»ºæ–°çš„ï¼Œè‡ªå®šä¹‰çš„ç±»å‹ã€‚

```swift
var num = 1
// åˆ›å»ºä¸€ä¸ªè¿­ä»£å™¨æ¥è¿­ä»£è¿™ä¸ªåºåˆ—
let iterator = AnyIterator { () -> Int? in
    let nextNum = num
    num *= 2
    return nextNum
}

for _ in 0..<10 {
    print(iterator.next() ?? "")
}
```

:::

### â“æ³›å‹ç±»å‹æ“¦é™¤å¦‚ä½•å®ç°

::: details ğŸ’¡

  > æ³›å‹ç±»å‹æ“¦é™¤ : å°†å…·æœ‰ç‰¹å®šæ³›å‹ç±»å‹çº¦æŸçš„å¯¹è±¡è½¬åŒ–ä¸ºä¸€ä¸ªä¸å†å…·æœ‰ç‰¹å®šæ³›å‹ç±»å‹çš„å¯¹è±¡ï¼Œä½†ä»ç„¶ä¿æŒç›¸ä¼¼çš„è¡Œä¸ºã€‚
  
  æ³›å‹ç±»å‹æ“¦é™¤å¤„ç†ï¼Œä¸€èˆ¬æ˜¯é€šè¿‡å°†æ³›å‹ç±»å‹æˆ–å‡½æ•°åŒ…è£…åœ¨ä¸€ä¸ªéæ³›å‹ç±»å‹ä¸­æ¥è¾¾æˆçš„ã€‚
  
```swift 
// åè®®
protocol MyProtocol {}
// å®ç° MyProtocol çš„æ³›å‹ç±»
class MyGenericClass<T: MyProtocol> {}
// å°†æ³›å‹ç±» MyGenericClass è¿›è¡Œç±»å‹æ“¦é™¤ï¼ŒåŒäº‹å…·å¤‡ MyProtocol çš„è¡Œä¸º
class AnyMyGenericClass {
    private var _myClass: AnyObject
    init<T: MyProtocol>(_ myClass: MyGenericClass<T>) {
        _myClass = myClass
    }
}
```

:::
  
------
  
## å¼‚æ­¥ç¼–ç¨‹

### â“`Swift` å¦‚ä½•å®ç°è‡ªå·±çš„ `Promise` 

::: details ğŸ’¡

å®ç°è‡ªå·±çš„ `Promise` å®è´¨ä¸Šæ˜¯è¦åˆ›å»ºä¸€ä¸ªå¯ä»¥åŒ…è£…å¼‚æ­¥æ“ä½œï¼Œå¹¶èƒ½å¤Ÿåœ¨ä¹‹åè·å–å…¶ç»“æœçš„å¯¹è±¡ã€‚

```swift
// ä¸€ç§ç®€å•çš„ Promise å®ç°
class Promise<Value> {
    private var value: Value?
    private var error: Error?
    private var callbacks = [(Result<Value, Error>) -> Void]()

    func fulfill(_ value: Value) {
        self.value = value
        executeCallbacksIfNeeded()
    }

    func reject(_ error: Error) {
        self.error = error
        executeCallbacksIfNeeded()
    }

    // then æ–¹æ³•è¢«è°ƒç”¨æ¥æ·»åŠ ä¸€ä¸ªå°†åœ¨ Promise è§£å†³æ—¶è°ƒç”¨çš„å›è°ƒ
    func then(_ callback: @escaping (Result<Value, Error>) -> Void) {
        callbacks.append(callback)
        executeCallbacksIfNeeded()
    }

    // ä¸€æ—¦ Promise è¢«è§£å†³(fulfilled æˆ– rejected)ï¼Œå®ƒå°±ä¼šæ‰§è¡Œæ‰€æœ‰å›è°ƒå‡½æ•°ï¼Œå¹¶æ¸…ç©ºå›è°ƒé˜Ÿåˆ—
    private func executeCallbacksIfNeeded() {
        if let value = value {
            callbacks.forEach { $0(.success(value)) }
            callbacks = []
        } else if let error = error {
            callbacks.forEach { $0(.failure(error)) }
            callbacks = []
        }
    }
}

// ä½¿ç”¨ Promise
let promise = Promise<Int>()

promise.then { result in
    switch result {
    case .success(let value):
        print("Value: \(value)")
    case .failure(let error):
        print("Error: \(error)")
    }
}

// åœ¨å…¨å±€é˜Ÿåˆ—ä¸Šæ¨¡æ‹Ÿä¸€ä¸ªå¼‚æ­¥æ“ä½œï¼Œ2ç§’åï¼Œ`fulfill` æ–¹æ³•å°† `Promise` çŠ¶æ€æ›´æ”¹ä¸ºå·²è§£å†³ï¼Œå¹¶æ‰“å°â€œValue: 5â€ã€‚
DispatchQueue.global().async {
    sleep(2) // simulate async operation
    promise.fulfill(5)
}
```

:::

### â“`async/await`

::: details ğŸ’¡

  > `Swift 5.5` æ–°å¼•å…¥çš„ä¸¤ä¸ªå…³é”®å­—ï¼Œä¸»è¦ç”¨äºç®€åŒ–ã€ç¾åŒ– `Swift` ä¸­çš„å¼‚æ­¥ä»»åŠ¡çš„ç¼–ç å’Œé˜…è¯»ã€‚

  `async/await` å¸¦æ¥äº†æ›´æ¸…æ™°ã€æ›´ç®€æ´çš„å¼‚æ­¥ç¼–ç¨‹æ¨¡å‹ã€‚è§£å†³äº†è¿‡å»å¤„ç†å¤šå¼‚æ­¥ä»»åŠ¡å›è°ƒåœ°ç‹±çš„é—®é¢˜ï¼Œå¯ä»¥å’ŒåŒæ­¥ä»£ç ä¸€æ ·é¡ºåºç¼–å†™ï¼Œå¤§å¤§æé«˜äº†ä»£ç çš„å¯è¯»æ€§å’Œå¯ç»´æŠ¤æ€§ã€‚

  - `async`ï¼šè¡¨ç¤ºä¸€ä¸ªå‡½æ•°ä¸ºå¼‚æ­¥å‡½æ•°ã€‚å¼‚æ­¥å‡½æ•°æ˜¯ä¸€ä¸ªå¯ä»¥åœ¨åå°è¿›ç¨‹è¿è¡Œè€Œä¸ä¼šé˜»å¡å½“å‰çš„è¿è¡Œè¿›ç¨‹ã€‚
  
  - `await`ï¼šé€šå¸¸åœ¨å¼‚æ­¥å‡½æ•°ä¸­è°ƒç”¨å¦ä¸€ä¸ªå¼‚æ­¥å‡½æ•°æ—¶ä½¿ç”¨ï¼Œä»¥è¡¨ç¤ºç­‰å¾…è¿™ä¸ªå¼‚æ­¥å‡½æ•°çš„æ‰§è¡Œç»“æœã€‚

  ```swift
  func fetchDataFromServer() async -> Data {
    ...
  }
  func processData() async {
    let data = await fetchDataFromServer() 
    ...
  }
  ```
  
:::

### Sendable

#### â“`Sendable` 

::: details ğŸ’¡

  > `Swift 5.5` ä¸­ä¸å¹¶å‘ç›¸å…³çš„æ–°ç‰¹æ€§ä¹‹ä¸€ï¼Œæ˜¯ä¸€ä¸ªæ ‡è®°æ€§çš„åè®®ã€‚ç”¨äºè¡¨ç¤ºéµå¾ªè¯¥åè®®çš„ç±»å‹æ˜¯èƒ½å®‰å…¨åœ°å‘é€åˆ°å’Œæ¥æ”¶è‡ªåˆ«çš„å¹¶å‘ä¸Šä¸‹æ–‡ï¼ˆä¾‹å¦‚ï¼Œå¼‚æ­¥ä»»åŠ¡ã€actorï¼‰ã€‚
  
  ç±»å‹å¯ä»¥æ ‡è®° `Sendable` åè®®çš„ä¸¤ä¸ªæ¡ä»¶ï¼š
  
  - å€¼ç±»å‹ï¼ˆä¾‹å¦‚ï¼Œæšä¸¾ã€ç»“æ„ä½“ï¼‰
  - æ‰€æœ‰çš„å­˜å‚¨å±æ€§ï¼ˆåŒ…æ‹¬é€’å½’åœ°ï¼‰éƒ½æ˜¯ `Sendable`
  
  ```swift
  // ç›´æ¥éµå¾ª Sendable åè®®
  struct Point: Sendable {
    let x: Double
    let y: Double
  }

  // æ‰©å±•éµå¾ª Sendable åè®®
  struct Point {
    let x = Double
    let y = Double
  }
  extension Point: Sendable {}
  ```

:::

#### â“`class` ç±»å‹å¯ä»¥æ ‡è®°ä¸º `Sendable` å—

::: details ğŸ’¡

  `class` å¹¶ä¸æ˜¯å€¼ç±»å‹ï¼Œå› æ­¤ä¸èƒ½ç›´æ¥è®© `class` éµä» `Sendable` åè®®ã€‚ä½†æ˜¯å¯ä»¥é€šè¿‡ `@unchecked Sendable` å±æ€§å¼ºåˆ¶è¡¨æ˜ `class` æ˜¯ `Sendable`ã€‚å¿…é¡»ä¿è¯è¿™ä¸ªç±»å‹æ˜¯ `class`ï¼Œåœ¨ä¼ é€’è¿™ä¸ªç±»çš„å®ä¾‹æ—¶ä»æ—§èƒ½ä¿è¯çº¿ç¨‹å®‰å…¨ã€‚

  `class`éµä» `Sendable` åè®®æ—¶å¿…é¡»å°å¿ƒï¼Œå› ä¸º `Sendable` è¦æ±‚éµå¾ªè¯¥åè®®çš„ç±»å‹æ˜¯çº¿ç¨‹å®‰å…¨çš„ã€‚å¦‚æœä¸èƒ½ä¿è¯çº¿ç¨‹å®‰å…¨ï¼Œä½¿ç”¨ `@unchecked Sendable` å¯èƒ½å¼•å‘éš¾ä»¥è°ƒè¯•çš„çº¿ç¨‹é—®é¢˜ã€‚
  
:::

------

## å¼‚å¸¸å¤„ç†

### â“`rethrows` å’Œ `throws` çš„åŒºåˆ«

::: details ğŸ’¡

åœ¨ Swift ä¸­ï¼Œ`throws` å’Œ `rethrows` éƒ½ä¸é”™è¯¯å¤„ç†æœ‰å…³ã€‚

  - `throws` å…³é”®å­—ç”¨äºæ ‡è¯†ä¸€ä¸ªå‡½æ•°æˆ–æ–¹æ³•å¯èƒ½ä¼šæŠ›å‡ºé”™è¯¯ã€‚è¿™æ„å‘³ç€åœ¨è°ƒç”¨è¿™ä¸ªå‡½æ•°æˆ–æ–¹æ³•æ—¶ï¼Œå¿…é¡»å¤„ç†å¯èƒ½æŠ›å‡ºçš„é”™è¯¯ã€‚
    > ä¾‹å¦‚ï¼Œä½¿ç”¨ `do-catch` è¯­å¥ï¼Œæˆ–è€…è®©åŒ…å«æ­¤è°ƒç”¨çš„å‡½æ•°åŒæ ·æ ‡è®°ä¸º `throws`ã€‚

    ```swift
    func performOperation() throws {
        // åœ¨å‡½æ•°ä½“ä¸­ï¼Œå¯èƒ½ä¼šæŠ›å‡ºä¸€ä¸ªé”™è¯¯
        throw MyError.someError // æŠ›å‡ºä¸€ä¸ªé”™è¯¯
    }
    
    do {
        try performOperation()
    } catch {
        // å¤„ç†é”™è¯¯
    }
    ```

  - `rethrows` å…³é”®å­—ç”¨äºæ ‡è¯†ä¸€ä¸ªå‡½æ•°æˆ–æ–¹æ³•æ¥å—ä¸€ä¸ªå¯èƒ½æŠ›å‡ºé”™è¯¯çš„å‡½æ•°ä½œä¸ºå‚æ•°ï¼Œå¹¶ä¸”å®ƒå°†å¯èƒ½æŠ›å‡ºæ­¤ç±»å‡½æ•°å¯èƒ½æŠ›å‡ºçš„é”™è¯¯ã€‚å¦‚æœä¼ å…¥çš„å‡½æ•°ä¸æŠ›å‡ºé”™è¯¯ï¼Œé‚£ä¹ˆè°ƒç”¨ `rethrows` å‡½æ•°çš„ä»£ç ä¸éœ€è¦è¿›è¡Œé”™è¯¯å¤„ç†ã€‚
    
    ```swift
    func performClosureOperation(on operation: () throws -> Void) rethrows {
        // è¿™ä¸ªå‡½æ•°ä½“å°†è½¬å‘ä» operation å‚æ•°ä¸­æŠ›å‡ºçš„ä»»ä½•é”™è¯¯
        try operation()
    }
    
    // ä½¿ç”¨ä¸€ä¸ªä¸æŠ›å‡ºé”™è¯¯çš„é—­åŒ…è°ƒç”¨å‡½æ•°
    performClosureOperation(on: { /* è¿™é‡Œæ²¡æœ‰é”™è¯¯æŠ›å‡ºï¼Œæ‰€ä»¥æˆ‘ä»¬ä¸éœ€è¦å¤„ç†é”™è¯¯ */ })
    
    do {
        // ä½¿ç”¨ä¸€ä¸ªå¯èƒ½æŠ›å‡ºé”™è¯¯çš„é—­åŒ…è°ƒç”¨å‡½æ•°
        try performClosureOperation(on: { throw MyError.someError }) // å¿…é¡»å¤„ç†é”™è¯¯
    } catch {
        // å¤„ç†é”™è¯¯
    }
    ```

æ€»ç»“ï¼š`rethrows` è¡¨ç¤ºå‡½æ•°æˆ–æ–¹æ³•å°†è½¬å‘ä½œä¸ºå‚æ•°ä¼ å…¥çš„å‡½æ•°å¯èƒ½æŠ›å‡ºçš„é”™è¯¯ï¼Œè€Œ `throws` åˆ™è¡¨ç¤ºå‡½æ•°æˆ–æ–¹æ³•æœ¬èº«å¯èƒ½æŠ›å‡ºé”™è¯¯ã€‚

:::

------

## æ··ç¼–

### â“`Swift` ä¸ `OC` æ··ç¼–ç›¸äº’è°ƒç”¨

::: details ğŸ’¡

  - `Swift` è°ƒç”¨ `Objective-C`ï¼š
    > åœ¨ä¸º `Swift` å·¥ç¨‹å¯¼å…¥ `OC` ç±»åï¼Œ`Xcode` ä¼šè‡ªåŠ¨ç”Ÿæˆä¸€ä¸ªåä¸º `é¡¹ç›®åç§°-Swift.h` çš„å¤´æ–‡ä»¶ï¼Œåªéœ€è¦åœ¨éœ€è¦ä½¿ç”¨ `OC` ä¸­å¯¹è±¡çš„ `Swift` æ–‡ä»¶ä¸­ï¼Œå¯¼å…¥è¿™ä¸ªæ–‡ä»¶å³å¯å®ç° `OC` çš„ç±»ã€æ–¹æ³•çš„è°ƒç”¨ã€‚ï¼ˆæ³¨æ„æ˜¯åœ¨ `OC` æ–‡ä»¶ä¸­å¼•å…¥ï¼‰ã€‚

  - `Objective-C` è°ƒç”¨ `Swift`ï¼š
    > é¡¹ç›®éœ€æ·»åŠ æ¡¥æ¥å¤´æ–‡ä»¶ï¼ˆå³åˆ›å»ºä¸€ä¸ª `Swift` æ–‡ä»¶æ—¶ç³»ç»Ÿè‡ªåŠ¨ç”Ÿæˆçš„ `é¡¹ç›®åç§°-Bridging-Header.h` æ–‡ä»¶ï¼‰ï¼Œç„¶ååœ¨è¯¥å¤´æ–‡ä»¶ä¸­ï¼Œå¼•å…¥è¦ç”¨åˆ°çš„ `OC` ç±»çš„å¤´æ–‡ä»¶ï¼Œè¿™æ ·å°±å¯ä»¥åœ¨ `Swift` ä¸­æ­£å¸¸ä½¿ç”¨ `OC` ç±»å’Œæ–¹æ³•ã€‚åœ¨ `Swift` ä»£ç å®ç°åï¼Œ`OC` å°±å¯ä»¥é€šè¿‡åœ¨ `OC` ä¸­å¼•å…¥ `TargetName-Swift.h` æ–‡ä»¶æ¥è°ƒç”¨ `Swift` ä»£ç äº†ã€‚

:::

### â“`dynamic` åœ¨ `Swift` ä¸ `OC` ä¸­çš„ä½œç”¨
  
::: details ğŸ’¡

  - åœ¨ `Objective-C` ä¸­ï¼Œ`dynamic` å…³é”®å­—ç”¨äºå‘ŠçŸ¥ç¼–è¯‘å™¨ï¼Œæ–¹æ³•çš„å®ç°å°†åœ¨è¿è¡Œæ—¶åŠ¨æ€ç»‘å®šï¼Œå³ä¸åœ¨ç¼–è¯‘æ—¶è¿›è¡Œç»‘å®šã€‚è¿™å…è®¸åœ¨è¿è¡Œæ—¶æ›¿æ¢ã€æ·»åŠ æˆ–è€…ä¿®æ”¹æ–¹æ³•å®ç°ã€‚
    > é€šå¸¸ä¼šåœ¨å®šä¹‰äº†å±æ€§çš„ `getter` å’Œ `setter` æ–¹æ³•åï¼Œä½¿ç”¨ `@dynamic` å…³é”®å­—æ¥é¿å…ç¼–è¯‘å™¨è‡ªåŠ¨ç”Ÿæˆæ–¹æ³•å®ç°ï¼Œç„¶ååœ¨è¿è¡Œæ—¶æ‰‹åŠ¨æä¾›è¿™äº›æ–¹æ³•çš„å®ç°ã€‚
    
  - åœ¨ `Swift` ä¸­ï¼Œ`dynamic` å…³é”®å­—ç”¨äºåœ¨ç±»æˆ–è€…ç±»çš„æˆå‘˜å‰ï¼Œè¡¨ç¤ºè¯¥ç±»æˆ–è€…ç±»çš„æˆå‘˜å¯ä»¥è¢« `Objective-C` åŠ¨æ€è°ƒåº¦ã€‚ä¹Ÿå°±æ˜¯è¯´ï¼Œè¢«`dynamic`ä¿®é¥°çš„æˆå‘˜æ–¹æ³•ã€å±æ€§æˆ–ä¸‹æ ‡è„šæœ¬çš„è°ƒç”¨ä¼šå˜æˆä¸€ä¸ª `Objective-C` çš„æ¶ˆæ¯å‘é€ã€‚
    > `Swift` ä¸­çš„ `dynamic` ä¸ä»…ä»…å‘Šè¯‰ç¼–è¯‘å™¨åœ¨è¿è¡Œæ—¶æŸ¥æ‰¾æ–¹æ³•å®ç°ï¼Œè€Œä¸”è¿˜ç¡®ä¿äº†è¢«ä¿®é¥°çš„å…ƒç´ å¯ä»¥è¢« `Objective-C` è®¿é—®ï¼Œå› æ­¤å®ƒä»¬å¯ä»¥è¢« `Objective-C` çš„è¿è¡Œæ—¶ç‰¹æ€§ï¼ˆå¦‚ `Key-Value Observing`ã€`Key-Value Coding`ï¼‰ä½¿ç”¨ã€‚

  æ³¨æ„ï¼šåœ¨ `Swift` ä¸­ï¼Œ`dynamic` åªèƒ½ç”¨äºä¿®é¥°ç±»çš„å®ä¾‹æˆå‘˜ï¼Œä¸èƒ½ç”¨äºä¿®é¥°é™æ€æˆå‘˜æˆ–è€…å…¨å±€å‡½æ•°ã€‚åŒæ—¶ï¼Œåªæœ‰ç»§æ‰¿è‡ª `NSObject` çš„ç±»å¯ä»¥ä½¿ç”¨ `dynamic` ä¿®é¥°æ–¹æ³•æˆ–è€…å±æ€§ã€‚

:::

### `Swift` æŒ‡é’ˆäº†è§£å—

::: details ğŸ’¡

> `Swift` ä¸­çš„æŒ‡é’ˆç›¸å¯¹äº `C/C++` æä¾›çš„åŸå§‹æŒ‡é’ˆç±»å‹è¿›è¡Œäº†å°è£…å’Œè§„èŒƒï¼Œä»¥æä¾›æ›´å®‰å…¨çš„ä½¿ç”¨æ–¹å¼ã€‚ä¸»è¦ä½¿ç”¨ `UnsafePointer<T>` å’Œ `UnsafeMutablePointer<T>` ç±»å‹æ¥è¡¨ç¤ºä¸å¯å˜å’Œå¯å˜çš„æŒ‡é’ˆã€‚

  åœ¨ä½¿ç”¨æ—¶å¯¹åŸå§‹å†…å­˜è¿›è¡Œäº†å¼•ç”¨ï¼Œè€Œéç›´æ¥æ“ä½œå†…å­˜ã€‚å½“å®Œæˆæ‰€æœ‰çš„è¯»ã€å†™æˆ–è€…æƒ³è¦é‡Šæ”¾æŸä¸ªå†…å­˜ç‰‡æ®µæ—¶ï¼Œä½¿ç”¨ `deinitialize` å’Œ `deallocate` æ–¹æ³•æ¥å®Œæˆã€‚

```swift
func usePointer() {
    // ä¸º Int åˆ›å»ºä¸å¯å˜å’Œå¯å˜æŒ‡é’ˆ
    let num = 10
    let numPointer: UnsafePointer<Int> = UnsafePointer(&num)
    print(numPointer.pointee) // 10
    let nums = UnsafeMutablePointer<Int>.allocate(capacity: 1)
    nums.initialize(to: 20)
    print(nums.pointee) // 20
    ...
    nums.deallocate() // ä½¿ç”¨å®Œæ¯•åè®°å¾—é‡Šæ”¾
}
```

:::

------

## ç‰¹æ€§

### â“`@available` & `@inlinable`

### â“`@discardableResult` & 

### â“`@objc` & `@objcMembers`

### â“`@testable`

### @propertyWrapper

#### â“`@propertyWrapper` æ˜¯ä»€ä¹ˆ

::: details ğŸ’¡

  > `Swift 5.1` å¼•å…¥äº†ä¸€é¡¹æ–°ç‰¹æ€§ï¼šå±æ€§åŒ…è£…å™¨ï¼ˆproperty wrappersï¼‰ã€‚å±æ€§åŒ…è£…å™¨æä¾›äº†ä¸€ç§å°†ç‰¹æ€§æ·»åŠ åˆ°å±æ€§ä¸Šçš„æ–°æ–¹æ³•ï¼Œä¾‹å¦‚çº¿ç¨‹å®‰å…¨ï¼Œæ‡’åŠ è½½ï¼Œé”®å€¼è§‚å¯Ÿï¼Œå­˜å‚¨åœ¨æ•°æ®åº“ä¸­ç­‰ï¼Œä»è€Œä½¿è¿™äº›å±æ€§æ›´æ˜“äºå¤ç”¨ã€‚ç®€å•æ¥è¯´ï¼Œå±æ€§åŒ…è£…å™¨å°±æ˜¯ä¸€ä¸ªå®šä¹‰äº†ç‰¹æ®Šè®¿é—®ç­–ç•¥çš„ç»“æ„æˆ–ç±»ï¼Œæˆ‘ä»¬å¯ä»¥å°†è¿™ä¸ªè®¿é—®ç­–ç•¥é™„åŠ åˆ°å±æ€§ä¸Šï¼Œè€Œä¸æ˜¯é‡æ–°å®ç°ç›¸åŒçš„è®¿é—®ç­–ç•¥ã€‚

```swift
// å®šä¹‰å±æ€§åŒ…è£…å™¨
@propertyWrapper
struct HundredOrLess {
    private var score = 0
    var wrappedValue: Int {
        get { return score }
        set { score = min(newValue, 100) }
    }
}
// ä½¿ç”¨å±æ€§åŒ…è£…å™¨
struct Grade {
    /// æ•°å­¦æˆç»©
    @HundredOrLess var math: Int
    /// ä½“è‚²æˆç»©
    @HundredOrLess var gym: Int
}
```

:::

#### â“`@propertyWrapper` çš„å¸¸è§ç”¨æ³•

::: details ğŸ’¡

> `@propertyWrapper` ä½¿å¾—å®šä¹‰å¯å¤ç”¨çš„å±æ€§è¡Œä¸ºæˆä¸ºå¯èƒ½ï¼Œä½¿å¾—ä»»åŠ¡åƒæ·»åŠ çº¿ç¨‹å®‰å…¨æ€§ã€å­—ç¬¦æ¸…ç†ã€å†…éƒ¨å€¼è½¬æ¢ç­‰è½¬åŒ–ä¸ºä¸€ä¸ªç®€æ˜“æ“ä½œã€‚

å¸¸è§ç”¨æ³•ï¼š

  - å­˜å‚¨å±æ€§çš„è½¬æ¢ã€‚

    ```swift
    @propertyWrapper
    struct Capitalized {
        var wrappedValue: String {
            didSet { self.wrappedValue = wrappedValue.capitalized }
        }
        
        init(wrappedValue: String) {
            self.wrappedValue = wrappedValue.capitalized
        }
    }
    
    struct User {
        // ä½¿ç”¨äº† @Capitalized ä¿®é¥°ç¬¦ï¼Œä½¿å¾—è¿™ä¸¤ä¸ªå±æ€§çš„å€¼è‡ªåŠ¨è¢«è½¬æ¢ä¸ºé¦–å­—æ¯å¤§å†™ã€‚
        @Capitalized var firstName: String
        @Capitalized var lastName: String
    }
    ```

  - çº¿ç¨‹å®‰å…¨ã€‚

    ```swift
    @propertyWrapper
    class Atomic<Value> {
        // ä¸²è¡Œé˜Ÿåˆ—
        private let queue = DispatchQueue(label: "Atomic serial queue")
        private var _value: Value
    
        // ä½¿ç”¨ä¸€ä¸ªä¸²è¡Œé˜Ÿåˆ—ä¿æŠ¤ï¼Œç¡®ä¿è¯»å–å’Œå†™å…¥æ“ä½œçš„åŸå­æ€§ã€‚
        var wrappedValue: Value {
          get { return queue.sync { _value } }
          set { queue.sync { _value = newValue } }
       }
    
       init(wrappedValue value: Value) {
         _value = value
       }
    }
    
    struct AtomicCounter {
        @Atomic var value: Int
    }
    ```

  - ç”¨æˆ·é»˜è®¤å€¼ã€‚
  
    ```swift
    @propertyWrapper
    struct UserDefault<T> {
        // UserDefaults å­˜å‚¨é”®
        let key: String
        /// é»˜è®¤å€¼
        let defaultValue: T
    
        var wrappedValue: T {
            // ä½¿ç”¨ UserDefaults å­˜å‚¨å’Œæ£€ç´¢å€¼ã€‚
            get { UserDefaults.standard.object(forKey: key) as? T ?? defaultValue }
            set { UserDefaults.standard.set(newValue, forKey: key) }
        }
    }
    
    struct Settings {
        @UserDefault(key: "ShowOnboarding", defaultValue: true) var showOnboarding: Bool
    }
    ```

:::

### â“`@dynamicMemberLookup` & `@dynamicCallable`
  
::: details ğŸ’¡
  
  - `@dynamicMemberLookup`: åŠ¨æ€æˆå‘˜æŸ¥æ‰¾ï¼Œ`Swift 4.2` å¼•å…¥çš„æ–°ç‰¹æ€§ã€‚
    > å…è®¸åˆ›å»ºè¢«åŠ¨æ€è°ƒç”¨çš„ç±»å‹ï¼Œå®ƒçš„å±æ€§å’Œæ–¹æ³•åœ¨ç¼–è¯‘æ—¶æ˜¯æœªçŸ¥çš„ï¼Œåªæœ‰åœ¨è¿è¡Œæ—¶æ‰ä¼šç¡®å®šã€‚

    ```swift
    @dynamicMemberLookup
    struct DynamicMember {
        let dictionary = ["dynamicMember": 110, "otherMember": 119]
        subscript(dynamicMember member: String) -> Int {
            return dictionary[member] ?? 114
        }
    }
    let member = DynamicMember()
    print(member.dynamicMember) // 110
    print(member.otherMember)   // 119
    ```

  - `@dynamicCallable`: åŠ¨æ€è°ƒç”¨ï¼Œ`Swift 5` æä¾›çš„ä¸€ä¸ªæ–°ç‰¹æ€§ã€‚
    > å…è®¸å®ç°è‡ªå®šä¹‰çš„â€œå¯è°ƒç”¨â€è¡Œä¸ºã€‚å®è´¨ä¸Šï¼Œå®ƒæ˜¯ä¸ºäº† `Swift` èƒ½æ›´å¥½åœ°ä¸å…¶ä»–çš„åŠ¨æ€è¯­è¨€äº¤äº’è€Œè®¾è®¡çš„ï¼Œæ¯”å¦‚ `Python`ã€‚

    `@dynamicCallable` ç±»å‹å¿…é¡»å®ç°ä»¥ä¸‹æ–¹æ³•ä¹‹ä¸€ï¼ˆæˆ–ä¸¤ä¸ªéƒ½å®ç°ï¼‰ï¼š
    
    * `func dynamicallyCall(withArguments args: [T]) -> U` : æ¥å—ä¸€ä¸ªæœªå‘½åå‚æ•°æ•°ç»„
    * `func dynamicallyCall(withKeywordArguments args: KeyValuePairs<N, T>) -> U` : æ¥å—ä¸€ä¸ªé”®-å€¼å¯¹æ•°ç»„ä½œä¸ºå‚æ•°ï¼ˆä¹Ÿå³æ ‡ç­¾å’Œå€¼çš„æ•°ç»„ï¼‰

    ```swift
    @dynamicCallable
    struct Repeater {
        func dynamicallyCall(withKeywordArguments arguments: KeyValuePairs<String, Int>) -> String {
            return String(repeating: "Hello", count: arguments.first?.value ?? 1)
        }
    }
    
    let repeatTask = Repeater()
    // å®ä¾‹å¯ä»¥åƒå‡½æ•°ä¸€æ ·è¢«è°ƒç”¨
    print(repeatTask(count: 5)) // HelloHelloHelloHelloHello
    ```

æ³¨ï¼šè¿™äº›ç‰¹æ€§åœ¨è°ƒç”¨ `Python`ã€`JavaScript`ã€`Ruby` å’Œå…¶ä»–ä¸€äº›åŠ¨æ€è„šæœ¬è¯­è¨€çš„ `API` æ—¶éå¸¸æœ‰ç”¨ï¼Œå› ä¸ºå®ƒèƒ½è®©ä½ å†™å‡ºæ›´åŠ ç›´è§‚å’Œæ›´åŠ æ¥è¿‘è¿™äº›è¯­è¨€çš„ `Swift` ä»£ç ã€‚

:::

### ç§æœ‰

#### â“`@_specialize`

::: details ğŸ’¡

  > `@_specialize` æ˜¯ `Swift` ä¸­çš„ä¸€ä¸ªç§æœ‰ç‰¹æ€§ï¼Œåœ¨æ­£å¼çš„ `Swift` ç‰ˆæœ¬ä¸­ä¸æ¨èä½¿ç”¨ï¼Œå› ä¸ºå®ƒå¯èƒ½åœ¨æœªæ¥çš„ç‰ˆæœ¬ä¸­è¢«ç§»é™¤æˆ–è€…ä¿®æ”¹ã€‚

  `@_specialize` å±æ€§ç”¨æ¥å‘Šè¯‰ `Swift` çš„ç¼–è¯‘å™¨ï¼Œå°½å¯èƒ½åœ°ä¸ºç‰¹å®šçš„ç±»å‹å‚æ•°ç”Ÿæˆä¸“é—¨çš„ä»£ç ã€‚è¿™æ„å‘³ç€å½“ä¸€ä¸ªä½¿ç”¨ç‰¹å®šç±»å‹å‚æ•°çš„å‡½æ•°è¢«è°ƒç”¨æ—¶ï¼Œç¼–è¯‘å™¨ä¸å†ä½¿ç”¨é€šç”¨ç‰ˆæœ¬ï¼Œè€Œæ˜¯ä½¿ç”¨ä¸ºè¿™äº›ç‰¹å®šç±»å‹ç”Ÿæˆçš„ä¸“é—¨ä»£ç ã€‚

  ä¼˜ç‚¹ï¼šæ€§èƒ½ä¼˜åŒ–ï¼Œå› ä¸ºä¸å†éœ€è¦ç±»å‹æ£€æŸ¥å’Œè§£åŒ…ï¼Œä¹Ÿä¸å†éœ€è¦åŠ¨æ€æ´¾å‘ã€‚

```swift
// æ¯”è¾ƒä¸¤ä¸ª Comparable çš„å…ƒç´ å¹¶è¿”å›æœ€å°çš„ä¸€ä¸ª
func min<T: Comparable>(_ x: T, _ y: T) -> T {
    return y < x ? y : x
}

// @_specialize ä¼˜åŒ–ï¼Œç”Ÿæˆä¸€ä¸ªä¸“é—¨å¤„ç† Int çš„ç‰ˆæœ¬
@_specialize(where T == Int)
func min<T: Comparable>(_ x: T, _ y: T) -> T {
    return y < x ? y : x
}
```

:::

#### â“`@_functionBuilder`

::: details ğŸ’¡

  > `Swift 5.1` å¼•å…¥äº†å‡½æ•°å»ºæ„å™¨ç‰¹æ€§ï¼Œç›®å‰è¿˜å¤„äºç§æœ‰é˜¶æ®µï¼Œæ•…ä»¥ `_` å¼€å¤´ã€‚å‡½æ•°å»ºæ„å™¨åŠŸèƒ½ä¸»è¦ç”¨äºç®€åŒ–å¤§é‡æ ·æ¿ä»£ç ã€‚
  
```swift
// SwiftUI 
VStack(content: { 
    return Group { 
        Text("Hello") 
        Text("World") 
    } 
})
// @_functionBuilder å¯ä»¥ç®€åŒ–ä¸ºå¦‚ä¸‹å†™æ³•
VStack { 
    Text("Hello") 
    Text("World") 
}
```

:::