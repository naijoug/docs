---
title: Swift
icon: hashtag

index: true
order: 2

---

<!-- more -->

## è®¾è®¡ç†å¿µ

### ğŸŒ `Swift` ç±»å’Œç»“æ„ä½“çš„åŒºåˆ«

::: details ğŸ”†

  - å€¼ç±»å‹å’Œå¼•ç”¨ç±»å‹ï¼šç»“æ„ä½“æ˜¯å€¼ç±»å‹ï¼Œç±»æ˜¯å¼•ç”¨ç±»å‹ã€‚å½“ä¸€ä¸ªç»“æ„ä½“å®ä¾‹è¢«èµ‹å€¼ç»™ä¸€ä¸ªæ–°çš„å˜é‡æˆ–è€…ä½œä¸ºä¸€ä¸ªå‡½æ•°çš„å‚æ•°ä¼ é€’æ—¶ï¼Œè¿™ä¸ªå®ä¾‹çš„æ‹·è´ä¼šè¢«åˆ›å»ºå‡ºæ¥ã€‚æ‰€ä»¥æ”¹å˜æ–°å˜é‡ä¸­çš„å€¼ä¸ä¼šå½±å“åŸæ¥çš„å®ä¾‹ã€‚è€Œå¯¹äºç±»æ¥è¯´ï¼Œèµ‹å€¼å®é™…ä¸Šæ˜¯ä¼ é€’äº†ä¸€ä¸ªå¼•ç”¨ï¼Œæ‰€ä»¥ä¿®æ”¹èµ‹å€¼åçš„å®ä¾‹ä¹Ÿä¼šå½±å“åˆ°åŸæ¥çš„å®ä¾‹ã€‚
  - ç»§æ‰¿ï¼šç»“æ„ä½“ä¸èƒ½ç»§æ‰¿å…¶ä»–çš„ç»“æ„ä½“æˆ–è€…ç±»ï¼Œè€Œç±»å¯ä»¥ç»§æ‰¿å…¶ä»–çš„ç±»ã€‚
  - ç±»å‹è½¬åŒ–ï¼šç±»å¯ä»¥è¢«å¼ºåˆ¶ç±»å‹è½¬æ¢ï¼Œå¯ä»¥ä½¿ç”¨iså’Œasæ“ä½œç¬¦åœ¨è¿è¡Œæ—¶æ£€æŸ¥å®ä¾‹çš„ç±»å‹ã€‚ç»“æ„ä½“æ²¡æœ‰è¿™ä¸ªåŠŸèƒ½ã€‚
  - ææ„å‡½æ•°ï¼šç±»å¯ä»¥æœ‰ææ„å‡½æ•°ï¼Œç”¨æ¥åœ¨ç±»å®ä¾‹è¢«é”€æ¯å‰æ‰§è¡Œç‰¹å®šçš„æ“ä½œã€‚ç»“æ„ä½“æ²¡æœ‰ææ„å‡½æ•°ã€‚
  - å¼•ç”¨è®¡æ•°ï¼šç±»å¯ä»¥é€šè¿‡å¼•ç”¨è®¡æ•°è¿›è¡Œå†…å­˜ç®¡ç†ï¼Œè€Œç»“æ„ä½“æ²¡æœ‰è¿™é¡¹åŠŸèƒ½ã€‚ 
  - åè®®ï¼šè™½ç„¶ç±»å’Œç»“æ„ä½“éƒ½å¯ä»¥å®ç°åè®®ï¼Œä½†æ˜¯åªæœ‰ç±»å¯ä»¥åˆ©ç”¨æŸäº›ç‰¹å®šçš„åè®®æä¾›çš„è¿è¡Œæ—¶ç‰¹æ€§ã€‚

:::

### â“`Swift` ä¸­çš„æšä¸¾å’Œå…¶å®ƒç¼–ç¨‹è¯­è¨€çš„åŒºåˆ«

::: details âœ…

  - å…³è”å€¼ï¼šSwiftçš„æšä¸¾æˆå‘˜å¯ä»¥ä¸ä»»æ„ç±»å‹çš„å€¼è¿›è¡Œå…³è”å­˜å‚¨ï¼Œå«åšå…³è”å€¼ï¼ˆAssociated Valuesï¼‰ã€‚æ¯ä¸ªæšä¸¾æˆå‘˜çš„å…³è”å€¼ç±»å‹å¯ä»¥æ˜¯ä¸åŒçš„ã€‚
  - æ–¹æ³•ï¼šä¸ç»“æ„ä½“å’Œç±»ä¸€æ ·ï¼Œæšä¸¾ä¹Ÿå¯ä»¥å®šä¹‰æ–¹æ³•ï¼Œä»è€Œæä¾›åœ¨æšä¸¾å€¼å®ä¾‹ä¸Šè°ƒç”¨çš„åŠŸèƒ½ï¼›
  - æ„é€ å‡½æ•°ï¼šæšä¸¾å¯ä»¥æä¾›æ„é€ å‡½æ•°ï¼Œç”¨ä»¥æä¾›ä¸€ä¸ªå¸¦æœ‰é»˜è®¤æšä¸¾å€¼çš„å®ä¾‹ã€‚
  - é€’å½’æšä¸¾ï¼šå¦‚æœæšä¸¾çš„ä¸€ç§caseï¼ŒæŒæœ‰è¯¥æšä¸¾ç±»å‹çš„å…³è”å€¼ï¼Œé‚£ä¹ˆè¿™ä¸ªæšä¸¾å°±æ˜¯é€’å½’æšä¸¾ã€‚
  - æ¨¡å¼åŒ¹é…ï¼šæšä¸¾å€¼å’Œswitchè¯­å¥ä¸€èµ·ä½¿ç”¨æ—¶ï¼Œå¯ä»¥è¿›è¡Œæ¨¡å¼åŒ¹é…ï¼ŒåŒ…æ‹¬è·å–æšä¸¾å€¼å…³è”å€¼ï¼Œæˆ–è€…å¤šä¸ªcaseå€¼ä¸€èµ·åŒ¹é…ã€‚

:::

  > ğŸŒ€ `Swift` ä¸­çš„ `switch` å’Œå…¶å®ƒç¼–ç¨‹è¯­è¨€æœ‰ä»€ä¹ˆåŒºåˆ«ï¼Ÿ

::: details ğŸ‰

  - æ¨¡å¼åŒ¹é…ï¼šå¯ä»¥è¿›è¡Œå¤æ‚çš„æ¨¡å¼åŒ¹é…ï¼Œè¿™åŒ…æ‹¬å…ƒç»„ã€èŒƒå›´åŒ¹é…ä»¥åŠå…³è”æšä¸¾å€¼ç­‰ã€‚
  - æ— éœ€ `break`ï¼šåœ¨å…¶ä»–ç¼–ç¨‹è¯­è¨€ä¸­ï¼Œå¦‚`C`è¯­è¨€æ¯ä¸ª `case` åé¢éƒ½éœ€è¦æ·»åŠ  `break` å…³é”®å­—ä»¥é€€å‡º `switch` å¦åˆ™å°†ä¼šå‘ç”Ÿè´¯ç©¿ç°è±¡ã€‚åœ¨ `Swift` ä¸­æ¯ä¸ªcaseåé¢ä¸éœ€è¦æ·»åŠ  `break`ï¼Œå½“é‡åˆ°ç¬¦åˆçš„ `case` åç¨‹åºä¼šç›´æ¥é€€å‡º `switch` è¯­å¥ã€‚
  - ç»‘å®šå¸¸é‡å’Œå˜é‡ï¼šåœ¨ä¸€ä¸ª `case` çš„è¯­å¥ä¸­ï¼Œå¯ä»¥ç”¨ `let` æˆ–è€… `var` æ¥ç»‘å®šåŒ¹é…åˆ°çš„å€¼åˆ°ä¸´æ—¶çš„å¸¸é‡æˆ–å˜é‡ä¸­ã€‚

:::
    
  > åŒ¹é…æ¨¡å¼æ·±å…¥è¯´ä¸€ä¸‹ï¼Ÿ

### `Swift` ä¸­çš„ `String` çš„è®¾è®¡ç†å¿µ

  æ”¯æŒ `Unicode` å’Œå­—ç¬¦ä¸²æ“ä½œçš„å®‰å…¨æ€§ã€‚ä¸èƒ½ç›´æ¥ä½¿ç”¨ä¸‹æ ‡ç´¢å¼•è®¿é—®ï¼Œä½¿ç”¨ `String.Index` è¿›è¡Œå­—ç¬¦ä¸²çš„è®¿é—®å’Œæ“ä½œã€‚

### ğŸ“Œ `Swift` ä¸­ `Array`ã€`Dictionary`ã€`Set` ä¸ºä»€ä¹ˆè®¾è®¡æˆå€¼ç±»å‹ï¼Ÿ

::: details ğŸš©

  - è¯­ä¹‰æ¸…æ™°ï¼šå¯ä»¥ä½¿èµ‹å€¼çš„è¯­ä¹‰æ›´åŠ æ¸…æ™°ã€‚å½“ä½ æŠŠä¸€ä¸ªæ•°ç»„ï¼ˆæˆ–å­—å…¸ã€é›†åˆï¼‰èµ‹å€¼ç»™æ–°çš„å˜é‡æ—¶ï¼Œ`Swift` å®é™…ä¸Šä¼šå¤åˆ¶ä¸€ä»½è¿™ä¸ªæ•°ç»„ï¼Œè¿™æ„å‘³ç€æ–°å˜é‡å’Œæ—§å˜é‡ä¹‹é—´ä¸å­˜åœ¨ä»»ä½•å…³è”ï¼Œå¯¹å…¶ä¸­ä¸€ä¸ªçš„æ”¹åŠ¨ä¸ä¼šå½±å“åˆ°å¦ä¸€ä¸ªã€‚
  - çº¿ç¨‹å®‰å…¨ï¼šåœ¨æ¶‰åŠå¤šçº¿ç¨‹æ“ä½œçš„ç¯å¢ƒä¸­ï¼Œæ— éœ€æ‹…å¿ƒå¯¹æ•°ç»„ï¼ˆæˆ–å­—å…¸ã€é›†åˆï¼‰çš„ä¿®æ”¹ä¼šæ½œåœ¨åœ°å½±å“åˆ°å…¶ä»–çº¿ç¨‹ã€‚æœ‰åˆ©äºå‡å°‘ç”±ç«æ€æ¡ä»¶ï¼ˆrace conditionï¼‰å¯¼è‡´çš„é—®é¢˜ï¼Œå¹¶ä½¿å¾—ä»£ç æ›´åŠ å®‰å…¨ã€‚
  - æ€§èƒ½ä¼˜åŒ–ï¼šè™½ç„¶å€¼ç±»å‹åœ¨èµ‹å€¼æ—¶éœ€è¦å¤åˆ¶å…¶æ•°æ®ï¼Œä½† `Swift` é‡‡ç”¨äº†ä¸€ç§è¢«ç§°ä¸ºâ€œå†™æ—¶å¤åˆ¶â€ï¼ˆcopy-on-writeï¼‰çš„ä¼˜åŒ–ç­–ç•¥ã€‚åªæœ‰å½“æ•°æ®çœŸæ­£éœ€è¦è¢«æ”¹åŠ¨æ—¶ï¼Œ`Swift` æ‰ä¼šå¤åˆ¶ä¸€ä»½æ•°æ®ï¼Œé¿å…äº†ä¸å¿…è¦çš„å¤åˆ¶æ“ä½œã€‚

:::

###  ğŸ”— `cow` è®¾è®¡è¯´ä¸€ä¸‹ï¼Ÿ

::: details ğŸ’¡

  `cow` (Copy on Write) : Swift çš„å†™æ—¶æ‹·è´ï¼Œä¹Ÿå°±æ˜¯è¯´æ•°æ®åªæœ‰ç­‰åˆ°èµ‹å€¼ä¿®æ”¹æ—¶æ‰è¿›è¡Œæ‹·è´ï¼Œä¸»è¦åº”ç”¨åœ¨ç³»ç»Ÿè®¾è®¡çš„å€¼ç±»å‹(`String`ã€`Array`ã€`Dictionary`)

:::
  
  > `isKnownUniquelyReferenced` å®ç°è‡ªå®šä¹‰ç»“æ„ä½“ `Cow`
  
::: details ğŸ…°ï¸ğŸ’¡ğŸ’¡ğŸ’¡ğŸ”—
  
  `isKnownUniquelyReferenced` å‡½æ•°å¯ä»¥ç”¨æ¥æ£€æµ‹æ˜¯è¢«è¢«å¤šä¸ªå˜é‡å¼•ç”¨
  
  ```swift
  // æ•°æ®åŒ…è£…ç±»
  final class Wrapper<A> {
    var wrapper: A
    init(_ value: A) { 
        self.wrapper = value 
    }
  }
  struct MyArray {
    private var storage: Wrapper<[Int]>
    init() {
        storage = Box([1, 2, 3])
    }
    /// æ·»åŠ æ•°æ®
    mutating func append(_ item: Int) {
        // åˆ¤æ–­æ˜¯å¦ä¸ºå”¯ä¸€çš„å¼•ç”¨ï¼Œå¦‚æœä¸æ˜¯ï¼Œå…ˆåˆ›å»ºå‰¯æœ¬å¯¹è±¡ï¼Œåœ¨è¿›è¡Œæ·»åŠ ä¿®æ”¹
        if !isKnownUniquelyReferenced(&storage) {
            storage = Wrapper(storage.wrapper)
        }
        storage.wapper.append(item)
    }
  }
  ```
  
:::

### `inout` å…³é”®å­—åšäº†ä»€ä¹ˆï¼Ÿ

### `Swift` ä¸­çš„é—­åŒ…

  - é€ƒé€¸é—­åŒ… : é—­åŒ…ä½œä¸ºå‡½æ•°å‚æ•°ä¼ å…¥å‡½æ•°ï¼Œå¦‚æœè¿™ä¸ªé—­åŒ…åœ¨å‡½æ•°è¿”å›ä¹‹åå†æ‰§è¡Œï¼Œåˆ™ä¸ºé€ƒé€¸é—­åŒ…ï¼Œé—­åŒ…å‚æ•°éœ€è¦ä½¿ç”¨ `@escaping` ä¿®é¥°ã€‚
  - éé€ƒé€¸é—­åŒ… : é—­åŒ…ä½œä¸ºå‡½æ•°å‚æ•°ï¼Œåœ¨å‡½æ•°è¿”å›ä¹‹å‰ï¼Œè¿™ä¸ªé—­åŒ…å·²ç»æ‰§è¡Œï¼Œåˆ™ä¸ºéé€ƒé€¸é—­åŒ…ã€‚
  - å°¾éšé—­åŒ… : å°†é—­åŒ…ä½œä¸ºå‡½æ•°çš„æœ€åä¸€ä¸ªå‚æ•°ï¼Œå‡½æ•°è°ƒç”¨æ—¶ï¼Œé—­åŒ…å‚æ•°å°±æ˜¯ä¸€ä¸ªå†™åœ¨å°¾éšå‡½æ•°è°ƒç”¨åé¢çš„ä¸€ä¸ªé—­åŒ…è¡¨è¾¾å¼ã€‚
  - è‡ªåŠ¨é—­åŒ… : éœ€è¦ä¸€ä¸ªä¸æ¥å—å‚æ•°çš„é—­åŒ…ä½œä¸ºå‡½æ•°å‚æ•°ï¼Œä½¿ç”¨ `@autoclosure` ä¿®é¥°ã€‚ç”¨ä½œé—­åŒ…è¡¨è¾¾å¼çš„å»¶è¿ŸåŠ è½½ï¼Œåªæœ‰å½“é—­åŒ…è¡¨è¾¾å¼çœŸæ­£è°ƒç”¨æ—¶æ‰æ‰§è¡Œã€‚

### `Swift` å¯é€‰ç±»å‹ `Optional` è¯´ä¸€ä¸‹ç†è§£ï¼Ÿ

  > `Optional` å¯é€‰ç±»å‹çš„åº•å±‚å®ç°

  ```swift
  public enum Optional<Wrapped>: ExpressibleByNilLiteral {
    case none           // è¡¨ç¤ºæ²¡æœ‰å€¼ nil
    case some(Wrapped)  // è¡¨ç¤ºæœ‰å€¼
  }
  ```

###  `swift_once` æ˜¯ç”¨åœ¨ä»€ä¹ˆåœ°æ–¹çš„ï¼Ÿ

  `swift_once`æ˜¯Swiftçš„ä¸€ä¸ªå†…éƒ¨å‡½æ•°ï¼Œå®ƒæä¾›äº†ä¸€ç§çº¿ç¨‹å®‰å…¨çš„æ–¹å¼æ¥æ‰§è¡Œä¸€æ¬¡åˆå§‹åŒ–æˆ–è€…é…ç½®ä»£ç ã€‚ä¸ `Objective-C` ä¸­ `dispatch_once()` å®ç°ç±»ä¼¼çš„åŠŸèƒ½ã€‚
  
  åœ¨ `Swift` çš„åº•å±‚å®ç°å±‚é¢ï¼Œåƒç±»å‹å…ƒæ•°æ®çš„åˆå§‹åŒ–ã€é™æ€å˜é‡å’Œå…¨å±€å˜é‡çš„åˆå§‹åŒ–ã€é™æ€å±æ€§å’Œæ‡’æƒ°å±æ€§çš„åˆå§‹åŒ–ç­‰ï¼Œéƒ½æ˜¯ä½¿ç”¨`swift_once`æ¥ç¡®ä¿å®ƒä»¬çš„åˆå§‹åŒ–ä»£ç åªä¼šè¢«æ‰§è¡Œä¸€æ¬¡ã€‚

### `@propertyWrapper`ã€`@_functionBuilder`ã€`@dynamicMemberLookup`

  - `@propertyWrapper` : `Swift 5.1` å¼•å…¥äº†ä¸€é¡¹æ–°ç‰¹æ€§ï¼šå±æ€§åŒ…è£…å™¨ï¼ˆproperty wrappersï¼‰ã€‚å±æ€§åŒ…è£…å™¨æä¾›äº†ä¸€ç§å°†ç‰¹æ€§æ·»åŠ åˆ°å±æ€§ä¸Šçš„æ–°æ–¹æ³•ï¼Œä¾‹å¦‚çº¿ç¨‹å®‰å…¨ï¼Œæ‡’åŠ è½½ï¼Œé”®å€¼è§‚å¯Ÿï¼Œå­˜å‚¨åœ¨æ•°æ®åº“ä¸­ç­‰ï¼Œä»è€Œä½¿è¿™äº›å±æ€§æ›´æ˜“äºå¤ç”¨ã€‚ç®€å•æ¥è¯´ï¼Œå±æ€§åŒ…è£…å™¨å°±æ˜¯ä¸€ä¸ªå®šä¹‰äº†ç‰¹æ®Šè®¿é—®ç­–ç•¥çš„ç»“æ„æˆ–ç±»ï¼Œæˆ‘ä»¬å¯ä»¥å°†è¿™ä¸ªè®¿é—®ç­–ç•¥é™„åŠ åˆ°å±æ€§ä¸Šï¼Œè€Œä¸æ˜¯é‡æ–°å®ç°ç›¸åŒçš„è®¿é—®ç­–ç•¥ã€‚
  
  ```swift
  // å®šä¹‰å±æ€§åŒ…è£…å™¨
  @propertyWrapper
  struct HundredOrLess {
    private var score = 0
    var wrappedValue: Int {
        get { return score }
        set { score = min(newValue, 100) }
    }
  }
  // ä½¿ç”¨å±æ€§åŒ…è£…å™¨
  struct Grade {
    /// æ•°å­¦æˆç»©
    @HundredOrLess var math: Int
    /// ä½“è‚²æˆç»©
    @HundredOrLess var gym: Int
  }
  ```

  - `@_functionBuilder` : `Swift 5.1` å¼•å…¥äº†å‡½æ•°å»ºæ„å™¨ç‰¹æ€§ï¼Œç›®å‰è¿˜å¤„äºç§æœ‰é˜¶æ®µï¼Œæ•…ä»¥ _ å¼€å¤´ã€‚å‡½æ•°å»ºæ„å™¨åŠŸèƒ½ä¸»è¦ç”¨äºç®€åŒ–å¤§é‡æ ·æ¿ä»£ç ã€‚
  
  ```swift
  // SwiftUI 
  VStack(content: { 
    return Group { 
      Text("Hello") 
      Text("World") 
    } 
  })
  // @_functionBuilder å¯ä»¥ç®€åŒ–ä¸ºå¦‚ä¸‹å†™æ³•
  VStack { 
    Text("Hello") 
    Text("World") 
  }
  ```
  
  - `@dynamicMemberLookup` : `Swift 4.2` å¼•å…¥çš„ `@dynamicMemberLookup` ç‰¹æ€§ã€‚è¿™ç§æ–°ç‰¹æ€§å…è®¸æˆ‘ä»¬åˆ›å»ºè¢«åŠ¨æ€è°ƒç”¨çš„ç±»å‹ï¼Œå®ƒçš„å±æ€§å’Œæ–¹æ³•åœ¨ç¼–è¯‘æ—¶æ˜¯æœªçŸ¥çš„ï¼Œåªæœ‰åœ¨è¿è¡Œæ—¶æ‰ä¼šç¡®å®šã€‚è¿™å¯¹äºåˆ©ç”¨ `Swift` æ¥è°ƒç”¨ `Python`ï¼Œ`JavaScript`ï¼Œ`Ruby` å’Œå…¶ä»–åŠ¨æ€è¯­è¨€çš„ä»£ç éå¸¸æœ‰ç”¨ã€‚è¿™æ ·å¯ä»¥ä½¿å¾— `Swift` å…·æœ‰ä¸€å®šçš„åŠ¨æ€æ€§ï¼ŒåŒæ—¶åˆä¸å¤±ç±»å‹å®‰å…¨ã€‚

  ```swift
  @dynamicMemberLookup
  struct DynamicMember {
    let dictionary = ["dynamicMember": 110, "otherMember": 119]
    subscript(dynamicMember member: String) -> Int {
        return dictionary[member] ?? 114
    }
  }
  let member = DynamicMember()
  print(member.dynamicMember) // 110
  ```
  
## `function` - â€œå‡½æ•°â€

### `Swift` å‡½æ•°æ´¾å‘æœºåˆ¶

  - **ç›´æ¥æ´¾å‘ï¼ˆDirect Dispatchï¼‰**ï¼šç›´æ¥æ´¾å‘å‘ç”Ÿåœ¨å€¼ç±»å‹ï¼ˆæšä¸¾ã€ç»“æ„ä½“ï¼‰å’Œ `final` ç±»ä¸Šçš„æ–¹æ³•ã€å±æ€§å’Œä¸‹æ ‡ã€‚è¿™äº›æ“ä½œçš„æ´¾å‘æ˜¯åœ¨ç¼–è¯‘æ—¶æœŸå†³å®šçš„ï¼Œä¸å­˜åœ¨åŠ¨æ€æ´¾å‘çš„è¿‡ç¨‹ï¼Œä¸èƒ½è¢«è¦†ç›–ï¼Œæ‰§è¡Œæ•ˆç‡ä¹Ÿæ˜¯æœ€é«˜çš„ã€‚
  - **è™šè¡¨æ´¾å‘ï¼ˆVirtual Table Dispatchï¼‰**ï¼šè™šè¡¨æ´¾å‘å‘ç”Ÿåœ¨æ™®é€šç±»ï¼ˆé `final`ï¼‰ä¸Šçš„æ–¹æ³•ã€å±æ€§å’Œä¸‹æ ‡ã€‚è¿™äº›æ“ä½œçš„æ´¾å‘æ–¹å¼ç”± `Swift` ç¼–è¯‘å™¨åœ¨è¿è¡Œæ—¶é€šè¿‡è™šè¡¨ï¼ˆ`vtable`ï¼‰æ¥æŸ¥æ‰¾ã€‚è™šè¡¨æ˜¯ä¸€ç§åœ¨ç¼–è¯‘æ—¶æœŸç”Ÿæˆçš„ç”¨äºåŠ¨æ€æ´¾å‘å‡½æ•°çš„æ•°æ®ç»“æ„ï¼Œå­˜å‚¨äº†ç±»å‹çš„åŠ¨æ€ç±»å‹ä¿¡æ¯ã€‚
  - **è§è¯è¡¨æ´¾å‘ï¼ˆWitness Table Dispatchï¼‰**ï¼šè§è¯è¡¨æ´¾å‘å‘ç”Ÿåœ¨åè®®æ–¹æ³•ã€å±æ€§å’Œä¸‹æ ‡çš„æ“ä½œã€‚è¿™äº›æ“ä½œçš„æ´¾å‘æ–¹å¼ç”± `Swift` ç¼–è¯‘å™¨åœ¨è¿è¡Œæ—¶é€šè¿‡ä¸€ç§åä¸ºè§è¯è¡¨çš„ç±»ä¼¼äºè™šè¡¨çš„æœºåˆ¶ï¼ŒæŸ¥æ‰¾å¹¶è°ƒç”¨ç›¸åº”çš„å®ç°ã€‚è§è¯è¡¨åŒ…å«äº†åè®®çš„åŠ¨æ€ç±»å‹ä¿¡æ¯å’Œåè®®æ–¹æ³•çš„å®ç°ã€‚å¯¹äºå¸¦æœ‰ `where` å­å¥çš„åè®®æ‰©å±•æä¾›çš„é»˜è®¤å®ç°ï¼Œä¼šä¸ºç¬¦åˆä¸åŒæ¡ä»¶çš„ç±»å‹ç”Ÿæˆä¸åŒçš„è§è¯è¡¨ã€‚

### â€œ`Swift` ä¸­å‡½æ•°æ˜¯ç¬¬ä¸€ç­‰å…¬æ°‘â€è¿™å¥è¯ä½ æ˜¯æ€ä¹ˆç†è§£çš„ï¼Ÿ

  åŒå…¶å®ƒåŸºç¡€æ•°æ®ç±»å‹ä¸€æ ·ï¼Œå¯ä»¥è¿ç”¨åœ¨ä»¥ä¸‹åœºæ™¯

  - å‡½æ•°å¯ä»¥ä½œä¸ºå‚æ•°ä¼ é€’ç»™å…¶ä»–å‡½æ•°(é«˜é˜¶å‡½æ•°)ã€‚
  - å‡½æ•°å¯ä»¥ä½œä¸ºå…¶ä»–å‡½æ•°çš„è¿”å›å€¼ã€‚
  - å‡½æ•°å¯ä»¥èµ‹å€¼ç»™å˜é‡ã€‚
  - å‡½æ•°å¯ä»¥å­˜å‚¨åœ¨æ•°æ®ç»“æ„ä¸­ã€‚

### `Swift` å‡½æ•°å¼ç¼–ç¨‹ (å‡½å­ã€å•å­)

  > å‡½æ•°å¼ç¼–ç¨‹æ˜¯ä¸€ç§ç¼–ç¨‹èŒƒå¼ï¼Œå‡½å­ï¼ˆ`functor`ï¼‰å’Œå•å­ï¼ˆ`monad`ï¼‰æ˜¯å‡½æ•°å¼ç¼–ç¨‹ä¸­çš„æœ¯è¯­ã€‚
  
  - å‡½å­ : æ˜¯ä¸€ç§å¯ä»¥å°†æ‰€æœ‰çš„è¾“å…¥æ“ä½œæ˜ å°„åˆ°è¾“å‡ºæ“ä½œçš„å¯¹è±¡ã€‚åœ¨ `Swift` ä¸­ï¼Œæœ€å¸¸è§çš„å‡½å­å°±æ˜¯ `Array`, `map` æ–¹æ³•å°±æ˜¯ä¸€ä¸ªå…¸å‹çš„å‡½å­æ“ä½œã€‚
  - å•å­ : æ˜¯å‡½å­çš„ä¸€ä¸ªç‰¹ä¾‹ï¼Œæ»¡è¶³ä¸€äº›é¢å¤–æ¡ä»¶ã€‚å…·ä½“æ¥è¯´ï¼Œå®ƒéœ€è¦å®ç°ä¸¤ä¸ªæ–¹æ³•ï¼šä¸€ä¸ªæ˜¯ç”¨æ¥åˆ›å»ºå•å­çš„æ–¹æ³•ï¼Œå¦ä¸€ä¸ªæ˜¯ç”¨æ¥è¿æ¥ä¸¤ä¸ªå•å­çš„æ–¹æ³•ã€‚åœ¨ `Swift` ä¸­ï¼Œå¯¹äº `Array` æ¥è¯´ï¼Œåˆ›å»ºå•å­çš„æ–¹æ³•æ˜¯åˆå§‹åŒ–æ–¹æ³•ï¼Œè¿æ¥ä¸¤ä¸ªå•å­çš„æ–¹æ³•åŒæ ·æ˜¯ `flatMap`ã€‚

## `protocol` - â€œåè®®â€

### `Swift` ä¸­çš„åè®®ä¸ `OC` ä¸­åè®®çš„ç‰¹ç‚¹å’ŒåŒºåˆ«ï¼Ÿ

  - ç›¸åŒç‚¹ : åè®®åœ¨ `Swift` å’Œ `Objective-C` ä¸­éƒ½æ˜¯å®šä¹‰ä¸€ç»„ç‰¹å®šçš„æ–¹æ³•ã€å±æ€§æˆ–è€…å…¶å®ƒè¦æ±‚çš„å·¥å…·ã€‚å…¶ä»–ç±»ã€ç»“æ„ä½“æˆ–è€…æšä¸¾éƒ½å¯ä»¥éµå®ˆè¿™äº›åè®®ï¼Œå¹¶æä¾›è¿™äº›è¦æ±‚çš„å…·ä½“å®ç°ã€‚

  - ä¸åŒç‚¹
    * `Objective-C` ä¸­ï¼Œåè®®å¾€å¾€ç”¨äºå®ç°â€œå§”æ‰˜â€æ¨¡å¼ï¼Œå°¤å…¶æ˜¯åœ¨ UI ç¼–ç¨‹ä¸­ç»å¸¸ä½¿ç”¨ã€‚åè®®ä¸­åªèƒ½åŒ…å«æ–¹æ³•çš„å£°æ˜ã€‚
    * `Swift` ä¸­çš„åè®®æ›´åŠ å¼ºå¤§ã€‚

  `Swift` åè®®ï¼š

  - è¦æ±‚éµå¾ªåè®®çš„ç±»å‹æä¾›ç‰¹å®šåç§°å’Œç±»å‹çš„å®ä¾‹å±æ€§æˆ–è€…ç±»å‹å±æ€§
  - è¦æ±‚éµå¾ªåè®®çš„ç±»å‹æä¾›ç‰¹å®šåç§°å’Œç±»å‹çš„æ–¹æ³•ã€åˆå§‹åŒ–æ–¹æ³•ã€ä¸‹æ ‡æ“ä½œç¬¦
  - è¦æ±‚éµå¾ªåè®®çš„ç±»å‹æä¾›ç‰¹å®šçš„æ“ä½œç¬¦æ–¹æ³•
  - ä¸ºéµå¾ªåè®®çš„ç±»å‹æä¾›é»˜è®¤çš„æ–¹æ³•æˆ–è€…å±æ€§çš„å®ç°
  - å¯ä»¥å®šä¹‰ç±»å‹åˆ«å
  - å¯ä»¥ç»§æ‰¿å…¶å®ƒåè®®
  - å¯ä»¥åœ¨åè®®ä¸­ä½¿ç”¨å…³è”ç±»å‹ç­‰

### â€œé¢å‘åè®®ç¼–ç¨‹â€ è¯´è¯´ä½ çš„ç†è§£ï¼Ÿ

  - é¢å‘åè®®ç¼–ç¨‹çš„æ ¸å¿ƒæ€æƒ³ : å…ˆå®šä¹‰å‡ºæˆ‘ä»¬éœ€è¦çš„è¡Œä¸ºå’Œç‰¹æ€§ï¼Œç„¶åå†æ ¹æ®è¿™äº›è¦æ±‚æ¥ç¼–å†™å…·ä½“çš„å®ç°ï¼Œè€Œä¸æ˜¯å…ˆå†™å…·ä½“çš„ç±»å‹ç„¶åå†å»è€ƒè™‘å®ƒä»¬ä¹‹é—´çš„å…³ç³»ã€‚
  - é¢å‘åè®®ç¼–ç¨‹ä½¿å¾—æˆ‘ä»¬çš„ä»£ç æ›´åŠ çµæ´»å’Œå¯å¤ç”¨ã€‚ç”±äºåè®®çš„é»˜è®¤å®ç°å’Œå¤šåè®®ç»§æ‰¿ç­‰ç‰¹æ€§ï¼Œæˆ‘ä»¬èƒ½å¤Ÿè½»æ¾åœ°å®šä¹‰å‡ºè¡Œä¸ºå¤æ‚çš„ç±»å‹ï¼Œå¹¶ä¸”èƒ½å¤Ÿé€šè¿‡åè®®çš„ç»„åˆæ¥å®ç°æ›´ä¸ºå¼ºå¤§çš„åŠŸèƒ½ã€‚å¦å¤–ï¼Œåè®®ä¹Ÿä½¿å¾—æˆ‘ä»¬çš„ä»£ç è§£è€¦æ€§æ›´å¼ºï¼Œæ›´å®¹æ˜“è¿›è¡Œå•å…ƒæµ‹è¯•ã€‚

## `generic` - â€œæ³›å‹â€

### è¯­æ³•ç‰¹æ€§æ³›å‹ `@_specialize`

  > `@_specialize` æ˜¯ `Swift` ä¸­çš„ä¸€ä¸ªç‰¹æ®Šæ ‡è®°ç‰¹æ€§ï¼Œå®ƒç”¨äºæ”¹å˜ç¼–è¯‘å™¨å¦‚ä½•ç¼–è¯‘å’Œä¼˜åŒ–æ³›å‹å‡½æ•°ã€‚`@_specialize` å‘Šè¯‰ç¼–è¯‘å™¨ç”Ÿæˆç‰¹å®šç±»å‹å‚æ•°çš„ä¸“é—¨åŒ–ç‰ˆæœ¬çš„ä»£ç ã€‚

  ```swift
  // æ¯”è¾ƒä¸¤ä¸ª Comparable çš„å…ƒç´ å¹¶è¿”å›æœ€å°çš„ä¸€ä¸ª
  func min<T: Comparable>(_ x: T, _ y: T) -> T {
    return y < x ? y : x
  }

  // @_specialize ä¼˜åŒ–ï¼Œç”Ÿæˆä¸€ä¸ªä¸“é—¨å¤„ç† Int çš„ç‰ˆæœ¬
  @_specialize(where T == Int)
  func min<T: Comparable>(_ x: T, _ y: T) -> T {
    return y < x ? y : x
  }
  ```

### æ³›å‹ç±»å‹æ“¦é™¤å¦‚ä½•å®ç°ï¼Ÿ

  > æ³›å‹ç±»å‹æ“¦é™¤ : å°†å…·æœ‰ç‰¹å®šæ³›å‹ç±»å‹çº¦æŸçš„å¯¹è±¡è½¬åŒ–ä¸ºä¸€ä¸ªä¸å†å…·æœ‰ç‰¹å®šæ³›å‹ç±»å‹çš„å¯¹è±¡ï¼Œä½†ä»ç„¶ä¿æŒç›¸ä¼¼çš„è¡Œä¸ºã€‚
  
  æ³›å‹ç±»å‹æ“¦é™¤å¤„ç†ï¼Œä¸€èˆ¬æ˜¯é€šè¿‡å°†æ³›å‹ç±»å‹æˆ–å‡½æ•°åŒ…è£…åœ¨ä¸€ä¸ªéæ³›å‹ç±»å‹ä¸­æ¥è¾¾æˆçš„ã€‚
  
  ```swift 
  // åè®®
  protocol MyProtocol {}
  // å®ç° MyProtocol çš„æ³›å‹ç±»
  class MyGenericClass<T: MyProtocol> {}
  // å°†æ³›å‹ç±» MyGenericClass è¿›è¡Œç±»å‹æ“¦é™¤ï¼ŒåŒäº‹å…·å¤‡ MyProtocol çš„è¡Œä¸º
  class AnyMyGenericClass {
    private var _myClass: AnyObject
    init<T: MyProtocol>(_ myClass: MyGenericClass<T>) {
        _myClass = myClass
    }
  }
  ```

## `Codable`

 > `Codable`æ˜¯ä¸€ä¸ªç»„åˆåè®®ï¼Œå®ƒæ˜¯ `Decodable` å’Œ `Encodable` çš„ "æ··åˆåè®®"ï¼Œç”¨äºé€šç”¨åºåˆ—åŒ–å’Œååºåˆ—åŒ–çš„æƒ…å†µã€‚

### `Codable` å®ç°åŸç†

  åœ¨æ ‡å‡†åº“ä¸­ï¼Œå®šä¹‰äº†ä¸€ä¸ª `Decoder` åè®®ï¼Œä¸€èˆ¬è§£ç å™¨ï¼ˆæ¯”å¦‚ `JSONDecoder`ï¼‰éƒ½ä¼šéµå¾ªè¿™ä¸ªåè®®ã€‚ç›¸åº”åœ°ï¼Œè¿˜æœ‰ä¸€ä¸ª `Encoder` åè®®ï¼Œç¼–ç å™¨ï¼ˆå¦‚ `JSONEncoder`ï¼‰ä¼šéµå¾ªè¿™ä¸ªåè®®ã€‚

  å¯¹äºæ¯ä¸ªæ•°æ®ç±»å‹ï¼Œåªè¦å®ƒéµå¾ªäº† `Decodable` åè®®ï¼Œå°±å¯ä»¥è§£ç ï¼›éµå¾ªäº† `Encodable` åè®®ï¼Œå°±å¯ä»¥ç¼–ç ã€‚é€šè¿‡åè®®é»˜è®¤å®ç°ç¼–ç è§£ç ä»»åŠ¡ã€‚

  ```swift
  // è§£ç æ–¹æ³•
  init(from decoder: Decoder) throws
  // ç¼–ç æ–¹æ³•
  func encode(to encoder: Encoder) throws
  ```
  
## å¼‚æ­¥ç¼–ç¨‹

### `async/await`

  > `async/await`æ˜¯åœ¨ `Swift 5.5` æ–°å¼•å…¥çš„ä¸¤ä¸ªå…³é”®å­—ï¼Œä¸»è¦ç”¨äºç®€åŒ–ã€ç¾åŒ– `Swift` ä¸­çš„å¼‚æ­¥ä»»åŠ¡çš„ç¼–ç å’Œé˜…è¯»ã€‚

  `async/await` å¸¦æ¥äº†æ›´æ¸…æ™°ã€æ›´ç®€æ´çš„å¼‚æ­¥ç¼–ç¨‹æ¨¡å‹ã€‚è§£å†³äº†è¿‡å»å¤„ç†å¤šå¼‚æ­¥ä»»åŠ¡å›è°ƒåœ°ç‹±çš„é—®é¢˜ï¼Œå¯ä»¥å’ŒåŒæ­¥ä»£ç ä¸€æ ·é¡ºåºç¼–å†™ï¼Œå¤§å¤§æé«˜äº†ä»£ç çš„å¯è¯»æ€§å’Œå¯ç»´æŠ¤æ€§ã€‚

  - `async`ï¼šè¡¨ç¤ºä¸€ä¸ªå‡½æ•°ä¸ºå¼‚æ­¥å‡½æ•°ã€‚å¼‚æ­¥å‡½æ•°æ˜¯ä¸€ä¸ªå¯ä»¥åœ¨åå°è¿›ç¨‹è¿è¡Œè€Œä¸ä¼šé˜»å¡å½“å‰çš„è¿è¡Œè¿›ç¨‹ã€‚
  - `await`ï¼šé€šå¸¸åœ¨å¼‚æ­¥å‡½æ•°ä¸­è°ƒç”¨å¦ä¸€ä¸ªå¼‚æ­¥å‡½æ•°æ—¶ä½¿ç”¨ï¼Œä»¥è¡¨ç¤ºç­‰å¾…è¿™ä¸ªå¼‚æ­¥å‡½æ•°çš„æ‰§è¡Œç»“æœã€‚

  ```swift
  func fetchDataFromServer() async -> Data {
    ...
  }
  func processData() async {
    let data = await fetchDataFromServer() 
    ...
  }
  ```

### `Sendable` 

  > `Sendable` æ˜¯ `Swift 5.5` ä¸­ä¸å¹¶å‘ç›¸å…³çš„æ–°ç‰¹æ€§ä¹‹ä¸€ï¼Œæ˜¯ä¸€ä¸ªæ ‡è®°æ€§çš„åè®®ã€‚ç”¨äºè¡¨ç¤ºéµå¾ªè¯¥åè®®çš„ç±»å‹æ˜¯èƒ½å®‰å…¨åœ°å‘é€åˆ°å’Œæ¥æ”¶è‡ªåˆ«çš„å¹¶å‘ä¸Šä¸‹æ–‡ï¼ˆä¾‹å¦‚ï¼Œå¼‚æ­¥ä»»åŠ¡ã€actorï¼‰ã€‚

  ç±»å‹å¯ä»¥æ ‡è®° `Sendable` åè®®çš„ä¸¤ä¸ªæ¡ä»¶ï¼š

  - å€¼ç±»å‹ï¼ˆä¾‹å¦‚ï¼Œæšä¸¾ã€ç»“æ„ä½“
  - æ‰€æœ‰çš„å­˜å‚¨å±æ€§ï¼ˆåŒ…æ‹¬é€’å½’åœ°ï¼‰éƒ½æ˜¯ `Sendable`

  ```swift
  // ç›´æ¥éµå¾ª Sendable åè®®
  struct Point: Sendable {
    let x: Double
    let y: Double
  }

  // æ‰©å±•éµå¾ª Sendable åè®®
  struct Point {
    let x = Double
    let y = Double
  }
  extension Point: Sendable {}
  ```

  > `class` ç±»å‹å¯ä»¥æ ‡è®°ä¸º `Sendable` å—ï¼Ÿ

  `class` å¹¶ä¸æ˜¯å€¼ç±»å‹ï¼Œå› æ­¤ä¸èƒ½ç›´æ¥è®© `class` éµä» `Sendable` åè®®ã€‚ä½†æ˜¯å¯ä»¥é€šè¿‡ `@unchecked Sendable` å±æ€§å¼ºåˆ¶è¡¨æ˜ `class` æ˜¯ `Sendable`ã€‚å¿…é¡»ä¿è¯è¿™ä¸ªç±»å‹æ˜¯ `class`ï¼Œåœ¨ä¼ é€’è¿™ä¸ªç±»çš„å®ä¾‹æ—¶ä»æ—§èƒ½ä¿è¯çº¿ç¨‹å®‰å…¨ã€‚

  `class`éµä» `Sendable` åè®®æ—¶å¿…é¡»å°å¿ƒï¼Œå› ä¸º `Sendable` è¦æ±‚éµå¾ªè¯¥åè®®çš„ç±»å‹æ˜¯çº¿ç¨‹å®‰å…¨çš„ã€‚å¦‚æœä¸èƒ½ä¿è¯çº¿ç¨‹å®‰å…¨ï¼Œä½¿ç”¨ `@unchecked Sendable` å¯èƒ½å¼•å‘éš¾ä»¥è°ƒè¯•çš„çº¿ç¨‹é—®é¢˜ã€‚
  