---
title: UIKit
icon: hashtag

index: true
order: 3

---

<!-- more -->

## `UIKit`

### â“ä½ äº†è§£çš„ `UIKit` ç»“æ„ï¼Ÿ

## `UIView`

### â“`UIView` vs `CALayer` ä¸ºä»€ä¹ˆè¦è¿™æ ·è®¾è®¡ï¼Ÿ

### â“`layoutSubviews` é‚£äº›æƒ…å†µä¸‹ä¼šè§¦å‘ï¼Ÿ

::: details ğŸ’¡

  > `layoutSubviews` åœ¨ iOS çš„ UIView çš„ç”Ÿå‘½å‘¨æœŸä¸­ï¼Œæ˜¯è´Ÿè´£å¸ƒå±€åŠæ’ç‰ˆå­è§†å›¾çš„æ–¹æ³•ã€‚

  - åœ¨åˆå§‹åŒ– `UIView` å¹¶æ·»åŠ åˆ°ç•Œé¢ä¸Šæ—¶ï¼Œç³»ç»Ÿä¼šè‡ªåŠ¨è°ƒç”¨ `layoutSubviews` æ–¹æ³•è¿›è¡Œå­è§†å›¾çš„å¸ƒå±€ã€‚
  - å½“ `UIView` çš„ `bounds` å‘ç”Ÿå˜åŒ–ï¼Œå¦‚æ”¹å˜å®½é«˜ã€æ—‹è½¬è®¾å¤‡æ—¶ï¼Œç³»ç»Ÿä¼šè°ƒç”¨ `layoutSubviews`ã€‚
  - å½“ç›´æ¥è°ƒç”¨ `UIView` çš„ `setNeedsLayout`æˆ–è€… `layoutIfNeeded` æ–¹æ³•æ—¶ï¼Œç³»ç»Ÿä¼šè°ƒç”¨ `layoutSubviews`ã€‚
    * `setNeedsLayout` ä¼šæ ‡è®°å½“å‰è§†å›¾è¢«æ ‡è®°ä¸ºéœ€è¦é‡æ–°å¸ƒå±€ï¼Œç„¶ååœ¨æ¥ä¸‹æ¥çš„æ›´æ–°å‘¨æœŸä¸­ï¼Œè°ƒç”¨ `layoutSubviews` å¯¹æ ‡è®°è¿›è¡Œé‡æ–°å¸ƒå±€
    * `layoutIfNeeded` åˆ™ä¼šç«‹å³å¯¹è§†å›¾è¿›è¡Œé‡æ–°å¸ƒå±€ï¼Œé€šå¸¸åœ¨åŠ¨ç”»çš„ `block` å†…ä½¿ç”¨
  - å½“è§†å›¾çš„æŸä¸ªå­è§†å›¾çš„ `frame` è¢«æ˜¾å¼åœ°ä¿®æ”¹ï¼Œä¹Ÿä¼šè§¦å‘çˆ¶è§†å›¾çš„ `layoutSubviews`ã€‚
  - æ·»åŠ æˆ–è€…åˆ é™¤å­è§†å›¾çš„æ—¶å€™ï¼Œä¹Ÿä¼šè§¦å‘çˆ¶è§†å›¾çš„ `layoutSubviews`ã€‚

:::

### â“æ ¹æ® `UIControl` å®ç° `UIButton`

## å±å¹•æ¸²æŸ“

::: details ğŸ’¡

  | æ¸²æŸ“ç±»å‹ | è¯´æ˜
  | --- | ---
  | CPU æ¸²æŸ“ | ç®€å•è§†å›¾ CPU æ¸²æŸ“å¯èƒ½é«˜äº GPU (ä¸éœ€è¦åˆ›å»ºç¼“å†²åŒºå’Œä¸Šä¸‹æ–‡åˆ‡æ¢)
  | GPU æ¸²æŸ“ | GPU æµ®ç‚¹è¿ç®—èƒ½åŠ›å¼ºäº CPUï¼Œæ‰€ä»¥ GPU æ¸²æŸ“æ•ˆç‡é«˜äº CPU

  * **å±å¹•æ¸²æŸ“**(On-Screen Rendering) : åœ¨å½“å‰å±å¹•çš„ç¼“å†²åŒºè¿›è¡Œæ¸²æŸ“ã€‚ä¼˜ç‚¹ï¼šä¸éœ€è¦åˆ›å»ºæ–°çš„ç¼“å­˜ï¼Œä¹Ÿä¸éœ€è¦è¿›è¡Œä¸Šä¸‹æ–‡åˆ‡æ¢ï¼Œæ€§èƒ½è¾ƒå¥½ï¼›ç¼ºç‚¹ï¼šç¼“å­˜å¤§å°å—é™åˆ¶ï¼Œæ— æ³•è¿›è¡Œå¤æ‚çš„æ“ä½œã€‚
  * **ç¦»å±æ¸²æŸ“**(Off-Screen Rendering) : GPU åœ¨å½“å‰å±å¹•å¤–ï¼Œæ–°å¼€è¾Ÿäº†ä¸€ä¸ªç¼“å†²åŒºè¿›è¡Œå›¾ç‰‡çš„æ¸²æŸ“å’Œåˆæˆã€‚æ¸²æŸ“å®Œæˆä¹‹åå†æ”¾å…¥å½“å‰å±å¹•çš„ç¼“å†²åŒºã€‚è¿™ä¸ªè¿‡ç¨‹éœ€è¦ CPU è°ƒåº¦ï¼Œå°†ä»»åŠ¡åˆ†é…ç»™ GPU è¿›è¡Œæ¸²æŸ“ç„¶åå†å°†æ¸²æŸ“ç»“æœè¿”å›ï¼Œéœ€è¦è¿›è¡Œä¸Šä¸‹æ–‡åˆ‡æ¢å’Œå†…å­˜è¯»å†™ç­‰æ“ä½œï¼Œå¯¹æ€§èƒ½å½±å“è¾ƒå¤§ã€‚
  
:::
  
### â“å“ªäº›åœºæ™¯å¯ä»¥è§¦å‘ç¦»å±æ¸²æŸ“ï¼Ÿ
  
::: details ğŸ’¡
  
  * åœ†è§’ `layer.masksToBounds = YES & layer.cornerRadius > 0`
  * å›¾å±‚è’™ç‰ˆ `layer.mask`
  * é˜´å½± `layer.shadowXXX (é™¤ shadowPath)`
  * å…‰æ …åŒ– `layer.shouldRasterize = YES`
  * æŠ—é”¯é½¿ `antialiasing`
  * ä¸é€æ˜ `opacity`

:::

## event dispatch - â€œäº‹ä»¶åˆ†å‘â€

### â“ç”¨æˆ·ç‚¹å‡»å±å¹•ä¸ŠæŒ‰é’®ï¼Œæ•´ä¸ªè¿‡ç¨‹è®²ä¸€ä¸‹ï¼Ÿ
