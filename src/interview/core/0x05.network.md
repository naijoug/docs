---
title: network - “网络”
icon: hashtag

index: true

---

<!-- more -->

## TCP

### `TCP/IP` 五层模型

1. 应用层 : `DNS`、`HTTP`、`HTTPS`、`RPC`、`P2P` (`DHCP`、`RTMP`、`GTP`)
    > `OSI` 七层模型中，将应用层细分为(应用层、表示层、会话层)
    * 表示层 : 
    * 会话层 : 
2. 传输层 : `TCP`、`UDP`、`QUIC`
3. 网络层 : (IP 层) `IP` (`ICMP`、`OSPF`、`BGP`、`IPSec`、`GRE`)
4. 链路层 : (MAC 层) `ARP`、`VLAN`、`STP`
5. 物理层 : 网络跳线

### `TCP` vs `UDP`
  
> `TCP` 特点
  
  * 可靠性 : 通过确认应答、超时重传等机制保证数据的可靠传输。
  * 有序性 : 通过数据序号来保证数据有序，传输完成后通过排序来保证数据的正确性。
  * 双全工 : 通信双方(服务端和客户端)都具备发送和接受数据的能力。(三次握手来保证)
  
> `UDP` 特点

  * 不可靠 : 通信通信双方不需要建立连接，不能保证数据准确送达。
  * 无序性 : 每次发送的数据包相互独立，没有特定的顺序。
  * 速度快 : 由于数据包结构简单，保证的 `UDP` 传输速度优于 `TCP`
  
  一些游戏、直播和需要低延迟实时性要求较高的应用，会使用 `UDP`。
  
> `TCP` 的 `keepalive` 机制

  `keepalive` 顾名思义是否还活着，是一种心跳检测机制。用于判断连接方是否还处于活动状态，以便断开已经失活连接释放资源。发送探测包后，如果处于活动状态，接收方会发送确认信号；如果处于失活状态，则会再连续再发送几次探测包如果均无响应则证明对方已断开连接，可以释放资源。
  
  需要注意的一点是，这个 `keepalive` 机制的时长一般默认为 2 小时。所以，不能使用使用该机制来确认实时性较高的保活探测。

### 全双工和半双工模式是什么？

### `TCP` 三次握手第三次丢失会怎么样?

### 为什么要四次挥手?

### 访问一个网站的详细过程?

### 解释下 `TCP` 的慢启动特性?

### 什么情况下发送方的滑动窗口会后移？

::: details 💡

  > `TCP` 发送方的滑动窗口 : 用来控制网络通信流量和确保信息可靠传输的一种机制。防止网络拥塞，确保在有限的网络带宽中，数据能够被高效、有序、可靠地传输。

  滑动窗口后移的两种情况

  - 当接收到确认(`ACK`)消息时
    > 当发送方接收到接收方发送的确认消息(`ACK`)，说明发送方发送的数据已经被接收方正确接收，此时发送方的滑动窗口的左边界会按照收到的确认信息进行移动。相应地，滑动窗口的右边界也会移动，使窗口大小保持不变。这样可以控制发送方继续发送未被确认的数据，或者发送新的数据。

  - 当窗口内数据全部被确认时
    > 如果滑动窗口中的所有数据都已经被接收方确认接收，那么滑动窗口会往右移动，来为新的数据腾出空间。

:::

### ❓`MTU` 了解吗？

::: details 💡

  > `MTU`(Max Transfer Unit)：最大传输单元，指的是网络中一种协议可以在不进行分片的情况下发送的最大数据包大小。

  在网络中，数据包的大小不能超过 `MTU` 大小，否则在发送过程中数据包会被分片。`MTU` 大小的设置取决于发送这些数据包的物理媒介或者网络协议。
  
  > 例如，在以太网中，`MTU` 的大小通常设置为 `1500` 字节。

  当数据包在网络中传输时，可能会经过不同的网络设备，这些设备可能有各自的 `MTU` 大小。为了避免数据包被分片，或者减少数据包的分片次数，路由器和其他网络设备可能采用最小 `MTU`（所有设备中 `MTU` 最小的值）进行发送。

  - 过大的 `MTU`：会导致数据包在传输过程中过于庞大，增大网络负担和延迟。
  - 过小的 `MTU`：会使得数据包过小，分片过多，影响网络效率。

  > 例如：`POST` 请求增加 `Content-Length` 参数后，数据传输过大时可能导致 `Broken pipe` 报错，调整 `MTU` 值可以解决这个问题。 

:::

### 如果手机应用与服务器通过 `TCP` 连接，这个时候手机切换为飞行模式，服务器可以短时间内知道到手机离线状态吗？

::: details 💡

  服务器通过 `TCP` 短时间内是不能知晓手机的离线状态的。因为 `TCP` 主要是为了保证数据的可靠传输，通信双方是通过数据交换来了解对方状态。而 `TCP` 并没有设计心跳检测机制，所有就没有实时检测对方是否离线的能力。
  
:::

### 在高宽带、高丢包的情况下，怎么保证 `TCP` 的性能？



### 有人认为 `TCP` 一定比 `UDP` 更快，你怎么认为？

### 为什么视频会议用 `UDP`？

### 用 `UDP` 实现音视频，有什么方法可以保证通话质量？

### 如果用 `TCP` 实现音视频，需要建立几次连接？

### 在整个视频面试的过程中，可能会用到哪些协议，都在哪几层？

------

## `HTTP`

### 为什么说 `HTTP` 是无状态的？

### 三次握手可以携带数据吗？

### `HTTP` vs `HTTPS`

  `HTTP`: 是基于 `TCP/IP` 通信协议的一种数据传输协议。
  `HTTPS` : `= HTTP + SSL`，在 `HTTP` 协议的基础加上了加密处理。

### ❓`HTTP` 中 `GET`、`POST` 区别

### `HTTP` 中的 `POST` 请求的 `body` 体使用 `form-urlencoded` 和 `multipart/form-data` 的区别？

### `POST` 请求参数能放在 `URL` 中吗？

### `GET` 请求参数一定是放在 `URL` 中的吗？

### 如何用 `HTTP` 实现长连接？

### `HTTP2.0` 针对同一个域名的多个请求，会建立多少个 `TCP` 连接？

### ❓`HTTP` 各个版本的区别

::: details 💡

  * `HTTP` 1.0 : 最早期版本，每次请求都会重新创建 `TCP` 的连接的创建和释放，造成极大的资源消耗。属于“非持续性连接”。
  * `HTTP` 1.1 : 改善了 1.0 版本的问题，修正为“持续性连接”。一次 `TCP` 连接可以发送多个请求和回复。引入 `pipeline` (管道)机制，可以同时发送多个请求，但是响应会按照请求队列的先后顺序进行，被称为“队头阻塞”问题。
  * `HTTP` 2.0 : 优化了传输数据格式(1.x 文本 -> 二进制)，减少了解析复杂度和提升传输速度。通过多路复用机制，解决了 1.0 “队头阻塞” 的问题，一次连接可以同时进行多个请求和响应。头信息压缩处理，减少数据体积。添加了服务器推送功能。
  * `HTTP` 3.0 : 开发中... `TCP` -> `QUIC`

:::

### `HTTPS` 比起 `HTTP` 有什么缺陷？

### `SSL` 证书除了压缩加密，还有什么别的用处？

### `HTTP` 断点续传涉及到哪些字段？怎么确保分片全部传输完后，文件的完整性和无篡改？

### 如何设计一个 `HTTPS` 抓包？

### 说说为什么要设计 304 这个状态码？

::: details

HTTP 304状态码也被称作"Not Modified"，即“未被修改”。当客户端发送一个带有 If-Modified-Since 或 If-None-Match 头的条件请求时，服务器可以使用这个状态码来告知客户端，自从上次获取资源以来，资源没有任何改变，所以客户端可以继续使用它的本地拷贝。

设计304状态码的主要原因有两个：

1. 提高效率：如果资源自上次获取以来没有发生改变，那么重新发送该资源显然是一种浪费，特别是对于大型资源（如图像、视频、大型CSS或JavaScript文件）而言。304状态码让服务器有可能仅仅通过发送一个小的HTTP头来满足请求，这显著减少了数据量，节省了带宽，提高了响应速度。

2. 减少服务器负载：对于很多动态生成的资源（比如基于数据库的网页内容），每次请求都生成和发送新资源可能会给服务器带来很大的计算负担，通过发送一个304状态，服务器可以避开这个负担。

综上所述，304状态码为了提高Web性能，优化用户体验，减少服务器负载而设计。

:::

### HTTP 状态码，2XX，3XX，4XX，5XX分别代表什么？ 

::: details

HTTP状态码是服务器在处理客户端请求时对该请求的响应状态进行标识的一种方式。下面是关于2XX, 3XX, 4XX, 5XX的简单解释：

1. 2XX（成功）- 表示成功处理了请求的状态码。如：
    - 200 OK，表示请求成功。
    - 201 Created，表示已创建成功。
    - 204 No Content，表示处理成功，但无需返回内容。

2. 3XX（重定向）- 表示需要客户端进行额外操作的状态码。如：
    - 301 Moved Permanently，表示资源已被永久移动。
    - 302 Found，表示资源临时移动。
    - 304 Not Modified，表示资源未更改(缓存)。

3. 4XX（客户端错误） - 表示客户端请求有错误的状态码。如：
    - 400 Bad Request，表示请求格式错误。
    - 401 Unauthorized，表示请求未被授权。
    - 404 Not Found，表示请求的资源不存在。

4. 5XX（服务器错误） - 表示服务器在处理请求时发生错误的状态码。如：
    - 500 Internal Server Error，表示服务器内部错误。
    - 502 Bad Gateway，表示网关错误。
    - 503 Service Unavailable，表示服务器当前无法处理请求。

这些状态码为客户端和服务器之间的通信提供了一种简洁、标准化的方式来表示请求的处理结果。

:::

### 在北京 `HTTP` 请求服务器响应快，可能离服务器距离近；而在上海访问就非常慢，会是什么原因？如果用户投诉，怎么分析这个问题？

::: details

当在某个地点访问服务器比其他地点慢时，可能的原因有很多，可能是网络带宽问题，也可能是路由问题，甚至可能是硬件问题。如果用户进行投诉，可以按照以下步骤分析：

1. 网络状况检测：首先可以进行一些基础的网络性能测试，比如 Ping 和 Traceroute，用来检测数据包到达服务器所需的时间以及经过的节点。Ping 可以查看网络延迟，Traceroute 可以看到数据包到达服务器所经过的所有路由节点。如果发现某一跳的延迟特别高，可能就是出问题的地方。

2. CDN 是否使用：如果服务器使用了内容分发网络 (CDN)，检查 CDN 是否在有问题的地方正常工作。CDN 运营商通常会在全国各地设立节点，如果某个地方的节点出现问题，可能会导致该地区的访问速度变慢。

3. 带宽查看：查看服务器的带宽使用情况，如果带宽使用过高，可能会导致访问速度变慢。

4. 服务器性能查看：分析服务器性能指标，如CPU使用率、内存使用情况、I/O等，如果服务器负载过高，可能会影响服务的响应时间。
   
5. 投诉用户所在网络环境分析：了解投诉用户的网络环境，如网络运营商，网络类型（光纤、ADSL、4G等），或者在其他网络环境下访问情况，以排除是用户本身网络原因导致的问题。

6. 应用层面的检查：除了硬件和网络，还要检查应用层面，比如你的服务器是不是出现了错误、是否有大量的请求等。

最后，如果问题还是无法定位，或者是跨越多个网络运营商的问题，则需要与网络服务提供商进行沟通，他们可能能提供更多的信息或者解决方案。

:::

------

## DNS

### 为什么能通过一个 `URL` 就能请求到对应的资源？

### `DNS` 是什么？

### `DNS` 解析过程？

### `DNS` 为什么用 `UDP`，为什么不用 `TCP`？

------

## Socket

### ❓`Socket` 了解吗？

------

## IP

### 除了好记以外，为什么要用域名访问服务器，直接用 `IP` 不行吗？

### 判断一个字符串是不是 `IPv6` 地址？

------

## 抓包

### `Charles` 抓包软件的原理

::: details 💡

  可以将它理解成中间人攻击。客户端将 `Charles` 作为代理服务器(中间人)。客户端所有请求都会先发送给 `Charles`，`Charles` 再将客户端的请求转发给服务器。`Charles` 收到服务器响应之后，再将从服务器收到的回复内容转发给客户端。这样请求和响应数据都被 `Charles` 记录下来，再通过界面展示即可。
  
  对于 `HTTP` 相对来说比较简单，直接进行接收和转发即可。而 `HTTPS` 中涉及 `CA` 认证，所以客户端需要进行的操作信任 `Charles` 的证书，这样通过 `Charles` 发送给客户端的公钥就可以通过这个证书校验成功，从而完成通信。

:::

### 不使用 `Charles`，`4G` 网络如何抓包？

### 为什么 `Wireshark` 不能直接抓取 `SSL` 的原始数据？

### 抓包工具抓取 `HTTPS` 的原理？

------

## 其它知识点

### `Ping` 是什么协议？

### 打开浏览器，输入网址到看到网站首页都经历那些过程？你觉得最耗时是哪里，怎么优化？

### ❓`Cookie` vs `Session`

### 网络模型了解么？有哪几种？说说你的看法？

### 流量控制和拥塞避免的区别？

### 使用 `ssh` 连接云服务器，整个网络通信过程？

### 如果发现微信和 QQ 都可以正常使用，但是浏览器网页打不开，可能是什么原因，有什么排查的办法？

