---
title: React
icon: hashtag

index: true

---

<!-- more -->

## ç»„ä»¶

### â“å‡½æ•°ç»„ä»¶ä¸ç±»ç»„ä»¶æœ‰ä»€ä¹ˆåŒºåˆ«

::: details ğŸ’¡

å‡½æ•°ç»„ä»¶ä¸ç±»ç»„ä»¶çš„ä¸»è¦åŒºåˆ«å¦‚ä¸‹ï¼š

1. **è¯­æ³•**ï¼šå‡½æ•°ç»„ä»¶æ˜¯ä¸€ä¸ªç®€å•çš„JavaScriptå‡½æ•°ï¼Œè€Œç±»ç»„ä»¶éœ€è¦ç»§æ‰¿è‡ª`React.Component`ã€‚
2. **çŠ¶æ€ç®¡ç†**ï¼šç±»ç»„ä»¶å¯ä»¥ä½¿ç”¨`this.state`å’Œ`this.setState`æ¥ç®¡ç†çŠ¶æ€ï¼Œè€Œå‡½æ•°ç»„ä»¶é€šå¸¸ä½¿ç”¨React Hooksï¼ˆå¦‚`useState`ï¼‰æ¥ç®¡ç†çŠ¶æ€ã€‚
3. **ç”Ÿå‘½å‘¨æœŸæ–¹æ³•**ï¼šç±»ç»„ä»¶å¯ä»¥ä½¿ç”¨ç”Ÿå‘½å‘¨æœŸæ–¹æ³•ï¼ˆå¦‚`componentDidMount`ã€`componentDidUpdate`ç­‰ï¼‰ï¼Œè€Œå‡½æ•°ç»„ä»¶é€šè¿‡`useEffect` Hookæ¥å®ç°ç±»ä¼¼çš„åŠŸèƒ½ã€‚
4. **æ€§èƒ½**ï¼šå‡½æ•°ç»„ä»¶é€šå¸¸æ¯”ç±»ç»„ä»¶æ›´è½»é‡ï¼Œä¸”åœ¨Reactçš„åç»­ç‰ˆæœ¬ä¸­ï¼Œå‡½æ•°ç»„ä»¶çš„æ€§èƒ½å¾—åˆ°äº†æ˜¾è‘—æå‡ã€‚
5. **ä»£ç ç®€æ´æ€§**ï¼šå‡½æ•°ç»„ä»¶é€šå¸¸æ›´ç®€æ´ï¼Œæ˜“äºç†è§£å’Œç»´æŠ¤ã€‚

éšç€Reactçš„å‘å±•ï¼Œå‡½æ•°ç»„ä»¶å’ŒHookså·²ç»æˆä¸ºç¼–å†™Reactç»„ä»¶çš„é¦–é€‰æ–¹å¼ã€‚

:::

### â“Reactä¸­çš„å—æ§ç»„ä»¶å’Œéå—æ§ç»„ä»¶æ˜¯ä»€ä¹ˆ

::: details ğŸ’¡

**å—æ§ç»„ä»¶**å’Œ**éå—æ§ç»„ä»¶**æ˜¯Reactä¸­å¤„ç†è¡¨å•è¾“å…¥çš„ä¸¤ç§æ–¹å¼ï¼š

1. **å—æ§ç»„ä»¶**ï¼š
   - è¡¨å•æ•°æ®ç”±Reactç»„ä»¶çš„stateæ§åˆ¶
   - æ¯å½“è¾“å…¥å€¼å˜åŒ–æ—¶ï¼Œéƒ½ä¼šè°ƒç”¨onChangeç­‰äº‹ä»¶å¤„ç†å‡½æ•°æ›´æ–°state
   - è¡¨å•çš„å½“å‰å€¼å­˜å‚¨åœ¨ç»„ä»¶stateä¸­ï¼Œè€Œä¸æ˜¯DOMå…ƒç´ ä¸­
   - æ›´å®¹æ˜“å®ç°è¡¨å•éªŒè¯å’Œç¦ç”¨æäº¤æŒ‰é’®ç­‰åŠŸèƒ½
   - ç¤ºä¾‹ï¼š
     ```jsx
     function ControlledForm() {
       const [value, setValue] = useState('');
       
       return (
         <input 
           value={value} 
           onChange={(e) => setValue(e.target.value)} 
         />
       );
     }
     ```

2. **éå—æ§ç»„ä»¶**ï¼š
   - è¡¨å•æ•°æ®ç”±DOMæœ¬èº«å¤„ç†
   - ä½¿ç”¨refè·å–è¡¨å•å€¼ï¼Œè€Œä¸æ˜¯é€šè¿‡äº‹ä»¶å¤„ç†å‡½æ•°
   - ä¸éœ€è¦ä¸ºæ¯ä¸ªçŠ¶æ€æ›´æ–°ç¼–å†™äº‹ä»¶å¤„ç†å‡½æ•°
   - é€‚åˆç®€å•çš„è¡¨å•æˆ–ä¸éReactä»£ç é›†æˆ
   - ç¤ºä¾‹ï¼š
     ```jsx
     function UncontrolledForm() {
       const inputRef = useRef(null);
       
       function handleSubmit() {
         console.log(inputRef.current.value);
       }
       
       return (
         <input ref={inputRef} defaultValue="é»˜è®¤å€¼" />
       );
     }
     ```

é€‰æ‹©ä½¿ç”¨å“ªç§æ–¹å¼å–å†³äºå…·ä½“éœ€æ±‚ï¼Œä½†Reactå®˜æ–¹æ¨èä½¿ç”¨å—æ§ç»„ä»¶ï¼Œå› ä¸ºå®ƒä»¬æ›´ç¬¦åˆReactçš„æ•°æ®æµç†å¿µã€‚

:::

### â“å¦‚ä½•åœ¨Reactä¸­å®ç°ç»„ä»¶é€šä¿¡

::: details ğŸ’¡

Reactç»„ä»¶ä¹‹é—´æœ‰å¤šç§é€šä¿¡æ–¹å¼ï¼š

1. **çˆ¶ç»„ä»¶å‘å­ç»„ä»¶é€šä¿¡**ï¼šé€šè¿‡propsä¼ é€’æ•°æ®
   ```jsx
   function Parent() {
     const data = "Hello from parent";
     return <Child message={data} />;
   }
   
   function Child({message}) {
     return <p>{message}</p>;
   }
   ```

2. **å­ç»„ä»¶å‘çˆ¶ç»„ä»¶é€šä¿¡**ï¼šé€šè¿‡å›è°ƒå‡½æ•°
   ```jsx
   function Parent() {
     const handleChildData = (data) => {
       console.log("ä»å­ç»„ä»¶æ”¶åˆ°:", data);
     };
     
     return <Child onSendData={handleChildData} />;
   }
   
   function Child({onSendData}) {
     return (
       <button onClick={() => onSendData("å­ç»„ä»¶æ•°æ®")}>
         å‘é€æ•°æ®åˆ°çˆ¶ç»„ä»¶
       </button>
     );
   }
   ```

3. **å…„å¼Ÿç»„ä»¶é€šä¿¡**ï¼šé€šè¿‡å…±åŒçš„çˆ¶ç»„ä»¶ä½œä¸ºä¸­ä»‹
   ```jsx
   function Parent() {
     const [data, setData] = useState("");
     
     return (
       <>
         <SiblingA onSendData={setData} />
         <SiblingB receivedData={data} />
       </>
     );
   }
   ```

4. **è·¨å±‚çº§ç»„ä»¶é€šä¿¡**ï¼š
   - ä½¿ç”¨Context API
     ```jsx
     const DataContext = createContext();
     
     function DataProvider({children}) {
       const [data, setData] = useState("å…±äº«æ•°æ®");
       
       return (
         <DataContext.Provider value={{data, setData}}>
           {children}
         </DataContext.Provider>
       );
     }
     
     function DeepChild() {
       const {data} = useContext(DataContext);
       return <p>{data}</p>;
     }
     ```
   
   - ä½¿ç”¨çŠ¶æ€ç®¡ç†åº“å¦‚Reduxæˆ–MobX

5. **å…¨å±€äº‹ä»¶**ï¼šä½¿ç”¨è‡ªå®šä¹‰äº‹ä»¶æˆ–ç¬¬ä¸‰æ–¹äº‹ä»¶åº“

é€‰æ‹©å“ªç§é€šä¿¡æ–¹å¼å–å†³äºç»„ä»¶çš„å…³ç³»å’Œåº”ç”¨çš„å¤æ‚åº¦ã€‚å¯¹äºç®€å•åº”ç”¨ï¼Œpropså’Œå›è°ƒé€šå¸¸è¶³å¤Ÿï¼›å¯¹äºå¤æ‚åº”ç”¨ï¼ŒContextæˆ–çŠ¶æ€ç®¡ç†åº“å¯èƒ½æ›´åˆé€‚ã€‚

:::

## ç”Ÿå‘½å‘¨æœŸ

### â“Reactç»„ä»¶çš„ç”Ÿå‘½å‘¨æœŸæœ‰å“ªäº›é˜¶æ®µ

::: details ğŸ’¡

Reactç±»ç»„ä»¶çš„ç”Ÿå‘½å‘¨æœŸå¯ä»¥åˆ†ä¸ºä¸‰ä¸ªä¸»è¦é˜¶æ®µï¼š

1. **æŒ‚è½½é˜¶æ®µ(Mounting)**ï¼šç»„ä»¶è¢«åˆ›å»ºå¹¶æ’å…¥DOM
   - `constructor()` - åˆå§‹åŒ–stateå’Œç»‘å®šæ–¹æ³•
   - `static getDerivedStateFromProps()` - æ ¹æ®propsæ›´æ–°state
   - `render()` - æ¸²æŸ“ç»„ä»¶
   - `componentDidMount()` - ç»„ä»¶æŒ‚è½½åæ‰§è¡Œï¼Œé€‚åˆè¿›è¡ŒAPIè°ƒç”¨ã€è®¢é˜…ç­‰

2. **æ›´æ–°é˜¶æ®µ(Updating)**ï¼šç»„ä»¶é‡æ–°æ¸²æŸ“ï¼Œå¯ç”±propsæˆ–stateå˜åŒ–è§¦å‘
   - `static getDerivedStateFromProps()` - åŒä¸Š
   - `shouldComponentUpdate()` - å†³å®šç»„ä»¶æ˜¯å¦éœ€è¦é‡æ–°æ¸²æŸ“
   - `render()` - é‡æ–°æ¸²æŸ“ç»„ä»¶
   - `getSnapshotBeforeUpdate()` - åœ¨DOMæ›´æ–°å‰æ•è·ä¸€äº›ä¿¡æ¯
   - `componentDidUpdate()` - ç»„ä»¶æ›´æ–°åæ‰§è¡Œï¼Œå¯ä»¥è¿›è¡ŒDOMæ“ä½œæˆ–ç½‘ç»œè¯·æ±‚

3. **å¸è½½é˜¶æ®µ(Unmounting)**ï¼šç»„ä»¶ä»DOMä¸­ç§»é™¤
   - `componentWillUnmount()` - ç»„ä»¶å¸è½½å‰æ‰§è¡Œï¼Œç”¨äºæ¸…ç†å·¥ä½œå¦‚å–æ¶ˆè®¢é˜…ã€å®šæ—¶å™¨ç­‰

**é”™è¯¯å¤„ç†**ï¼š
- `static getDerivedStateFromError()` - æ¸²æŸ“å¤‡ç”¨UI
- `componentDidCatch()` - è®°å½•é”™è¯¯ä¿¡æ¯

**æ³¨æ„**ï¼šä»¥ä¸‹ç”Ÿå‘½å‘¨æœŸæ–¹æ³•å·²è¢«æ ‡è®°ä¸ºè¿‡æ—¶ï¼Œåº”é¿å…ä½¿ç”¨ï¼š
- `componentWillMount()`
- `componentWillReceiveProps()`
- `componentWillUpdate()`

åœ¨å‡½æ•°ç»„ä»¶ä¸­ï¼Œå¯ä»¥ä½¿ç”¨Hooksï¼ˆå¦‚`useEffect`ï¼‰æ¥æ¨¡æ‹Ÿç”Ÿå‘½å‘¨æœŸè¡Œä¸ºï¼š
```jsx
// æ¨¡æ‹ŸcomponentDidMount
useEffect(() => {
  // æ‰§è¡Œå‰¯ä½œç”¨
  return () => {
    // æ¸…ç†å‡½æ•°ï¼Œæ¨¡æ‹ŸcomponentWillUnmount
  };
}, []); // ç©ºä¾èµ–æ•°ç»„è¡¨ç¤ºåªåœ¨æŒ‚è½½å’Œå¸è½½æ—¶æ‰§è¡Œ

// æ¨¡æ‹ŸcomponentDidUpdate
useEffect(() => {
  // å½“ä¾èµ–é¡¹å˜åŒ–æ—¶æ‰§è¡Œ
}, [dependency1, dependency2]);
```

:::

### â“componentDidMountå’ŒuseEffectæœ‰ä»€ä¹ˆåŒºåˆ«

::: details ğŸ’¡

`componentDidMount`å’Œ`useEffect`éƒ½ç”¨äºå¤„ç†å‰¯ä½œç”¨ï¼Œä½†æœ‰å‡ ä¸ªé‡è¦åŒºåˆ«ï¼š

1. **æ‰§è¡Œæ—¶æœº**ï¼š
   - `componentDidMount`ï¼šä»…åœ¨ç»„ä»¶é¦–æ¬¡æ¸²æŸ“åæ‰§è¡Œä¸€æ¬¡
   - `useEffect`ï¼šé»˜è®¤æƒ…å†µä¸‹åœ¨æ¯æ¬¡æ¸²æŸ“åæ‰§è¡Œï¼Œä½†å¯ä»¥é€šè¿‡ä¾èµ–æ•°ç»„æ§åˆ¶

2. **ä½¿ç”¨åœºæ™¯**ï¼š
   - `componentDidMount`ï¼šä»…ç”¨äºç±»ç»„ä»¶
   - `useEffect`ï¼šä»…ç”¨äºå‡½æ•°ç»„ä»¶

3. **æ¸…ç†æœºåˆ¶**ï¼š
   - `componentDidMount`ï¼šéœ€è¦åœ¨`componentWillUnmount`ä¸­æ‰‹åŠ¨æ¸…ç†
   - `useEffect`ï¼šå¯ä»¥è¿”å›ä¸€ä¸ªæ¸…ç†å‡½æ•°ï¼ŒReactä¼šåœ¨ç»„ä»¶å¸è½½æˆ–ä¸‹ä¸€æ¬¡effectæ‰§è¡Œå‰è°ƒç”¨å®ƒ

4. **æ¡ä»¶æ‰§è¡Œ**ï¼š
   - `componentDidMount`ï¼šæ€»æ˜¯åœ¨é¦–æ¬¡æ¸²æŸ“åæ‰§è¡Œ
   - `useEffect`ï¼šå¯ä»¥é€šè¿‡ä¾èµ–æ•°ç»„æ§åˆ¶ä½•æ—¶æ‰§è¡Œ
     ```jsx
     // ä»…åœ¨æŒ‚è½½å’Œå¸è½½æ—¶æ‰§è¡Œï¼Œæ¨¡æ‹ŸcomponentDidMount
     useEffect(() => {
       // æ‰§è¡Œä»£ç 
       return () => {
         // æ¸…ç†ä»£ç ï¼Œç›¸å½“äºcomponentWillUnmount
       };
     }, []); // ç©ºä¾èµ–æ•°ç»„
     
     // å½“countå˜åŒ–æ—¶æ‰§è¡Œ
     useEffect(() => {
       document.title = `ç‚¹å‡»äº†${count}æ¬¡`;
     }, [count]);
     
     // æ¯æ¬¡æ¸²æŸ“åæ‰§è¡Œ
     useEffect(() => {
       // æ‰§è¡Œä»£ç 
     }); // æ²¡æœ‰ä¾èµ–æ•°ç»„
     ```

5. **åŒæ­¥æ€§**ï¼š
   - `componentDidMount`ï¼šåŒæ­¥æ‰§è¡Œ
   - `useEffect`ï¼šé»˜è®¤å¼‚æ­¥æ‰§è¡Œï¼ˆåœ¨æµè§ˆå™¨ç»˜åˆ¶åï¼‰ï¼Œå¯ä»¥ä½¿ç”¨`useLayoutEffect`å®ç°åŒæ­¥æ•ˆæœ

6. **å¤šä¸ªå®ä¾‹**ï¼š
   - `componentDidMount`ï¼šä¸€ä¸ªç»„ä»¶åªèƒ½æœ‰ä¸€ä¸ª
   - `useEffect`ï¼šä¸€ä¸ªç»„ä»¶å¯ä»¥æœ‰å¤šä¸ªï¼ŒæŒ‰å£°æ˜é¡ºåºæ‰§è¡Œ

ç†è§£è¿™äº›åŒºåˆ«æœ‰åŠ©äºåœ¨è¿ç§»ç±»ç»„ä»¶åˆ°å‡½æ•°ç»„ä»¶æ—¶æ­£ç¡®ä½¿ç”¨Hooksã€‚

:::

## Hooks

### â“React Hooksçš„ä¸»è¦ä¼˜åŠ¿æ˜¯ä»€ä¹ˆ

::: details ğŸ’¡

React Hooksçš„ä¸»è¦ä¼˜åŠ¿åŒ…æ‹¬ï¼š

1. **ç®€åŒ–ç»„ä»¶é€»è¾‘**ï¼šHookså…è®¸åœ¨ä¸ä½¿ç”¨ç±»çš„æƒ…å†µä¸‹ä½¿ç”¨çŠ¶æ€å’Œå…¶ä»–Reactç‰¹æ€§ï¼Œä½¿ä»£ç æ›´ç®€æ´ã€‚

2. **æ›´å¥½çš„ä»£ç å¤ç”¨**ï¼šè‡ªå®šä¹‰Hooksä½¿é€»è¾‘å¤ç”¨å˜å¾—ç®€å•ï¼Œé¿å…äº†é«˜é˜¶ç»„ä»¶å’Œrender propså¸¦æ¥çš„"åµŒå¥—åœ°ç‹±"ã€‚

3. **å…³æ³¨ç‚¹åˆ†ç¦»**ï¼šå¯ä»¥æ ¹æ®ç›¸å…³åŠŸèƒ½è€Œä¸æ˜¯ç”Ÿå‘½å‘¨æœŸæ–¹æ³•ç»„ç»‡ä»£ç ï¼Œä½¿ç›¸å…³é€»è¾‘é›†ä¸­åœ¨ä¸€èµ·ã€‚
   ```jsx
   // ä¼ ç»Ÿç±»ç»„ä»¶ä¸­ï¼Œç›¸å…³é€»è¾‘åˆ†æ•£åœ¨ä¸åŒç”Ÿå‘½å‘¨æœŸæ–¹æ³•ä¸­
   componentDidMount() {
     this.fetchData();
     window.addEventListener('resize', this.handleResize);
   }
   
   componentDidUpdate(prevProps) {
     if (prevProps.id !== this.props.id) {
       this.fetchData();
     }
   }
   
   componentWillUnmount() {
     window.removeEventListener('resize', this.handleResize);
   }
   
   // ä½¿ç”¨Hooksï¼Œç›¸å…³é€»è¾‘å¯ä»¥é›†ä¸­åœ¨ä¸€èµ·
   useEffect(() => {
     fetchData();
     
     return () => {
       // æ¸…ç†ä»£ç 
     };
   }, [id]);
   
   useEffect(() => {
     window.addEventListener('resize', handleResize);
     return () => {
       window.removeEventListener('resize', handleResize);
     };
   }, []);
   ```

4. **é¿å…thiså…³é”®å­—**ï¼šä¸éœ€è¦ç†è§£JavaScriptä¸­thisçš„å·¥ä½œæ–¹å¼ï¼Œå‡å°‘äº†å¸¸è§çš„é”™è¯¯æ¥æºã€‚

5. **æ›´å¥½çš„ç±»å‹æ¨æ–­**ï¼šåœ¨TypeScriptä¸­ï¼ŒHooksé€šå¸¸æ¯”é«˜é˜¶ç»„ä»¶æœ‰æ›´å¥½çš„ç±»å‹æ¨æ–­ã€‚

6. **å‡å°‘åŒ…å¤§å°**ï¼šå‡½æ•°ç»„ä»¶é€šå¸¸æ¯”ç±»ç»„ä»¶ç¼–è¯‘åçš„ä»£ç æ›´å°ã€‚

7. **æ›´å®¹æ˜“æµ‹è¯•**ï¼šçº¯å‡½æ•°æ›´å®¹æ˜“æµ‹è¯•ï¼Œè‡ªå®šä¹‰Hookså¯ä»¥ç‹¬ç«‹æµ‹è¯•ã€‚

8. **æ¸è¿›å¼é‡‡ç”¨**ï¼šå¯ä»¥åœ¨ç°æœ‰é¡¹ç›®ä¸­é€æ­¥é‡‡ç”¨Hooksï¼Œä¸éœ€è¦é‡å†™æ‰€æœ‰ç»„ä»¶ã€‚

9. **æ›´å¥½çš„å¼€å‘è€…ä½“éªŒ**ï¼šå‡å°‘äº†æ¨¡æ¿ä»£ç ï¼Œä½¿ç»„ä»¶æ›´æ˜“äºç†è§£å’Œç»´æŠ¤ã€‚

10. **æœªæ¥å…¼å®¹æ€§**ï¼šReactå›¢é˜Ÿè¡¨ç¤ºï¼ŒHooksæ˜¯Reactçš„æœªæ¥å‘å±•æ–¹å‘ã€‚

:::

### â“è§£é‡ŠuseStateå’ŒuseEffectçš„åŸºæœ¬ç”¨æ³•

::: details ğŸ’¡

**useState**å’Œ**useEffect**æ˜¯Reactæœ€å¸¸ç”¨çš„ä¸¤ä¸ªHooksã€‚

**useState** - åœ¨å‡½æ•°ç»„ä»¶ä¸­æ·»åŠ çŠ¶æ€ï¼š

```jsx
import React, { useState } from 'react';

function Counter() {
  // å£°æ˜ä¸€ä¸ªåä¸ºcountçš„stateå˜é‡ï¼Œåˆå§‹å€¼ä¸º0
  const [count, setCount] = useState(0);
  
  return (
    <div>
      <p>ä½ ç‚¹å‡»äº†{count}æ¬¡</p>
      <button onClick={() => setCount(count + 1)}>
        ç‚¹å‡»æˆ‘
      </button>
      {/* ä½¿ç”¨å‡½æ•°å¼æ›´æ–°ï¼Œé€‚ç”¨äºåŸºäºå…ˆå‰çŠ¶æ€æ›´æ–°çš„æƒ…å†µ */}
      <button onClick={() => setCount(prevCount => prevCount + 1)}>
        å‡½æ•°å¼æ›´æ–°
      </button>
      <button onClick={() => setCount(0)}>é‡ç½®</button>
    </div>
  );
}
```

useStateçš„å…³é”®ç‰¹æ€§ï¼š
1. è¿”å›ä¸€ä¸ªåŒ…å«ä¸¤ä¸ªå…ƒç´ çš„æ•°ç»„ï¼šå½“å‰çŠ¶æ€å€¼å’Œæ›´æ–°å‡½æ•°
2. å¯ä»¥å¤šæ¬¡è°ƒç”¨useStateæ¥å£°æ˜å¤šä¸ªçŠ¶æ€å˜é‡
3. åˆå§‹çŠ¶æ€å¯ä»¥æ˜¯ä»»ä½•ç±»å‹ï¼šæ•°å­—ã€å­—ç¬¦ä¸²ã€å¸ƒå°”å€¼ã€å¯¹è±¡ã€æ•°ç»„ç­‰
4. æ›´æ–°å‡½æ•°å¯ä»¥æ¥æ”¶æ–°å€¼æˆ–åŸºäºå…ˆå‰çŠ¶æ€è®¡ç®—æ–°å€¼çš„å‡½æ•°
5. ä¸ç±»ç»„ä»¶çš„setStateä¸åŒï¼ŒuseStateä¸ä¼šè‡ªåŠ¨åˆå¹¶å¯¹è±¡

**useEffect** - å¤„ç†å‰¯ä½œç”¨ï¼ˆå¦‚æ•°æ®è·å–ã€è®¢é˜…ã€DOMæ“ä½œç­‰ï¼‰ï¼š

```jsx
import React, { useState, useEffect } from 'react';

function DataFetcher() {
  const [data, setData] = useState(null);
  const [loading, setLoading] = useState(true);
  const [error, setError] = useState(null);
  const [count, setCount] = useState(0);
  
  // ç¤ºä¾‹1ï¼šä»…åœ¨ç»„ä»¶æŒ‚è½½å’Œå¸è½½æ—¶æ‰§è¡Œï¼ˆæ¨¡æ‹ŸcomponentDidMountå’ŒcomponentWillUnmountï¼‰
  useEffect(() => {
    console.log('ç»„ä»¶å·²æŒ‚è½½');
    
    // è¿”å›æ¸…ç†å‡½æ•°
    return () => {
      console.log('ç»„ä»¶å°†å¸è½½');
    };
  }, []); // ç©ºä¾èµ–æ•°ç»„
  
  // ç¤ºä¾‹2ï¼šåœ¨ç»„ä»¶æŒ‚è½½æ—¶è·å–æ•°æ®
  useEffect(() => {
    const fetchData = async () => {
      try {
        setLoading(true);
        const response = await fetch('https://api.example.com/data');
        const result = await response.json();
        setData(result);
      } catch (err) {
        setError(err);
      } finally {
        setLoading(false);
      }
    };
    
    fetchData();
  }, []); // ç©ºä¾èµ–æ•°ç»„è¡¨ç¤ºä»…åœ¨æŒ‚è½½æ—¶æ‰§è¡Œ
  
  // ç¤ºä¾‹3ï¼šå½“countå˜åŒ–æ—¶æ‰§è¡Œ
  useEffect(() => {
    document.title = `ç‚¹å‡»äº†${count}æ¬¡`;
  }, [count]); // ä¾èµ–æ•°ç»„åŒ…å«count
  
  // ç¤ºä¾‹4ï¼šæ¯æ¬¡æ¸²æŸ“åæ‰§è¡Œ
  useEffect(() => {
    console.log('ç»„ä»¶å·²æ›´æ–°');
  }); // æ²¡æœ‰ä¾èµ–æ•°ç»„
  
  return (
    <div>
      <button onClick={() => setCount(count + 1)}>
        ç‚¹å‡»äº†{count}æ¬¡
      </button>
      
      {loading && <p>åŠ è½½ä¸­...</p>}
      {error && <p>é”™è¯¯: {error.message}</p>}
      {data && <pre>{JSON.stringify(data, null, 2)}</pre>}
    </div>
  );
}
```

useEffectçš„å…³é”®ç‰¹æ€§ï¼š
1. é»˜è®¤åœ¨æ¯æ¬¡æ¸²æŸ“åæ‰§è¡Œ
2. ç¬¬äºŒä¸ªå‚æ•°ï¼ˆä¾èµ–æ•°ç»„ï¼‰æ§åˆ¶ä½•æ—¶æ‰§è¡Œ
3. å¯ä»¥è¿”å›ä¸€ä¸ªæ¸…ç†å‡½æ•°ï¼Œåœ¨ç»„ä»¶å¸è½½æˆ–ä¸‹ä¸€æ¬¡effectæ‰§è¡Œå‰è°ƒç”¨
4. å¯ä»¥åœ¨ä¸€ä¸ªç»„ä»¶ä¸­å¤šæ¬¡ä½¿ç”¨useEffectï¼ŒæŒ‰å£°æ˜é¡ºåºæ‰§è¡Œ
5. å¼‚æ­¥æ‰§è¡Œï¼Œä¸ä¼šé˜»å¡æµè§ˆå™¨ç»˜åˆ¶ï¼ˆå¦‚éœ€åŒæ­¥æ‰§è¡Œï¼Œå¯ä½¿ç”¨useLayoutEffectï¼‰

:::

### â“ä»€ä¹ˆæ˜¯è‡ªå®šä¹‰Hookï¼Œå¦‚ä½•åˆ›å»º

::: details ğŸ’¡

è‡ªå®šä¹‰Hookæ˜¯ä¸€ç§å¤ç”¨çŠ¶æ€é€»è¾‘çš„æœºåˆ¶ï¼Œå®ƒä¸å¤ç”¨çŠ¶æ€æœ¬èº«ï¼Œè€Œæ˜¯å¤ç”¨çŠ¶æ€é€»è¾‘ã€‚è‡ªå®šä¹‰Hookæ˜¯ä¸€ä¸ªä»¥"use"å¼€å¤´çš„JavaScriptå‡½æ•°ï¼Œå¯ä»¥è°ƒç”¨å…¶ä»–Hookã€‚

**åˆ›å»ºè‡ªå®šä¹‰Hookçš„æ­¥éª¤**ï¼š

1. åˆ›å»ºä¸€ä¸ªä»¥"use"å¼€å¤´çš„å‡½æ•°ï¼ˆè¿™æ˜¯ä¸€ä¸ªçº¦å®šï¼Œè®©ReactçŸ¥é“è¿™æ˜¯ä¸€ä¸ªHookï¼‰
2. åœ¨å‡½æ•°å†…éƒ¨ä½¿ç”¨Reactå†…ç½®çš„Hook
3. ç¡®å®šHookéœ€è¦çš„å‚æ•°å’Œè¿”å›å€¼
4. åœ¨ç»„ä»¶ä¸­ä½¿ç”¨è‡ªå®šä¹‰Hook

**ç¤ºä¾‹1ï¼šåˆ›å»ºä¸€ä¸ªç®¡ç†è¡¨å•å­—æ®µçš„Hook**

```jsx
// è‡ªå®šä¹‰Hook: useFormField
function useFormField(initialValue = '') {
  const [value, setValue] = useState(initialValue);
  
  function handleChange(e) {
    setValue(e.target.value);
  }
  
  return {
    value,
    onChange: handleChange,
    reset: () => setValue(initialValue)
  };
}

// ä½¿ç”¨è‡ªå®šä¹‰Hook
function SignupForm() {
  const name = useFormField('');
  const email = useFormField('');
  const password = useFormField('');
  
  function handleSubmit(e) {
    e.preventDefault();
    console.log({
      name: name.value,
      email: email.value,
      password: password.value
    });
    
    // é‡ç½®è¡¨å•
    name.reset();
    email.reset();
    password.reset();
  }
  
  return (
    <form onSubmit={handleSubmit}>
      <input placeholder="å§“å" {...name} />
      <input placeholder="é‚®ç®±" type="email" {...email} />
      <input placeholder="å¯†ç " type="password" {...password} />
      <button type="submit">æ³¨å†Œ</button>
    </form>
  );
}
```

**ç¤ºä¾‹2ï¼šåˆ›å»ºä¸€ä¸ªæ•°æ®è·å–Hook**

```jsx
function useFetch(url) {
  const [data, setData] = useState(null);
  const [loading, setLoading] = useState(true);
  const [error, setError] = useState(null);
  
  useEffect(() => {
    let isMounted = true;
    
    const fetchData = async () => {
      try {
        setLoading(true);
        const response = await fetch(url);
        
        if (!response.ok) {
          throw new Error(`HTTP error! status: ${response.status}`);
        }
        
        const result = await response.json();
        
        if (isMounted) {
          setData(result);
          setError(null);
        }
      } catch (err) {
        if (isMounted) {
          setError(err.message);
          setData(null);
        }
      } finally {
        if (isMounted) {
          setLoading(false);
        }
      }
    };
    
    fetchData();
    
    return () => {
      isMounted = false;
    };
  }, [url]);
  
  return { data, loading, error };
}

// ä½¿ç”¨è‡ªå®šä¹‰Hook
function UserProfile({ userId }) {
  const { data, loading, error } = useFetch(`https://api.example.com/users/${userId}`);
  
  if (loading) return <p>åŠ è½½ä¸­...</p>;
  if (error) return <p>é”™è¯¯: {error}</p>;
  if (!data) return <p>æ— æ•°æ®</p>;
  
  return (
    <div>
      <h1>{data.name}</h1>
      <p>Email: {data.email}</p>
      <p>Phone: {data.phone}</p>
    </div>
  );
}
```

**è‡ªå®šä¹‰Hookçš„ä¼˜åŠ¿**ï¼š

1. **é€»è¾‘å¤ç”¨**ï¼šåœ¨å¤šä¸ªç»„ä»¶ä¹‹é—´å…±äº«é€»è¾‘ï¼Œè€Œä¸éœ€è¦æ›´æ”¹ç»„ä»¶ç»“æ„
2. **å…³æ³¨ç‚¹åˆ†ç¦»**ï¼šå°†å¤æ‚ç»„ä»¶çš„é€»è¾‘æ‹†åˆ†ä¸ºæ›´å°ã€æ›´æ˜“ç®¡ç†çš„å•å…ƒ
3. **å¯æµ‹è¯•æ€§**ï¼šè‡ªå®šä¹‰Hookå¯ä»¥ç‹¬ç«‹æµ‹è¯•
4. **å¯ç»„åˆæ€§**ï¼šå¯ä»¥ç»„åˆå¤šä¸ªè‡ªå®šä¹‰Hookåˆ›å»ºæ›´å¤æ‚çš„åŠŸèƒ½

**æ³¨æ„äº‹é¡¹**ï¼š

1. è‡ªå®šä¹‰Hookå¿…é¡»ä»¥"use"å¼€å¤´ï¼ˆReactçš„lintè§„åˆ™ä¼šå¼ºåˆ¶æ‰§è¡Œï¼‰
2. æ¯æ¬¡è°ƒç”¨Hookéƒ½ä¼šè·å¾—ç‹¬ç«‹çš„çŠ¶æ€
3. å¯ä»¥åœ¨è‡ªå®šä¹‰Hookä¸­è°ƒç”¨å…¶ä»–è‡ªå®šä¹‰Hook
4. åªèƒ½åœ¨Reactå‡½æ•°ç»„ä»¶æˆ–å…¶ä»–è‡ªå®šä¹‰Hookä¸­è°ƒç”¨Hook

:::

### â“useCallbackå’ŒuseMemoçš„åŒºåˆ«å’Œä½¿ç”¨åœºæ™¯

::: details ğŸ’¡

`useCallback`å’Œ`useMemo`éƒ½æ˜¯ç”¨äºæ€§èƒ½ä¼˜åŒ–çš„React Hooksï¼Œå®ƒä»¬é€šè¿‡è®°å¿†åŒ–ï¼ˆmemoizationï¼‰é¿å…ä¸å¿…è¦çš„è®¡ç®—æˆ–æ¸²æŸ“ï¼Œä½†æœ‰ä¸åŒçš„ç”¨é€”ï¼š

**useCallback**ï¼š
- **ç”¨é€”**ï¼šè®°å¿†åŒ–**å‡½æ•°å¼•ç”¨**
- **è¿”å›å€¼**ï¼šè®°å¿†åŒ–çš„å‡½æ•°
- **ä½¿ç”¨åœºæ™¯**ï¼š
  - å°†å›è°ƒå‡½æ•°ä¼ é€’ç»™ä¾èµ–å¼•ç”¨ç›¸ç­‰æ€§çš„å­ç»„ä»¶ï¼ˆå¦‚ä½¿ç”¨React.memoåŒ…è£…çš„ç»„ä»¶ï¼‰
  - å½“å‡½æ•°ä½œä¸ºå…¶ä»–Hookçš„ä¾èµ–é¡¹æ—¶

```jsx
import React, { useState, useCallback } from 'react';

function ParentComponent() {
  const [count, setCount] = useState(0);
  const [otherState, setOtherState] = useState(0);
  
  // æ²¡æœ‰ä½¿ç”¨useCallback - æ¯æ¬¡æ¸²æŸ“éƒ½ä¼šåˆ›å»ºæ–°å‡½æ•°
  const handleClickNormal = () => {
    setCount(count + 1);
  };
  
  // ä½¿ç”¨useCallback - åªæœ‰å½“countå˜åŒ–æ—¶æ‰ä¼šåˆ›å»ºæ–°å‡½æ•°
  const handleClickMemoized = useCallback(() => {
    setCount(count + 1);
  }, [count]); // ä¾èµ–æ•°ç»„
  
  return (
    <div>
      <p>Count: {count}</p>
      <p>Other state: {otherState}</p>
      
      {/* å³ä½¿otherStateå˜åŒ–å¯¼è‡´çˆ¶ç»„ä»¶é‡æ–°æ¸²æŸ“ï¼ŒMemoizedChildä¹Ÿä¸ä¼šé‡æ–°æ¸²æŸ“ */}
      <MemoizedChild onIncrement={handleClickMemoized} />
      
      <button onClick={() => setOtherState(otherState + 1)}>
        æ›´æ–°å…¶ä»–çŠ¶æ€
      </button>
    </div>
  );
}

// ä½¿ç”¨React.memoåŒ…è£…çš„å­ç»„ä»¶ï¼Œåªæœ‰å½“propså˜åŒ–æ—¶æ‰ä¼šé‡æ–°æ¸²æŸ“
const MemoizedChild = React.memo(function Child({ onIncrement }) {
  console.log('Childç»„ä»¶æ¸²æŸ“');
  return <button onClick={onIncrement}>å¢åŠ è®¡æ•°</button>;
});
```

**useMemo**ï¼š
- **ç”¨é€”**ï¼šè®°å¿†åŒ–**è®¡ç®—ç»“æœ**
- **è¿”å›å€¼**ï¼šè®°å¿†åŒ–çš„å€¼ï¼ˆå¯ä»¥æ˜¯ä»»ä½•ç±»å‹ï¼‰
- **ä½¿ç”¨åœºæ™¯**ï¼š
  - é¿å…æ˜‚è´µçš„è®¡ç®—
  - é¿å…åˆ›å»ºæ–°çš„å¼•ç”¨ï¼ˆå¯¹è±¡ã€æ•°ç»„ç­‰ï¼‰

```jsx
import React, { useState, useMemo } from 'react';

function ExpensiveCalculation({ list, filter }) {
  // ä½¿ç”¨useMemoè®°å¿†åŒ–è¿‡æ»¤å’Œæ’åºç»“æœ
  const processedList = useMemo(() => {
    console.log('æ‰§è¡Œæ˜‚è´µè®¡ç®—');
    
    // å‡è®¾è¿™æ˜¯ä¸€ä¸ªæ˜‚è´µçš„æ“ä½œ
    return list
      .filter(item => item.includes(filter))
      .sort()
      .map(item => ({ text: item }));
  }, [list, filter]); // åªæœ‰å½“listæˆ–filterå˜åŒ–æ—¶æ‰é‡æ–°è®¡ç®—
  
  return (
    <div>
      <p>è¿‡æ»¤æ¡ä»¶: {filter}</p>
      <ul>
        {processedList.map((item, index) => (
          <li key={index}>{item.text}</li>
        ))}
      </ul>
    </div>
  );
}

function ParentWithObject() {
  const [name, setName] = useState('');
  const [counter, setCounter] = useState(0);
  
  // ä¸ä½¿ç”¨useMemo - æ¯æ¬¡æ¸²æŸ“éƒ½ä¼šåˆ›å»ºæ–°å¯¹è±¡
  const userWithoutMemo = { name, age: 30 };
  
  // ä½¿ç”¨useMemo - åªæœ‰å½“nameå˜åŒ–æ—¶æ‰ä¼šåˆ›å»ºæ–°å¯¹è±¡
  const userWithMemo = useMemo(() => {
    return { name, age: 30 };
  }, [name]);
  
  return (
    <div>
      <input
        value={name}
        onChange={e => setName(e.target.value)}
        placeholder="è¾“å…¥åå­—"
      />
      <button onClick={() => setCounter(c => c + 1)}>
        ç‚¹å‡»è®¡æ•°: {counter}
      </button>
      
      {/* å³ä½¿counterå˜åŒ–å¯¼è‡´çˆ¶ç»„ä»¶é‡æ–°æ¸²æŸ“ï¼Œä¹Ÿåªæœ‰å½“nameå˜åŒ–æ—¶æ‰ä¼šé‡æ–°æ¸²æŸ“ */}
      <MemoizedChildWithObject user={userWithMemo} />
    </div>
  );
}

const MemoizedChildWithObject = React.memo(function ChildWithObject({ user }) {
  console.log('ChildWithObjectæ¸²æŸ“', user);
  return <div>ç”¨æˆ·: {user.name}, å¹´é¾„: {user.age}</div>;
});
```

**ä¸»è¦åŒºåˆ«**ï¼š
1. `useCallback(fn, deps)` ç­‰ä»·äº `useMemo(() => fn, deps)`
2. `useCallback` è®°å¿†åŒ–å‡½æ•°æœ¬èº«ï¼Œè€Œ `useMemo` è®°å¿†åŒ–å‡½æ•°çš„æ‰§è¡Œç»“æœ
3. `useCallback` è¿”å›ä¸€ä¸ªå‡½æ•°ï¼Œè€Œ `useMemo` å¯ä»¥è¿”å›ä»»ä½•å€¼

**ä½¿ç”¨å»ºè®®**ï¼š
1. ä¸è¦è¿‡æ—©ä¼˜åŒ–ï¼Œåªåœ¨æ€§èƒ½é—®é¢˜æ˜æ˜¾æ—¶ä½¿ç”¨
2. ç¡®ä¿ä¾èµ–æ•°ç»„æ­£ç¡®ï¼Œå¦åˆ™å¯èƒ½å¯¼è‡´bug
3. ä½¿ç”¨React DevTools Profilerè¯†åˆ«ä¸å¿…è¦çš„é‡æ–°æ¸²æŸ“
4. è€ƒè™‘ä½¿ç”¨`useReducer`ä»£æ›¿å¤šä¸ªç›¸å…³çŠ¶æ€å’Œå›è°ƒ
5. å¯¹äºç®€å•çš„UIæ¸²æŸ“ï¼Œè®°å¿†åŒ–çš„æˆæœ¬å¯èƒ½è¶…è¿‡æ”¶ç›Š

:::

## çŠ¶æ€ç®¡ç†

### â“Reactä¸­çŠ¶æ€ç®¡ç†çš„æ–¹å¼æœ‰å“ªäº›

::: details ğŸ’¡

Reactåº”ç”¨ä¸­æœ‰å¤šç§çŠ¶æ€ç®¡ç†æ–¹å¼ï¼Œä»ç®€å•åˆ°å¤æ‚ï¼š

1. **ç»„ä»¶å†…éƒ¨çŠ¶æ€**ï¼š
   - ä½¿ç”¨`useState`æˆ–ç±»ç»„ä»¶çš„`this.state`
   - é€‚ç”¨äºç®€å•ç»„ä»¶çš„å±€éƒ¨çŠ¶æ€
   ```jsx
   function Counter() {
     const [count, setCount] = useState(0);
     return (
       <button onClick={() => setCount(count + 1)}>
         ç‚¹å‡»æ¬¡æ•°: {count}
       </button>
     );
   }
   ```

2. **çŠ¶æ€æå‡**ï¼š
   - å°†å…±äº«çŠ¶æ€æå‡åˆ°æœ€è¿‘çš„å…±åŒçˆ¶ç»„ä»¶
   - é€šè¿‡propså‘ä¸‹ä¼ é€’çŠ¶æ€å’Œæ›´æ–°å‡½æ•°
   - é€‚ç”¨äºå°‘é‡ç›¸å…³ç»„ä»¶å…±äº«çŠ¶æ€
   ```jsx
   function Parent() {
     const [count, setCount] = useState(0);
     return (
       <>
         <Counter count={count} setCount={setCount} />
         <Display count={count} />
       </>
     );
   }
   ```

3. **Context API**ï¼š
   - é¿å…"props drilling"ï¼ˆé€šè¿‡å¤šå±‚ç»„ä»¶ä¼ é€’propsï¼‰
   - é€‚ç”¨äºä¸­ç­‰è§„æ¨¡åº”ç”¨æˆ–ç‰¹å®šé¢†åŸŸçš„çŠ¶æ€ï¼ˆå¦‚ä¸»é¢˜ã€ç”¨æˆ·è®¤è¯ï¼‰
   ```jsx
   const CountContext = createContext();
   
   function CountProvider({ children }) {
     const [count, setCount] = useState(0);
     return (
       <CountContext.Provider value={{ count, setCount }}>
         {children}
       </CountContext.Provider>
     );
   }
   
   function DeepChild() {
     const { count, setCount } = useContext(CountContext);
     return (
       <button onClick={() => setCount(count + 1)}>
         ç‚¹å‡»æ¬¡æ•°: {count}
       </button>
     );
   }
   ```

4. **Redux**ï¼š
   - é›†ä¸­å¼çŠ¶æ€ç®¡ç†
   - åŸºäºä¸å¯å˜æ•°æ®å’Œå•å‘æ•°æ®æµ
   - é€‚ç”¨äºå¤§å‹åº”ç”¨æˆ–å¤æ‚çŠ¶æ€é€»è¾‘
   ```jsx
   // åˆ›å»ºreducer
   function counterReducer(state = { count: 0 }, action) {
     switch (action.type) {
       case 'INCREMENT':
         return { count: state.count + 1 };
       default:
         return state;
     }
   }
   
   // ä½¿ç”¨Redux Toolkitç®€åŒ–
   const counterSlice = createSlice({
     name: 'counter',
     initialState: { count: 0 },
     reducers: {
       increment: state => {
         state.count += 1; // å†…éƒ¨ä½¿ç”¨Immerï¼Œå®é™…ä¸Šæ˜¯ä¸å¯å˜æ›´æ–°
       }
     }
   });
   ```

5. **MobX**ï¼š
   - åŸºäºå¯è§‚å¯Ÿå¯¹è±¡çš„å“åº”å¼çŠ¶æ€ç®¡ç†
   - ç›¸æ¯”Reduxæ›´å°‘çš„æ¨¡æ¿ä»£ç 
   - é€‚ç”¨äºå–œæ¬¢é¢å‘å¯¹è±¡é£æ ¼çš„å¼€å‘è€…
   ```jsx
   class CounterStore {
     count = 0;
     
     constructor() {
       makeAutoObservable(this);
     }
     
     increment() {
       this.count += 1;
     }
   }
   ```

6. **Recoil**ï¼š
   - Facebookå¼€å‘çš„åŸå­åŒ–çŠ¶æ€ç®¡ç†
   - é€‚ç”¨äºéœ€è¦ç»†ç²’åº¦çŠ¶æ€æ§åˆ¶çš„åº”ç”¨
   ```jsx
const countState = atom({
  key: 'countState',
  default: 0
});

function RecoilCounter() {
  const [count, setCount] = useRecoilState(countState);
  return (
    <button onClick={() => setCount(count + 1)}>
      ç‚¹å‡»æ¬¡æ•°: {count}
    </button>
  );
}
```

7. **Zustand**ï¼š
   - è½»é‡çº§çŠ¶æ€ç®¡ç†åº“
   - ç®€å•çš„APIï¼Œæ— éœ€æ ·æ¿ä»£ç 
   - é€‚ç”¨äºä¸­å°å‹åº”ç”¨
   ```jsx
   const useStore = create((set) => ({
     count: 0,
     increment: () => set((state) => ({ count: state.count + 1 }))
   }));

   function ZustandCounter() {
     const { count, increment } = useStore();
     return (
       <button onClick={increment}>
         ç‚¹å‡»æ¬¡æ•°: {count}
       </button>
     );
   }
   ```

8. **Jotai**ï¼š
   - åŸå­åŒ–çŠ¶æ€ç®¡ç†ï¼Œç±»ä¼¼Recoilä½†æ›´è½»é‡
   - åŸºäºåŸå§‹å€¼æ„å»ºå¤æ‚çŠ¶æ€
   - é€‚ç”¨äºéœ€è¦ç»†ç²’åº¦æ›´æ–°çš„åº”ç”¨
   ```jsx
   const countAtom = atom(0);
   
   function JotaiCounter() {
     const [count, setCount] = useAtom(countAtom);
     return (
       <button onClick={() => setCount(count + 1)}>
         ç‚¹å‡»æ¬¡æ•°: {count}
       </button>
     );
   }
   ```

é€‰æ‹©åˆé€‚çš„çŠ¶æ€ç®¡ç†æ–¹æ¡ˆåº”è€ƒè™‘ä»¥ä¸‹å› ç´ ï¼š
- åº”ç”¨è§„æ¨¡å’Œå¤æ‚åº¦
- å›¢é˜Ÿç†Ÿæ‚‰åº¦å’Œåå¥½
- æ€§èƒ½éœ€æ±‚
- å¼€å‘ä½“éªŒ
- é•¿æœŸç»´æŠ¤æˆæœ¬

å¯¹äºå¤§å¤šæ•°åº”ç”¨ï¼Œå»ºè®®ä»ç®€å•çš„æ–¹æ¡ˆå¼€å§‹ï¼ˆå¦‚ç»„ä»¶çŠ¶æ€ã€çŠ¶æ€æå‡æˆ–Contextï¼‰ï¼Œéšç€åº”ç”¨å¢é•¿å†è€ƒè™‘å¼•å…¥ä¸“é—¨çš„çŠ¶æ€ç®¡ç†åº“ã€‚

:::