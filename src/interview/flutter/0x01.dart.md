---
title: Dart
icon: hashtag

index: true

---

<!-- more -->

### â“`final` ä¸ `const` åŒºåˆ«

::: details ğŸ’¡ 

  * `const` : æ˜¯ç¼–è¯‘æ—¶å¸¸é‡ï¼Œå¿…é¡»åˆå§‹åŒ–ã€‚
  * `final` : è¿è¡Œæ—¶å¸¸é‡ï¼Œæ”¯æŒæƒ°æ€§åˆå§‹åŒ–ï¼Œåªèƒ½è¢«èµ‹å€¼ä¸€æ¬¡çš„å˜é‡ã€‚ 
  
```dart
final date = DateTime().now(); // âœ…
const date = DateTime().now(); // âŒ ç¼–è¯‘é”™è¯¯
```

:::

### â“`Dart` ä¸­ `..` è¡¨ç¤ºä»€ä¹ˆæ„æ€

::: details ğŸ’¡ 

> `..` : çº§è”è¿ç®—ç¬¦ (`Cascade notation`)ã€‚

çº§è”è¿ç®—ç¬¦å…è®¸åœ¨åŒä¸€ä¸ªå¯¹è±¡ä¸Šæ‰§è¡Œä¸€ç³»åˆ—æ“ä½œã€‚è¿™å¯ä»¥ä½¿ä»£ç æ›´åŠ ç®€æ´ï¼Œåªéœ€è¦å¼•ç”¨å¯¹è±¡ä¸€æ¬¡ï¼Œç„¶åæ‰§è¡Œå¤šä¸ªæ“ä½œã€‚

```dart
var myObject = SomeClass();
myObject.method1();
myObject.method2();
myObject.method3();

// ä½¿ç”¨çº§è”æ“ä½œç¬¦
var myObject = SomeClass()
  ..method1()
  ..method2()
  ..method3();
  
// æ³¨æ„ï¼šçº§è”æ“ä½œçš„ç»“æœæ˜¯è¡¨è¾¾å¼çš„ç›®æ ‡ï¼Œä¹Ÿå°±æ˜¯è¯´ä¾ç„¶æ˜¯ myObjectï¼Œè€Œä¸æ˜¯æœ€åä¸€æ¡è¯­å¥çš„è¿”å›å€¼ã€‚
```

:::

### â“`Dart` çš„ä½œç”¨åŸŸ

::: details ğŸ’¡ 

> ä½œç”¨åŸŸï¼šæ˜¯ä¸€ç§è§„å®šå˜é‡ï¼Œå‡½æ•°å’Œå¯¹è±¡çš„å¯è®¿é—®èŒƒå›´çš„æœºåˆ¶ã€‚

  - å±€éƒ¨ä½œç”¨åŸŸï¼šåœ¨å‡½æ•°æˆ–æ–¹æ³•ä¸­å£°æ˜çš„å˜é‡åªèƒ½åœ¨å…¶å†…éƒ¨ä½¿ç”¨ã€‚

    ```dart
    void main() {
      // å±€éƒ¨å˜é‡
      var x = 'Hello World'; // x is only accessible within main() function
      print(x);
    }
    ```

  - å…¨å±€ä½œç”¨åŸŸï¼šåœ¨å‡½æ•°æˆ–æ–¹æ³•å¤–éƒ¨å£°æ˜çš„å˜é‡å¯ä»¥åœ¨ç¨‹åºçš„ä»»æ„ä½ç½®ä½¿ç”¨ã€‚

    ```dart
    // å…¨å±€å˜é‡
    var x = 'Hello World';  // x is accessible anywhere in the code
    
    void main() {
      print(x);  // can access x within main() function
    }
    ```

  - è¯æ³•ä½œç”¨åŸŸï¼šè¿™æ„å‘³ç€å˜é‡çš„ä½œç”¨èŒƒå›´æ˜¯é™æ€çš„ï¼Œç”±ä»£ç çš„å¸ƒå±€å†³å®šã€‚

    ```dart
    var x = 'Hello World';  // x is accessible anywhere in the code
    
    void main() {
      var x = 'Hello Dart';  // This x variable is not the same as the global x
      print(x);  // This will print 'Hello Dart'
    }
    ```

  - å—ä½œç”¨åŸŸï¼šå¤§æ‹¬å· `{}` å†…éƒ¨å£°æ˜çš„å˜é‡å…·æœ‰å—çº§ä½œç”¨åŸŸï¼Œä¹Ÿå°±æ˜¯å®ƒä»¬ä»…åœ¨è¿™ä¸ªå—ä¸­å¯è§ã€‚

    ```dart
    void main() {
      if(true) {
        var x = 'Hello';  // x is only accessible within this if block
        print(x);  // This will print 'Hello'
      }
      print(x);  // Error: x is not accessible outside the if block
    }
    ``` 
    
:::

### â“è¯´ä¸€ä¸‹ `mixin`

::: details ğŸ’¡ 

> `mixin`: â€œæ··å…¥â€ï¼Œä¸€ç§åœ¨å¤šä¸ªç±»ä¹‹é—´é‡ç”¨ä»£ç çš„æ–¹å¼ã€‚å®ƒæä¾›äº†ä¸€ç§å®ç°æ–¹æ³•é‡ç”¨çš„æ–¹å¼ï¼Œå¹¶ä¸”ä¸éœ€è¦åˆ›å»ºå’Œä½¿ç”¨å¤æ‚çš„ç±»å±‚æ¬¡ã€‚

  - ä¸€ä¸ªç±»å¯ä»¥æ··å…¥å¤šä¸ª `mixin`ï¼Œ`mixin` ä¹Ÿå¯ä»¥ç»§æ‰¿å…¶å®ƒ `mixin`ã€‚
  - `mixin` ä¸èƒ½å®šä¹‰æ„é€ å‡½æ•°ï¼Œä¹Ÿä¸èƒ½ä»ç±»æ‰©å±•è€Œæ¥æ—¶ã€‚è¿™æ˜¯å› ä¸º `mixin` æœ¬è´¨ä¸Šæ˜¯ä¸€ç§å¯¹æ¥å£çš„è¡¥å……ï¼Œå®ƒæè¿°çš„æ˜¯è¡Œä¸ºï¼Œè€Œä¸æ˜¯çŠ¶æ€ã€‚

```dart
mixin Flyable {
  fly() {
    print('I can fly!');
  }
}

// ä½¿ç”¨ with æ··å…¥ Flyable
class Bird with Flyable { }

void main() {
  Bird b = Bird();
  b.fly();  // æ‰“å° 'I can fly!'
}
```

:::

### â“`mixin` `extends` `implement` ä¹‹é—´çš„å…³ç³»

::: details ğŸ’¡ 

  - `mixin`ï¼šä¸€ç§å°†ç±»çš„ä»£ç åœ¨å¤šä¸ªç±»å±‚æ¬¡ç»“æ„ä¸­å¤ç”¨çš„æ–¹æ³•ã€‚ä½¿ç”¨ `mixin` å…³é”®å­—å®šä¹‰ç±»ï¼Œç„¶åä½¿ç”¨ `with` å…³é”®å­—å°†å…¶æ··å…¥å¦ä¸€ä¸ªç±»ã€‚æ³¨æ„ï¼Œ`mixin` ç±»ä¸èƒ½è¢«å®ä¾‹åŒ–ï¼Œä¹Ÿä¸èƒ½æœ‰æ„é€ å‡½æ•°ã€‚

    ```dart
    mixin Musical {
      void sing() {
        print('Singing...');
      }
    }
    
    class Musician extends Person with Musical {
      // We can now use the sing() method in Musician.
    }
    ```
    
  - `extends`ï¼šç±»å¯ä»¥é€šè¿‡ `extends` å…³é”®å­—ç»§æ‰¿ä¸€ä¸ªçˆ¶ç±»ã€‚ä¸æ”¯æŒå¤šç»§æ‰¿ï¼Œä¸€ä¸ªå­ç±»åªèƒ½ç»§æ‰¿ä¸€ä¸ªçˆ¶ç±»ã€‚

    ```dart
    class Vehicle {
      void drive() {
        print('Driving...');
      }
    }
    
    class Car extends Vehicle {
      void honk() {
        print('Honking...');
      }
      @override
      void drive() {
        print('Driving car...');
      }
    }
    ```

  - `implements`ï¼šç”¨äºå®ç°ä¸€ä¸ªæ¥å£ã€‚æ¥å£æ˜¯æ–¹æ³•å’Œå±æ€§çš„é›†åˆï¼Œå®ƒè¢«ç”¨ä½œé€šç”¨æ¨¡æ¿ï¼Œä¸€æ—¦è¢«ç±»å®ç°ï¼Œè¿™ä¸ªç±»å°±å¿…é¡»å®ç°æ¥å£ä¸­çš„æ‰€æœ‰æ–¹æ³•å’Œå±æ€§ã€‚ 

    ```dart
    abstract class Animal {
      void walk();
      void makeNoise();
    }
    
    class Dog implements Animal {
      @override
      void walk() {
        print('The dog is walking.');
      }
      
      @override
      void makeNoise() {
        print('The dog is barking.');
      }
    }
    
    void main() {
      Dog dog = Dog();
      dog.walk();
      dog.makeNoise();
    }
    ```
    
:::

### â“`Dart` ä¸ºå•¥æ²¡æœ‰åå°„

::: details ğŸ’¡ 

  > å› ä¸ºåå°„ä¼šå½±å“ `Dart` çš„ `tree shaking`(æ‘‡æ ‘ä¼˜åŒ–)ã€‚è¿™æ˜¯ä¸€ç§æ— ç”¨ä»£ç è£å‰ªæŠ€æœ¯ï¼Œæœ‰åˆ©äºä¼˜åŒ–å‘å¸ƒç‰ˆæœ¬çš„ `App` ä½“ç§¯ã€‚å¦‚æœåå°„æœºåˆ¶å­˜åœ¨ï¼Œä¼šå­˜åœ¨éšå¼ä»£ç ï¼Œ`tree shaking` æ—¶æ— æ³•å‡†ç¡®å®šä½è¿è¡Œæ—¶å“ªäº›ä»£ç ä¸ä¼šè¢«è°ƒç”¨ï¼Œå†—ä½™ä»£ç å°±æ²¡æ³•è¢«è£å‰ªã€‚

æ³¨æ„ï¼š`Dart` å…¶å®æ˜¯æ”¯æŒåå°„çš„ï¼Œåå°„åœ¨ `dart:mirrors` åº“ä¸­å®ç°ï¼Œæä¾›äº†ä¸€ç³»åˆ—ç”¨äºæ‰§è¡Œåå°„æ“ä½œçš„ç±»å’Œæ–¹æ³•ã€‚

:::
  
### â“`Dart` ä¸­å¦‚ä½•ä½¿ç”¨åå°„

::: details ğŸ’¡ 

> åå°„ï¼šä¸€ç§åŠ¨æ€è¯­è¨€ç‰¹æ€§ï¼Œå¯ä»¥åœ¨è¿è¡Œæ—¶æ£€æŸ¥å’Œä¿®æ”¹ç¨‹åºã€‚åœ¨ `dart:mirrors` åŒ…ä¸­å®ç°ï¼Œè¯¥åŒ…æä¾›äº†ä¸€ç³»åˆ—ç”¨äºæ‰§è¡Œåå°„æ“ä½œçš„ç±»å’Œæ–¹æ³•ã€‚
  
  - `ClassMirror` : ç±»
  - `InstanceMirror` : å®ä¾‹ 
  - `ClosureMirror` : é—­åŒ…
  - `DeclarationMirror` : ç±»å±æ€§
  - `IsolateMirror` : Isolate
  - `MethodMirror` : æ–¹æ³•

```dart
import 'dart:mirrors';

class MyClass {
  MyClass(String message) {
    print('New object created. Message: $message');
  }

  void myMethod(String message) {
    print('myMethod called. Message: $message');
  }
}

void main() {
  // è·å– MyClass çš„ç±»é•œåƒ
  ClassMirror classMirror = reflectClass(MyClass);

  // ç”¨ MyClass çš„æ„é€ å‡½æ•°åˆ›å»ºæ–°å®ä¾‹
  var myClassInstanceMirror = classMirror.newInstance(Symbol(''), ['Hello Constructor']);
  
  // è·å– MyClass çš„å®ä¾‹
  MyClass myClassInstance = myClassInstanceMirror.reflectee;

  // è·å– MyClass.myMethod çš„æ–¹æ³•é•œåƒ
  var myMethodMirror = reflect(myClassInstance).type.instanceMembers[Symbol('myMethod')];

  // é€šè¿‡åå°„è°ƒç”¨ myMethod
  myMethodMirror.invoke(myClassInstanceMirror, ['Hello Method']);
}
```

  æ³¨æ„ï¼š`dart:mirrors` åº“ï¼ˆä»¥åŠæ‰€æœ‰çš„åå°„åœ¨ `Dart` ä¸­ï¼‰åœ¨ `web` åœºæ™¯ä¸­å¹¶ä¸è¢«æ‰€æœ‰çš„ç¼–è¯‘ç›®æ ‡(ä¾‹å¦‚ `dart2js` æˆ– `flutter web`)æ”¯æŒï¼Œå¹¶ä¸”å¯èƒ½å¯¹ç¨‹åºçš„ä½“ç§¯å’Œæ€§èƒ½æœ‰æ‰€å½±å“ã€‚å› æ­¤ï¼Œåœ¨å°†ä»£ç éƒ¨ç½²åˆ°ç”Ÿäº§ç¯å¢ƒä¹‹å‰ï¼Œåº”ä»”ç»†è€ƒè™‘æ˜¯å¦éœ€è¦ä½¿ç”¨åå°„ã€‚

:::
  
### â“è¯´ä¸€ä¸‹ `Future`

::: details ğŸ’¡ 

> `Future`ï¼šä¸€ä¸ªä»£è¡¨æœªå®Œæˆçš„è®¡ç®—çš„ç±»ã€‚å¯ä»¥æŠŠå®ƒæƒ³è±¡æˆä¸€ä¸ªä¼šåœ¨å°†æ¥æŸä¸ªæ—¶é—´è¿”å›ä¸€ä¸ªå€¼ï¼ˆæˆ–é”™è¯¯ï¼‰çš„æ“ä½œã€‚

```dart
void main() {
  // åˆ›å»ºä¸€ä¸ª Future
  Future<String> future = Future.delayed(
    Duration(seconds: 2),
    () => 'Hello, Future!',
  );
  
  // æ³¨å†Œå›è°ƒ
  future.then(print);  // å½“ Future å®Œæˆæ—¶ï¼Œä¼šæ‰“å° 'Hello, Future!'
}
```

:::

### â“è¯´ä¸€ä¸‹ `Stream`

::: details ğŸ’¡ 

> `Stream`ï¼šç”¨äºåºåˆ—åŒ–å¼‚æ­¥äº‹ä»¶ã€‚ä¸åªå®Œæˆä¸€æ¬¡çš„ `Future` ä¸åŒï¼Œ`Stream` èƒ½å¤Ÿå‘å‡ºå¤šä¸ªå€¼ã€‚

  - å¯ä»¥æŠŠ `Stream` ç†è§£æˆä¸€ä¸ªå¼‚æ­¥çš„æ•°ç»„ï¼Œå°±åƒä¸€ä¸ªæµæ°´çº¿ï¼Œå¯ä»¥åœ¨æµæ°´çº¿çš„ä¸€ç«¯æŠ•å…¥æ•°æ®ï¼Œåœ¨å¦ä¸€ç«¯å¤„ç†æ•°æ®ï¼Œæ•°æ®åœ¨æµæ°´çº¿ä¸Šç§»åŠ¨æ—¶å¹¶ä¸ä¼šé˜»å¡ä¸»çº¿ç¨‹çš„æ‰§è¡Œã€‚  
  - å‘ `Stream` æ·»åŠ æ•°æ®çš„æœ€å¸¸ç”¨æ–¹å¼æ˜¯ä½¿ç”¨ `StreamController`ï¼Œå¯ä»¥ä½¿ç”¨ `StreamController` ç®¡ç†æ•°æ®çš„æ·»åŠ å’Œ `Stream` çš„ç›‘å¬ã€‚

```dart
void main() {
  // åˆ›å»ºä¸€ä¸ª Stream 
  const data = [1, 2, 3, 4, 5];
  final stream = Stream.fromIterable(data);

  // ç›‘å¬ Stream
  stream.listen(print);  // æ‰“å° 1, 2, 3, 4, 5
}
```

:::

### â“`await for` å¦‚ä½•ä½¿ç”¨

::: details ğŸ’¡ 

> `await for` å¾ªç¯ç”¨äºå¼‚æ­¥è¿­ä»£ `Stream` çš„å…ƒç´ ã€‚ä½¿ç”¨ `await for` ä¼šæš‚åœå‡½æ•°çš„æ‰§è¡Œï¼Œç›´åˆ°æ•´ä¸ª `Stream` è¢«å¤„ç†å®Œæ¯•ã€‚

```dart
Future<void> printStream(Stream<int> stream) async {
  await for (var number in stream) {
    print(number);
  }
}

void main() {
  var stream = Stream.fromIterable([1, 2, 3, 4, 5]);
  printStream(stream);
}
```

:::
