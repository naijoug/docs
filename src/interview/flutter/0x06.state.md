---
title: State - â€œçŠ¶æ€ç®¡ç†â€
icon: hashtag

index: true

---

<!-- more -->

------

## State - â€œçŠ¶æ€â€

### â“è¯´ä¸€ä¸‹ä»€ä¹ˆæ˜¯çŠ¶æ€ç®¡ç†

::: details ğŸ’¡ 

> çŠ¶æ€ç®¡ç†ï¼šå¤„ç†åº”ç”¨ä¸­æ•°æ®æ”¹å˜ä»¥åŠæ•°æ®å¦‚ä½•å½±å“åº”ç”¨ç•Œé¢çš„è¿‡ç¨‹ã€‚åœ¨å¼€å‘åº”ç”¨ç¨‹åºæ—¶ï¼Œæ“ä½œçš„æ˜¯ç”¨æˆ·çš„äº¤äº’è¡Œä¸ºï¼Œåå°æ•°æ®ï¼Œä»¥åŠåº”ç”¨å‘ç”¨æˆ·å±•ç¤ºçš„è§†å›¾ï¼Œè¿™äº›å› ç´ çš„æ”¹å˜éƒ½éœ€è¦è¢«é€‚å½“åœ°ç®¡ç†ã€‚æ•°æ®ç®¡ç†å’Œè§†å›¾åé¦ˆçš„è¿‡ç¨‹å°±æ˜¯çŠ¶æ€ç®¡ç†ã€‚

ä¸ºä»€ä¹ˆæˆ‘ä»¬éœ€è¦çŠ¶æ€ç®¡ç†ï¼Ÿ

  - åœ¨å¤æ‚çš„åº”ç”¨ä¸­ï¼Œæœ‰äº›æ•°æ®éœ€è¦åœ¨å¾ˆå¤šé¡µé¢ä¸­ä½¿ç”¨ã€‚ä½¿ç”¨å…¨å±€çš„çŠ¶æ€ç®¡ç†å¯ä»¥ä½¿åº”ç”¨ä¿æŒåŒæ­¥ï¼Œé¿å…æ•°æ®åœ¨å„ä¸ªé¡µé¢ä¹‹é—´äº§ç”Ÿä¸ä¸€è‡´ã€‚

  - çŠ¶æ€ç®¡ç†åˆ©äºä»£ç çš„ç»“æ„æ¸…æ™°ï¼Œå…·æœ‰å¯æ§æ€§ã€å¯é¢„æµ‹æ€§ã€‚åœ¨å¤§å‹é¡¹ç›®ä¸­å°¤å…¶é‡è¦ï¼Œå› ä¸ºå®ƒæœ‰åŠ©äºé™ä½è°ƒè¯•å’Œç†è§£ä»£ç çš„å¤æ‚æ€§ã€‚

  - çŠ¶æ€ç®¡ç†èƒ½æé«˜æ¸²æŸ“æ•ˆç‡ã€‚åœ¨ `React` æˆ–è€… `Flutter` è¿™ç§å£°æ˜å¼ç¼–ç¨‹æ¡†æ¶ä¸­ï¼Œå½“æœ¬åœ°çŠ¶æ€å‘ç”Ÿå˜åŒ–æ—¶ï¼Œä¼šå¼•èµ·ç»„ä»¶çš„é‡æ–°æ¸²æŸ“ï¼Œè€ŒçŠ¶æ€ç®¡ç†åº“é€šè¿‡ç»´æŠ¤ä¸€ä¸ªå•ä¸€çš„çŠ¶æ€æ ‘ï¼Œèƒ½å¤Ÿæœ‰é€‰æ‹©æ€§åœ°é€šçŸ¥æŸä¸€éƒ¨åˆ†çš„ç»„ä»¶å»æ›´æ–°ï¼Œæé«˜æ¸²æŸ“æ•ˆç‡ã€‚

:::

### â“`State` æ€ä¹ˆå®ç°è·¨å¸§å…±äº«

::: details ğŸ’¡ 



:::

### â“`setState` åº•å±‚å®ç°

::: details ğŸ’¡ 

```dart
void setState(VoidCallback fn) {
  // è¿›è¡Œä¸€äº›æ–­è¨€æ£€æŸ¥ï¼Œç¡®å®šå½“å‰çš„ State å¯¹è±¡å·²ç» mountedï¼ˆå³å·²ç»è¢«æ·»åŠ åˆ°äº† widgets æ ‘ä¸­ï¼‰ï¼Œå¹¶ä¸”æ²¡æœ‰è¢«disposedï¼ˆå³è¿˜æ²¡æœ‰è¢«é”€æ¯ï¼‰ã€‚
  assert(fn != null);
  assert(() {
    if (_debugLifecycleState == _ElementLifecycle.defunct) {
      // ä¸€ä¸ª StatefulWidget çš„ state å·²ç»è¢«é”€æ¯ï¼ˆdisposeï¼‰ä¹‹åï¼Œä»ç„¶å»è°ƒç”¨ setState æ–¹æ³•
      throw FlutterError.fromParts(<DiagnosticsNode>[]);
      /** 
      å…¸å‹åœºæ™¯ï¼šçš„å‘ç”Ÿåœºæ™¯æ˜¯åœ¨ StatefulWidget çš„ state ä¸­å¯åŠ¨äº†ä¸€ä¸ªå®šæ—¶å™¨æˆ–è€…åŠ¨ç”»ï¼Œ
              ä½†æ˜¯å½“ Widget ä¸å†éœ€è¦æ˜¾ç¤ºï¼Œå¹¶è¢«ç³»ç»Ÿé”€æ¯åï¼Œ
              è¿™ä¸ªå®šæ—¶å™¨æˆ–è€…åŠ¨ç”» callback ä»ç„¶åœ¨åå°è¿è¡Œï¼Œå¹¶å°è¯•å»è°ƒç”¨ setState æ–¹æ³•ã€‚
      è§£å†³æ–¹æ¡ˆï¼š
          1> åœ¨ state çš„ dispose æ–¹æ³•ä¸­ï¼Œåœæ­¢æ‰€æœ‰çš„å®šæ—¶å™¨æˆ–è€…åŠ¨ç”»ã€‚è¿™ä¼šé˜»æ­¢å®ƒä»¬åœ¨é”€æ¯åç»§ç»­è¿è¡Œã€‚
             å…·ä½“å®ç°æ–¹æ³•æ˜¯åœ¨ dispose æ–¹æ³•ä¸­è°ƒç”¨å®šæ—¶å™¨çš„ cancel æ–¹æ³•æˆ–è€…åŠ¨ç”»çš„ stop æ–¹æ³•ã€‚
          2> åœ¨è°ƒç”¨ setState ä¹‹å‰ï¼Œé¦–å…ˆæ£€æŸ¥ä¸€ä¸‹ mounted å±æ€§ã€‚
             å¦‚æœ mounted è¿”å› falseï¼Œé‚£ä¹ˆå°±è¯´æ˜è¿™ä¸ª state å·²ç»è¢«ç§»é™¤å‡º Widget æ ‘ï¼Œä¸åº”å†å»è°ƒç”¨ setState æ–¹æ³•ã€‚
      */
    }
    if (_debugLifecycleState != _ElementLifecycle.active) {
      // åœ¨é”™è¯¯çš„ä¸Šä¸‹æ–‡æˆ–é”™è¯¯çš„çŠ¶æ€è°ƒç”¨ setState() æ–¹æ³•
      throw FlutterError.fromParts(<DiagnosticsNode>[]);
      /**
      å…¸å‹åœºæ™¯ï¼šä¸èƒ½åœ¨ä¸€ä¸ª Widget çš„æ„å»ºæ–¹æ³• build() ä¸­è°ƒç”¨ setState() ã€‚
              åŸå› æ˜¯ setState() ä¼šé€šçŸ¥æœ‰çŠ¶æ€çš„æ•°æ®å·²æ›´æ”¹ï¼Œä»è€Œè§¦å‘ build æ–¹æ³•é‡å»º widgetã€‚
              ç„¶è€Œå·²ç»åœ¨ build æ–¹æ³•ä¸­ï¼Œåœ¨æ„å»ºè¿‡ç¨‹ä¸­æ— æ³•é€šçŸ¥ç³»ç»Ÿå…³äºçŠ¶æ€çš„æ›´æ”¹ã€‚
              è¿™å°†å¯¼è‡´ä¸ä¸€è‡´çš„çŠ¶æ€ï¼Œå¹¶å¯èƒ½å¯¼è‡´å…¶ä»–é—®é¢˜ã€‚
      è§£å†³æ–¹æ¡ˆï¼šå°†å¯èƒ½ä¼šæ”¹å˜ Widget çŠ¶æ€çš„é€»è¾‘æ”¾åœ¨äº‹ä»¶å¤„ç†ã€å¼‚æ­¥å¤„ç†ç­‰åœ°æ–¹ï¼Œ
              è€Œä¸æ˜¯ç›´æ¥åœ¨ç”¨æˆ·ç•Œé¢çš„æ¸²æŸ“è¿‡ç¨‹ä¸­è¿›è¡Œæ›´æ”¹ã€‚è¿™æ ·å¯ä»¥é¿å…è¿™ä¸ªé”™è¯¯ã€‚
      */
    }
    return true;
  }());
  // è°ƒç”¨ Element çš„ markNeedsBuild æ–¹æ³•ï¼Œæ ‡è®°è¿™ä¸ª Element åœ¨ä¸‹ä¸€æ¬¡ build é˜¶æ®µéœ€è¦é‡å»ºã€‚
  _element._element.markNeedsBuild();
}
```

:::

### â“`markNeedsBuild` åº•å±‚å®ç°

::: details ğŸ’¡ 

> `markNeedsBuild` æ˜¯ `Element` ç±»çš„ä¸€ä¸ªæ–¹æ³•ï¼Œç”¨äºæ ‡è®°éœ€è¦é‡å»ºæ­¤ `Element`ã€‚

```dart
void markNeedsBuild() {
  if (_dirty) return;
  //  _dirty æ ‡è®°è¢«è®¾ç½®ä¸º trueï¼Œè¡¨ç¤ºè¯¥ Element å·²è¢«â€œå¼„è„â€ï¼Œéœ€è¦åœ¨ä¸‹ä¸€ä¸ª build é˜¶æ®µè¿›è¡Œé‡å»ºã€‚
  _dirty = true;
  // è¯¥å…ƒç´ è¢«ä¼ é€’ç»™ _scheduleBuildFor æ–¹æ³•ï¼Œä»¥ä¾¿åœ¨ä¸‹ä¸€ä¸ª build å¸ƒå±€å‘¨æœŸä¸­è¿›è¡Œé‡æ–°æ„å»ºã€‚
  _scheduleBuildFor(this);
}
```

åŸºæœ¬æ€æƒ³ï¼šå»¶è¿Ÿå’Œåˆ†æ‰¹è¿›è¡Œ UI æ›´æ–°ã€‚å½“å‘ç”Ÿäº†å¯èƒ½ä¼šæ”¹å˜UIçš„äº‹ä»¶å¹¶ä¸”è°ƒç”¨äº† `markNeedsBuild`ï¼Œè€Œä¸æ˜¯ç«‹å³è¿›è¡Œ `UI` çš„æ›´æ–°ï¼Œ`Flutter` å°†ä¼šå»¶è¿Ÿåˆ°ä¸‹ä¸€å¸§ï¼Œç„¶åä¸€æ¬¡å¤„ç†æ‰€æœ‰çš„è„å…ƒç´ ï¼Œè¿™ç§æ–¹å¼æé«˜äº†æ•´ä½“çš„æ€§èƒ½æ•ˆç‡ã€‚

:::

### â“`inflateWidget` çš„ä½œç”¨

::: details ğŸ’¡ 

`inflateWidget` è¿™ä¸ªæ–¹æ³•ä½äº `Element` ç±»ä¸­ã€‚å®ƒçš„ä½œç”¨æ˜¯æ ¹æ®æä¾›çš„ `Widget` åˆ›å»ºæˆ–æ›´æ–°å¯¹åº”çš„ `Element`ã€‚

  `Element` åœ¨ `Flutter` ä¸­æ˜¯éå¸¸å…³é”®çš„æ¦‚å¿µï¼Œå®ƒæ˜¯ `Widget` å’Œ `RenderObject` çš„æ¡¥æ¥å±‚ã€‚`Widget` æ˜¯ä¸€æ¬¡æ€§é…ç½®ï¼Œå®ƒæ˜¯ä¸å¯å˜çš„ã€‚è€Œ `RenderObject` æ˜¯ä¸€ä¸ªåœ¨å±å¹•ä¸Šæ˜¾ç¤ºçš„å¯¹è±¡ï¼Œå®ƒæ˜¯å¯å˜çš„ã€‚`Element` å°±æ˜¯å°†è¿™ä¸¤è€…è”ç³»äº†èµ·æ¥ï¼Œå®ƒåŒ…å«å¯¹ `Widget` å’Œ `RenderObject` çš„å¼•ç”¨ã€‚

  å½“ä¸€ä¸ªæ–°çš„ `Widget` è¦æ˜¾ç¤ºåœ¨å±å¹•ä¸Šï¼ˆæˆ–è€…å·²æœ‰`Widget`çš„é…ç½®å‘ç”Ÿæ”¹å˜ï¼‰æ—¶ï¼Œ`Flutter` å¼•æ“å°±ä¼šè°ƒç”¨ `inflateWidget` æ–¹æ³•ã€‚`inflateWidget` ä¼šæ ¹æ®æ–°çš„ `Widget` åˆ›å»ºå¯¹åº”çš„ `Element`ï¼ˆå¦‚æœä¸å­˜åœ¨ï¼‰ï¼Œæˆ–è€…æ›´æ–°å·²å­˜åœ¨ `Element` çš„é…ç½®ã€‚
     
:::

------

## InheritedWidget - â€œçŠ¶æ€å…±äº«â€

### â“`InheritedWidget` ä½œç”¨

::: details ğŸ’¡ 

> `InheritedWidget`ï¼š`Flutter` ä¸­ä¸€ä¸ªéå¸¸é‡è¦çš„å¹•åè§’è‰²ï¼Œä¸»è¦ç”¨äºåœ¨ `Widget` æ ‘ä¸­æœ‰æ•ˆåœ°ä¼ é€’æ•°æ®ã€‚

  é—®é¢˜ï¼š`Flutter` ä¸­ `Widget` æ˜¯ä¸å¯å˜çš„ï¼Œç”±äºå…¶è‡ªèº«ä¸èƒ½æ”¹å˜ï¼Œæ‰€ä»¥å¦‚æœæœ‰ä»»ä½•æ•°æ®æ›´æ”¹ï¼Œæ€»æ˜¯æŒ‰ç…§ä»ä¸Šåˆ°ä¸‹çš„æ–¹å¼é‡æ–°æ„å»ºæ‰€æœ‰çš„ `Widget`ã€‚ç„¶è€Œè¿™å¯èƒ½å¯¼è‡´é‡ç»˜çš„æ€§èƒ½é—®é¢˜ï¼Œç‰¹åˆ«æ˜¯å¯¹äºå¤§å‹æ ‘çŠ¶ç»“æ„æ¥è¯´ã€‚

  è§£å†³æ–¹æ¡ˆï¼š`InheritedWidget` åˆ™ä¸ºè¿™ä¸ªé—®é¢˜æä¾›äº†è§£å†³æ–¹æ¡ˆã€‚å®ƒå…è®¸å¼€å‘è€…åœ¨ `Widget` æ ‘çš„é¡¶éƒ¨æˆ–ä»»ä½•ä½ç½®æä¾›æ•°æ®ï¼Œç„¶åè¿™äº›æ•°æ®å¯ä»¥åœ¨æ ‘çš„ä»»ä½•ä¸‹å±‚éƒ½èƒ½è·å–åˆ°ã€‚å½“ `InheritedWidget` æ›´æ–°æ—¶ï¼Œå®ƒä¼šé€šçŸ¥ä½¿ç”¨å…¶æ•°æ®çš„æ‰€æœ‰ `Widget`ï¼Œè¿™äº› `Widget` åªéœ€é€šè¿‡ `BuildContext` å³å¯è®¿é—®åˆ°è¿™äº›æ•°æ®ï¼Œè¿™ä¸ªè¿‡ç¨‹ç§°ä¸ºä¾èµ–ã€‚

  ä½œç”¨ï¼šå¯ä»¥è®©å¼€å‘è€…æ›´é«˜æ•ˆåœ°åˆ†äº«æ•°æ®ï¼Œé¿å…äº†ä¸å¿…è¦çš„ `Widget` é‡ç½®ï¼Œé¿å…äº†ä¸€äº›æ€§èƒ½é—®é¢˜ï¼ŒåŒæ—¶è®© `Widget` æ ‘çš„çŠ¶æ€ç®¡ç†æ›´åŠ æ¸…æ™°å’Œæ–¹ä¾¿ã€‚
  
  ğŸŒ° `Flutter` çš„ `Theme` å’Œ `Locale` å°±æ˜¯é€šè¿‡ `InheritedWidget` æ¥ä¼ é€’çš„ã€‚
    
:::

### â“`InheritedWidget` æ˜¯å¦‚ä½•å®ç°å…±äº«æ•°æ®çš„

::: details ğŸ’¡ 



:::

### â“`inheritFromWidgetOfExactType` äº†è§£å—

::: details ğŸ’¡ 



:::

### â“`InheritedWidget` ä¸ `didChangeDependencies()` çš„å…³ç³»

::: details ğŸ’¡ 

:::

### â“`InheritedWidget` å®ç°åŸç†

::: details ğŸ’¡ 

> `InheritedWidget` å…è®¸åœ¨ `Widget` æ ‘ä¸­æœ‰æ•ˆåœ°ä¼ é€’æ•°æ®ã€‚

  - åœ¨åº”ç”¨çš„é¡¶éƒ¨åˆ›å»ºä¸€ä¸ª `InheritedWidget` æ—¶ï¼Œå…¶å­ `Widget` å¯ä»¥é€šè¿‡è°ƒç”¨ `context.dependOnInheritedWidgetOfExactType<MyInheritedWidget>()` æ¥è·å–è¿™ä¸ª `InheritedWidget`ã€‚

  - åœ¨ `InheritedWidget` çš„å†…éƒ¨ï¼Œå®ƒçš„æ•°æ®çš„å­˜å‚¨å’Œè®¿é—®å®é™…ä¸Šæ˜¯é€šè¿‡ `BuildContext` æ¥å®ç°çš„ã€‚`BuildContext` å®é™…ä¸Šå°±åƒæ˜¯ `Widget` æ ‘çš„ä¸€çº§ä¸€çº§èŠ‚ç‚¹çš„å¿«ç…§ï¼Œå®ƒçŸ¥é“å½“å‰èŠ‚ç‚¹åœ¨æ ‘ä¸­çš„ä½ç½®ï¼ŒçŸ¥é“å®ƒçš„çˆ¶èŠ‚ç‚¹æ˜¯è°ï¼Œä¹ŸçŸ¥é“å®ƒæ˜¯åœ¨ä»€ä¹ˆæ—¶é—´è¢«åˆ›å»ºçš„ã€‚

  - è°ƒç”¨ `context.dependOnInheritedWidgetOfExactType<MyInheritedWidget>()` çš„æ—¶å€™ï¼Œ`BuildContext` å®é™…ä¸Šæ˜¯åœ¨ `Widget` æ ‘ä¸­å‘ä¸Šå¯»æ‰¾ï¼Œç›´åˆ°æ‰¾åˆ°å¯¹åº”çš„ `InheritedWidget` ä¸ºæ­¢ã€‚å¦‚æ­¤ä¸€æ¥ï¼Œå³ä½¿å½“å‰çš„ `Widget` åœ¨æ ‘ä¸­å¾ˆæ·±çš„åœ°æ–¹ï¼Œä¹Ÿå¯ä»¥éå¸¸é«˜æ•ˆåœ°è®¿é—®åˆ°æ ‘ä¸­æ›´é«˜å±‚çš„ `InheritedWidget`ã€‚

```dart
  class MyInheritedWidgetData {
    const MyInheritedWidgetData(this.message);
    final String message;
  }
  
  class MyInheritedWidget extends InheritedWidget {
    const MyInheritedWidget({
      Key key,
      @required Widget child,
      @required this.data,
    }) : super(key: key, child: child);

    final MyInheritedWidgetData data;

    static MyInheritedWidgetData of(BuildContext context) {
      final MyInheritedWidget result =
          context.dependOnInheritedWidgetOfExactType<MyInheritedWidget>();
      return result.data;
    }

    @override
    bool updateShouldNotify(MyInheritedWidget oldWidget) {
      return data.message != oldWidget.data.message;
    }
  }
```

:::

------

## Package

### â“`Provider` `BLoc` `GetX` åŒºåˆ«
  
::: details ğŸ’¡ 

  - `Provider` æ˜¯ä¸šç•Œå¹¶ä¸” `Google` å®˜æ–¹æ¨èçš„çŠ¶æ€ç®¡ç†åº“ï¼Œå®ƒæ˜¯åŸºäº `InheritedWidget` çš„æ•°æ®æµä¼ é€’ã€‚å®ƒå¯ä»¥ç›´æ¥ä½¿ç”¨çŠ¶æ€ï¼ŒçŠ¶æ€å˜åŒ–è‡ªåŠ¨é€šçŸ¥å…¶ä¾èµ–ç»„ä»¶è¿›è¡Œåˆ·æ–°ï¼Œä½¿ç”¨ç®€ç›´ä¸”å…¥é—¨å®¹æ˜“ã€‚

  - `BLoCï¼ˆBusiness Logic Componentï¼‰` æ˜¯ `Google` æ¨å‡ºçš„ä¸€ç§åº”ç”¨ç¨‹åºæ¶æ„è®¾è®¡æ¨¡å¼ã€‚å…¶æ ¸å¿ƒæ¦‚å¿µæ˜¯ï¼Œé€šè¿‡ä½¿ç”¨ `Dart` çš„`Stream` å°†æ•°æ®çš„è¾“å…¥è¾“å‡ºæŠ½è±¡ä¸º `Sink` å’Œ `Stream`ï¼Œè¿›è¡Œä¸šåŠ¡é€»è¾‘å¤„ç†ã€‚`BLoC` ç›¸æ¯” `Provider` æ›´é€‚åˆå¤§å‹é¡¹ç›®ï¼Œå¯ä»¥å®ç°æ›´å¤§ç¨‹åº¦çš„ä»£ç è§£è€¦ã€‚

  - `GetX` æ˜¯æ¥è‡ªç¤¾åŒºçš„ `Flutter` åº“ï¼Œå®ƒä¸ä»…å®ç°äº†çŠ¶æ€ç®¡ç†ï¼Œè¿˜æä¾›äº†è·¯ç”±ç®¡ç†ï¼Œä¾èµ–æ³¨å…¥ç­‰åŠŸèƒ½ã€‚`GetX` ä¼˜åŠ¿åœ¨äºå…¶ç®€æ´çš„ `API`ã€é«˜æ•ˆçš„æ€§èƒ½ä»¥åŠå¯¹ç©ºå®‰å…¨çš„å¤©ç„¶æ”¯æŒã€‚

:::
  
### â“`Provider` å®ç°åŸç†

::: details ğŸ’¡ 
 
> `Provider` æ˜¯ä¸€ç§éå¸¸æµè¡Œçš„çŠ¶æ€ç®¡ç†å·¥å…·ã€‚å®ç°åŸç†ä¸»è¦åˆ©ç”¨äº† `Flutter` ä¸­çš„ `InheritedWidget` å’Œ `ChangeNotifier`ã€‚

  - `InheritedWidget`: ä¸€ä¸ªèƒ½åœ¨å­ `Widget` æ ‘ä¸­å¿«é€Ÿæä¾›æ•°æ®çš„ `Widget`ï¼Œé€šè¿‡å®ƒå¯ä»¥å®ç°æ•°æ®åœ¨ `Widget` æ ‘ä¸­çš„å‘ä¸‹ä¼ é€’ã€‚

  - `ChangeNotifier`: å¯ä»¥å°†å®ƒç†è§£ä¸ºä¸€ä¸ªå¯ä»¥é€šçŸ¥ `Flutter` `UI` å‘ç”Ÿæ›´æ–°çš„æ–¹æ³•ï¼Œé€šå¸¸æ˜¯å®ƒçš„æ¨¡å‹å‘ç”Ÿæ”¹å˜ã€è·å¾—æ–°æ•°æ®æˆ–å˜ä¸ºç©ºçš„æ—¶å€™ã€‚å½“æ•°æ®æ”¹å˜çš„æ—¶å€™ï¼Œå¯ä»¥è°ƒç”¨ `ChangeNotifier.notifyListeners()` è¿™æ ·çš„è¯ï¼Œæ‰€æœ‰çš„ç›‘å¬å™¨ï¼ˆ`UI`ï¼‰ä¼šæ¥æ”¶é€šçŸ¥ï¼Œè¿›è¡Œå¯¹åº”çš„ä¸šåŠ¡å¤„ç†ï¼Œæ¯”å¦‚åˆ·æ–° `UI`ã€‚

åœ¨ä½¿ç”¨ `Provider` çš„æ—¶å€™ï¼Œä¼šåˆ›å»ºä¸€ä¸ªç»§æ‰¿è‡ª `ChangeNotifier` çš„æ•°æ®æ¨¡å‹ï¼Œå¹¶æŠŠå®ƒæä¾›ç»™é‚£äº›éœ€è¦è¿™äº›æ•°æ®çš„ `Widget`ã€‚åœ¨éœ€è¦æ¥æ”¶æ•°æ®çš„ `Widget` ä¸­ï¼Œä½¿ç”¨ `Provider.of` æˆ–è€… `Consumer` æ¥æ¥æ”¶æ•°æ®ã€‚å¹¶ä¸”æ˜ç¡®äº†å½“æ•°æ®å‘é€æ”¹å˜çš„æ—¶å€™æ˜¯å¦éœ€è¦ `Widget` æ˜¾ç¤ºåˆ·æ–°ã€‚

:::
  
### â“è¯´ä¸€ä¸‹ `BLoC` æ¨¡å¼

::: details ğŸ’¡ 

> `BLoC`ï¼ˆBusiness Logic Componentï¼‰æ˜¯ `Google` æ¨å‡ºçš„ä¸€ç§åº”ç”¨ç¨‹åºæ¶æ„è®¾è®¡æ¨¡å¼ã€‚å…¶æ ¸å¿ƒæ¦‚å¿µæ˜¯ï¼Œå°†"äº‹ä»¶(`event`)"æµè½¬æ¢ä¸º"çŠ¶æ€(`state`)"æµã€‚

ä½¿ç”¨æµç¨‹ï¼š

  - å®šä¹‰äº‹ä»¶ï¼ˆ`Event`ï¼‰ï¼šè¿™äº›äº‹ä»¶è¡¨ç¤ºå¯ä»¥ä»ç”¨æˆ·ç•Œé¢å‘é€åˆ° `BLoC` çš„å„ç§æ“ä½œ
    > ä¾‹å¦‚ç”¨æˆ·çš„ç‚¹å‡»ï¼Œæ‹–åŠ¨ä»¥åŠå…¶ä»–è¡Œä¸ºã€‚

  - å®šä¹‰çŠ¶æ€ï¼ˆ`State`ï¼‰ï¼šè¿™äº›çŠ¶æ€è¡¨ç¤º `BLoC` åœ¨æ¥æ”¶äº‹ä»¶åå¯èƒ½å¤„äºçš„ä¸åŒçŠ¶æ€
    > ä¾‹å¦‚åŠ è½½ï¼ŒæˆåŠŸï¼Œé”™è¯¯ç­‰ã€‚

  - åˆ›å»º `BLoC`ï¼š ç”Ÿäº§çŠ¶æ€(`state`)æµï¼Œå¹¶æ¶ˆè´¹äº‹ä»¶(`event`)æµã€‚åœ¨ `BLoC` å†…éƒ¨ï¼Œä½¿ç”¨ä¸€ä¸ªæˆ–å¤šä¸ª `Stream` æ¥è¡¨ç¤ºçŠ¶æ€ï¼Œä½¿ç”¨ `Sink` æ¥æ¥æ”¶äº‹ä»¶ã€‚`BLoC` é‡Œé¢çš„ä¸šåŠ¡é€»è¾‘å°±æ˜¯å°†äº‹ä»¶æµè½¬å˜ä¸ºçŠ¶æ€æµã€‚

  - `UI` ä¸­ä½¿ç”¨ `BLoC`ï¼šé€šå¸¸ä½¿ç”¨ `StreamBuilder` å’Œå„ç§äº‹ä»¶è§¦å‘å™¨å¦‚æŒ‰é’®ç‚¹å‡»ï¼Œæ¥è¿æ¥ `BLoC` å’Œ `UI`ã€‚

ä¼˜ç‚¹ï¼šå¯ä»¥å°†ä¸šåŠ¡é€»è¾‘å®Œå…¨ä» `UI` å±‚ä¸­åˆ†ç¦»å‡ºæ¥ï¼Œä½¿å¾—ä»£ç æ›´åŠ æ¨¡å—åŒ–å¹¶ä¸”æ˜“äºæµ‹è¯•ã€‚ä¹Ÿæé«˜äº†åº”ç”¨çš„å“åº”æ€§ï¼Œå› ä¸ºå®ƒåŸºäºæµï¼Œå¯ä»¥ä¾¿æ·åœ°å¤„ç†å¼‚æ­¥æ“ä½œå’Œå„ç§äº‹ä»¶ã€‚

:::