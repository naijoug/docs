---
title: 入门知识
icon: hashtag

index: true

---

## 类型定义

### 常量 & 变量

```dart
// const: 常量
const PI = 3.14159; // 声明编译时常量
final date = Date().now; // 声明运行时常量

// 变量
//  - 通过 var 声明变量
var num = 10; // 编译器自动推断为 int
//  - 通过类型明确指定类型
String str = 'hello dart.'; // 声明字符串变量
```

### 全局变量 vs 静态变量

```dart
// 全局变量，计数器
int globalCounter = 0;

// 静态变量，计数器
class Counter {
  // static 在类里面修饰静态属性
  static int count = 0;
  // static 在类里面修饰静态方法
  static tick() {
    count += 1;
  }
}

void main() {
  globalCounter += 1;
  Counter.count += 1;   
  Counter.tick();
}
```

### `const` vs `final`

  - `const`: 编译时常量，赋值一次，指向的对象不可变，对象内部的字段也不可变。
  - `final`: 运行时常量，只能被赋值一次，`final` 指向的对象不可以变，但是对象内部的字段可变。

```dart
// const
const pi = 3.14159;
const date = DateTime().now(); // 编译时 ❌ 
const arr = [1, 2, 3];
arr[0] = 0; // ❌ 

// final
final date = DateTime().now();
final arr = [1, 2, 3];
arr[0] = 0; // ✅
arr = [3, 4, 5]; // ❌
```

### `var` vs `Object` vs `dynamic`

  - `var`: 声明对象会自动推断类型，之后类型不能改变。
  - `Object`: 是所有 `Dart` 类型的基类，可以将任务类型值赋值给 `Object`。
  - `dynamic`: 可以进行任意类型值赋值，编译时不检查类型，运行时进行类型检查。

```dart
// var
var name = 'dart'; // name 类型推断为 String
name = 1; // ❌

// Object
Object obj = 1; 
obj = 'dart'; // ✅
obj.length; // ❌，只能调用 Object 类中的方法

// dynamic
dynamic age = 1; 
age = 'dart'; 
age.foo(); // // 编译时 ✅，运行时 ❌
```

### `late` 

> `late` 关键字允许推迟初始化一个非空变量。变量可以在声明时不被初始化，在后续某个时刻再进行初始化。

```dart
// 全局延迟变量
late String description;

class MyClass {
  // 类属性延迟变量
  late String description;

  MyClass() { 
    // 类初始化时，进行初始化
    description = 'Hello, World';
  }
}

void main() {
  description = 'Hello, World';
  print(description);
  
  var myClass = MyClass();
  print(myClass.description);
} 
```

### `typedef`

> `typedef`: 类型定义，可以为函数类型指定可读的别名。

  - 提升代码的可读性：可以为复杂的函数类型提供更简洁、更清晰的名字。
  - 提供代码复用：允许在多个地方重复使用相同的函数类型，而无需每次都重新定义它。
    
```dart
typedef IntHandler = void Function(int);

void printNumber(IntHandler handler) {
  handler(10);
}

void main() {
  printNumber((num) => print('Number is $num'));  // "Number is 10"
}
```

------

## 数据类型

### 数据类型一览

| 类型 | 说明 
| -- | -- 
| `bool`            | 布尔值
| `int`             | 整形
| `double`          | 浮点数
| |
| `String`          | 字符串
| `StringBuffer`    | 缓冲字符串
| |
| `List`            | 列表
| `Set`             | 集合
| `Map`             | 哈希表
| |
| `Duration`        | 时长
| `DateTime`        | 日期时间

```dart
// bool: 布尔值
bool isOk = true;
// int: 整形
int num = 42;
// double: 浮点数
double ratio = 0.618;

// String: 字符串
String country = 'China';
// StringBuffer
var sb = StringBuffer();
sb.write('Hello');
sb.write(',');
sb.write('world.');
sb.toString(); // Hello,world.

// List: 列表
List<int> nums = [1, 2, 3];
// Set: 集合
// Map: 哈希表
Map<String, int> map = {
    'one': 1,
    'two': 2,
    'three': 3
};

// Duration: 时长

// DateTime: 日期时间

```

### 字符串

```dart
// 字符串创建
//  - 单引号字符串
String name = 'peter';
//  - 双引号字符串
String country = "China";
//  - 多行字符串
String multi = '''
- one
- two
- three
'''
//  - 模版字符串
String intro = 'My name is ${name}';
//  如果 {} 内仅包含一个变量标识符，可以省略 {}。
String intro = 'My name is $name';

// 字符串操作
//  - 增
var str = 'Hello' + ', world.'
str += ' Hello dart.'
//  - 删
str.trim(); // 去除字符串前后空格字符
//  - 改
str.replaceAll('Hello', 'Hi'); // 替换字符串
str.toLowerCase(); // 转化为小写字母
str.toUpperCase(); // 转化为大写字母
//  - 查
str.isEmpty; // 字符串是否为空
str.contains('dart');       // 判断字符串是否包含某字符串
str.startsWith('Hello');    // 判断字符串是否包含某前缀字符串
str.endsWith('.');          // 判断字符串是否包含某后缀字符串
int idx = str.indexOf(','); // 获取子串在字符串中的起始索引值
```

### 集合类型

> `List`: 列表

```dart
// 列表创建
//  - 定长数组
List<int> nums = List<int>.filled(3, 0); // 创建长度为 3 的数组，初始化值为 0
//  - 动态数组
List<int> nums = []; // 创建空数组
List<int> nums = [1, 2, 3];

// 列表操作
//  - 增
nums.add(4); // 添加元素
nums.addAll([5, 6, 7]);     // 添加多个元素
nums = nums + [4, 5, 6];    // 列表加法
//  - 删
nums.remove(3);     // 移除元素 3
nums.removeAt(0);   // 移除索引值为 0 的元素
//  - 改
nums.insert(0, 0); // 在索引插入一个元素
nums.insertAll(0， [-1, 0]); // 在指定索引插入多个元素
nums.sort();    // 排序(升序)
nums.reversed;  // 反转
nums.shuffle(); // 打乱，使用洗牌算法打乱列表
//  - 查
nums.isEmpty;   // 列表是否为空
nums.length;    // 列表的长度
nums.first;     // 列表的第一个元素
nums.last;      // 列表最后一个元素
nums.sublist(1, 3); // 获取指定索引范围子列表 [left, right)，左闭右开
int idx = nums.indexOf(3); // 查询指定元素索引
int idx = nums.indexWhere((num) => num == 3); // 查询指定条件元素索引 
```

> `Set`: 集合

```dart
// 集合创建
var set = Set<int>();
var set = <int>{}; // 空集合
var set= {1, 2, 3};

// 集合操作
//  - 增
set.add(1);     // 添加单个元素
set.addAll([2, 3, 4, 5]);   // 添加多个元素
//  - 删
set.remove(2);  // 删除指定元素
set.removeAll([2, 3, 4]);               // 删除多个元素
set.removeWhere({(item) => item == 3}); // 删除指定条件元素
set.clear();    // 清空集合
//  - 改
set.add(1);     // 插入重复元素，仅保留一个
//  - 查
set.isEmpty;    // 集合是否为空
set.length;     // 获取集合长度
set.first;      // 获取集合第一个元素
set.last;       // 获取集合最后一个元素
set.contains(1);            // 查询集合是否包含某个值
set.containsAll([1, 2]);    // 查询集合是否包含多个值

// 集合运算
var a = Set<int>{ 1, 2, 3 };
var b = Set<int>{ 2, 3, 4 };
//  - 交集
a.intersection(b);  // 取交集，[2, 3]
//  - 并集
a.union(b);         // 取并集，[1, 2, 3, 4]
//  - 差值
a.difference(b);    // 取差值，[1]

// 集合转化
//  - Set -> List
set.toList(); 
```

> `Map`: 哈希表

```dart
// 哈希表创建
//  - 字面量创建
var map = {'one': 1, 'two': 2};
//  - 指定类型创建
var map = Map<String, int>();
var map = {}; // 空哈希表

// 哈希表操作
//  - 增
map['one'] = 1;
map['two'] = 2;
map.addAll({'three': 3, 'four': 4});
//  - 删
map.remove('one');  // 删除指定键数据
map.removeWhere((key, value) => key == 'one'); // 删除指定条件键值
map.clear();        // 清空哈希表
//  - 改
map['one'] = 11; 
map.update('one', (value) => value + 1);    // 更新指定键值
map.updateAll((key, value) => value * 10);  // 更新所有键值
//  - 查
map['one'];     // 获取指定键值
map.isEmpty;    // 哈希表是否为空
map.length;     // 哈希表长度
map.keys;       // 获取键列表
map.values;     // 获取值列表
map.containsKey('three');   // 查询哈希表是否包含某个键
map.containsValue(3);       // 查询哈希表是否包含某个值
```

### 可空类型

> `null safety`: 空安全

```dart
// 非空类型，不能被设置为 null
String a; 
a = null; // 编译 ❌

// 可空类型，可以被设置为 null
String? a; 
a = null;  // ✅

// 可空类型强制解包
a = 'dart';
var b = a!; // 此时 b 字符串 未非空类型。
```

### 类型转换

```dart
// String -> int
int num = int.parse('30');
// int -> String
num.toString();

// String -> double
int pi = double.parse('3.14');
// double -> String
pi.toString();

// double -> int
int i = pi.toInt();
// int -> double
double d = num.toDouble();
```

------

## 操作符

### 算术运算符 `+ - * / ~/ %`

  - `/` : 除法，计算结果为 double
  - `~/` : 取整，得到两数相除的整数结果
  - `%`: 取余

```dart
int a = 10;
int b = 5;
var c = (a + b) / 2; // c 为 double，值为 7.5
var d = (a + b) ~/ 2; // d 为 int， 值为 7
```

### 比较运算符 `= > <`

```dart
int a = 1;
int b = 2;
bool result = a == b;
bool result = a != b;
bool result = a > b;
bool result = a < b;
```

### 逻辑运算符 `&& || !`

```dart

```

### 位运算符 `& | ~ ^ << >>`

```dart

```

### 条件表达式 `?: ??`

```dart
// ?: - 条件表达式
var isOk = true;
var result = isOk ? 'success' : 'failure';

// ?? - 可选择取值表达式，不为空返回该值，为空返回后面值
var name: String?
name = name ?? 'peter';
name ??= 'peter';
```

### 级联操作符 `..`

```dart

```

------

## 流程控制

### 分支 `if-else switch-case`

```dart
// if-else
bool isDone = true;
if (isDone) {
    print('done!');
} else {
    print('todo!');
}

// switch-case
//  - 基础类型中使用
String key = 'one';
switch key {
    case 'one'; 
        print('1');
        break;
    case 'two':
        print('2');
        break;
    default:
        print('404');
}   
//  - 枚举中使用
enum Arrow { top, bottom, left, right }
var arrow = Arrow.top;
switch arrow {
    case Arrow.top: 
        print('arrow top');
        break;
    case Arrow.bottom:
        print('arrow bottom');
        break;
    case Arrow.left:
        print('arrow left');
        break;
    case Arrow.right:
        print('arrow right');   
        break;
}
```

### 循环 `for while`

```dart
// 打印 0 ~ 99
//  - for 循环
for (var i = 0; i < 100; i++) {
    print(i); 
}
//  - while 循环
var count = 0;
while (count < 100) {
    print(count);
    count += 1;
}
//  - do-while 循环
var isDone = false;
do {
    print('do it');
} while(isDone);
```

------

## 函数

### 函数类型

> 所有函数都是 `Function` 对象，函数可以被分配给变量或者作为参数传递给其它函数。也可以将函数赋值给 `Function` 类型的变量。

```dart
// Function 定义函数
int Function(int, int) add = (int a, int b) {
  return a + b;
};
add(1, 1);
// Function 定义可选参数函数
String Function(String, [String]) say = (String name, [String msg]) {
  var result = 'Hello $name';
  if (msg != null) {
    result = '$result. $msg';
  }
  return result;
};
say('Peter');
```

### 普通函数

```dart
// 无参数、无返回值函数
void doSomething() {
    print('do something.');
}
doSomething();

// 有参数，有返回值函数
int add(int a, int b) {
    return a + b;
} 
add(1, 1); // 1 + 1 = 2
```

### 可选参数函数

```dart
// 可选(默认)参数: 使用 [] 进行包裹
void greet(String name, [String? msg]) {
  print('$name!');
  if (msg != null) {
    print('$msg, $name!');
  }
}
// 可选参数，设置默认值
void greet(String name, [String msg = 'Hello']) {
  print('$msg, $name!');
}
greet('Peter'); // Hello, Peter!
greet('Peter', 'Hi'); // Hi, Peter!
```

### 命名参数函数

```dart
// 命名参数: 使用 {} 进行包裹
void greet({String name, int age}) {
  print('Welcome $name! You are $age years old.');
}
greet(name: 'Peter', age: 6);
```

### 箭头函数

```dart
// `=>` 函数就是 `{ return expression; }` 的语法糖
void greet(String name) => print('Hello, $name!');
greet('Peter');
```

### 嵌套函数

```dart
// 外部函数
void outter() {
    // 内部嵌套函数
    void inner() {
        print('This is inner func.');
    }
    print('This is outer func.');
    inner();
}
```

### 闭包

```dart

```

### 匿名函数

```dart

```

### 高阶函数

```dart
// 函数作为返回值
Function makeMultiplier(int multiplier) {
  return (int item) => item * multiplier;
}
var multi2 = makeMultiplier(2);
var multi3 = makeMultiplier(3);
multi2(2); // 4
multi3(3); // 6

// 函数作为参数
void modifyList(List<int> list, Function action) {
  for (int i = 0; i < list.length; i++) {
    list[i] = action(list[i]);
  }
}
modifyList([1, 2, 3], (number) => number * 2); // [2, 4, 6]
```

