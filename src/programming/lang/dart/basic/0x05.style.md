---
title: Code Style- â€œç¼–ç è§„èŒƒâ€
icon: hashtag

index: true

---

## reference

- [Effective Dart](https://dart.dev/effective-dart) ğŸ‘‰ğŸ» [ğŸ‡¨ğŸ‡³](https://dart.cn/effective-dart)
- [Google Style Guides](https://google.github.io/styleguide/) : [Google å¼€æºé¡¹ç›®é£æ ¼æŒ‡å—](http://zh-google-styleguide.readthedocs.io/en/latest/)

## æ ¸å¿ƒåŸåˆ™

- å¯è¯»æ€§ï¼šæä¾›æ¸…æ™°çš„ä»£ç ç»“æ„
- ç¨³å®šæ€§ï¼šå‡å°‘æ½œåœ¨çš„é”™è¯¯é£é™©
- å¯ç»´æŠ¤æ€§ï¼šä»£ç æ˜“äºç†è§£å’Œä¿®æ”¹
- å¯æµ‹è¯•æ€§ï¼šä¾¿äºç¼–å†™å’Œç»´æŠ¤æµ‹è¯•
- å›¢é˜Ÿåä½œï¼šæä¾›ç»Ÿä¸€çš„ä»£ç é£æ ¼

## é€šç”¨

### ç‰ˆæœ¬ç®¡ç†

#### æäº¤æ¶ˆæ¯è§„èŒƒ

- `feat`: æ·»åŠ æ–°ç‰¹æ€§
- `fix`: ä¿®å¤ bug
- `docs`: ä¿®æ”¹æ–‡æ¡£
- `update`: æ›´æ–°å†…å®¹
- `comment`: æ·»åŠ æ³¨é‡Š
- `tidy`: æ•´ç†ä»£ç 
- `refactor`: é‡æ„ä»£ç 
...

```git
âœ…
feat: æ·»åŠ ç”¨æˆ·ç™»å½•åŠŸèƒ½
fix: ä¿®å¤ç”¨æˆ·æ— æ³•é€€å‡ºçš„é—®é¢˜

âŒ
æäº¤ä»£ç 
update.
```

## Dart

### å‘½åè§„èŒƒ

#### æ–‡ä»¶å‘½åè§„èŒƒ

```dart
// âœ… æ­£ç¡®ç¤ºä¾‹
user_profile_screen.dart
shopping_cart_widget.dart
auth_service.dart

// âŒ é”™è¯¯ç¤ºä¾‹
userProfile.dart
UserProfile.dart
shopping-cart.dart
```

#### æ–‡ä»¶å¯¼å…¥è§„èŒƒ

```dart
// âœ…
import 'package:flutter/material.dart';

import 'utils/my_utils.dart';

// âŒ
import 'utils/my_utils.dart';
import 'package:flutter/material.dart';
```

#### ç±»ä¸ç±»å‹å‘½å

> è§„åˆ™

- ç±»åä½¿ç”¨**å¤§é©¼å³°**å‘½åæ³•ï¼ˆ`UpperCamelCase`ï¼‰
- ç±»ååº”è¯¥ç®€æ´ä¸”å…·æœ‰æè¿°æ€§
- å°½é‡ä¸è¦æ˜¯ä½¿ç”¨æ— æ„ä¹‰çš„ç¼©å†™ï¼Œé™¤äº†å¸¸è§çš„ç¼©å†™å¦‚ `URL`ã€`ID`

```dart
// âœ… 
class UserProfile { } 
class ShoppingCart { }

// âŒ 
class userprofile { }
class shopping_cart { }
```

> ç†ç”±

- ç¬¦åˆ `Dart` è¯­è¨€çš„å®˜æ–¹æ¨èè§„èŒƒ
- ä½¿ç±»ååœ¨ä»£ç ä¸­æ›´å®¹æ˜“è¯†åˆ«ï¼Œä¸å˜é‡å’Œæ–¹æ³•åæ˜æ˜¾åŒºåˆ†
- ä¸å…¶ä»–ä¸»æµç¼–ç¨‹è¯­è¨€ï¼ˆå¦‚ `Javaã€Swift`ï¼‰çš„å‘½åæƒ¯ä¾‹ä¿æŒä¸€è‡´ï¼Œé™ä½å¤šè¯­è¨€å¼€å‘è€…çš„å­¦ä¹ æˆæœ¬

#### å˜é‡ä¸æ–¹æ³•å‘½å

> è§„åˆ™

- å˜é‡å’Œæ–¹æ³•ä½¿ç”¨**å°é©¼å³°**å‘½åæ³•ï¼ˆ`lowerCamelCase`ï¼‰
- é¿å…ä½¿ç”¨å•å­—æ¯å‘½åï¼Œé™¤éæ˜¯å¾ªç¯è®¡æ•°å™¨

```dart
// âœ… 
String userName;
void calculateTotal() { }
int itemCount;

// âŒ 
String UserName;
void calc_tot() { }
int i;
```

> ç†ç”±

- ç¬¦åˆ `Dart` è¯­è¨€çš„å®˜æ–¹æ¨èè§„èŒƒ
- å˜é‡åæ¸…æ™°è¡¨è¾¾å…¶ç”¨é€”ï¼Œä¾¿äºç†è§£å’Œç»´æŠ¤
- é¿å…ä½¿ç”¨å•å­—æ¯å‘½åå¯ä»¥æé«˜ä»£ç **è‡ªæ–‡æ¡£åŒ–**ç¨‹åº¦

#### å¸¸é‡å‘½å

- å¸¸é‡ä½¿ç”¨**å°é©¼å³°**å‘½åæ³•
- é™æ€å¸¸é‡ä½¿ç”¨ `static const`

```dart
// âœ…
const double piValue = 3.14159;
static const int maxRetryCount = 3;
const String apiBaseUrl = 'https://api.example.com';

// âŒ
const double PI_VALUE = 3.14159;
static const int MaxRetryCount = 3;
const String API_BASE_URL = 'https://api.example.com';
```

### ä»£ç é£æ ¼

> å®Œæˆä»£ç ç¼–å†™åï¼Œå°½é‡ä½¿ç”¨ `formart` è¿›è¡Œä¸€æ¬¡ä»£ç æ ¼å¼åŒ–ã€‚

#### è¡Œé•¿

> è§„åˆ™

- `dart formart` é»˜è®¤è¡Œé•¿ä¸º 80ï¼Œæœ‰ç‚¹è¿‡çŸ­ï¼Œå¯ä»¥ç»Ÿä¸€ä¸º 100ã€‚

#### ç¼©è¿›

> è§„åˆ™

- ä½¿ç”¨ 2 ä¸ªç©ºæ ¼è¿›è¡Œç¼©è¿›

```dart
// âœ…
if (isEnabled) {
  print('Enabled');
}

// âŒ
if(isEnabled){
print('Enabled');
}
```

> ç†ç”±

- ä¿æŒä»£ç çš„è§†è§‰å±‚æ¬¡ç»“æ„æ¸…æ™°
- æé«˜ä»£ç å¯è¯»æ€§

#### ç©ºæ ¼

> è§„åˆ™

- åœ¨æ“ä½œç¬¦ã€å…³é”®å­—å‰åæ·»åŠ ç©ºæ ¼

```dart
// âœ…
if (isEnabled) {
  print('Enabled');
}
int sum = a + b;

// âŒ
if(isEnabled){
  print('Enabled');}
int sum=a+b;
```

> ç†ç”±

- å‡å°‘ä»£ç å¯†åº¦ï¼Œé™ä½é˜…è¯»ç–²åŠ³ï¼Œæé«˜ä»£ç å¯è¯»æ€§
- ä¾¿äºå¿«é€Ÿè¯†åˆ«è¿ç®—é€»è¾‘ï¼Œä½¿æ“ä½œç¬¦å’Œæ“ä½œæ•°ä¹‹é—´çš„å…³ç³»æ›´æ¸…æ™°

#### ä»£ç å—

- å¤§æ‹¬å·çš„å¼€æ‹¬å·ä¸æ¢è¡Œ
- å³ä½¿æ˜¯å•è¡Œ `if` è¯­å¥ä¹Ÿä½¿ç”¨å¤§æ‹¬å·

```dart
// âœ…
if (user != null) {
  return user.name;
}
if (isError) return;

// âŒ
if (user != null)
  return user.name;

if (user != null) 
{
  return user.name;
}
```

> ç†ç”±

- åœ¨ä¸åŒç¼–è¾‘å™¨å’Œå¹³å°ä¸‹æ˜¾ç¤ºä¸€è‡´æ€§
- å‡å°‘ä»£ç å ç”¨çš„æ°´å¹³ç©ºé—´ï¼Œé¿å…è¿‡é•¿çš„è¡Œ

### æ³¨é‡Šè§„èŒƒ

#### ä»£ç æ³¨é‡Š

> è§„åˆ™

- ä½¿ç”¨ `///` æ·»åŠ **æ–‡æ¡£æ³¨é‡Š**
- ä½¿ç”¨ `//` æ·»åŠ å…¶å®ƒæ³¨é‡Š
- æ–‡æ¡£æ³¨é‡Šï¼š å…¬å…± `API`ã€ç±»å’Œæ–¹æ³•

```dart
// âœ…
/// ç”¨æˆ·æ¨¡å‹ç±»ï¼ŒåŒ…å«ç”¨æˆ·çš„åŸºæœ¬ä¿¡æ¯
class User {
  /// ç”¨æˆ·å”¯ä¸€æ ‡è¯†ç¬¦
  final String id;
  
  /// ç”¨æˆ·æ˜¾ç¤ºåç§°
  final String name;
  
  void doSomething() {
    // do somehting....
  }
}

// âŒ
// ç”¨æˆ·ç±»
class User {
  // id
  final String id;
  
  // åç§°
  final String name;
  
  void doSomething() {
    /// do somehting....
  }
}
```

> ç†ç”±

- æœ‰æ„ä¹‰çš„æ³¨é‡Šå’Œæ–‡æ¡£æœ‰åŠ©äºç†è§£ä»£ç çš„ç›®çš„å’Œå·¥ä½œåŸç†ï¼Œæå‡ä»£ç ç»´æŠ¤æ€§ã€‚
- ä¸ºåº“ã€ç±»å’Œæ–¹æ³•æ·»åŠ æ–‡æ¡£æ³¨é‡Šæœ‰åŠ©äºè‡ªåŠ¨ç”Ÿæˆ API æ–‡æ¡£ï¼Œæé«˜ä»£ç å¯è¯»æ€§ã€‚

#### TODO æ³¨é‡Š

```dart
// âœ…
// TODO(alex): æ·»åŠ ç”¨æˆ·å¤´åƒä¸Šä¼ åŠŸèƒ½ - 2024/10/30å‰å®Œæˆ
// TODO(sarah): ä¼˜åŒ–å›¾ç‰‡åŠ è½½æ€§èƒ½ #JIRA-123

// âŒ
// TODO: ä¿®å¤è¿™ä¸ªé—®é¢˜
// TODO ä¹‹åå¤„ç†
```

### å¼‚æ­¥ç¼–ç¨‹

#### å¼‚æ­¥æ–¹æ³•

- ä¼˜å…ˆä½¿ç”¨ `async/await` è€Œä¸æ˜¯ç›´æ¥ä½¿ç”¨ `Future`
- å¼‚æ­¥æ–¹æ³•ååº”è¯¥è¡¨æ˜å…¶å¼‚æ­¥æ€§è´¨

```dart
// âœ… 
Future<User> fetchUserProfile() async {
  final response = await api.get('/profile');
  return User.fromJson(response);
}

// âŒ 
Future<User> getUserProfile() {
  return api.get('/profile').then((response) {
    return User.fromJson(response);
  });
}
```

### é”™è¯¯å¤„ç†

- ç»Ÿä¸€çš„å¼‚å¸¸å¤„ç†ç­–ç•¥

```dart
// âœ…  
Future<void> handleLogin() async {
  try {
    await authService.login(username, password);
  } catch (e, st) {
    print('login error: ', e, st);
  }
}
  
// ğŸ’¯
Future<void> handleLogin() async {
  try {
    await authService.login(username, password);
  } on AuthException catch (e) {
    showErrorDialog('Authentication failed: ${e.message}');
  } on NetworkException catch (e) {
    showErrorDialog('Network error: ${e.message}');
  } catch (e) {
    showErrorDialog('An unexpected error occurred');
  }
}

// âŒ
Future<void> handleLogin() async {
  await authService.login(username, password);
}
```

> ç†ç”±

- ä¾¿äºé—®é¢˜å®šä½å’Œè°ƒè¯•
- æé«˜ä»£ç çš„å¯ç»´æŠ¤æ€§

### æ—¥å¿—å¤„ç†

- ä¾¿äºè°ƒè¯•å’Œå®šä½ bug
- å¯ä»¥åœ¨å¼€å‘é˜¶æ®µåŠæ—¶å‘ç°é—®é¢˜

```dart
// âœ…
logger.debug('debug log message');  
logger.info('info log message');  
logger.error('error log message');

// âŒ
print('log message.');
```

## Flutter

### Widget ç»„ç»‡

- å°†å¤æ‚çš„ `Widget` æ‹†åˆ†ä¸ºæ›´å°çš„ç»„ä»¶
- ä½¿ç”¨ç§æœ‰ `Widget` æ¥æé«˜ä»£ç å¯è¯»æ€§

```dart
// âœ…
class UserProfilePage extends StatelessWidget {
  @override
  Widget build(BuildContext context) {
    return Column(
      children: [
        _buildHeader(),
        _buildBody(),
        _buildFooter(),
      ],
    );
  }

  Widget _buildHeader() { ... }
  Widget _buildBody() { ... }
  Widget _buildFooter() { ... }
}
// => ä¸ªäººä¹ æƒ¯
class UserProfilePage extends StatelessWidget {
  @override
  Widget build(BuildContext context) {
    return Column(
      children: [
        _headerWidget,
        _bodyWidget,
        _footerWidget,
      ],
    );
  }
    
  Widget get _headerWidget { ... }
  Widget get _bodyWidget { ... }
  Widget get _footerWidget { ... }
}

// âŒ
class UserProfilePage extends StatelessWidget {
  @override
  Widget build(BuildContext context) {
    return Column(
      children: [
        Container(
          child: Text('Header'),
          // å¤§é‡åµŒå¥—çš„ Widget...
        ),
        Container(
          child: Text('Body'),
          // æ›´å¤šåµŒå¥—çš„ Widget...
        ),
      ],
    );
  }
}
```

### Widget å‚æ•°é¡ºåº

- å¿…éœ€å‚æ•°æ”¾åœ¨å¯é€‰å‚æ•°ä¹‹å‰
- ç›¸å…³çš„å‚æ•°æ”¾åœ¨ä¸€èµ·

```dart
// âœ…
class CustomButton extends StatelessWidget {
  const CustomButton({
    super.key,
    required this.onPressed,
    required this.child,
    this.width,
    this.height,
    this.color,
  });
}

// âŒ
class CustomButton extends StatelessWidget {
  const CustomButton({
    this.color,
    required this.child,
    this.width,
    required this.onPressed,
    super.key,
    this.height,
  });
}
```

### Widget ä¼˜åŒ–

> `const` ä¼˜åŒ–: å¯ä»¥å‡å°‘ä¸å¿…è¦çš„é‡ç»˜

```dart
// âœ… 
const Text('Title');
const SizedBox(height: 8);
const Padding(
  padding: EdgeInsets.all(8.0),
  child: Text('Content'),
);

// âŒ 
Text('Title')
SizedBox(height: 8)
Padding(
  padding: EdgeInsets.all(8.0),
  child: Text('Content'),
)
```

> åˆ—è¡¨ä¼˜åŒ–

```dart
// âœ… 
ListView.builder(
  itemCount: items.length,
  itemBuilder: (context, index) => ListItem(
    key: ValueKey(items[index].id),
    item: items[index],
  ),
)

// âŒ 
ListView(
  children: items.map((item) => ListItem(
    item: item,
  )).toList(),
)
```

### èµ„æºç®¡ç†

#### å›¾ç‰‡èµ„æºç®¡ç†

- ä¾¿äºèµ„æºçš„ç®¡ç†å’Œç»´æŠ¤
- æé«˜èµ„æºæ–‡ä»¶çš„å¯å¤ç”¨æ€§

```yaml
# âœ…
assets:
  - assets/images/
  - assets/icons/

# âŒ
assets:
  - assets/icons/logo.png
  - assets/image/icon.png
  - assets/images/background.png
```

#### å›¾ç‰‡ä½¿ç”¨è§„èŒƒ

```dart
// âœ…
Image.asset(
  'assets/images/logo.png',
  width: 100.0,
  height: 100.0,
  fit: BoxFit.cover,
)

// âŒ
Image.asset('assets/images/logo.png')
```

### ä¸»é¢˜å’Œæ ·å¼

```dart
// âœ…
ThemeData theme = ThemeData(
  primaryColor: Colors.blue,
  textTheme: TextTheme(
    headline1: TextStyle(fontSize: 24, fontWeight: FontWeight.bold),
  ),
);

class MyApp extends StatelessWidget {
  @override
  Widget build(BuildContext context) {
    return MaterialApp(
      theme: theme,
      home: HomeScreen(),
    );
  }
}

// âŒ
Text('Title', style: TextStyle(fontSize: 24, fontWeight: FontWeight.bold));
```

### ä¾èµ–ç®¡ç†

#### `pubspec.yaml`

- é¿å…ä½¿ç”¨ `any`
- é¿å…ä½¿ç”¨ä¸ç¡®å®šçš„ç‰ˆæœ¬èŒƒå›´

```yaml
# âœ…
dependencies:
  flutter:
    sdk: flutter
  http: ^0.13.0
  provider: ^6.0.0

dev_dependencies:
  flutter_test:
    sdk: flutter
  flutter_lints: ^2.0.0

# âŒ
dependencies:
  flutter:
    sdk: flutter
  http: any  # é¿å…ä½¿ç”¨ any
  provider: '>6.0.0' # é¿å…ä½¿ç”¨ä¸ç¡®å®šçš„ç‰ˆæœ¬èŒƒå›´
``` 

#### `analysis_options.yaml`


