import{_ as n}from"./plugin-vue_export-helper-x3n3nnut.js";import{o as s,c as a,a as e,f as t}from"./app-932Ytx5b.js";const c={},i=t(`<hr><h2 id="state-çŠ¶æ€" tabindex="-1"><a class="header-anchor" href="#state-çŠ¶æ€" aria-hidden="true">#</a> State - â€œçŠ¶æ€â€</h2><h3 id="â“è¯´ä¸€ä¸‹ä»€ä¹ˆæ˜¯çŠ¶æ€ç®¡ç†" tabindex="-1"><a class="header-anchor" href="#â“è¯´ä¸€ä¸‹ä»€ä¹ˆæ˜¯çŠ¶æ€ç®¡ç†" aria-hidden="true">#</a> â“è¯´ä¸€ä¸‹ä»€ä¹ˆæ˜¯çŠ¶æ€ç®¡ç†</h3><details class="hint-container details"><summary>ğŸ’¡</summary><blockquote><p>çŠ¶æ€ç®¡ç†ï¼šå¤„ç†åº”ç”¨ä¸­æ•°æ®æ”¹å˜ä»¥åŠæ•°æ®å¦‚ä½•å½±å“åº”ç”¨ç•Œé¢çš„è¿‡ç¨‹ã€‚åœ¨å¼€å‘åº”ç”¨ç¨‹åºæ—¶ï¼Œæ“ä½œçš„æ˜¯ç”¨æˆ·çš„äº¤äº’è¡Œä¸ºï¼Œåå°æ•°æ®ï¼Œä»¥åŠåº”ç”¨å‘ç”¨æˆ·å±•ç¤ºçš„è§†å›¾ï¼Œè¿™äº›å› ç´ çš„æ”¹å˜éƒ½éœ€è¦è¢«é€‚å½“åœ°ç®¡ç†ã€‚æ•°æ®ç®¡ç†å’Œè§†å›¾åé¦ˆçš„è¿‡ç¨‹å°±æ˜¯çŠ¶æ€ç®¡ç†ã€‚</p></blockquote><p>ä¸ºä»€ä¹ˆæˆ‘ä»¬éœ€è¦çŠ¶æ€ç®¡ç†ï¼Ÿ</p><ul><li><p>åœ¨å¤æ‚çš„åº”ç”¨ä¸­ï¼Œæœ‰äº›æ•°æ®éœ€è¦åœ¨å¾ˆå¤šé¡µé¢ä¸­ä½¿ç”¨ã€‚ä½¿ç”¨å…¨å±€çš„çŠ¶æ€ç®¡ç†å¯ä»¥ä½¿åº”ç”¨ä¿æŒåŒæ­¥ï¼Œé¿å…æ•°æ®åœ¨å„ä¸ªé¡µé¢ä¹‹é—´äº§ç”Ÿä¸ä¸€è‡´ã€‚</p></li><li><p>çŠ¶æ€ç®¡ç†åˆ©äºä»£ç çš„ç»“æ„æ¸…æ™°ï¼Œå…·æœ‰å¯æ§æ€§ã€å¯é¢„æµ‹æ€§ã€‚åœ¨å¤§å‹é¡¹ç›®ä¸­å°¤å…¶é‡è¦ï¼Œå› ä¸ºå®ƒæœ‰åŠ©äºé™ä½è°ƒè¯•å’Œç†è§£ä»£ç çš„å¤æ‚æ€§ã€‚</p></li><li><p>çŠ¶æ€ç®¡ç†èƒ½æé«˜æ¸²æŸ“æ•ˆç‡ã€‚åœ¨ <code>React</code> æˆ–è€… <code>Flutter</code> è¿™ç§å£°æ˜å¼ç¼–ç¨‹æ¡†æ¶ä¸­ï¼Œå½“æœ¬åœ°çŠ¶æ€å‘ç”Ÿå˜åŒ–æ—¶ï¼Œä¼šå¼•èµ·ç»„ä»¶çš„é‡æ–°æ¸²æŸ“ï¼Œè€ŒçŠ¶æ€ç®¡ç†åº“é€šè¿‡ç»´æŠ¤ä¸€ä¸ªå•ä¸€çš„çŠ¶æ€æ ‘ï¼Œèƒ½å¤Ÿæœ‰é€‰æ‹©æ€§åœ°é€šçŸ¥æŸä¸€éƒ¨åˆ†çš„ç»„ä»¶å»æ›´æ–°ï¼Œæé«˜æ¸²æŸ“æ•ˆç‡ã€‚</p></li></ul></details><h3 id="â“state-æ€ä¹ˆå®ç°è·¨å¸§å…±äº«" tabindex="-1"><a class="header-anchor" href="#â“state-æ€ä¹ˆå®ç°è·¨å¸§å…±äº«" aria-hidden="true">#</a> â“<code>State</code> æ€ä¹ˆå®ç°è·¨å¸§å…±äº«</h3><details class="hint-container details"><summary>ğŸ’¡</summary><blockquote><p><code>State</code> è·¨å¸§å…±äº«æ˜¯æŒ‡åœ¨ Flutter åº”ç”¨ä¸­ï¼Œå½“ä¸€ä¸ª Widget è¢«é‡å»ºæ—¶ï¼Œå¦‚ä½•ä¿æŒå…¶çŠ¶æ€ä¸ä¸¢å¤±ã€‚</p></blockquote><p>å®ç°æ–¹å¼ï¼š</p><ol><li><p><code>GlobalKey</code></p><ul><li>é€šè¿‡ <code>GlobalKey</code> å¯ä»¥åœ¨æ•´ä¸ªåº”ç”¨ä¸­å”¯ä¸€æ ‡è¯†ä¸€ä¸ª Widget</li><li>å¯ä»¥é€šè¿‡ <code>GlobalKey</code> è·å–å¯¹åº” Widget çš„ State</li><li>é€‚ç”¨äºéœ€è¦åœ¨ Widget æ ‘çš„ä¸åŒä½ç½®è®¿é—®åŒä¸€ä¸ª State çš„åœºæ™¯</li></ul></li><li><p><code>InheritedWidget</code></p><ul><li>é€šè¿‡ <code>InheritedWidget</code> å¯ä»¥åœ¨ Widget æ ‘ä¸­å…±äº«æ•°æ®</li><li>å­ Widget å¯ä»¥é€šè¿‡ <code>BuildContext</code> è·å– <code>InheritedWidget</code> ä¸­çš„æ•°æ®</li><li>å½“ <code>InheritedWidget</code> ä¸­çš„æ•°æ®å‘ç”Ÿå˜åŒ–æ—¶ï¼Œä¾èµ–è¯¥æ•°æ®çš„å­ Widget ä¼šè‡ªåŠ¨é‡å»º</li></ul></li><li><p><code>Provider</code></p><ul><li>åŸºäº <code>InheritedWidget</code> å°è£…çš„çŠ¶æ€ç®¡ç†æ–¹æ¡ˆ</li><li>å¯ä»¥åœ¨ Widget æ ‘çš„ä»»ä½•ä½ç½®è®¿é—®æ•°æ®</li><li>æ”¯æŒæ•°æ®çš„å“åº”å¼æ›´æ–°</li></ul></li><li><p><code>GetX</code></p><ul><li>è½»é‡çº§çš„çŠ¶æ€ç®¡ç†è§£å†³æ–¹æ¡ˆ</li><li>æä¾›ç®€å•çš„ API è¿›è¡ŒçŠ¶æ€ç®¡ç†</li><li>æ”¯æŒå“åº”å¼ç¼–ç¨‹å’Œä¾èµ–æ³¨å…¥</li></ul></li></ol></details><h3 id="â“setstate-åº•å±‚å®ç°" tabindex="-1"><a class="header-anchor" href="#â“setstate-åº•å±‚å®ç°" aria-hidden="true">#</a> â“<code>setState</code> åº•å±‚å®ç°</h3><details class="hint-container details"><summary>ğŸ’¡</summary><div class="language-dart line-numbers-mode" data-ext="dart"><pre class="language-dart"><code><span class="token keyword">void</span> <span class="token function">setState</span><span class="token punctuation">(</span><span class="token class-name">VoidCallback</span> fn<span class="token punctuation">)</span> <span class="token punctuation">{</span>
  <span class="token comment">// è¿›è¡Œä¸€äº›æ–­è¨€æ£€æŸ¥ï¼Œç¡®å®šå½“å‰çš„ State å¯¹è±¡å·²ç» mountedï¼ˆå³å·²ç»è¢«æ·»åŠ åˆ°äº† widgets æ ‘ä¸­ï¼‰ï¼Œå¹¶ä¸”æ²¡æœ‰è¢«disposedï¼ˆå³è¿˜æ²¡æœ‰è¢«é”€æ¯ï¼‰ã€‚</span>
  <span class="token keyword">assert</span><span class="token punctuation">(</span>fn <span class="token operator">!=</span> <span class="token keyword">null</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
  <span class="token keyword">assert</span><span class="token punctuation">(</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token keyword">if</span> <span class="token punctuation">(</span>_debugLifecycleState <span class="token operator">==</span> _ElementLifecycle<span class="token punctuation">.</span>defunct<span class="token punctuation">)</span> <span class="token punctuation">{</span>
      <span class="token comment">// ä¸€ä¸ª StatefulWidget çš„ state å·²ç»è¢«é”€æ¯ï¼ˆdisposeï¼‰ä¹‹åï¼Œä»ç„¶å»è°ƒç”¨ setState æ–¹æ³•</span>
      <span class="token keyword">throw</span> <span class="token class-name">FlutterError</span><span class="token punctuation">.</span><span class="token function">fromParts</span><span class="token punctuation">(</span><span class="token generics"><span class="token punctuation">&lt;</span><span class="token class-name">DiagnosticsNode</span><span class="token punctuation">&gt;</span></span><span class="token punctuation">[</span><span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
      <span class="token comment">/** 
      å…¸å‹åœºæ™¯ï¼šçš„å‘ç”Ÿåœºæ™¯æ˜¯åœ¨ StatefulWidget çš„ state ä¸­å¯åŠ¨äº†ä¸€ä¸ªå®šæ—¶å™¨æˆ–è€…åŠ¨ç”»ï¼Œ
              ä½†æ˜¯å½“ Widget ä¸å†éœ€è¦æ˜¾ç¤ºï¼Œå¹¶è¢«ç³»ç»Ÿé”€æ¯åï¼Œ
              è¿™ä¸ªå®šæ—¶å™¨æˆ–è€…åŠ¨ç”» callback ä»ç„¶åœ¨åå°è¿è¡Œï¼Œå¹¶å°è¯•å»è°ƒç”¨ setState æ–¹æ³•ã€‚
      è§£å†³æ–¹æ¡ˆï¼š
          1&gt; åœ¨ state çš„ dispose æ–¹æ³•ä¸­ï¼Œåœæ­¢æ‰€æœ‰çš„å®šæ—¶å™¨æˆ–è€…åŠ¨ç”»ã€‚è¿™ä¼šé˜»æ­¢å®ƒä»¬åœ¨é”€æ¯åç»§ç»­è¿è¡Œã€‚
             å…·ä½“å®ç°æ–¹æ³•æ˜¯åœ¨ dispose æ–¹æ³•ä¸­è°ƒç”¨å®šæ—¶å™¨çš„ cancel æ–¹æ³•æˆ–è€…åŠ¨ç”»çš„ stop æ–¹æ³•ã€‚
          2&gt; åœ¨è°ƒç”¨ setState ä¹‹å‰ï¼Œé¦–å…ˆæ£€æŸ¥ä¸€ä¸‹ mounted å±æ€§ã€‚
             å¦‚æœ mounted è¿”å› falseï¼Œé‚£ä¹ˆå°±è¯´æ˜è¿™ä¸ª state å·²ç»è¢«ç§»é™¤å‡º Widget æ ‘ï¼Œä¸åº”å†å»è°ƒç”¨ setState æ–¹æ³•ã€‚
      */</span>
    <span class="token punctuation">}</span>
    <span class="token keyword">if</span> <span class="token punctuation">(</span>_debugLifecycleState <span class="token operator">!=</span> _ElementLifecycle<span class="token punctuation">.</span>active<span class="token punctuation">)</span> <span class="token punctuation">{</span>
      <span class="token comment">// åœ¨é”™è¯¯çš„ä¸Šä¸‹æ–‡æˆ–é”™è¯¯çš„çŠ¶æ€è°ƒç”¨ setState() æ–¹æ³•</span>
      <span class="token keyword">throw</span> <span class="token class-name">FlutterError</span><span class="token punctuation">.</span><span class="token function">fromParts</span><span class="token punctuation">(</span><span class="token generics"><span class="token punctuation">&lt;</span><span class="token class-name">DiagnosticsNode</span><span class="token punctuation">&gt;</span></span><span class="token punctuation">[</span><span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
      <span class="token comment">/**
      å…¸å‹åœºæ™¯ï¼šä¸èƒ½åœ¨ä¸€ä¸ª Widget çš„æ„å»ºæ–¹æ³• build() ä¸­è°ƒç”¨ setState() ã€‚
              åŸå› æ˜¯ setState() ä¼šé€šçŸ¥æœ‰çŠ¶æ€çš„æ•°æ®å·²æ›´æ”¹ï¼Œä»è€Œè§¦å‘ build æ–¹æ³•é‡å»º widgetã€‚
              ç„¶è€Œå·²ç»åœ¨ build æ–¹æ³•ä¸­ï¼Œåœ¨æ„å»ºè¿‡ç¨‹ä¸­æ— æ³•é€šçŸ¥ç³»ç»Ÿå…³äºçŠ¶æ€çš„æ›´æ”¹ã€‚
              è¿™å°†å¯¼è‡´ä¸ä¸€è‡´çš„çŠ¶æ€ï¼Œå¹¶å¯èƒ½å¯¼è‡´å…¶ä»–é—®é¢˜ã€‚
      è§£å†³æ–¹æ¡ˆï¼šå°†å¯èƒ½ä¼šæ”¹å˜ Widget çŠ¶æ€çš„é€»è¾‘æ”¾åœ¨äº‹ä»¶å¤„ç†ã€å¼‚æ­¥å¤„ç†ç­‰åœ°æ–¹ï¼Œ
              è€Œä¸æ˜¯ç›´æ¥åœ¨ç”¨æˆ·ç•Œé¢çš„æ¸²æŸ“è¿‡ç¨‹ä¸­è¿›è¡Œæ›´æ”¹ã€‚è¿™æ ·å¯ä»¥é¿å…è¿™ä¸ªé”™è¯¯ã€‚
      */</span>
    <span class="token punctuation">}</span>
    <span class="token keyword">return</span> <span class="token boolean">true</span><span class="token punctuation">;</span>
  <span class="token punctuation">}</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
  <span class="token comment">// è°ƒç”¨ Element çš„ markNeedsBuild æ–¹æ³•ï¼Œæ ‡è®°è¿™ä¸ª Element åœ¨ä¸‹ä¸€æ¬¡ build é˜¶æ®µéœ€è¦é‡å»ºã€‚</span>
  _element<span class="token punctuation">.</span>_element<span class="token punctuation">.</span><span class="token function">markNeedsBuild</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div></details><h3 id="â“markneedsbuild-åº•å±‚å®ç°" tabindex="-1"><a class="header-anchor" href="#â“markneedsbuild-åº•å±‚å®ç°" aria-hidden="true">#</a> â“<code>markNeedsBuild</code> åº•å±‚å®ç°</h3><details class="hint-container details"><summary>ğŸ’¡</summary><blockquote><p><code>markNeedsBuild</code> æ˜¯ <code>Element</code> ç±»çš„ä¸€ä¸ªæ–¹æ³•ï¼Œç”¨äºæ ‡è®°éœ€è¦é‡å»ºæ­¤ <code>Element</code>ã€‚</p></blockquote><div class="language-dart line-numbers-mode" data-ext="dart"><pre class="language-dart"><code><span class="token keyword">void</span> <span class="token function">markNeedsBuild</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
  <span class="token keyword">if</span> <span class="token punctuation">(</span>_dirty<span class="token punctuation">)</span> <span class="token keyword">return</span><span class="token punctuation">;</span>
  <span class="token comment">//  _dirty æ ‡è®°è¢«è®¾ç½®ä¸º trueï¼Œè¡¨ç¤ºè¯¥ Element å·²è¢«â€œå¼„è„â€ï¼Œéœ€è¦åœ¨ä¸‹ä¸€ä¸ª build é˜¶æ®µè¿›è¡Œé‡å»ºã€‚</span>
  _dirty <span class="token operator">=</span> <span class="token boolean">true</span><span class="token punctuation">;</span>
  <span class="token comment">// è¯¥å…ƒç´ è¢«ä¼ é€’ç»™ _scheduleBuildFor æ–¹æ³•ï¼Œä»¥ä¾¿åœ¨ä¸‹ä¸€ä¸ª build å¸ƒå±€å‘¨æœŸä¸­è¿›è¡Œé‡æ–°æ„å»ºã€‚</span>
  <span class="token function">_scheduleBuildFor</span><span class="token punctuation">(</span><span class="token keyword">this</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p>åŸºæœ¬æ€æƒ³ï¼šå»¶è¿Ÿå’Œåˆ†æ‰¹è¿›è¡Œ UI æ›´æ–°ã€‚å½“å‘ç”Ÿäº†å¯èƒ½ä¼šæ”¹å˜UIçš„äº‹ä»¶å¹¶ä¸”è°ƒç”¨äº† <code>markNeedsBuild</code>ï¼Œè€Œä¸æ˜¯ç«‹å³è¿›è¡Œ <code>UI</code> çš„æ›´æ–°ï¼Œ<code>Flutter</code> å°†ä¼šå»¶è¿Ÿåˆ°ä¸‹ä¸€å¸§ï¼Œç„¶åä¸€æ¬¡å¤„ç†æ‰€æœ‰çš„è„å…ƒç´ ï¼Œè¿™ç§æ–¹å¼æé«˜äº†æ•´ä½“çš„æ€§èƒ½æ•ˆç‡ã€‚</p></details><h3 id="â“inflatewidget-çš„ä½œç”¨" tabindex="-1"><a class="header-anchor" href="#â“inflatewidget-çš„ä½œç”¨" aria-hidden="true">#</a> â“<code>inflateWidget</code> çš„ä½œç”¨</h3><details class="hint-container details"><summary>ğŸ’¡</summary><p><code>inflateWidget</code> è¿™ä¸ªæ–¹æ³•ä½äº <code>Element</code> ç±»ä¸­ã€‚å®ƒçš„ä½œç”¨æ˜¯æ ¹æ®æä¾›çš„ <code>Widget</code> åˆ›å»ºæˆ–æ›´æ–°å¯¹åº”çš„ <code>Element</code>ã€‚</p><p><code>Element</code> åœ¨ <code>Flutter</code> ä¸­æ˜¯éå¸¸å…³é”®çš„æ¦‚å¿µï¼Œå®ƒæ˜¯ <code>Widget</code> å’Œ <code>RenderObject</code> çš„æ¡¥æ¥å±‚ã€‚<code>Widget</code> æ˜¯ä¸€æ¬¡æ€§é…ç½®ï¼Œå®ƒæ˜¯ä¸å¯å˜çš„ã€‚è€Œ <code>RenderObject</code> æ˜¯ä¸€ä¸ªåœ¨å±å¹•ä¸Šæ˜¾ç¤ºçš„å¯¹è±¡ï¼Œå®ƒæ˜¯å¯å˜çš„ã€‚<code>Element</code> å°±æ˜¯å°†è¿™ä¸¤è€…è”ç³»äº†èµ·æ¥ï¼Œå®ƒåŒ…å«å¯¹ <code>Widget</code> å’Œ <code>RenderObject</code> çš„å¼•ç”¨ã€‚</p><p>å½“ä¸€ä¸ªæ–°çš„ <code>Widget</code> è¦æ˜¾ç¤ºåœ¨å±å¹•ä¸Šï¼ˆæˆ–è€…å·²æœ‰<code>Widget</code>çš„é…ç½®å‘ç”Ÿæ”¹å˜ï¼‰æ—¶ï¼Œ<code>Flutter</code> å¼•æ“å°±ä¼šè°ƒç”¨ <code>inflateWidget</code> æ–¹æ³•ã€‚<code>inflateWidget</code> ä¼šæ ¹æ®æ–°çš„ <code>Widget</code> åˆ›å»ºå¯¹åº”çš„ <code>Element</code>ï¼ˆå¦‚æœä¸å­˜åœ¨ï¼‰ï¼Œæˆ–è€…æ›´æ–°å·²å­˜åœ¨ <code>Element</code> çš„é…ç½®ã€‚</p></details><hr><h2 id="inheritedwidget-çŠ¶æ€å…±äº«" tabindex="-1"><a class="header-anchor" href="#inheritedwidget-çŠ¶æ€å…±äº«" aria-hidden="true">#</a> InheritedWidget - â€œçŠ¶æ€å…±äº«â€</h2><h3 id="â“inheritedwidget-ä½œç”¨" tabindex="-1"><a class="header-anchor" href="#â“inheritedwidget-ä½œç”¨" aria-hidden="true">#</a> â“<code>InheritedWidget</code> ä½œç”¨</h3><details class="hint-container details"><summary>ğŸ’¡</summary><blockquote><p><code>InheritedWidget</code>ï¼š<code>Flutter</code> ä¸­ä¸€ä¸ªéå¸¸é‡è¦çš„å¹•åè§’è‰²ï¼Œä¸»è¦ç”¨äºåœ¨ <code>Widget</code> æ ‘ä¸­æœ‰æ•ˆåœ°ä¼ é€’æ•°æ®ã€‚</p></blockquote><p>é—®é¢˜ï¼š<code>Flutter</code> ä¸­ <code>Widget</code> æ˜¯ä¸å¯å˜çš„ï¼Œç”±äºå…¶è‡ªèº«ä¸èƒ½æ”¹å˜ï¼Œæ‰€ä»¥å¦‚æœæœ‰ä»»ä½•æ•°æ®æ›´æ”¹ï¼Œæ€»æ˜¯æŒ‰ç…§ä»ä¸Šåˆ°ä¸‹çš„æ–¹å¼é‡æ–°æ„å»ºæ‰€æœ‰çš„ <code>Widget</code>ã€‚ç„¶è€Œè¿™å¯èƒ½å¯¼è‡´é‡ç»˜çš„æ€§èƒ½é—®é¢˜ï¼Œç‰¹åˆ«æ˜¯å¯¹äºå¤§å‹æ ‘çŠ¶ç»“æ„æ¥è¯´ã€‚</p><p>è§£å†³æ–¹æ¡ˆï¼š<code>InheritedWidget</code> åˆ™ä¸ºè¿™ä¸ªé—®é¢˜æä¾›äº†è§£å†³æ–¹æ¡ˆã€‚å®ƒå…è®¸å¼€å‘è€…åœ¨ <code>Widget</code> æ ‘çš„é¡¶éƒ¨æˆ–ä»»ä½•ä½ç½®æä¾›æ•°æ®ï¼Œç„¶åè¿™äº›æ•°æ®å¯ä»¥åœ¨æ ‘çš„ä»»ä½•ä¸‹å±‚éƒ½èƒ½è·å–åˆ°ã€‚å½“ <code>InheritedWidget</code> æ›´æ–°æ—¶ï¼Œå®ƒä¼šé€šçŸ¥ä½¿ç”¨å…¶æ•°æ®çš„æ‰€æœ‰ <code>Widget</code>ï¼Œè¿™äº› <code>Widget</code> åªéœ€é€šè¿‡ <code>BuildContext</code> å³å¯è®¿é—®åˆ°è¿™äº›æ•°æ®ï¼Œè¿™ä¸ªè¿‡ç¨‹ç§°ä¸ºä¾èµ–ã€‚</p><p>ä½œç”¨ï¼šå¯ä»¥è®©å¼€å‘è€…æ›´é«˜æ•ˆåœ°åˆ†äº«æ•°æ®ï¼Œé¿å…äº†ä¸å¿…è¦çš„ <code>Widget</code> é‡ç½®ï¼Œé¿å…äº†ä¸€äº›æ€§èƒ½é—®é¢˜ï¼ŒåŒæ—¶è®© <code>Widget</code> æ ‘çš„çŠ¶æ€ç®¡ç†æ›´åŠ æ¸…æ™°å’Œæ–¹ä¾¿ã€‚</p><p>ğŸŒ° <code>Flutter</code> çš„ <code>Theme</code> å’Œ <code>Locale</code> å°±æ˜¯é€šè¿‡ <code>InheritedWidget</code> æ¥ä¼ é€’çš„ã€‚</p></details><h3 id="â“inheritedwidget-æ˜¯å¦‚ä½•å®ç°å…±äº«æ•°æ®çš„" tabindex="-1"><a class="header-anchor" href="#â“inheritedwidget-æ˜¯å¦‚ä½•å®ç°å…±äº«æ•°æ®çš„" aria-hidden="true">#</a> â“<code>InheritedWidget</code> æ˜¯å¦‚ä½•å®ç°å…±äº«æ•°æ®çš„</h3><details class="hint-container details"><summary>ğŸ’¡</summary><blockquote><p><code>InheritedWidget</code> é€šè¿‡ä»¥ä¸‹æœºåˆ¶å®ç°æ•°æ®å…±äº«ï¼š</p></blockquote><ol><li><p>æ•°æ®ä¼ é€’</p><ul><li>åœ¨ Widget æ ‘é¡¶éƒ¨åˆ›å»º InheritedWidget</li><li>åœ¨ InheritedWidget ä¸­å­˜å‚¨å…±äº«æ•°æ®</li><li>å­ Widget å¯ä»¥é€šè¿‡ BuildContext è®¿é—®æ•°æ®</li></ul><div class="language-dart line-numbers-mode" data-ext="dart"><pre class="language-dart"><code><span class="token keyword">class</span> <span class="token class-name">SharedData</span> <span class="token keyword">extends</span> <span class="token class-name">InheritedWidget</span> <span class="token punctuation">{</span>
  <span class="token keyword">final</span> <span class="token class-name">String</span> data<span class="token punctuation">;</span>
  
  <span class="token class-name">SharedData</span><span class="token punctuation">(</span><span class="token punctuation">{</span>
    <span class="token class-name">Key</span><span class="token operator">?</span> key<span class="token punctuation">,</span>
    required <span class="token keyword">this</span><span class="token punctuation">.</span>data<span class="token punctuation">,</span>
    required <span class="token class-name">Widget</span> child<span class="token punctuation">,</span>
  <span class="token punctuation">}</span><span class="token punctuation">)</span> <span class="token punctuation">:</span> <span class="token keyword">super</span><span class="token punctuation">(</span>key<span class="token punctuation">:</span> key<span class="token punctuation">,</span> child<span class="token punctuation">:</span> child<span class="token punctuation">)</span><span class="token punctuation">;</span>
  
  <span class="token keyword">static</span> <span class="token class-name">SharedData</span><span class="token operator">?</span> <span class="token function">of</span><span class="token punctuation">(</span><span class="token class-name">BuildContext</span> context<span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token keyword">return</span> context<span class="token punctuation">.</span>dependOnInheritedWidgetOfExactType<span class="token generics"><span class="token punctuation">&lt;</span><span class="token class-name">SharedData</span><span class="token punctuation">&gt;</span></span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
  <span class="token punctuation">}</span>
  
  <span class="token metadata function">@override</span>
  bool <span class="token function">updateShouldNotify</span><span class="token punctuation">(</span><span class="token class-name">SharedData</span> oldWidget<span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token keyword">return</span> data <span class="token operator">!=</span> oldWidget<span class="token punctuation">.</span>data<span class="token punctuation">;</span>
  <span class="token punctuation">}</span>
<span class="token punctuation">}</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div></li><li><p>ä¾èµ–æ”¶é›†</p><ul><li>å½“å­ Widget é€šè¿‡ <code>context.dependOnInheritedWidgetOfExactType()</code> è®¿é—®æ•°æ®æ—¶</li><li>Flutter è‡ªåŠ¨å»ºç«‹å­ Widget å’Œ InheritedWidget ä¹‹é—´çš„ä¾èµ–å…³ç³»</li><li>ç³»ç»Ÿä¼šè¿½è¸ªå“ªäº› Widget ä¾èµ–äºè¿™ä¸ª InheritedWidget</li></ul><div class="language-dart line-numbers-mode" data-ext="dart"><pre class="language-dart"><code><span class="token comment">// åœ¨å­ widget ä¸­è®¿é—®æ•°æ®</span>
<span class="token keyword">class</span> <span class="token class-name">ChildWidget</span> <span class="token keyword">extends</span> <span class="token class-name">StatelessWidget</span> <span class="token punctuation">{</span>
  <span class="token metadata function">@override</span>
  <span class="token class-name">Widget</span> <span class="token function">build</span><span class="token punctuation">(</span><span class="token class-name">BuildContext</span> context<span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token keyword">final</span> data <span class="token operator">=</span> <span class="token class-name">SharedData</span><span class="token punctuation">.</span><span class="token function">of</span><span class="token punctuation">(</span>context<span class="token punctuation">)</span><span class="token operator">?</span><span class="token punctuation">.</span>data <span class="token operator">?</span><span class="token operator">?</span> <span class="token string-literal"><span class="token string">&#39;&#39;</span></span><span class="token punctuation">;</span>
    <span class="token keyword">return</span> <span class="token class-name">Text</span><span class="token punctuation">(</span>data<span class="token punctuation">)</span><span class="token punctuation">;</span>
  <span class="token punctuation">}</span>
<span class="token punctuation">}</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div></li><li><p>æ›´æ–°æœºåˆ¶</p><ul><li>å½“ InheritedWidget ä¸­çš„æ•°æ®å‘ç”Ÿå˜åŒ–æ—¶</li><li>Flutter ä¼šè°ƒç”¨ updateShouldNotify() æ–¹æ³•</li><li>å¦‚æœè¿”å› trueï¼Œæ‰€æœ‰ä¾èµ–çš„å­ Widget éƒ½ä¼šé‡æ–°æ„å»º</li></ul><div class="language-dart line-numbers-mode" data-ext="dart"><pre class="language-dart"><code><span class="token comment">// åœ¨çˆ¶ widget ä¸­ä½¿ç”¨ SharedData</span>
<span class="token keyword">class</span> <span class="token class-name">ParentWidget</span> <span class="token keyword">extends</span> <span class="token class-name">StatelessWidget</span> <span class="token punctuation">{</span>
  <span class="token metadata function">@override</span>
  <span class="token class-name">Widget</span> <span class="token function">build</span><span class="token punctuation">(</span><span class="token class-name">BuildContext</span> context<span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token keyword">return</span> <span class="token class-name">SharedData</span><span class="token punctuation">(</span>
      data<span class="token punctuation">:</span> <span class="token string-literal"><span class="token string">&#39;Hello World&#39;</span></span><span class="token punctuation">,</span>
      child<span class="token punctuation">:</span> <span class="token class-name">ChildWidget</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">,</span>
    <span class="token punctuation">)</span><span class="token punctuation">;</span>
  <span class="token punctuation">}</span>
<span class="token punctuation">}</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div></li></ol></details><h3 id="â“inheritfromwidgetofexacttype-äº†è§£å—" tabindex="-1"><a class="header-anchor" href="#â“inheritfromwidgetofexacttype-äº†è§£å—" aria-hidden="true">#</a> â“<code>inheritFromWidgetOfExactType</code> äº†è§£å—</h3><details class="hint-container details"><summary>ğŸ’¡</summary><blockquote><p><code>inheritFromWidgetOfExactType</code> æ˜¯ Flutter ä¸­ç”¨äºè·å– InheritedWidget çš„ä¸€ä¸ªæ–¹æ³•ï¼Œç°åœ¨å·²è¢«åºŸå¼ƒï¼Œæ¨èä½¿ç”¨ <code>dependOnInheritedWidgetOfExactType</code>ã€‚</p></blockquote><p>ä¸»è¦åŠŸèƒ½ï¼š</p><ol><li><p>å‘ä¸ŠæŸ¥æ‰¾Widgetæ ‘</p><ul><li>ä»å½“å‰contextå¼€å§‹å‘ä¸Šéå†Widgetæ ‘</li><li>æŸ¥æ‰¾æŒ‡å®šç±»å‹çš„InheritedWidget</li><li>è¿”å›æœ€è¿‘çš„åŒ¹é…å®ä¾‹</li></ul></li><li><p>å»ºç«‹ä¾èµ–å…³ç³»</p><ul><li>è‡ªåŠ¨åœ¨å½“å‰Elementå’Œæ‰¾åˆ°çš„InheritedWidgetä¹‹é—´å»ºç«‹ä¾èµ–å…³ç³»</li><li>å½“InheritedWidgetå‘ç”Ÿå˜åŒ–æ—¶ï¼Œä¾èµ–å®ƒçš„Widgetä¼šé‡æ–°æ„å»º</li></ul></li><li><p>ä½¿ç”¨ç¤ºä¾‹ï¼š</p><div class="language-dart line-numbers-mode" data-ext="dart"><pre class="language-dart"><code><span class="token comment">// å®šä¹‰ä¸€ä¸ª InheritedWidget</span>
<span class="token keyword">class</span> <span class="token class-name">MyInheritedWidget</span> <span class="token keyword">extends</span> <span class="token class-name">InheritedWidget</span> <span class="token punctuation">{</span>
  <span class="token keyword">final</span> <span class="token class-name">String</span> data<span class="token punctuation">;</span> 
  <span class="token class-name">MyInheritedWidget</span><span class="token punctuation">(</span><span class="token punctuation">{</span>
    <span class="token class-name">Key</span><span class="token operator">?</span> key<span class="token punctuation">,</span>
    required <span class="token keyword">this</span><span class="token punctuation">.</span>data<span class="token punctuation">,</span>
    required <span class="token class-name">Widget</span> child<span class="token punctuation">,</span>
  <span class="token punctuation">}</span><span class="token punctuation">)</span>
  <span class="token punctuation">:</span> <span class="token keyword">super</span><span class="token punctuation">(</span>key<span class="token punctuation">:</span> key<span class="token punctuation">,</span> child<span class="token punctuation">:</span> child<span class="token punctuation">)</span><span class="token punctuation">;</span>

  <span class="token comment">// å®šä¹‰ä¸€ä¸ªæ–¹æ³•ç”¨äºè·å– InheritedWidget</span>
  <span class="token keyword">static</span> <span class="token class-name">MyInheritedWidget</span><span class="token operator">?</span> <span class="token function">of</span><span class="token punctuation">(</span><span class="token class-name">BuildContext</span> context<span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token keyword">return</span> context<span class="token punctuation">.</span>dependOnInheritedWidgetOfExactType<span class="token generics"><span class="token punctuation">&lt;</span><span class="token class-name">MyInheritedWidget</span><span class="token punctuation">&gt;</span></span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
  <span class="token punctuation">}</span>

  <span class="token comment">// é‡å†™ updateShouldNotify æ–¹æ³•</span>
  <span class="token metadata function">@override</span>
  bool <span class="token function">updateShouldNotify</span><span class="token punctuation">(</span><span class="token class-name">MyInheritedWidget</span> oldWidget<span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token keyword">return</span> data<span class="token operator">!=</span> oldWidget<span class="token punctuation">.</span>data<span class="token punctuation">;</span>
  <span class="token punctuation">}</span>
<span class="token punctuation">}</span>

</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div></li></ol></details><h3 id="â“inheritedwidget-ä¸-didchangedependencies-çš„å…³ç³»" tabindex="-1"><a class="header-anchor" href="#â“inheritedwidget-ä¸-didchangedependencies-çš„å…³ç³»" aria-hidden="true">#</a> â“<code>InheritedWidget</code> ä¸ <code>didChangeDependencies()</code> çš„å…³ç³»</h3><details class="hint-container details"><summary>ğŸ’¡</summary></details><h3 id="â“inheritedwidget-å®ç°åŸç†" tabindex="-1"><a class="header-anchor" href="#â“inheritedwidget-å®ç°åŸç†" aria-hidden="true">#</a> â“<code>InheritedWidget</code> å®ç°åŸç†</h3><details class="hint-container details"><summary>ğŸ’¡</summary><blockquote><p><code>InheritedWidget</code> å…è®¸åœ¨ <code>Widget</code> æ ‘ä¸­æœ‰æ•ˆåœ°ä¼ é€’æ•°æ®ã€‚</p></blockquote><ul><li><p>åœ¨åº”ç”¨çš„é¡¶éƒ¨åˆ›å»ºä¸€ä¸ª <code>InheritedWidget</code> æ—¶ï¼Œå…¶å­ <code>Widget</code> å¯ä»¥é€šè¿‡è°ƒç”¨ <code>context.dependOnInheritedWidgetOfExactType&lt;MyInheritedWidget&gt;()</code> æ¥è·å–è¿™ä¸ª <code>InheritedWidget</code>ã€‚</p></li><li><p>åœ¨ <code>InheritedWidget</code> çš„å†…éƒ¨ï¼Œå®ƒçš„æ•°æ®çš„å­˜å‚¨å’Œè®¿é—®å®é™…ä¸Šæ˜¯é€šè¿‡ <code>BuildContext</code> æ¥å®ç°çš„ã€‚<code>BuildContext</code> å®é™…ä¸Šå°±åƒæ˜¯ <code>Widget</code> æ ‘çš„ä¸€çº§ä¸€çº§èŠ‚ç‚¹çš„å¿«ç…§ï¼Œå®ƒçŸ¥é“å½“å‰èŠ‚ç‚¹åœ¨æ ‘ä¸­çš„ä½ç½®ï¼ŒçŸ¥é“å®ƒçš„çˆ¶èŠ‚ç‚¹æ˜¯è°ï¼Œä¹ŸçŸ¥é“å®ƒæ˜¯åœ¨ä»€ä¹ˆæ—¶é—´è¢«åˆ›å»ºçš„ã€‚</p></li><li><p>è°ƒç”¨ <code>context.dependOnInheritedWidgetOfExactType&lt;MyInheritedWidget&gt;()</code> çš„æ—¶å€™ï¼Œ<code>BuildContext</code> å®é™…ä¸Šæ˜¯åœ¨ <code>Widget</code> æ ‘ä¸­å‘ä¸Šå¯»æ‰¾ï¼Œç›´åˆ°æ‰¾åˆ°å¯¹åº”çš„ <code>InheritedWidget</code> ä¸ºæ­¢ã€‚å¦‚æ­¤ä¸€æ¥ï¼Œå³ä½¿å½“å‰çš„ <code>Widget</code> åœ¨æ ‘ä¸­å¾ˆæ·±çš„åœ°æ–¹ï¼Œä¹Ÿå¯ä»¥éå¸¸é«˜æ•ˆåœ°è®¿é—®åˆ°æ ‘ä¸­æ›´é«˜å±‚çš„ <code>InheritedWidget</code>ã€‚</p></li></ul><div class="language-dart line-numbers-mode" data-ext="dart"><pre class="language-dart"><code>  <span class="token keyword">class</span> <span class="token class-name">MyInheritedWidgetData</span> <span class="token punctuation">{</span>
    <span class="token keyword">const</span> <span class="token class-name">MyInheritedWidgetData</span><span class="token punctuation">(</span><span class="token keyword">this</span><span class="token punctuation">.</span>message<span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token keyword">final</span> <span class="token class-name">String</span> message<span class="token punctuation">;</span>
  <span class="token punctuation">}</span>
  
  <span class="token keyword">class</span> <span class="token class-name">MyInheritedWidget</span> <span class="token keyword">extends</span> <span class="token class-name">InheritedWidget</span> <span class="token punctuation">{</span>
    <span class="token keyword">const</span> <span class="token class-name">MyInheritedWidget</span><span class="token punctuation">(</span><span class="token punctuation">{</span>
      <span class="token class-name">Key</span> key<span class="token punctuation">,</span>
      <span class="token metadata function">@required</span> <span class="token class-name">Widget</span> child<span class="token punctuation">,</span>
      <span class="token metadata function">@required</span> <span class="token keyword">this</span><span class="token punctuation">.</span>data<span class="token punctuation">,</span>
    <span class="token punctuation">}</span><span class="token punctuation">)</span> <span class="token punctuation">:</span> <span class="token keyword">super</span><span class="token punctuation">(</span>key<span class="token punctuation">:</span> key<span class="token punctuation">,</span> child<span class="token punctuation">:</span> child<span class="token punctuation">)</span><span class="token punctuation">;</span>

    <span class="token keyword">final</span> <span class="token class-name">MyInheritedWidgetData</span> data<span class="token punctuation">;</span>

    <span class="token keyword">static</span> <span class="token class-name">MyInheritedWidgetData</span> <span class="token function">of</span><span class="token punctuation">(</span><span class="token class-name">BuildContext</span> context<span class="token punctuation">)</span> <span class="token punctuation">{</span>
      <span class="token keyword">final</span> <span class="token class-name">MyInheritedWidget</span> result <span class="token operator">=</span>
          context<span class="token punctuation">.</span>dependOnInheritedWidgetOfExactType<span class="token generics"><span class="token punctuation">&lt;</span><span class="token class-name">MyInheritedWidget</span><span class="token punctuation">&gt;</span></span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
      <span class="token keyword">return</span> result<span class="token punctuation">.</span>data<span class="token punctuation">;</span>
    <span class="token punctuation">}</span>

    <span class="token metadata function">@override</span>
    bool <span class="token function">updateShouldNotify</span><span class="token punctuation">(</span><span class="token class-name">MyInheritedWidget</span> oldWidget<span class="token punctuation">)</span> <span class="token punctuation">{</span>
      <span class="token keyword">return</span> data<span class="token punctuation">.</span>message <span class="token operator">!=</span> oldWidget<span class="token punctuation">.</span>data<span class="token punctuation">.</span>message<span class="token punctuation">;</span>
    <span class="token punctuation">}</span>
  <span class="token punctuation">}</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div></details><hr><h2 id="state-manager-çŠ¶æ€ç®¡ç†" tabindex="-1"><a class="header-anchor" href="#state-manager-çŠ¶æ€ç®¡ç†" aria-hidden="true">#</a> State Manager - â€œçŠ¶æ€ç®¡ç†â€</h2><h3 id="â“flutter-ä¸­çŠ¶æ€ç®¡ç†æ¡†æ¶çš„çœŸæ­£ä½œç”¨-ä¸-setstate-çš„åŒºåˆ«-ä¸¤è€…ä½¿ç”¨çš„æœ€ä½³å®è·µ" tabindex="-1"><a class="header-anchor" href="#â“flutter-ä¸­çŠ¶æ€ç®¡ç†æ¡†æ¶çš„çœŸæ­£ä½œç”¨-ä¸-setstate-çš„åŒºåˆ«-ä¸¤è€…ä½¿ç”¨çš„æœ€ä½³å®è·µ" aria-hidden="true">#</a> â“<code>Flutter</code> ä¸­çŠ¶æ€ç®¡ç†æ¡†æ¶çš„çœŸæ­£ä½œç”¨ï¼Ÿä¸ <code>setState</code> çš„åŒºåˆ«ï¼Ÿä¸¤è€…ä½¿ç”¨çš„æœ€ä½³å®è·µï¼Ÿ</h3><details class="hint-container details"><summary>ğŸ’¡</summary><blockquote><p><code>setState</code></p></blockquote><ul><li><p><code>setState</code> æ˜¯ <code>Flutter</code> æä¾›çš„æœ€åŸºç¡€çš„çŠ¶æ€ç®¡ç†æ–¹å¼ï¼š</p><ul><li>ä»…èƒ½åœ¨ <code>StatefulWidget</code> å†…éƒ¨ä½¿ç”¨ï¼Œç”¨äºç®¡ç†ç»„ä»¶è‡ªèº«çš„çŠ¶æ€</li><li>å½“è°ƒç”¨ <code>setState</code> æ—¶ï¼Œä¼šè§¦å‘ç»„ä»¶çš„é‡å»º(rebuild)</li><li>é€‚åˆå¤„ç†ç®€å•çš„ã€å±€éƒ¨çš„çŠ¶æ€ç®¡ç†éœ€æ±‚</li></ul></li><li><p><code>setState</code> å±€é™æ€§ï¼š</p><ul><li>æ— æ³•è·¨ç»„ä»¶å…±äº«çŠ¶æ€</li><li>å¯¹äºæ·±å±‚ç»„ä»¶æ ‘ï¼Œéœ€è¦é€šè¿‡å±‚å±‚ä¼ é€’å‚æ•°ï¼Œå¯¼è‡´ä»£ç å†—ä½™</li><li>éš¾ä»¥å¤„ç†å¤æ‚çš„çŠ¶æ€ä¾èµ–å…³ç³»</li><li>çŠ¶æ€åˆ†æ•£åœ¨å„ä¸ªç»„ä»¶ä¸­ï¼Œä¸æ˜“ç»´æŠ¤</li></ul></li><li><p><code>setState</code> é€‚ç”¨åœºæ™¯ï¼š</p><ul><li>ç®€å•çš„é¡µé¢çº§çŠ¶æ€ç®¡ç†</li><li>ç»„ä»¶å†…éƒ¨çš„ä¸´æ—¶çŠ¶æ€</li><li>ä¸éœ€è¦å…±äº«çš„å±€éƒ¨çŠ¶æ€</li></ul></li></ul><div class="language-dart line-numbers-mode" data-ext="dart"><pre class="language-dart"><code><span class="token keyword">class</span> <span class="token class-name">CounterWidget</span> <span class="token keyword">extends</span> <span class="token class-name">StatefulWidget</span> <span class="token punctuation">{</span>
  <span class="token metadata function">@override</span>
  _CounterWidgetState <span class="token function">createState</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">=</span><span class="token operator">&gt;</span> <span class="token function">_CounterWidgetState</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span>

<span class="token keyword">class</span> _CounterWidgetState <span class="token keyword">extends</span> <span class="token class-name">State</span><span class="token generics"><span class="token punctuation">&lt;</span><span class="token class-name">CounterWidget</span><span class="token punctuation">&gt;</span></span> <span class="token punctuation">{</span>
  int count <span class="token operator">=</span> <span class="token number">0</span><span class="token punctuation">;</span>
  
  <span class="token keyword">void</span> <span class="token function">increment</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token function">setState</span><span class="token punctuation">(</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">=</span><span class="token operator">&gt;</span> count<span class="token operator">++</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
  <span class="token punctuation">}</span>
<span class="token punctuation">}</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><blockquote><p>çŠ¶æ€ç®¡ç†æ¡†æ¶(å¦‚ <code>Provider</code>ã€<code>Riverpod</code>ã€<code>GetX</code>ã€<code>Bloc</code> ç­‰)æä¾›äº†æ›´å¼ºå¤§çš„èƒ½åŠ›ã€‚</p></blockquote><ul><li>çŠ¶æ€å…±äº«ä¸è®¿é—®</li></ul><div class="language-dart line-numbers-mode" data-ext="dart"><pre class="language-dart"><code><span class="token comment">// Provider ç¤ºä¾‹</span>
<span class="token keyword">final</span> counterProvider <span class="token operator">=</span> <span class="token class-name">StateProvider</span><span class="token punctuation">(</span><span class="token punctuation">(</span>ref<span class="token punctuation">)</span> <span class="token operator">=</span><span class="token operator">&gt;</span> <span class="token number">0</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

<span class="token comment">// åœ¨ä»»æ„ç»„ä»¶ä¸­è®¿é—®</span>
<span class="token class-name">Consumer</span><span class="token punctuation">(</span>
  builder<span class="token punctuation">:</span> <span class="token punctuation">(</span>context<span class="token punctuation">,</span> ref<span class="token punctuation">,</span> child<span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token keyword">final</span> count <span class="token operator">=</span> ref<span class="token punctuation">.</span><span class="token function">watch</span><span class="token punctuation">(</span>counterProvider<span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token keyword">return</span> <span class="token class-name">Text</span><span class="token punctuation">(</span><span class="token string-literal"><span class="token string">&#39;</span><span class="token interpolation"><span class="token punctuation">$</span><span class="token expression">count</span></span><span class="token string">&#39;</span></span><span class="token punctuation">)</span><span class="token punctuation">;</span>
  <span class="token punctuation">}</span><span class="token punctuation">,</span>
<span class="token punctuation">)</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><ul><li><p>çŠ¶æ€é›†ä¸­ç®¡ç†ï¼š</p><ul><li>å°†ä¸šåŠ¡é€»è¾‘ä¸ UI è§£è€¦</li><li>ä¾¿äºçŠ¶æ€çš„ç»Ÿä¸€ç®¡ç†å’Œè¿½è¸ª</li><li>æ›´å®¹æ˜“å®ç°å¤æ‚çš„çŠ¶æ€ä¾èµ–å…³ç³»</li></ul></li><li><p>æ€§èƒ½ä¼˜åŒ–ï¼š</p><ul><li>ç²¾ç¡®æ§åˆ¶ç»„ä»¶é‡å»ºèŒƒå›´</li><li>é¿å…ä¸å¿…è¦çš„é‡å»º</li><li>æä¾›çŠ¶æ€å˜åŒ–çš„ç»†ç²’åº¦æ§åˆ¶</li></ul></li><li><p>çŠ¶æ€ç®¡ç†æ¡†æ¶é€‚ç”¨åœºæ™¯ï¼š</p><ul><li>éœ€è¦è·¨ç»„ä»¶å…±äº«çŠ¶æ€</li><li>å¤æ‚çš„ä¸šåŠ¡é€»è¾‘</li><li>éœ€è¦ç»Ÿä¸€ç®¡ç†çš„å…¨å±€çŠ¶æ€</li></ul></li></ul><div class="language-dart line-numbers-mode" data-ext="dart"><pre class="language-dart"><code><span class="token comment">// ä½¿ç”¨ Provider çš„ç¤ºä¾‹</span>
<span class="token keyword">class</span> <span class="token class-name">CounterNotifier</span> <span class="token keyword">extends</span> <span class="token class-name">ChangeNotifier</span> <span class="token punctuation">{</span>
  int _count <span class="token operator">=</span> <span class="token number">0</span><span class="token punctuation">;</span>
  int <span class="token keyword">get</span> count <span class="token operator">=</span><span class="token operator">&gt;</span> _count<span class="token punctuation">;</span>
  
  <span class="token keyword">void</span> <span class="token function">increment</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    _count<span class="token operator">++</span><span class="token punctuation">;</span>
    <span class="token function">notifyListeners</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
  <span class="token punctuation">}</span>
<span class="token punctuation">}</span>

<span class="token comment">// åœ¨ widget tree é¡¶å±‚æä¾›çŠ¶æ€</span>
<span class="token class-name">MultiProvider</span><span class="token punctuation">(</span>
  providers<span class="token punctuation">:</span> <span class="token punctuation">[</span>
    <span class="token class-name">ChangeNotifierProvider</span><span class="token punctuation">(</span>create<span class="token punctuation">:</span> <span class="token punctuation">(</span>_<span class="token punctuation">)</span> <span class="token operator">=</span><span class="token operator">&gt;</span> <span class="token class-name">CounterNotifier</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">,</span>
  <span class="token punctuation">]</span><span class="token punctuation">,</span>
  child<span class="token punctuation">:</span> <span class="token class-name">MyApp</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">,</span>
<span class="token punctuation">)</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><blockquote><p>æœ€ä½³å®è·µ</p></blockquote><ul><li>ä¼˜å…ˆä½¿ç”¨ <code>setState</code> å¤„ç†ç®€å•åœºæ™¯</li><li>å½“é‡åˆ°å¤æ‚çš„ä¸šåŠ¡é€»è¾‘æƒ…å†µæ—¶ï¼Œè€ƒè™‘ä½¿ç”¨çŠ¶æ€ç®¡ç†æ¡†æ¶ï¼š <ul><li>çŠ¶æ€éœ€è¦åœ¨å¤šä¸ªé¡µé¢å…±äº«</li><li>ä¸šåŠ¡é€»è¾‘è¾ƒä¸ºå¤æ‚</li><li>éœ€è¦æ›´å¥½çš„ä»£ç ç»„ç»‡</li><li>å›¢é˜Ÿå¼€å‘éœ€è¦ç»Ÿä¸€çš„çŠ¶æ€ç®¡ç†æ–¹æ¡ˆ</li></ul></li><li>åœ¨åŒä¸€ä¸ªé¡¹ç›®ä¸­ï¼Œå¯ä»¥æ··åˆä½¿ç”¨ï¼š <ul><li>ç®€å•çš„å±€éƒ¨çŠ¶æ€ç”¨ <code>setState</code></li><li>å¤æ‚çš„å…±äº«çŠ¶æ€ç”¨çŠ¶æ€ç®¡ç†æ¡†æ¶</li></ul></li></ul></details><h3 id="â“provider-bloc-getx-åŒºåˆ«" tabindex="-1"><a class="header-anchor" href="#â“provider-bloc-getx-åŒºåˆ«" aria-hidden="true">#</a> â“<code>Provider</code> <code>BLoc</code> <code>GetX</code> åŒºåˆ«</h3><details class="hint-container details"><summary>ğŸ’¡</summary><ul><li><p><code>Provider</code> æ˜¯ä¸šç•Œå¹¶ä¸” <code>Google</code> å®˜æ–¹æ¨èçš„çŠ¶æ€ç®¡ç†åº“ï¼Œå®ƒæ˜¯åŸºäº <code>InheritedWidget</code> çš„æ•°æ®æµä¼ é€’ã€‚å®ƒå¯ä»¥ç›´æ¥ä½¿ç”¨çŠ¶æ€ï¼ŒçŠ¶æ€å˜åŒ–è‡ªåŠ¨é€šçŸ¥å…¶ä¾èµ–ç»„ä»¶è¿›è¡Œåˆ·æ–°ï¼Œä½¿ç”¨ç®€ç›´ä¸”å…¥é—¨å®¹æ˜“ã€‚</p></li><li><p><code>BLoCï¼ˆBusiness Logic Componentï¼‰</code> æ˜¯ <code>Google</code> æ¨å‡ºçš„ä¸€ç§åº”ç”¨ç¨‹åºæ¶æ„è®¾è®¡æ¨¡å¼ã€‚å…¶æ ¸å¿ƒæ¦‚å¿µæ˜¯ï¼Œé€šè¿‡ä½¿ç”¨ <code>Dart</code> çš„<code>Stream</code> å°†æ•°æ®çš„è¾“å…¥è¾“å‡ºæŠ½è±¡ä¸º <code>Sink</code> å’Œ <code>Stream</code>ï¼Œè¿›è¡Œä¸šåŠ¡é€»è¾‘å¤„ç†ã€‚<code>BLoC</code> ç›¸æ¯” <code>Provider</code> æ›´é€‚åˆå¤§å‹é¡¹ç›®ï¼Œå¯ä»¥å®ç°æ›´å¤§ç¨‹åº¦çš„ä»£ç è§£è€¦ã€‚</p></li><li><p><code>GetX</code> æ˜¯æ¥è‡ªç¤¾åŒºçš„ <code>Flutter</code> åº“ï¼Œå®ƒä¸ä»…å®ç°äº†çŠ¶æ€ç®¡ç†ï¼Œè¿˜æä¾›äº†è·¯ç”±ç®¡ç†ï¼Œä¾èµ–æ³¨å…¥ç­‰åŠŸèƒ½ã€‚<code>GetX</code> ä¼˜åŠ¿åœ¨äºå…¶ç®€æ´çš„ <code>API</code>ã€é«˜æ•ˆçš„æ€§èƒ½ä»¥åŠå¯¹ç©ºå®‰å…¨çš„å¤©ç„¶æ”¯æŒã€‚</p></li></ul></details><h3 id="â“provider-å®ç°åŸç†" tabindex="-1"><a class="header-anchor" href="#â“provider-å®ç°åŸç†" aria-hidden="true">#</a> â“<code>Provider</code> å®ç°åŸç†</h3><details class="hint-container details"><summary>ğŸ’¡</summary><blockquote><p><code>Provider</code> æ˜¯ä¸€ç§éå¸¸æµè¡Œçš„çŠ¶æ€ç®¡ç†å·¥å…·ã€‚å®ç°åŸç†ä¸»è¦åˆ©ç”¨äº† <code>Flutter</code> ä¸­çš„ <code>InheritedWidget</code> å’Œ <code>ChangeNotifier</code>ã€‚</p></blockquote><ul><li><p><code>InheritedWidget</code>: ä¸€ä¸ªèƒ½åœ¨å­ <code>Widget</code> æ ‘ä¸­å¿«é€Ÿæä¾›æ•°æ®çš„ <code>Widget</code>ï¼Œé€šè¿‡å®ƒå¯ä»¥å®ç°æ•°æ®åœ¨ <code>Widget</code> æ ‘ä¸­çš„å‘ä¸‹ä¼ é€’ã€‚</p></li><li><p><code>ChangeNotifier</code>: å¯ä»¥å°†å®ƒç†è§£ä¸ºä¸€ä¸ªå¯ä»¥é€šçŸ¥ <code>Flutter</code> <code>UI</code> å‘ç”Ÿæ›´æ–°çš„æ–¹æ³•ï¼Œé€šå¸¸æ˜¯å®ƒçš„æ¨¡å‹å‘ç”Ÿæ”¹å˜ã€è·å¾—æ–°æ•°æ®æˆ–å˜ä¸ºç©ºçš„æ—¶å€™ã€‚å½“æ•°æ®æ”¹å˜çš„æ—¶å€™ï¼Œå¯ä»¥è°ƒç”¨ <code>ChangeNotifier.notifyListeners()</code> è¿™æ ·çš„è¯ï¼Œæ‰€æœ‰çš„ç›‘å¬å™¨ï¼ˆ<code>UI</code>ï¼‰ä¼šæ¥æ”¶é€šçŸ¥ï¼Œè¿›è¡Œå¯¹åº”çš„ä¸šåŠ¡å¤„ç†ï¼Œæ¯”å¦‚åˆ·æ–° <code>UI</code>ã€‚</p></li></ul><p>åœ¨ä½¿ç”¨ <code>Provider</code> çš„æ—¶å€™ï¼Œä¼šåˆ›å»ºä¸€ä¸ªç»§æ‰¿è‡ª <code>ChangeNotifier</code> çš„æ•°æ®æ¨¡å‹ï¼Œå¹¶æŠŠå®ƒæä¾›ç»™é‚£äº›éœ€è¦è¿™äº›æ•°æ®çš„ <code>Widget</code>ã€‚åœ¨éœ€è¦æ¥æ”¶æ•°æ®çš„ <code>Widget</code> ä¸­ï¼Œä½¿ç”¨ <code>Provider.of</code> æˆ–è€… <code>Consumer</code> æ¥æ¥æ”¶æ•°æ®ã€‚å¹¶ä¸”æ˜ç¡®äº†å½“æ•°æ®å‘é€æ”¹å˜çš„æ—¶å€™æ˜¯å¦éœ€è¦ <code>Widget</code> æ˜¾ç¤ºåˆ·æ–°ã€‚</p></details><h3 id="â“è¯´ä¸€ä¸‹-bloc-æ¨¡å¼" tabindex="-1"><a class="header-anchor" href="#â“è¯´ä¸€ä¸‹-bloc-æ¨¡å¼" aria-hidden="true">#</a> â“è¯´ä¸€ä¸‹ <code>BLoC</code> æ¨¡å¼</h3><details class="hint-container details"><summary>ğŸ’¡</summary><blockquote><p><code>BLoC</code>ï¼ˆBusiness Logic Componentï¼‰æ˜¯ <code>Google</code> æ¨å‡ºçš„ä¸€ç§åº”ç”¨ç¨‹åºæ¶æ„è®¾è®¡æ¨¡å¼ã€‚å…¶æ ¸å¿ƒæ¦‚å¿µæ˜¯ï¼Œå°†&quot;äº‹ä»¶(<code>event</code>)&quot;æµè½¬æ¢ä¸º&quot;çŠ¶æ€(<code>state</code>)&quot;æµã€‚</p></blockquote><p>ä½¿ç”¨æµç¨‹ï¼š</p><ul><li><p>å®šä¹‰äº‹ä»¶ï¼ˆ<code>Event</code>ï¼‰ï¼šè¿™äº›äº‹ä»¶è¡¨ç¤ºå¯ä»¥ä»ç”¨æˆ·ç•Œé¢å‘é€åˆ° <code>BLoC</code> çš„å„ç§æ“ä½œ</p><blockquote><p>ä¾‹å¦‚ç”¨æˆ·çš„ç‚¹å‡»ï¼Œæ‹–åŠ¨ä»¥åŠå…¶ä»–è¡Œä¸ºã€‚</p></blockquote></li><li><p>å®šä¹‰çŠ¶æ€ï¼ˆ<code>State</code>ï¼‰ï¼šè¿™äº›çŠ¶æ€è¡¨ç¤º <code>BLoC</code> åœ¨æ¥æ”¶äº‹ä»¶åå¯èƒ½å¤„äºçš„ä¸åŒçŠ¶æ€</p><blockquote><p>ä¾‹å¦‚åŠ è½½ï¼ŒæˆåŠŸï¼Œé”™è¯¯ç­‰ã€‚</p></blockquote></li><li><p>åˆ›å»º <code>BLoC</code>ï¼š ç”Ÿäº§çŠ¶æ€(<code>state</code>)æµï¼Œå¹¶æ¶ˆè´¹äº‹ä»¶(<code>event</code>)æµã€‚åœ¨ <code>BLoC</code> å†…éƒ¨ï¼Œä½¿ç”¨ä¸€ä¸ªæˆ–å¤šä¸ª <code>Stream</code> æ¥è¡¨ç¤ºçŠ¶æ€ï¼Œä½¿ç”¨ <code>Sink</code> æ¥æ¥æ”¶äº‹ä»¶ã€‚<code>BLoC</code> é‡Œé¢çš„ä¸šåŠ¡é€»è¾‘å°±æ˜¯å°†äº‹ä»¶æµè½¬å˜ä¸ºçŠ¶æ€æµã€‚</p></li><li><p><code>UI</code> ä¸­ä½¿ç”¨ <code>BLoC</code>ï¼šé€šå¸¸ä½¿ç”¨ <code>StreamBuilder</code> å’Œå„ç§äº‹ä»¶è§¦å‘å™¨å¦‚æŒ‰é’®ç‚¹å‡»ï¼Œæ¥è¿æ¥ <code>BLoC</code> å’Œ <code>UI</code>ã€‚</p></li></ul><p>ä¼˜ç‚¹ï¼šå¯ä»¥å°†ä¸šåŠ¡é€»è¾‘å®Œå…¨ä» <code>UI</code> å±‚ä¸­åˆ†ç¦»å‡ºæ¥ï¼Œä½¿å¾—ä»£ç æ›´åŠ æ¨¡å—åŒ–å¹¶ä¸”æ˜“äºæµ‹è¯•ã€‚ä¹Ÿæé«˜äº†åº”ç”¨çš„å“åº”æ€§ï¼Œå› ä¸ºå®ƒåŸºäºæµï¼Œå¯ä»¥ä¾¿æ·åœ°å¤„ç†å¼‚æ­¥æ“ä½œå’Œå„ç§äº‹ä»¶ã€‚</p></details>`,34);function o(p,l){return s(),a("div",null,[e(" more "),i])}const r=n(c,[["render",o],["__file","0x06.state.html.vue"]]);export{r as default};
