import{_ as o}from"./plugin-vue_export-helper-x3n3nnut.js";import{r as e,o as c,c as l,a as i,b as n,e as s,d as t,f as p}from"./app-SX6jYwBY.js";const u={},r=n("hr",null,null,-1),k=n("h2",{id:"çœ‹æºç ",tabindex:"-1"},[n("a",{class:"header-anchor",href:"#çœ‹æºç ","aria-hidden":"true"},"#"),s(" çœ‹æºç ")],-1),d=n("h3",{id:"ivar-t",tabindex:"-1"},[n("a",{class:"header-anchor",href:"#ivar-t","aria-hidden":"true"},"#"),s(" ivar_t")],-1),m={href:"https://github.com/apple-oss-distributions/objc4/blob/objc4-876/runtime/objc-runtime-new.h#L1243",target:"_blank",rel:"noopener noreferrer"},v=p(`<div class="language-objc line-numbers-mode" data-ext="objc"><pre class="language-objc"><code><span class="token comment">// objc-runtime-new.h#L1243</span>
<span class="token keyword">struct</span> ivar_t <span class="token punctuation">{</span> <span class="token comment">// å®ä¾‹å˜é‡ç»“æ„ä½“å®šä¹‰</span>
    int32_t <span class="token operator">*</span>offset<span class="token punctuation">;</span>    <span class="token comment">// ç›¸å¯¹äºå¯¹è±¡å†…å­˜èµ·å§‹ä½ç½®åç§»</span>
    <span class="token keyword">const</span> <span class="token keyword">char</span> <span class="token operator">*</span>name<span class="token punctuation">;</span>   <span class="token comment">// å˜é‡å</span>
    <span class="token keyword">const</span> <span class="token keyword">char</span> <span class="token operator">*</span>type<span class="token punctuation">;</span>   <span class="token comment">// å˜é‡ç±»å‹</span>
    <span class="token comment">// alignment is sometimes -1; use alignment() instead</span>
    uint32_t alignment_raw<span class="token punctuation">;</span> <span class="token comment">// å†…å­˜å¯¹é½</span>
    uint32_t size<span class="token punctuation">;</span>          <span class="token comment">// å˜é‡å†…å­˜å°ºå¯¸</span>

    uint32_t <span class="token function">alignment</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token keyword">const</span> <span class="token punctuation">{</span>  <span class="token comment">// å†…å­˜å¯¹é½</span>
        <span class="token keyword">if</span> <span class="token punctuation">(</span>alignment_raw <span class="token operator">==</span> <span class="token operator">~</span><span class="token punctuation">(</span>uint32_t<span class="token punctuation">)</span><span class="token number">0</span><span class="token punctuation">)</span> <span class="token keyword">return</span> <span class="token number">1U</span> <span class="token operator">&lt;&lt;</span> WORD_SHIFT<span class="token punctuation">;</span>
        <span class="token keyword">return</span> <span class="token number">1</span> <span class="token operator">&lt;&lt;</span> alignment_raw<span class="token punctuation">;</span>
    <span class="token punctuation">}</span>
<span class="token punctuation">}</span><span class="token punctuation">;</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><h3 id="ivar-list-t" tabindex="-1"><a class="header-anchor" href="#ivar-list-t" aria-hidden="true">#</a> ivar_list_t</h3>`,2),b={href:"https://github.com/apple-oss-distributions/objc4/blob/objc4-876/runtime/objc-runtime-new.h#L1405",target:"_blank",rel:"noopener noreferrer"},_=p(`<div class="language-objc line-numbers-mode" data-ext="objc"><pre class="language-objc"><code><span class="token comment">// objc-runtime-new.h#L1405</span>
<span class="token keyword">struct</span> ivar_list_t <span class="token punctuation">:</span> entsize_list_tt<span class="token operator">&lt;</span>ivar_t<span class="token punctuation">,</span> ivar_list_t<span class="token punctuation">,</span> <span class="token number">0</span><span class="token operator">&gt;</span> <span class="token punctuation">{</span>
    bool <span class="token function">containsIvar</span><span class="token punctuation">(</span>Ivar ivar<span class="token punctuation">)</span> <span class="token keyword">const</span> <span class="token punctuation">{</span>
        <span class="token keyword">return</span> <span class="token punctuation">(</span>ivar <span class="token operator">&gt;=</span> <span class="token punctuation">(</span>Ivar<span class="token punctuation">)</span><span class="token operator">&amp;</span><span class="token operator">*</span><span class="token function">begin</span><span class="token punctuation">(</span><span class="token punctuation">)</span>  <span class="token operator">&amp;&amp;</span>  ivar <span class="token operator">&lt;</span> <span class="token punctuation">(</span>Ivar<span class="token punctuation">)</span><span class="token operator">&amp;</span><span class="token operator">*</span><span class="token function">end</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span>
<span class="token punctuation">}</span><span class="token punctuation">;</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><h3 id="property-t" tabindex="-1"><a class="header-anchor" href="#property-t" aria-hidden="true">#</a> property_t</h3>`,2),h={href:"https://github.com/apple-oss-distributions/objc4/blob/objc4-876/runtime/objc-runtime-new.h#L1265",target:"_blank",rel:"noopener noreferrer"},y=p(`<div class="language-objc line-numbers-mode" data-ext="objc"><pre class="language-objc"><code><span class="token comment">// objc-runtime-new.h#L1265</span>
<span class="token keyword">struct</span> property_t <span class="token punctuation">{</span> <span class="token comment">// å±æ€§ç»“æ„ä½“å®šä¹‰</span>
    <span class="token keyword">const</span> <span class="token keyword">char</span> <span class="token operator">*</span>name<span class="token punctuation">;</span>       <span class="token comment">// å±æ€§å</span>
    <span class="token keyword">const</span> <span class="token keyword">char</span> <span class="token operator">*</span>attributes<span class="token punctuation">;</span> <span class="token comment">// ç‰¹æ€§</span>
<span class="token punctuation">}</span><span class="token punctuation">;</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><h3 id="property-list-t" tabindex="-1"><a class="header-anchor" href="#property-list-t" aria-hidden="true">#</a> property_list_t</h3>`,2),w={href:"https://github.com/apple-oss-distributions/objc4/blob/objc4-876/runtime/objc-runtime-new.h#L1411",target:"_blank",rel:"noopener noreferrer"},f=p(`<div class="language-objc line-numbers-mode" data-ext="objc"><pre class="language-objc"><code><span class="token comment">// objc-runtime-new.h#L1411</span>
<span class="token keyword">struct</span> property_list_t <span class="token punctuation">:</span> entsize_list_tt<span class="token operator">&lt;</span>property_t<span class="token punctuation">,</span> property_list_t<span class="token punctuation">,</span> <span class="token number">0</span><span class="token operator">&gt;</span> <span class="token punctuation">{</span>
<span class="token punctuation">}</span><span class="token punctuation">;</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><h3 id="class-copyivarlist-vs-class-copypropertylist" tabindex="-1"><a class="header-anchor" href="#class-copyivarlist-vs-class-copypropertylist" aria-hidden="true">#</a> <code>class_copyIvarList()</code> vs <code>class_copyPropertyList()</code></h3>`,2),g={href:"https://github.com/apple-oss-distributions/objc4/blob/objc4-876/runtime/objc-runtime-new.mm#L5701",target:"_blank",rel:"noopener noreferrer"},j={href:"https://github.com/apple-oss-distributions/objc4/blob/objc4-876/runtime/objc-runtime-new.mm#L5739",target:"_blank",rel:"noopener noreferrer"},L=p(`<div class="language-objc line-numbers-mode" data-ext="objc"><pre class="language-objc"><code><span class="token comment">// objc-runtime-new.mm#L5701</span>
Ivar <span class="token operator">*</span> <span class="token function">class_copyIvarList</span><span class="token punctuation">(</span>Class cls<span class="token punctuation">,</span> <span class="token keyword">unsigned</span> <span class="token keyword">int</span> <span class="token operator">*</span>outCount<span class="token punctuation">)</span>
<span class="token punctuation">{</span> <span class="token comment">// è·å–ç±»çš„å®ä¾‹å˜é‡åˆ—è¡¨</span>
    <span class="token keyword">const</span> ivar_list_t <span class="token operator">*</span>ivars<span class="token punctuation">;</span>
    Ivar <span class="token operator">*</span>result <span class="token operator">=</span> nil<span class="token punctuation">;</span>
    <span class="token keyword">unsigned</span> <span class="token keyword">int</span> count <span class="token operator">=</span> <span class="token number">0</span><span class="token punctuation">;</span>

    <span class="token keyword">if</span> <span class="token punctuation">(</span><span class="token operator">!</span>cls<span class="token punctuation">)</span> <span class="token punctuation">{</span>
        <span class="token keyword">if</span> <span class="token punctuation">(</span>outCount<span class="token punctuation">)</span> <span class="token operator">*</span>outCount <span class="token operator">=</span> <span class="token number">0</span><span class="token punctuation">;</span>
        <span class="token keyword">return</span> nil<span class="token punctuation">;</span>
    <span class="token punctuation">}</span>
    <span class="token comment">// äº’æ–¥é”ï¼ŒåŠ é”</span>
    mutex_locker_t <span class="token function">lock</span><span class="token punctuation">(</span>runtimeLock<span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token comment">// æ ¡éªŒç±»æ˜¯å¦å·²å®ç°</span>
    <span class="token function">ASSERT</span><span class="token punctuation">(</span>cls<span class="token operator">-&gt;</span><span class="token function">isRealized</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token comment">// ä» ro ä¸­è·å–æ‰€æœ‰å®ä¾‹å˜é‡</span>
    <span class="token keyword">if</span> <span class="token punctuation">(</span><span class="token punctuation">(</span>ivars <span class="token operator">=</span> cls<span class="token operator">-&gt;</span><span class="token function">data</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token operator">-&gt;</span><span class="token function">ro</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token operator">-&gt;</span>ivars<span class="token punctuation">)</span>  <span class="token operator">&amp;&amp;</span>  ivars<span class="token operator">-&gt;</span>count<span class="token punctuation">)</span> <span class="token punctuation">{</span>
        result <span class="token operator">=</span> <span class="token punctuation">(</span>Ivar <span class="token operator">*</span><span class="token punctuation">)</span><span class="token function">malloc</span><span class="token punctuation">(</span><span class="token punctuation">(</span>ivars<span class="token operator">-&gt;</span>count<span class="token operator">+</span><span class="token number">1</span><span class="token punctuation">)</span> <span class="token operator">*</span> <span class="token keyword">sizeof</span><span class="token punctuation">(</span>Ivar<span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token keyword">for</span> <span class="token punctuation">(</span><span class="token keyword">auto</span><span class="token operator">&amp;</span> ivar <span class="token punctuation">:</span> <span class="token operator">*</span>ivars<span class="token punctuation">)</span> <span class="token punctuation">{</span> <span class="token comment">// éå†æ‰€æœ‰å®ä¾‹å˜é‡æ”¾å…¥ç»“æœæ•°ç»„</span>
            <span class="token keyword">if</span> <span class="token punctuation">(</span><span class="token operator">!</span>ivar<span class="token punctuation">.</span>offset<span class="token punctuation">)</span> <span class="token keyword">continue</span><span class="token punctuation">;</span>  <span class="token comment">// anonymous bitfield</span>
            result<span class="token punctuation">[</span>count<span class="token operator">++</span><span class="token punctuation">]</span> <span class="token operator">=</span> <span class="token operator">&amp;</span>ivar<span class="token punctuation">;</span>
        <span class="token punctuation">}</span>
        result<span class="token punctuation">[</span>count<span class="token punctuation">]</span> <span class="token operator">=</span> nil<span class="token punctuation">;</span>
    <span class="token punctuation">}</span>
    <span class="token keyword">if</span> <span class="token punctuation">(</span>outCount<span class="token punctuation">)</span> <span class="token operator">*</span>outCount <span class="token operator">=</span> count<span class="token punctuation">;</span>
    <span class="token keyword">return</span> result<span class="token punctuation">;</span>
<span class="token punctuation">}</span>

<span class="token comment">// objc-runtime-new.mm#L5739 </span>
objc_property_t <span class="token operator">*</span> <span class="token function">class_copyPropertyList</span><span class="token punctuation">(</span>Class cls<span class="token punctuation">,</span> <span class="token keyword">unsigned</span> <span class="token keyword">int</span> <span class="token operator">*</span>outCount<span class="token punctuation">)</span>
<span class="token punctuation">{</span> <span class="token comment">// è·å–ç±»å±æ€§åˆ—è¡¨</span>
    <span class="token keyword">if</span> <span class="token punctuation">(</span><span class="token operator">!</span>cls<span class="token punctuation">)</span> <span class="token punctuation">{</span>
        <span class="token keyword">if</span> <span class="token punctuation">(</span>outCount<span class="token punctuation">)</span> <span class="token operator">*</span>outCount <span class="token operator">=</span> <span class="token number">0</span><span class="token punctuation">;</span>
        <span class="token keyword">return</span> nil<span class="token punctuation">;</span>
    <span class="token punctuation">}</span>
    <span class="token comment">// äº’æ–¥é”ï¼ŒåŠ é”</span>
    mutex_locker_t <span class="token function">lock</span><span class="token punctuation">(</span>runtimeLock<span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token comment">// æ ¡éªŒç±»æ˜¯å¦å·²å®ç°</span>
    <span class="token function">checkIsKnownClass</span><span class="token punctuation">(</span>cls<span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token function">ASSERT</span><span class="token punctuation">(</span>cls<span class="token operator">-&gt;</span><span class="token function">isRealized</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    
    <span class="token comment">// è·å–ç±»æ•°æ®</span>
    <span class="token keyword">auto</span> rw <span class="token operator">=</span> cls<span class="token operator">-&gt;</span><span class="token function">data</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    property_t <span class="token operator">*</span><span class="token operator">*</span>result <span class="token operator">=</span> nil<span class="token punctuation">;</span>
    <span class="token keyword">auto</span> <span class="token keyword">const</span> properties <span class="token operator">=</span> rw<span class="token operator">-&gt;</span><span class="token function">properties</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token comment">// ä» rw ä¸­è·å–æ‰€æœ‰å±æ€§</span>
    <span class="token keyword">unsigned</span> <span class="token keyword">int</span> count <span class="token operator">=</span> properties<span class="token punctuation">.</span><span class="token function">count</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token keyword">if</span> <span class="token punctuation">(</span>count <span class="token operator">&gt;</span> <span class="token number">0</span><span class="token punctuation">)</span> <span class="token punctuation">{</span> <span class="token comment">// å­˜åœ¨å±æ€§ï¼Œéå†æ‰€æœ‰å±æ€§æ”¾å…¥ç»“æœæ•°ç»„ä¸­</span>
        result <span class="token operator">=</span> <span class="token punctuation">(</span>property_t <span class="token operator">*</span><span class="token operator">*</span><span class="token punctuation">)</span><span class="token function">malloc</span><span class="token punctuation">(</span><span class="token punctuation">(</span>count <span class="token operator">+</span> <span class="token number">1</span><span class="token punctuation">)</span> <span class="token operator">*</span> <span class="token keyword">sizeof</span><span class="token punctuation">(</span>property_t <span class="token operator">*</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        count <span class="token operator">=</span> <span class="token number">0</span><span class="token punctuation">;</span>
        <span class="token keyword">for</span> <span class="token punctuation">(</span><span class="token keyword">auto</span><span class="token operator">&amp;</span> prop <span class="token punctuation">:</span> properties<span class="token punctuation">)</span> <span class="token punctuation">{</span>
            result<span class="token punctuation">[</span>count<span class="token operator">++</span><span class="token punctuation">]</span> <span class="token operator">=</span> <span class="token operator">&amp;</span>prop<span class="token punctuation">;</span>
        <span class="token punctuation">}</span>
        result<span class="token punctuation">[</span>count<span class="token punctuation">]</span> <span class="token operator">=</span> nil<span class="token punctuation">;</span>
    <span class="token punctuation">}</span>
    <span class="token keyword">if</span> <span class="token punctuation">(</span>outCount<span class="token punctuation">)</span> <span class="token operator">*</span>outCount <span class="token operator">=</span> count<span class="token punctuation">;</span>
    <span class="token keyword">return</span> <span class="token punctuation">(</span>objc_property_t <span class="token operator">*</span><span class="token punctuation">)</span>result<span class="token punctuation">;</span>
<span class="token punctuation">}</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div>`,1);function x(C,I){const a=e("ExternalLinkIcon");return c(),l("div",null,[i(" more "),r,k,d,n("blockquote",null,[n("p",null,[n("a",m,[s("ğŸ‘‰ğŸ»"),t(a)])])]),v,n("blockquote",null,[n("p",null,[n("a",b,[s("ğŸ‘‰ğŸ»"),t(a)])])]),_,n("blockquote",null,[n("p",null,[n("a",h,[s("ğŸ‘‰ğŸ»"),t(a)])])]),y,n("blockquote",null,[n("p",null,[n("a",w,[s("ğŸ‘‰ğŸ»"),t(a)])])]),f,n("blockquote",null,[n("p",null,[n("a",g,[s("ğŸ‘‰ğŸ»"),t(a)]),s(" vs "),n("a",j,[s("ğŸ‘‰ğŸ»"),t(a)])])]),L])}const q=o(u,[["render",x],["__file","property.html.vue"]]);export{q as default};
