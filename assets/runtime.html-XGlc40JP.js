import{_ as a}from"./plugin-vue_export-helper-x3n3nnut.js";import{o as n,c as e,a as c,b as s,f as o}from"./app-nOqLU-Iw.js";const t="/docs/assets/objc-class-diagram-0JRmvx1z.jpg",i={},d=s("blockquote",null,[s("p",null,"è¿è¡Œæ—¶")],-1),p=o('<h3 id="â“oc-çš„å¯¹è±¡æ¨¡å‹" tabindex="-1"><a class="header-anchor" href="#â“oc-çš„å¯¹è±¡æ¨¡å‹" aria-hidden="true">#</a> â“<code>OC</code> çš„å¯¹è±¡æ¨¡å‹</h3><details class="hint-container details"><summary>ğŸ’¡</summary><blockquote><p>Objective-C ç±»å›¾</p></blockquote><figure><img src="'+t+`" alt="objc-class-diagram" tabindex="0" loading="lazy"><figcaption>objc-class-diagram</figcaption></figure></details><h3 id="â“isa-æ˜¯ä»€ä¹ˆ" tabindex="-1"><a class="header-anchor" href="#â“isa-æ˜¯ä»€ä¹ˆ" aria-hidden="true">#</a> â“<code>isa</code> æ˜¯ä»€ä¹ˆï¼Ÿ</h3><details class="hint-container details"><summary>ğŸ’¡</summary><blockquote><p><code>isa</code>ï¼š <code>OC</code> å¯¹è±¡çš„ä¸€ä¸ªæŒ‡é’ˆï¼Œå®ƒæ˜¯æ¯ä¸ª <code>OC</code> å¯¹è±¡çš„ç¬¬ä¸€ä¸ªæˆå‘˜å˜é‡ï¼Œç”¨äºæŒ‡å‘è¯¥å¯¹è±¡çš„ç±»å¯¹è±¡ã€‚</p></blockquote><p><code>Objective-C</code> çš„å¯¹è±¡æ¨¡å‹ä¸­ï¼Œå¯¹è±¡åˆ†ä¸ºå®ä¾‹å¯¹è±¡ã€ç±»å¯¹è±¡ã€å…ƒç±»å¯¹è±¡ï¼Œè¿™ä¸‰ç§å¯¹è±¡éƒ½å«æœ‰ <code>isa</code> æŒ‡é’ˆã€‚</p><ul><li><p>å®ä¾‹å¯¹è±¡: å®ä¾‹å¯¹è±¡çš„<code>isa</code>æŒ‡å‘å®ƒçš„ç±»å¯¹è±¡ï¼›å®ä¾‹å¯¹è±¡ä¸»è¦å­˜å‚¨å®ä¾‹å˜é‡çš„å€¼ã€‚</p></li><li><p>ç±»å¯¹è±¡: ç±»å¯¹è±¡çš„<code>isa</code>æŒ‡å‘å…ƒç±»å¯¹è±¡ï¼›ç±»å¯¹è±¡ä¸»è¦å­˜å‚¨å®ä¾‹æ–¹æ³•ã€å±æ€§ã€ä»¥åŠéµå®ˆçš„åè®®ç­‰ä¿¡æ¯ã€‚</p></li><li><p>å…ƒç±»å¯¹è±¡: å…ƒç±»å¯¹è±¡çš„<code>isa</code>æŒ‡å‘è‡ªèº«ï¼›å…ƒç±»å¯¹è±¡ä¸»è¦å­˜å‚¨ç±»æ–¹æ³•ç­‰ä¿¡æ¯ã€‚</p></li></ul><p>å½“å‘é€æ¶ˆæ¯ç»™ä¸€ä¸ªå¯¹è±¡æ—¶ï¼Œ<code>runtime</code> é€šè¿‡è¿™ä¸ªå¯¹è±¡çš„ <code>isa</code> æŒ‡é’ˆæ‰¾åˆ°å®ƒçš„ç±»å¯¹è±¡ï¼Œç„¶ååœ¨ç±»å¯¹è±¡çš„æ–¹æ³•åˆ—è¡¨ä¸­æŸ¥æ‰¾å¯¹åº”çš„æ–¹æ³•è¿›è¡Œè°ƒç”¨ã€‚</p></details><h3 id="è®²ä¸€ä¸‹å¯¹è±¡-ç±»å¯¹è±¡-å…ƒç±»-è·Ÿå…ƒç±»ç»“æ„ä½“çš„ç»„æˆä»¥åŠä»–ä»¬æ˜¯å¦‚ä½•ç›¸å…³è”çš„" tabindex="-1"><a class="header-anchor" href="#è®²ä¸€ä¸‹å¯¹è±¡-ç±»å¯¹è±¡-å…ƒç±»-è·Ÿå…ƒç±»ç»“æ„ä½“çš„ç»„æˆä»¥åŠä»–ä»¬æ˜¯å¦‚ä½•ç›¸å…³è”çš„" aria-hidden="true">#</a> è®²ä¸€ä¸‹å¯¹è±¡ï¼Œç±»å¯¹è±¡ï¼Œå…ƒç±»ï¼Œè·Ÿå…ƒç±»ç»“æ„ä½“çš„ç»„æˆä»¥åŠä»–ä»¬æ˜¯å¦‚ä½•ç›¸å…³è”çš„ï¼Ÿ</h3><h3 id="ä¸ºä»€ä¹ˆè¦è®¾è®¡-metaclass" tabindex="-1"><a class="header-anchor" href="#ä¸ºä»€ä¹ˆè¦è®¾è®¡-metaclass" aria-hidden="true">#</a> ä¸ºä»€ä¹ˆè¦è®¾è®¡ <code>metaclass</code>ï¼Ÿ</h3><h3 id="ä¸ºä»€ä¹ˆå¯¹è±¡æ–¹æ³•æ²¡æœ‰ä¿å­˜çš„å¯¹è±¡ç»“æ„ä½“é‡Œ-è€Œæ˜¯ä¿å­˜åœ¨ç±»å¯¹è±¡çš„ç»“æ„ä½“é‡Œ" tabindex="-1"><a class="header-anchor" href="#ä¸ºä»€ä¹ˆå¯¹è±¡æ–¹æ³•æ²¡æœ‰ä¿å­˜çš„å¯¹è±¡ç»“æ„ä½“é‡Œ-è€Œæ˜¯ä¿å­˜åœ¨ç±»å¯¹è±¡çš„ç»“æ„ä½“é‡Œ" aria-hidden="true">#</a> ä¸ºä»€ä¹ˆå¯¹è±¡æ–¹æ³•æ²¡æœ‰ä¿å­˜çš„å¯¹è±¡ç»“æ„ä½“é‡Œï¼Œè€Œæ˜¯ä¿å­˜åœ¨ç±»å¯¹è±¡çš„ç»“æ„ä½“é‡Œï¼Ÿ</h3><h3 id="class-copyivarlist-vs-class-copypropertylist" tabindex="-1"><a class="header-anchor" href="#class-copyivarlist-vs-class-copypropertylist" aria-hidden="true">#</a> <code>class_copyIvarList</code> vs <code>class_copyPropertyList</code></h3><h3 id="class-ro-t-vs-class-rw-t" tabindex="-1"><a class="header-anchor" href="#class-ro-t-vs-class-rw-t" aria-hidden="true">#</a> <code>class_ro_t</code> vs <code>class_rw_t</code></h3><h3 id="èƒ½å¦å‘ç¼–è¯‘åå¾—åˆ°çš„ç±»ä¸­å¢åŠ å®ä¾‹å˜é‡-èƒ½å¦å‘è¿è¡Œæ—¶åˆ›å»ºçš„ç±»ä¸­æ·»åŠ å®ä¾‹å˜é‡" tabindex="-1"><a class="header-anchor" href="#èƒ½å¦å‘ç¼–è¯‘åå¾—åˆ°çš„ç±»ä¸­å¢åŠ å®ä¾‹å˜é‡-èƒ½å¦å‘è¿è¡Œæ—¶åˆ›å»ºçš„ç±»ä¸­æ·»åŠ å®ä¾‹å˜é‡" aria-hidden="true">#</a> èƒ½å¦å‘ç¼–è¯‘åå¾—åˆ°çš„ç±»ä¸­å¢åŠ å®ä¾‹å˜é‡ï¼Ÿèƒ½å¦å‘è¿è¡Œæ—¶åˆ›å»ºçš„ç±»ä¸­æ·»åŠ å®ä¾‹å˜é‡ï¼Ÿ</h3><h3 id="å¯¹è±¡æ–¹æ³•-ä¸-ç±»æ–¹æ³•å­˜æ”¾åœ¨å“ª" tabindex="-1"><a class="header-anchor" href="#å¯¹è±¡æ–¹æ³•-ä¸-ç±»æ–¹æ³•å­˜æ”¾åœ¨å“ª" aria-hidden="true">#</a> å¯¹è±¡æ–¹æ³• ä¸ ç±»æ–¹æ³•å­˜æ”¾åœ¨å“ªï¼Ÿ</h3><h3 id="classã€objc-getclassã€object-getclass-ä¸‰ä¸ªæ–¹æ³•çš„åŒºåˆ«" tabindex="-1"><a class="header-anchor" href="#classã€objc-getclassã€object-getclass-ä¸‰ä¸ªæ–¹æ³•çš„åŒºåˆ«" aria-hidden="true">#</a> <code>class</code>ã€<code>objc_getClass</code>ã€<code>object_getclass</code> ä¸‰ä¸ªæ–¹æ³•çš„åŒºåˆ«ï¼Ÿ</h3><h3 id="åœ¨è¿è¡Œæ—¶åˆ›å»ºç±»çš„æ–¹æ³•-objc-allocateclasspair-çš„æ–¹æ³•åå°¾éƒ¨ä¸ºä»€ä¹ˆæ˜¯pair-æˆå¯¹çš„æ„æ€" tabindex="-1"><a class="header-anchor" href="#åœ¨è¿è¡Œæ—¶åˆ›å»ºç±»çš„æ–¹æ³•-objc-allocateclasspair-çš„æ–¹æ³•åå°¾éƒ¨ä¸ºä»€ä¹ˆæ˜¯pair-æˆå¯¹çš„æ„æ€" aria-hidden="true">#</a> åœ¨è¿è¡Œæ—¶åˆ›å»ºç±»çš„æ–¹æ³• <code>objc_allocateClassPair</code> çš„æ–¹æ³•åå°¾éƒ¨ä¸ºä»€ä¹ˆæ˜¯pairï¼ˆæˆå¯¹çš„æ„æ€ï¼‰ï¼Ÿ</h3><h3 id="â“super-æ˜¯ä»€ä¹ˆ" tabindex="-1"><a class="header-anchor" href="#â“super-æ˜¯ä»€ä¹ˆ" aria-hidden="true">#</a> â“<code>super</code> æ˜¯ä»€ä¹ˆï¼Ÿ</h3><details class="hint-container details"><summary>ğŸ’¡</summary><p><code>super</code> å¹¶ä¸æ˜¯ä¸€ä¸ªæŒ‡é’ˆï¼Œåœ¨ <code>OC</code> è¿›è¡Œæ¶ˆæ¯è°ƒç”¨æ—¶ï¼Œå…¶å®æ˜¯æœ‰ä¸¤ä¸ªéšè—å‚æ•°çš„ï¼Œä¸€ä¸ªæ˜¯æ¥æ”¶è€…(receiver)ï¼Œä¸€ä¸ªæ˜¯æ–¹æ³•é€‰æ‹©å™¨(selector)ã€‚</p><p>å¸¸è§çš„ <code>self</code> è¡¨ç¤ºçš„æ˜¯æ¥æ”¶è€…ã€‚è€Œ <code>super</code> å…¶å®æ˜¯ä¸€ä¸ªç¼–è¯‘å™¨æ ‡ç¤ºç¬¦ï¼Œå½“å‘é€ç»™ <code>super</code> ä¸€ä¸ªæ¶ˆæ¯æ—¶ï¼Œè°ƒç”¨è€…ä»ç„¶æ˜¯ <code>self</code> ï¼Œä½†æ˜¯è¿è¡Œæ—¶ä¼šä»å½“å‰ç±»çš„çˆ¶ç±»å¼€å§‹æŸ¥æ‰¾æ–¹æ³•ã€‚</p><blockquote><p>ä»¥ä¸‹ä»£ç è¾“å‡ºï¼Ÿ</p></blockquote><div class="language-objc line-numbers-mode" data-ext="objc"><pre class="language-objc"><code><span class="token keyword">@interface</span> Animal
<span class="token keyword">@end</span>
<span class="token keyword">@interface</span> Dog <span class="token punctuation">:</span> Animal
<span class="token keyword">@end</span>
<span class="token keyword">@implementation</span> Dog
<span class="token operator">-</span> <span class="token punctuation">(</span>instancetype<span class="token punctuation">)</span>init <span class="token punctuation">{</span>
  <span class="token keyword">self</span> <span class="token operator">=</span> <span class="token punctuation">[</span><span class="token keyword">super</span> init<span class="token punctuation">]</span><span class="token punctuation">;</span>
  <span class="token keyword">if</span> <span class="token punctuation">(</span><span class="token keyword">self</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
      <span class="token function">NSLog</span><span class="token punctuation">(</span><span class="token string">@&quot;%@&quot;</span><span class="token punctuation">,</span> <span class="token function">NSStringFromClass</span><span class="token punctuation">(</span><span class="token punctuation">[</span><span class="token keyword">self</span> class<span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
      <span class="token function">NSLog</span><span class="token punctuation">(</span><span class="token string">@&quot;%@&quot;</span><span class="token punctuation">,</span> <span class="token function">NSStringFromClass</span><span class="token punctuation">(</span><span class="token punctuation">[</span><span class="token keyword">super</span> class<span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
  <span class="token punctuation">}</span>
  <span class="token keyword">return</span> <span class="token keyword">self</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span>
<span class="token keyword">@end</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p>ä¹Ÿå°±æ˜¯è¯´ <code>super</code> å¹¶ä¸ä¼šæ”¹å˜æ¶ˆæ¯çš„æ¥æ”¶è€…ï¼Œæ‰€ä»¥å½“æˆ‘ä»¬è°ƒç”¨ <code>[super class]</code> æ—¶ï¼Œè™½ç„¶æ˜¯ä»çˆ¶ç±»å¼€å§‹æŸ¥æ‰¾ <code>class</code> æ–¹æ³•ï¼Œä½†æ˜¯æ–¹æ³•çš„æ¥æ”¶è€…ä¾ç„¶æ˜¯ <code>self</code> æœ¬èº«ï¼Œå…¶ç±»åˆ«è‡ªç„¶æ˜¯å½“å‰ç±»æœ¬èº«ã€‚è¿™ä¹Ÿæ˜¯ä¸ºä»€ä¹ˆæˆ‘ä»¬å†è°ƒç”¨ <code>[super class]</code> æ—¶è¿˜ä¼šè¿”å› <code>Dog</code> ç±»çš„åŸå› ã€‚</p></details><blockquote><p><code>super</code> çš„åº•å±‚å®ç°ï¼Ÿ</p></blockquote><details class="hint-container details"><summary>ğŸ’¡</summary><p><code>OC</code> ä¸­ <code>super</code> çš„å®ç°æ˜¯é€šè¿‡ <code>runtime</code> çš„ <code>objc_msgSendSuper</code> å’Œ <code>objc_msgSendSuper_stret</code> ä¸¤ä¸ªå‡½æ•°æ¥å®Œæˆçš„ã€‚å…·ä½“æ¥è¯´ï¼Œå½“ç¼–è¯‘å™¨é‡åˆ° <code>[super method]</code> è¿™ç§å½¢å¼çš„è°ƒç”¨æ—¶ï¼Œä¼šè½¬åŒ–ä¸º <code>objc_msgSendSuper(super_cls, sel)</code> çš„å½¢å¼ã€‚</p><div class="language-c line-numbers-mode" data-ext="c"><pre class="language-c"><code><span class="token comment">// super ç»“æ„ä½“</span>
<span class="token keyword">struct</span> <span class="token class-name">objc_super</span> <span class="token punctuation">{</span>
  __unsafe_unretained id receiver<span class="token punctuation">;</span>        <span class="token comment">// æ¶ˆæ¯çš„æ¥æ”¶è€…</span>
  __unsafe_unretained Class super_class<span class="token punctuation">;</span>  <span class="token comment">// çˆ¶ç±»(å¼€å§‹æŸ¥æ‰¾çš„ç±»)</span>
<span class="token punctuation">}</span><span class="token punctuation">;</span>
<span class="token comment">// objc_msgSendSuper</span>
<span class="token keyword">void</span> <span class="token function">objc_msgSendSuper</span><span class="token punctuation">(</span><span class="token keyword">struct</span> <span class="token class-name">objc_super</span> <span class="token operator">*</span>super<span class="token punctuation">,</span> SEL op<span class="token punctuation">,</span> <span class="token punctuation">.</span><span class="token punctuation">.</span><span class="token punctuation">.</span><span class="token punctuation">)</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div></details><h3 id="â“weak-çš„åº•å±‚å®ç°" tabindex="-1"><a class="header-anchor" href="#â“weak-çš„åº•å±‚å®ç°" aria-hidden="true">#</a> â“<code>weak</code> çš„åº•å±‚å®ç°ï¼Ÿ</h3><h3 id="â“oc-è¿è¡Œæ—¶åœ¨å·¥ç¨‹ä¸­çš„æœ‰è¿‡å®è·µè¿ç”¨å—" tabindex="-1"><a class="header-anchor" href="#â“oc-è¿è¡Œæ—¶åœ¨å·¥ç¨‹ä¸­çš„æœ‰è¿‡å®è·µè¿ç”¨å—" aria-hidden="true">#</a> â“<code>OC</code> è¿è¡Œæ—¶åœ¨å·¥ç¨‹ä¸­çš„æœ‰è¿‡å®è·µè¿ç”¨å—ï¼Ÿ</h3>`,19);function l(r,u){return n(),e("div",null,[d,c(" more "),p])}const m=a(i,[["render",l],["__file","runtime.html.vue"]]);export{m as default};
